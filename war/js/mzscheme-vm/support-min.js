var sys={print:function(d){d=d.toString().replace(RegExp("\n","g"),"<br />");document.write(d)},error:function(d){typeof console!=="undefined"&&console.log?d.stack?console.log(d.stack):console.log("Error: "+str):(d=d.toString().replace(RegExp("\n","g"),"<br />"),document.write("<br />Error: "+d+"<br />"))},inspect:function(d){return d+""}},DEBUG_ON=!1,setDebug=function(d){DEBUG_ON=d},debug=function(d){DEBUG_ON&&sys.print(d)},debugF=function(d){DEBUG_ON&&sys.print(d())},deepEqual=function(d,m){if(d===
m)return!0;for(var b in d)if(d.hasOwnProperty(b)&&(!m.hasOwnProperty(b)||!deepEqual(d[b],m[b])))return!1;for(b in m)if(m.hasOwnProperty(b)&&(!d.hasOwnProperty(b)||!deepEqual(d[b],m[b])))return!1;return!0},assert={equal:function(d,m){if(d!==m)throw alert("AssertError: "+d+" equal "+m),Error("AssertError: "+d+" equal "+m);}};if(!this.JSON)this.JSON={};
(function(){function d(b){return b<10?"0"+b:b}function m(b){h.lastIndex=0;return h.test(b)?'"'+b.replace(h,function(b){var c=A[b];return typeof c==="string"?c:"\\u"+("0000"+b.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+b+'"'}function b(c,d){var A,h,J,ca,la=q,D,W=d[c];W&&typeof W==="object"&&typeof W.toJSON==="function"&&(W=W.toJSON(c));typeof P==="function"&&(W=P.call(d,c,W));switch(typeof W){case "string":return m(W);case "number":return isFinite(W)?String(W):"null";case "boolean":case "null":return String(W);
case "object":if(!W)return"null";q+=C;D=[];if(Object.prototype.toString.apply(W)==="[object Array]"){ca=W.length;for(A=0;A<ca;A+=1)D[A]=b(A,W)||"null";J=D.length===0?"[]":q?"[\n"+q+D.join(",\n"+q)+"\n"+la+"]":"["+D.join(",")+"]";q=la;return J}if(P&&typeof P==="object"){ca=P.length;for(A=0;A<ca;A+=1)h=P[A],typeof h==="string"&&(J=b(h,W))&&D.push(m(h)+(q?": ":":")+J)}else for(h in W)Object.hasOwnProperty.call(W,h)&&(J=b(h,W))&&D.push(m(h)+(q?": ":":")+J);J=D.length===0?"{}":q?"{\n"+q+D.join(",\n"+q)+
"\n"+la+"}":"{"+D.join(",")+"}";q=la;return J}}if(typeof Date.prototype.toJSON!=="function")Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+d(this.getUTCMonth()+1)+"-"+d(this.getUTCDate())+"T"+d(this.getUTCHours())+":"+d(this.getUTCMinutes())+":"+d(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()};var c=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
h=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,q,C,A={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},P;if(typeof JSON.stringify!=="function")JSON.stringify=function(c,d,A){var h;C=q="";if(typeof A==="number")for(h=0;h<A;h+=1)C+=" ";else typeof A==="string"&&(C=A);if((P=d)&&typeof d!=="function"&&(typeof d!=="object"||typeof d.length!=="number"))throw Error("JSON.stringify");return b("",
{"":c})};if(typeof JSON.parse!=="function")JSON.parse=function(b,d){function A(b,c){var C,h,w=b[c];if(w&&typeof w==="object")for(C in w)Object.hasOwnProperty.call(w,C)&&(h=A(w,C),h!==void 0?w[C]=h:delete w[C]);return d.call(b,c,w)}var C,b=String(b);c.lastIndex=0;c.test(b)&&(b=b.replace(c,function(b){return"\\u"+("0000"+b.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(b.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return C=eval("("+b+")"),typeof d==="function"?A({"":C},""):C;throw new SyntaxError("JSON.parse");}})();var helpers={};
(function(){var d=function(b){throw types.schemeError(b);},m=function(b,c,h){if(h&&h.length>1){for(var w=["~a: expects type <~a> as ~a arguments, given: ~s; other arguments were:"],q=0;q<h.length;q++)q!=c-1&&w.push(types.toWrittenString(h[q]));c=w.join(" ")}else c="~a: expects argument of type <~a>, given: ~s",b.splice(2,1);d(types.incompleteExn(types.exnFailContract,helpers.format(c,b),[]))},b=function(b){if(b===types.EMPTY)return!0;for(;types.isPair(b);)b=b.rest();return b===types.EMPTY},c=function(b,
c){if(b===types.EMPTY)return!0;for(;types.isPair(b);){if(!c(b.first()))return!1;b=b.rest()}return b===types.EMPTY},h=function(b){var c=b;if(c===types.EMPTY)return[];else{if(types.isPair(c))for(b=[];!c.isEmpty();)b.push(h(c.first())),c=c.rest();return b}},q=function(c){if(!b(c))return[c];for(var d=[];!c.isEmpty();)d=d.concat(q(c.first())),c=c.rest();return d};helpers.format=function(b,c,h){var w=function(){h=h||"#<procedure>";for(var w=b.match(RegExp("~[sSaA]","g")),w=[h+": format string requires "+
(w==null?0:w.length)+" arguments, given "+c.length+"; arguments were:",types.toWrittenString(b)],q=0;q<c.length;q++)w.push(types.toWrittenString(c[q]));d(types.incompleteExn(types.exnFailContract,w.join(" "),[]))},q=RegExp("~[sSaAn%~]","g"),m=c.slice(0),q=b.replace(q,function(b){if(b=="~~")return"~";else if(b=="~n"||b=="~%")return"\n";else if(b=="~s"||b=="~S")return m.length==0&&w(),types.toWrittenString(m.shift());else if(b=="~a"||b=="~A")return m.length==0&&w(),types.toDisplayedString(m.shift());
else throw types.internalError("format: string.replace matched invalid regexp",!1);});m.length>0&&w();return q};helpers.forEachK=function(b,c,d,h){var q=function(m){if(m>=b.length)h&&h();else try{c(b[m],function(){q(m+1)})}catch(X){d(X)}};q(0)};helpers.reportError=function(b){var c;c=typeof console!="undefined"&&typeof console.log!="undefined"?function(b){console.log(b)}:function(b){alert(b)};typeof b=="string"?c(b):types.isSchemeError(b)?types.isExn(b.val)?c(types.exnMessage(b.val)):c(b.val):b.message?
c(b.message):c(b.toString())};helpers.raise=d;helpers.procArityContains=function(b){return function(c){var d=function(c){if(c instanceof types.ContinuationClosureValue)return!0;return c.numParams==b||c.isRest&&c.numParams<=b},h=[];if(c instanceof types.ContinuationClosureValue||c instanceof types.ClosureValue||c instanceof types.PrimProc)return d(c);else if(c instanceof types.CasePrimitive)h=c.cases;else if(c instanceof types.CaseLambdaValue)h=c.closures;for(c=0;c<h.length;c++)if(d(h[c]))return!0;
return!1}};helpers.throwCheckError=m;helpers.isList=b;helpers.isListOf=c;helpers.check=function(b,c,d,h,q,T){c(b)||m([d,h,helpers.ordinalize(q),b],q,T)};helpers.checkListOf=function(b,d,h,w,q,m){c(b,d)||helpers.throwCheckError([h,"list of "+w,helpers.ordinalize(q),b],q,m)};helpers.map=function(b,c){for(var d=Array(c.length),h=0;h<c.length;h++)d[h]=b(c[h]);return d};helpers.schemeListToArray=function(b){for(var c=[];!b.isEmpty();)c.push(b.first()),b=b.rest();return c};helpers.deepListToArray=h;helpers.flattenSchemeListToArray=
q;helpers.assocListToHash=function(b){for(var c={};!b.isEmpty();){var d=b.first().first(),h=b.first().rest().first();c[d]=h;b=b.rest()}return c};helpers.ordinalize=function(b){if(b%100==11)return b+"th";var c=b;switch(b%10){case 1:c+="st";break;case 2:c+="nd";break;case 3:c+="rd";break;default:c+="th"}return c};helpers.wrapJsObject=function(b){return b===void 0?types.jsObject("undefined",b):b===null?types.jsObject("null",b):typeof b=="function"?types.jsObject("function",b):b instanceof Array?types.jsObject("array",
b):typeof b=="string"?types.jsObject("'"+b.toString()+"'",b):types.jsObject(b.toString(),b)};helpers.getKeyCodeName=function(b){b=b.charCode||b.keyCode;switch(b){case 16:b="shift";break;case 17:b="control";break;case 19:b="pause";break;case 27:b="escape";break;case 33:b="prior";break;case 34:b="next";break;case 35:b="end";break;case 36:b="home";break;case 37:b="left";break;case 38:b="up";break;case 39:b="right";break;case 40:b="down";break;case 42:b="print";break;case 45:b="insert";break;case 46:b=
String.fromCharCode(127);break;case 106:b="*";break;case 107:b="+";break;case 109:b="-";break;case 110:b=".";break;case 111:b="/";break;case 144:b="numlock";break;case 145:b="scroll";break;case 186:b=";";break;case 187:b="=";break;case 188:b=",";break;case 189:b="-";break;case 190:b=".";break;case 191:b="/";break;case 192:b="`";break;case 219:b="[";break;case 220:b="\\";break;case 221:b="]";break;case 222:b="'";break;default:b=b>=96&&b<=105?(b-96).toString():b>=112&&b<=123?"f"+(b-111):String.fromCharCode(b).toLowerCase()}return b};
helpers.maybeCallAfterAttach=function(b){for(b=[b];b.length!==0;){var c=b.pop();c.afterAttach&&c.afterAttach(c);if(c.hasChildNodes&&c.hasChildNodes())for(var c=c.childNodes,d=0;d<c.length;d++)b.push(c[d])}};helpers.makeLocationDom=function(b){var c=document.createElement("span"),d=document.createElement("span"),h=document.createElement("span"),q=document.createElement("span"),m=document.createElement("span"),X=document.createElement("span");c.className="location-reference";d.className="location-id";
h.className="location-offset";q.className="location-line";m.className="location-column";X.className="location-span";d.appendChild(document.createTextNode(b.id+""));h.appendChild(document.createTextNode(b.offset+""));q.appendChild(document.createTextNode(b.line+""));m.appendChild(document.createTextNode(b.column+""));X.appendChild(document.createTextNode(b.span+""));c.appendChild(d);c.appendChild(h);c.appendChild(q);c.appendChild(m);c.appendChild(X);return c};helpers.isLocationDom=function(b){return b&&
(b.nodeType===Node.TEXT_NODE||b.nodeType===Node.ELEMENT_NODE)&&b.className==="location-reference"}})();var jsworld={};
(function(){function d(){}function m(b){U.push(b)}function b(b){b=U.indexOf(b);b!=-1&&U.splice(b,1)}function c(){Q=new d;U=[];for(var b=0;b<z.length;b++)z[b]();z=[]}function h(b,e){var c=Q,d=function(){if(Q instanceof l){var b=Q.getEffects();helpers.forEachK(b,function(b,e){b.invokeEffect(h,e)},function(b){throw b;},function(){Q=Q.getWorld();o()})}else o()},o=function(){helpers.forEachK(U,function(b,e){b(Q,c,e)},function(b){Q=c;throw b;},e)};try{b(Q,function(b){Q=b;d()})}catch(u){throw Q=c,typeof console!==
"undefined"&&console.log&&u.stack&&console.log(u.stack),u;}}function q(b,e){for(var c=Array(b.length),l=0;l<b.length;l++)c[l]=e(b[l]);return c}function C(b,e){for(var c=[],l=0;l<b.length;l++)c=c.concat(e(b[l]));return c}function A(b,e){for(var c=0;c<b.length;c++)if(b[c]==e)return!0;return!1}function P(b){for(var e=[b],b=b.firstChild;b!=null;b=b.nextSibling)e.push(P(b));return e}function w(b){var e=[b.node];if(b.node.jsworldOpaque==!0)return e;for(var c=0;c<b.children.length;c++)e=e.concat(w(b.children[c]));
return e}function L(b){var e=[];if(b.node.jsworldOpaque==!0)return[];for(var c=0;c<b.children.length;c++)e.push({relation:"parent",parent:b.node,child:b.children[c].node});for(c=0;c<b.children.length-1;c++)e.push({relation:"neighbor",left:b.children[c].node,right:b.children[c+1].node});for(c=0;c<b.children.length;c++)e=e.concat(L(b.children[c]));return e}function T(b,e,c){function l(b,e){var c=b.compareDocumentPosition(e);if(c&b.DOCUMENT_POSITION_CONTAINED_BY)return 1;if(c&b.DOCUMENT_POSITION_CONTAINS)return-1;
if(c&b.DOCUMENT_POSITION_FOLLOWING)return-1;if(c&b.DOCUMENT_POSITION_PRECEDING)return 1;return 0}for(var d=0;d<c.length;d++)if(c[d].relation=="parent"){var u=c[d].parent,Z=c[d].child;Z.parentNode&&u&&Z.parentNode===u||u.appendChild(Z)}for(u=!0;u;){u=!1;for(d=0;d<c.length;d++)if(c[d].relation=="neighbor"){var Z=c[d].left,o=c[d].right;if(!Z.nextSibling||!(o&&Z.nextSibling===o))Z.parentNode.insertBefore(Z,o),u=!0}}var I;try{I=e.concat(b).sort(l)}catch(y){I=null}c=b;for(b=b.parentNode;c!=b;){for(;!(c.firstChild==
null||c.jsworldOpaque);)c=c.firstChild;for(;c!=b;){Z=c.nextSibling;u=c.parentNode;o=!1;if(I!=null)for(;I.length>0&&l(c,I[0])>=0;){if((d=I.shift())&&c&&d===c){o=!0;break}}else for(d=0;d<e.length;d++)if(e[d]&&c&&e[d]===c){o=!0;break}if(!o){if(!c.isJsworldOpaque)for(;c.firstChild!=null;)c.parentNode.appendChild(c.firstChild);Z=c.nextSibling;c.parentNode.removeChild(c)}if(Z==null)c=u;else{c=Z;break}}}la(e)}function X(b){return b.replace(/\-(.)/g,function(b,e){return e.toUpperCase()})}function J(b,e){for(var c=
0;c<e.length;c++)b.style[X(e[c].attrib)]=e[c].values.join(" ")}function ca(b,e){for(var c=0;c<b.length;c++);for(c=0;c<e.length;c++)if("id"in e[c])for(var d=0;d<b.length;d++)(e[c].id.match(/^\./)?"class"in b[d]&&A(b[d]["class"].split(/\s+/),e[c].id.substring(1)):"id"in b[d]&&b[d].id==e[c].id)&&J(b[d],e[c].attribs);else J(e[c].node,e[c].attribs)}function la(b){for(var e=0;e<b.length;e++)if(b[e].onWorldChange)b[e].onWorldChange(Q)}function D(b,e,c,l,o,u){e instanceof d?l(b,function(e){var d=V(e),l=w(d);
o(b,function(b){ca(l,C(b,t));T(c,l,L(d));u()})}):W(function(u){l(e,function(d){l(b,function(l){o(e,function(e){o(b,function(b){var o=V(l),I=w(o);d!==l?(ca(I,C(b,t)),T(c,I,L(o))):e!==b&&ca(I,C(b,t));u()})})})})},u)}function W(b,e){var c;na!=void 0?(c=new ga,b(function(){c.restore();e()})):b(function(){e()})}function ga(){this.focused=na;this.selectionStart=na.selectionStart;this.selectionEnd=na.selectionEnd}function fa(b,e,c,d,l){this.top=b;this.world=e;this.handlers=d;this.handlerCreators=c;this.attribs=
l}function N(b,e,d,l,o){c();var u=q(d,function(b){return b()});H.length>0&&H[H.length-1].pause();var Z=new fa(b,e,d,u,l);H.push(Z);m(function(b,e,c){Z.world=b;c()});for(var y=new sa(function(b,e){e(!1)},function(b,e){e(b)}),d=0;d<u.length;d++)if(u[d]instanceof sa)y=u[d];else u[d].onRegister(b);m(function(b,e,c){y.test(b,function(e){e?(G.shutdown(),o(b)):c()})});I(b,l);h(function(b,c){c(e)},va)}function sa(b,e){this.test=b;this.receiver=e}function aa(b,e,c){b.addEventListener?b.addEventListener(e,
c,!1):b.attachEvent("on"+e,c,!1)}function F(b,e,c){var d=function(b){h(function(e,d){c(e,b,d)},va)};aa(b,e,d);z.push(function(){Y(b,e,d)})}function ja(b,e,c){var d=function(b){setTimeout(function(){h(function(e,d){c(e,b,d)},va)},0)};aa(b,e,d);z.push(function(){Y(b,e,d)})}function K(b){aa(b,"focus",function(){na=b});aa(b,"blur",function(){na=void 0});return b}function V(b){return isPage(b)?V(P(b.toDomNode())):b.length==void 0?{node:b,children:[]}:{node:b[0],children:q(b.slice(1),V)}}function ha(b){return{attrib:b[0],
values:b.slice(1)}}function t(b){var e=q(b.slice(1),ha);return typeof b[0]=="string"?[{id:b[0],attribs:e}]:"length"in b[0]?q(b[0],function(b){return{id:b,attribs:e}}):[{node:b[0],attribs:e}]}function k(b,c){if(!isPage(b))if(!b instanceof Array&&ma(b,c),b.length==0&&ma(b,c),b[0].nodeType==Node.TEXT_NODE){if(b.length>1)throw new e(helpers.format("Text node ~s can not have children",[b]),b);}else if(b[0].nodeType==Node.ELEMENT_NODE)for(var d=1;d<b.length;d++)k(b[d],b);else throw new e(helpers.format("expected a Text or an Element, received ~s within ~s",
[b,c]),b[0]);}function e(b,e){this.msg=b;this.elt=e}function I(b,e){if(e)for(a in e)e.hasOwnProperty(a)&&(typeof e[a]=="function"?F(b,a,e[a]):b[a]=e[a]);return b}function y(b){return K(I(document.createElement("div"),b))}function E(b){var e=document.createElement("div");e.appendChild(document.createTextNode(b));e.style["white-space"]="pre";e.jsworldOpaque=!0;return e}function $(b){var e=document.createElement("option");e.text=b.value;e.value=b.value;return e}jsworld.Jsworld={};var G=jsworld.Jsworld,
na=!1,va=function(){},Q=new d,U=[],z=[],H=[];G.shutdown=function(){for(;H.length>0;){var b=H.pop();b&&b.pause()}c()};G.change_world=h;Number.prototype.NaN0=function(){return isNaN(this)?0:this};G.getPosition=function(b){for(var e=0,c=0;b.offsetParent;)e+=b.offsetLeft+(b.currentStyle?parseInt(b.currentStyle.borderLeftWidth).NaN0():0),c+=b.offsetTop+(b.currentStyle?parseInt(b.currentStyle.borderTopWidth).NaN0():0),b=b.offsetParent;e+=b.offsetLeft+(b.currentStyle?parseInt(b.currentStyle.borderLeftWidth).NaN0():
0);c+=b.offsetTop+(b.currentStyle?parseInt(b.currentStyle.borderTopWidth).NaN0():0);return{x:e,y:c}};var wa=0;G.gensym=function(){return wa++};G.map=q;G.mapi=function(b,e){for(var c=Array(b.length),d=0;d<b.length;d++)c[d]=e(b[d],d);return c};G.fold=function(b,e,c){for(var d=0;d<b.length;d++)e=c(b[d],e);return e};G.augment=function(b,e){var c={},d;for(d in b)c[d]=b[d];for(d in e)c[d]=e[d];return c};G.assoc_cons=function(b,e,c){var d={},l;for(l in b)d[l]=b[l];d[e]=c;return d};G.cons=function(b,e){return[b].concat(e)};
G.append=function(b,e){return b.concat(e)};G.array_join=function(b,e){for(var c=[],d=0;d<b.length;d++)c.push([b[d],e[d]]);return c};G.removeq=function(b,e){for(var c=0;c<b.length;c++)if(b[c]===e)return b.slice(0,c).concat(b.slice(c+1));return b};G.removef=function(b){for(var e=0;e<b.length;e++)if(f(b[e]))return b.slice(0,e).concat(b.slice(e+1));return b};G.filter=function(b,e){for(var c=[],d=0;d<b.length;d++)e(b[d])&&c.push(b[d]);return c};G.without=function(b,e){var c={},d;for(d in b)d!=e&&(c[d]=
b[d]);return c};G.memberq=function(b,e){for(var c=0;c<b.length;c++)if(b[c]===e)return!0;return!1};G.member=A;G.head=function(b){return b[0]};G.tail=function(b){return b.slice(1,b.length)};G.node_to_tree=P;ga.prototype.restore=function(){if(this.focused.parentNode)this.focused.selectionStart=this.selectionStart,this.focused.selectionEnd=this.selectionEnd,this.focused.focus();else if(this.focused.id){var b=document.getElementById(this.focused.id);if(b)b.selectionStart=this.selectionStart,b.selectionEnd=
this.selectionEnd,b.focus()}};fa.prototype.restart=function(){N(this.top,this.world,this.handlerCreators,this.attribs)};fa.prototype.pause=function(){for(var b=0;b<this.handlers.length;b++)if(!(this.handlers[b]instanceof sa))this.handlers[b].onUnregister(top)};G.big_bang=N;G.on_tick=function(b,e){return function(){var c={watchId:-1,onRegister:function(){c.watchId=setInterval(function(){h(e,va)},b)},onUnregister:function(){clearInterval(c.watchId)}};return c}};G.on_key=function(b){return function(){var e=
function(e){O(e);da(e);h(function(c,d){b(c,e,d)},va)};return{onRegister:function(b){aa(b,"keydown",e)},onUnregister:function(b){Y(b,"keydown",e)}}}};G.on_draw=function(e,c){var d=function(b,c){e(b,function(b){k(b,b);c(b)})};return function(){var e={_top:null,_listener:function(b,u,l){D(b,u,e._top,d,c,l)},onRegister:function(b){e._top=b;m(e._listener)},onUnregister:function(){b(e._listener)}};return e}};G.stop_when=function(b,e){return function(){e==void 0&&(e=function(b,e){e(b)});return new sa(b,
e)}};G.on_world_change=function(e){var c=function(b,c,d){e(b,d)};return function(){return{onRegister:function(){m(c)},onUnregister:function(){b(c)}}}};var Y=function(b,e,c){b.addEventListener?b.removeEventListener(e,c,!1):b.detachEvent("on"+e,c,!1)},ma=function(b,c){throw new e(helpers.format("Expected a non-empty array, received ~s within ~s",[b,c]),b);};e.prototype.toString=function(){return"on-draw: "+this.msg};G.p=function(b){return K(I(document.createElement("p"),b))};G.div=y;G.button=function(b,
e){var c=document.createElement("button");c.onclick=function(){return!1};F(c,"click",b);return K(I(c,e))};var O=function(b){b.preventDefault?b.preventDefault():b.returnValue=!1},da=function(b){b.stopPropagation?b.stopPropagation():b.cancelBubble=!0},ia=function(b){aa(b,"click",function(b){da(b)});return b};G.input=function(b,e,c){var b=b.toLowerCase(),d={text:ba,password:ba,checkbox:ra};if(d[b])return d[b](b,e,c);else throw Error("js-input: does not currently support type "+b);};var ba=function(b,
e,c){var d=document.createElement("input");d.type=b;ja(d,"keypress",function(b,c,u){e(b,d.value,u)});var l=d.value,u=setInterval(function(){if(d.parentNode){if(l!=d.value)l=d.value,h(function(b,c){e(b,d.value,c)},va)}else clearInterval(u)},1E3);return ia(K(I(d,c)))},ra=function(b,e,c){var d=document.createElement("input");d.type=b;ja(d,"change",function(b,c,l){e(b,d.checked,l)});aa(d,"click",function(b){da(b)});return I(d,c)};G.text=E;G.select=function(b,e,c){for(var d=document.createElement("select"),
l=0;l<e.length;l++)d.add($({value:e[l]}),null);d.jsworldOpaque=!0;F(d,"change",c);return K(I(d,b))};G.textarea=function(b){return K(I(document.createElement("textarea"),b))};G.h1=function(b){return K(I(document.createElement("h1"),b))};G.canvas=function(b){return K(I(document.createElement("canvas"),b))};G.img=function(b,e){var c=document.createElement("img");c.src=b;return K(I(c,e))};G.raw_node=function(b,e){return K(I(b,e))};var l=function(b,e){b instanceof l?(this.w=b.w,this.e=b.e.concat(e)):(this.w=
b,this.e=e)};l.prototype.getWorld=function(){return this.w};l.prototype.getEffects=function(){return this.e};G.with_effect=function(b,e){return new l(b,[e])};G.with_multiple_effects=function(b,e){return new l(b,e)};G.has_effects=function(b){return b instanceof l};G.alert_effect=function(b){return new o(b)};var o=function(b){this.msg=b};o.prototype.invokeEffect=function(b){alert(this.msg);b()};G.music_effect=function(b){return new oa(b)};var oa=function(b){this.musicUrl=b};oa.prototype.invokeEffect=
function(b){(new Audio(url)).play();b()};var Ga=function(b,e){typeof b==="undefined"&&(b=[]);this.elts=b;this.attribs=e};Ga.prototype.add=function(b,e,c){return new Ga(this.elts.concat([{elt:b,positionTop:c,positionLeft:e}]),this.attribs)};Ga.prototype.toDomNode=function(){for(var b=y(),e=0;e<this.elts.length;e++){var c=this.elts[e].elt;if(!c.style)c.style="";c.style.position="absolute";c.style.left=this.elts[e].positionLeft+"px";c.style.top=this.elts[e].positionTop+"px";b.appendChild(c)}I(b,this.attribs);
return b};isPage=function(b){return b instanceof Ga};G.isPage=isPage;G.emptyPage=function(b){return new Ga([],b)};G.placeOnPage=function(b,e,c,d){typeof b==="string"&&(b=E(b));return d.add(b,e,c)}})();var jsnums={};
(function(){function d(g,b,j){g!=null&&("number"==typeof g?this.fromNumber(g,b,j):b==null&&"string"!=typeof g?this.fromString(g,256):this.fromString(g,b))}function m(){return new d(null)}function b(g,b,j,e,c,p){for(;--p>=0;){var u=b*this[g++]+j[e]+c,c=Math.floor(u/67108864);j[e++]=u&67108863}return c}function c(g,b,j,e,c,p){var u=b&32767;for(b>>=15;--p>=0;){var v=this[g]&32767,i=this[g++]>>15,d=b*v+i*u,v=u*v+((d&32767)<<15)+j[e]+(c&1073741823),c=(v>>>30)+(d>>>15)+b*i+(c>>>30);j[e++]=v&1073741823}return c}
function h(g,b,j,e,c,p){var u=b&16383;for(b>>=14;--p>=0;){var v=this[g]&16383,i=this[g++]>>14,d=b*v+i*u,v=u*v+((d&16383)<<14)+j[e]+c,c=(v>>28)+(d>>14)+b*i;j[e++]=v&268435455}return c}function q(g,b){var j=cb[g.charCodeAt(b)];return j==null?-1:j}function C(g){var b=m();b.fromInt(g);return b}function A(g){var b=this.s-g.s;if(b!=0)return b;var j=this.t,b=this.s<0?g.t-j:j-g.t;if(b!=0)return b;for(;--j>=0;)if((b=this[j]-g[j])!=0)return b;return 0}function P(g){var b=1,j;if((j=g>>>16)!=0)g=j,b+=16;if((j=
g>>8)!=0)g=j,b+=8;if((j=g>>4)!=0)g=j,b+=4;if((j=g>>2)!=0)g=j,b+=2;g>>1!=0&&(b+=1);return b}function w(g){var b=m();this.abs().divRemTo(g,null,b);this.s<0&&b.compareTo(d.ZERO)>0&&g.subTo(b,b);return b}function L(g){this.m=g}function T(g){this.m=g;this.mp=g.invDigit();this.mpl=this.mp&32767;this.mph=this.mp>>15;this.um=(1<<g.DB-15)-1;this.mt2=2*g.t}function X(g){return this.compareTo(g)==0}function J(g,b){return g&b}function ca(g,b){return g|b}function la(g,b){return g^b}function D(g,b){return g&~b}
function W(g){var b=m();this.addTo(g,b);return b}function ga(g){var b=m();this.subTo(g,b);return b}function fa(g){var b=m();this.multiplyTo(g,b);return b}function N(g){var b=m();this.divRemTo(g,b,null);return b}function sa(g){var b=m();this.divRemTo(g,null,b);return b}function aa(g){var b=m(),j=m();this.divRemTo(g,b,j);return[b,j]}function F(){}function ja(g){return g}function K(g){return this.exp(g,new F)}function V(g){this.r2=m();this.q3=m();d.ONE.dlShiftTo(2*g.t,this.r2);this.mu=this.r2.divide(g);
this.m=g}function ha(g){var b=this.s<0?this.negate():this.clone(),g=g.s<0?g.negate():g.clone();if(b.compareTo(g)<0)var j=b,b=g,g=j;var j=b.getLowestSetBit(),e=g.getLowestSetBit();if(e<0)return b;j<e&&(e=j);e>0&&(b.rShiftTo(e,b),g.rShiftTo(e,g));for(;b.signum()>0;)(j=b.getLowestSetBit())>0&&b.rShiftTo(j,b),(j=g.getLowestSetBit())>0&&g.rShiftTo(j,g),b.compareTo(g)>=0?(b.subTo(g,b),b.rShiftTo(1,b)):(g.subTo(b,g),g.rShiftTo(1,g));e>0&&g.lShiftTo(e,g);return g}var t=jsnums,k=function(g,b,j){j=j||{};return function(e,
c){if(j.isXSpecialCase&&j.isXSpecialCase(e))return j.onXSpecialCase(e,c);if(j.isYSpecialCase&&j.isYSpecialCase(c))return j.onYSpecialCase(e,c);if(typeof e==="number"&&typeof c==="number")return g(e,c);typeof e==="number"&&(e=I(e,c));typeof c==="number"&&(c=I(c,e));e.level<c.level&&(e=e.liftTo(c));c.level<e.level&&(c=c.liftTo(e));return b(e,c)}},e=function(g){if(isNaN(g)||!isFinite(g))return r.makeInstance(g);var b=Math.floor(g);return b===g?La(b)?Fa(g):b:r.makeInstance(g)},I=function(g,b){switch(b.level){case 0:return Fa(g);
case 1:return new M(g,1);case 2:return new r(g);case 3:return new B(g,0);default:y("IMPOSSIBLE: cannot lift fixnum integer to "+b.toString(),g,b)}},y=function(g,b,j){t.onThrowRuntimeError(g,b,j)},E=function(g){return typeof g==="number"||g instanceof M||g instanceof r||g instanceof B||g instanceof d},$=function(g){return typeof g==="number"||E(g)&&g.isRational()},G=function(g){return typeof g==="number"||E(g)&&g.isReal()},na=function(g){return typeof g==="number"||E(g)&&g.isExact()},va=function(g){return typeof g===
"number"?!1:E(g)&&g.isInexact()},Q=function(g){return typeof g==="number"||E(g)&&g.isInteger()},U=function(g){return typeof g==="number"||E(g)&&g.isInteger()&&g.isExact()},z=function(g){if(typeof g==="number")return g;return g.toFixnum()},H=function(g){if(typeof g==="number")return g;return g.toExact()},wa=function(g){if(typeof g==="number")return r.makeInstance(g);return g.toInexact()},Y=k(function(g,b){var j=g+b;return La(j)?Fa(g).add(Fa(b)):j},function(g,b){return g.add(b)},{isXSpecialCase:function(g){return U(g)&&
j(g)},onXSpecialCase:function(g,b){return b},isYSpecialCase:function(g){return U(g)&&j(g)},onYSpecialCase:function(g){return g}}),ma=k(function(g,b){var j=g-b;return La(j)?Fa(g).subtract(Fa(b)):j},function(g,b){return g.subtract(b)},{isXSpecialCase:function(g){return U(g)&&j(g)},onXSpecialCase:function(g,b){return Ba(b)},isYSpecialCase:function(g){return U(g)&&j(g)},onYSpecialCase:function(g){return g}}),O=k(function(g,b){var j=g*b;return La(j)?Fa(g).multiply(Fa(b)):j},function(g,b){return g.multiply(b)},
{isXSpecialCase:function(g){return U(g)&&(j(g)||p(g)||v(g))},onXSpecialCase:function(g,b){if(j(g))return 0;if(p(g))return b;if(v(g))return Ba(b)},isYSpecialCase:function(g){return U(g)&&(j(g)||p(g)||v(g))},onYSpecialCase:function(g,b){if(j(b))return 0;if(p(b))return g;if(v(b))return Ba(g)}}),da=k(function(g,b){j(b)&&y("/: division by zero",g,b);var e=g/b;return La(e)?Fa(g).divide(Fa(b)):Math.floor(e)!==e?M.makeInstance(g,b):e},function(g,b){return g.divide(b)},{isYSpecialCase:function(g){return ba(g,
fb)||ba(g,ua)},onYSpecialCase:function(g,b){var j=b!==ua;return G(g)?na(g)?o(g,0)?j?Xa:Va:oa(g,0)?j?Va:Xa:0:isNaN(z(g))?Pa:o(g,0)?j?Xa:Va:oa(g,0)?j?Va:Xa:Pa:(g.level<b.level&&(g=g.liftTo(b)),b.level<g.level&&(b=b.liftTo(g)),g.divide(b))}}),ia=k(function(g,b){return g===b},function(g,b){return g.equals(b)}),ba=function(g,b){if(g===b)return!0;if(typeof g==="number"&&typeof b==="number")return g===b;if(g===ua||b===ua)return g===b;if(g instanceof B||b instanceof B)return ba(pa(g),pa(b))&&ba(ta(g),ta(b));
var j=na(g),e=na(b);return(j&&e||!j&&!e)&&ia(g,b)},ra=k(function(g,b){return g>=b},function(g,b){(!G(g)||!G(b))&&y(">=: couldn't be applied to complex number",g,b);return g.greaterThanOrEqual(b)}),l=k(function(g,b){return g<=b},function(g,b){(!G(g)||!G(b))&&y("<=: couldn't be applied to complex number",g,b);return g.lessThanOrEqual(b)}),o=k(function(g,b){return g>b},function(g,b){(!G(g)||!G(b))&&y(">: couldn't be applied to complex number",g,b);return g.greaterThan(b)}),oa=k(function(g,b){return g<
b},function(g,b){(!G(g)||!G(b))&&y("<: couldn't be applied to complex number",g,b);return g.lessThan(b)}),Ga=function(){var g=k(function(g,b){var j=Math.pow(g,b);return La(j)?Fa(g).expt(Fa(b)):j},function(g,b){return ia(b,0)?Y(b,1):g.expt(b)});return function(b,j){if(ia(j,0))return Y(j,1);if(G(j)&&oa(j,0))return g(da(1,b),Ba(j));return g(b,j)}}(),ya=function(g){if(ba(g,0))return 1;if(typeof g==="number")return r.makeInstance(Math.exp(g));return g.exp()},S=function(g,b){Q(g)||y("modulo: the first argument "+
g+" is not an integer.",g,b);Q(b)||y("modulo: the second argument "+b+" is not an integer.",g,b);var j;if(typeof g==="number")return j=g%b,b<0?j<=0?j:j+b:j<0?j+b:j;j=Za(Z(g),Z(b));if(oa(b,0)){if(l(j,0))return j;return Y(j,b)}else{if(oa(j,0))return Y(j,b);return j}},za=function(g){if(typeof g==="number")return g;return g.numerator()},qa=function(g){if(typeof g==="number")return 1;return g.denominator()},Ea=function(g){if(typeof g==="number")return g>=0?(g=Math.sqrt(g),Math.floor(g)===g?g:r.makeInstance(g)):
B.makeInstance(0,Ea(-g));return g.sqrt()},u=function(g){if(typeof g==="number")return Math.abs(g);return g.abs()},Z=function(g){if(typeof g==="number")return g;return g.floor()},ea=function(g){if(typeof g==="number")return g;return g.ceiling()},Aa=function(g){if(typeof g==="number")return g;return g.conjugate()},Oa=function(g){if(ba(g,1))return 0;if(typeof g==="number")return r.makeInstance(Math.log(g));return g.log()},Ua=function(g){if(typeof g==="number")return g>0?0:r.pi;return g.angle()},Na=function(g){if(typeof g===
"number")return r.makeInstance(Math.tan(g));return g.tan()},Ya=function(g){if(typeof g==="number")return r.makeInstance(Math.atan(g));return g.atan()},xa=function(g){if(ba(g,0))return 1;if(typeof g==="number")return r.makeInstance(Math.cos(g));return g.cos()},Wa=function(g){if(ba(g,0))return 0;if(typeof g==="number")return r.makeInstance(Math.sin(g));return g.sin()},R=function(g){if(ba(g,1))return 0;if(typeof g==="number")return r.makeInstance(Math.acos(g));return g.acos()},i=function(g){if(typeof g===
"number")return r.makeInstance(Math.asin(g));return g.asin()},ta=function(g){if(typeof g==="number")return 0;return g.imaginaryPart()},pa=function(g){if(typeof g==="number")return g;return g.realPart()},Qa=function(g){if(typeof g==="number")return g;return g.round()},Ka=function(g){return O(g,g)},db=function(g){Q(g)||y("integer-sqrt: the argument "+g.toString()+" is not an integer.",g);if(typeof g==="number")return g<0?B.makeInstance(0,Math.floor(Math.sqrt(-g))):Math.floor(Math.sqrt(g));return g.integerSqrt()},
Ra=function(g,b){Q(g)||y("quotient: the first argument "+g.toString()+" is not an integer.",g);Q(b)||y("quotient: the second argument "+b.toString()+" is not an integer.",b);return $a(g,b)},Ta=function(g,b){Q(g)||y("remainder: the first argument "+g.toString()+" is not an integer.",g);Q(b)||y("remainder: the second argument "+b.toString()+" is not an integer.",b);return nb(g,b)},La=function(g){return g<-9E15||9E15<g},Ba=function(g){if(typeof g==="number")return-g;return g.negate()},ab=function(g,
b){for(var e=1;;){if(j(b))return e;ia(S(b,2),0)?(g=O(g,g),b=da(b,2)):(e=O(e,g),b=ma(b,1))}},ka=function(g,b,j){j=j||{};return function(e,c){e instanceof M?e=za(e):e instanceof B&&(e=pa(e));c instanceof M?c=za(c):c instanceof B&&(c=pa(c));if(typeof e==="number"&&typeof c==="number"){var p=g(e,c);if(!La(p)||j.ignoreOverflow)return p}if(e instanceof r||c instanceof r)return j.doNotCoerseToFloating?g(z(e),z(c)):r.makeInstance(g(z(e),z(c)));typeof e==="number"&&(e=Fa(e));typeof c==="number"&&(c=Fa(c));
return b(e,c)}},Ca=function(g,b,j){j=j||{};return function(e){e instanceof M?e=za(e):e instanceof B&&(e=pa(e));if(typeof e==="number"){var c=g(e);if(!La(c)||j.ignoreOverflow)return c}if(e instanceof r)return g(z(e));typeof e==="number"&&(e=Fa(e));return b(e)}},Za=ka(function(g,b){return g%b},function(g,b){return w.call(g,b)}),g=ka(function(g,b){for(var j;b!==0;)j=g,g=b,b=j%b;return g},function(g,b){return ha.call(g,b)}),j=Ca(function(g){return g===0},function(g){return X.call(g,d.ZERO)}),p=Ca(function(g){return g===
1},function(g){return X.call(g,d.ONE)}),v=Ca(function(g){return g===-1},function(g){return X.call(g,d.NEGATIVE_ONE)}),Ha=ka(function(g,b){return g+b},function(g,b){return W.call(g,b)}),ob=ka(function(g,b){return g-b},function(g,b){return ga.call(g,b)}),Da=ka(function(g,b){return g*b},function(g,b){return fa.call(g,b)}),$a=ka(function(g,b){return(g-g%b)/b},function(g,b){return N.call(g,b)}),nb=ka(function(g,b){return g%b},function(g,b){return sa.call(g,b)}),Ia=ka(function(g,b){return g/b},function(g,
b){return z(g)/z(b)},{ignoreOverflow:!0,doNotCoerseToFloating:!0}),gb=ka(function(g,b){return g===b},function(g,b){return X.call(g,b)},{doNotCoerseToFloating:!0}),hb=ka(function(g,b){return g>b},function(g,b){return A.call(g,b)>0},{doNotCoerseToFloating:!0}),eb=ka(function(g,b){return g<b},function(g,b){return A.call(g,b)<0},{doNotCoerseToFloating:!0}),ib=ka(function(g,b){return g>=b},function(g,b){return A.call(g,b)>=0},{doNotCoerseToFloating:!0}),pb=ka(function(g,b){return g<=b},function(g,b){return A.call(g,
b)<=0},{doNotCoerseToFloating:!0}),M=function(g,b){this.n=g;this.d=b};M.prototype.toString=function(){return p(this.d)?this.n.toString()+"":this.n.toString()+"/"+this.d.toString()};M.prototype.level=1;M.prototype.liftTo=function(g){if(g.level===2)return new r(Ia(this.n,this.d));if(g.level===3)return new B(this,0);return y("invalid level of Number",this,g)};M.prototype.isFinite=function(){return!0};M.prototype.equals=function(g){return g instanceof M&&gb(this.n,g.n)&&gb(this.d,g.d)};M.prototype.isInteger=
function(){return p(this.d)};M.prototype.isRational=function(){return!0};M.prototype.isReal=function(){return!0};M.prototype.add=function(g){return M.makeInstance(Ha(Da(this.n,g.d),Da(this.d,g.n)),Da(this.d,g.d))};M.prototype.subtract=function(g){return M.makeInstance(ob(Da(this.n,g.d),Da(this.d,g.n)),Da(this.d,g.d))};M.prototype.negate=function(){return M.makeInstance(-this.n,this.d)};M.prototype.multiply=function(g){return M.makeInstance(Da(this.n,g.n),Da(this.d,g.d))};M.prototype.divide=function(g){(j(this.d)||
j(g.n))&&y("/: division by zero",this,g);return M.makeInstance(Da(this.n,g.d),Da(this.d,g.n))};M.prototype.toExact=function(){return this};M.prototype.toInexact=function(){return r.makeInstance(this.toFixnum())};M.prototype.isExact=function(){return!0};M.prototype.isInexact=function(){return!1};M.prototype.toFixnum=function(){return Ia(this.n,this.d)};M.prototype.numerator=function(){return this.n};M.prototype.denominator=function(){return this.d};M.prototype.greaterThan=function(g){return hb(Da(this.n,
g.d),Da(this.d,g.n))};M.prototype.greaterThanOrEqual=function(g){return ib(Da(this.n,g.d),Da(this.d,g.n))};M.prototype.lessThan=function(g){return eb(Da(this.n,g.d),Da(this.d,g.n))};M.prototype.lessThanOrEqual=function(g){return pb(Da(this.n,g.d),Da(this.d,g.n))};M.prototype.integerSqrt=function(){var g=Ea(this);return $(g)?H(Z(g)):G(g)?H(Z(g)):B.makeInstance(H(Z(pa(g))),H(Z(ta(g))))};M.prototype.sqrt=function(){if(ib(this.n,0)){var g=Ea(this.n),b=Ea(this.d);return ia(Z(g),g)&&ia(Z(b),b)?M.makeInstance(g,
b):r.makeInstance(Ia(g,b))}else return g=Ea(Ba(this.n)),b=Ea(this.d),ia(Z(g),g)&&ia(Z(b),b)?B.makeInstance(0,M.makeInstance(g,b)):B.makeInstance(0,r.makeInstance(Ia(g,b)))};M.prototype.abs=function(){return M.makeInstance(u(this.n),this.d)};M.prototype.floor=function(){var g=$a(this.n,this.d);return eb(this.n,0)?ma(g,1):g};M.prototype.ceiling=function(){var g=$a(this.n,this.d);return eb(this.n,0)?g:Y(g,1)};M.prototype.conjugate=function(){return this};M.prototype.magnitude=M.prototype.abs;M.prototype.log=
function(){return r.makeInstance(Math.log(this.n/this.d))};M.prototype.angle=function(){if(j(this.n))return 0;return hb(this.n,0)?0:r.pi};M.prototype.tan=function(){return r.makeInstance(Math.tan(Ia(this.n,this.d)))};M.prototype.atan=function(){return r.makeInstance(Math.atan(Ia(this.n,this.d)))};M.prototype.cos=function(){return r.makeInstance(Math.cos(Ia(this.n,this.d)))};M.prototype.sin=function(){return r.makeInstance(Math.sin(Ia(this.n,this.d)))};M.prototype.expt=function(g){if(U(g)&&ra(g,0))return ab(this,
g);return r.makeInstance(Math.pow(Ia(this.n,this.d),Ia(g.n,g.d)))};M.prototype.exp=function(){return r.makeInstance(Math.exp(Ia(this.n,this.d)))};M.prototype.acos=function(){return r.makeInstance(Math.acos(Ia(this.n,this.d)))};M.prototype.asin=function(){return r.makeInstance(Math.asin(Ia(this.n,this.d)))};M.prototype.imaginaryPart=function(){return 0};M.prototype.realPart=function(){return this};M.prototype.round=function(){if(ia(this.d,2)){var g=Ia(this.n,this.d),b=Math.floor(g),g=Math.ceil(g);
return j(b%2)?e(b):e(g)}else return e(Math.round(this.n/this.d))};M.makeInstance=function(b,e){b===void 0&&y("n undefined",b,e);e===void 0&&(e=1);eb(e,0)&&(b=Ba(b),e=Ba(e));var c=g(u(b),u(e)),b=$a(b,c),e=$a(e,c);if(p(e)||j(b))return b;return new M(b,e)};var r=function(g){this.n=g},Pa=new r(Number.NaN),Xa=new r(Number.POSITIVE_INFINITY),Va=new r(Number.NEGATIVE_INFINITY),jb=new r(Number.POSITIVE_INFINITY),kb=new r(Number.NEGATIVE_INFINITY),ua=new r(0),fb=new r(0);r.pi=new r(Math.PI);r.e=new r(Math.E);
r.nan=Pa;r.inf=Xa;r.neginf=Va;r.makeInstance=function(g){if(isNaN(g))return r.nan;else if(g===Number.POSITIVE_INFINITY)return r.inf;else if(g===Number.NEGATIVE_INFINITY)return r.neginf;return new r(g)};r.prototype.isExact=function(){return!1};r.prototype.isInexact=function(){return!0};r.prototype.isFinite=function(){return isFinite(this.n)||this===jb||this===kb};r.prototype.toExact=function(){(!isFinite(this.n)||isNaN(this.n))&&y("toExact: no exact representation for "+this,this);var g=this.n.toString().match(/^(.*)\.(.*)$/);
return g?(parseInt(g[1]),parseInt(g[2]),g=Math.pow(10,g[2].length),M.makeInstance(Math.round(this.n*g),g)):this.n};r.prototype.toInexact=function(){return this};r.prototype.isInexact=function(){return!0};r.prototype.level=2;r.prototype.liftTo=function(g){if(g.level===3)return new B(this,0);return y("invalid level of Number",this,g)};r.prototype.toString=function(){if(isNaN(this.n))return"+nan.0";if(this.n===Number.POSITIVE_INFINITY)return"+inf.0";if(this.n===Number.NEGATIVE_INFINITY)return"-inf.0";
if(this===ua)return"-0.0";var g=this.n.toString();return g.match("\\.")?g:g+".0"};r.prototype.equals=function(g){return g instanceof r&&this.n===g.n};r.prototype.isRational=function(){return this.isFinite()};r.prototype.isInteger=function(){return this.isFinite()&&this.n===Math.floor(this.n)};r.prototype.isReal=function(){return!0};var Sa=function(g){return oa(g,0)?-1:o(g,0)?1:g===ua?-1:0};r.prototype.add=function(g){if(this.isFinite()&&g.isFinite()){if(this===ua&&g===ua)return ua;return r.makeInstance(this.n+
g.n)}else return isNaN(this.n)||isNaN(g.n)?Pa:this.isFinite()&&!g.isFinite()?g:!this.isFinite()&&g.isFinite()?this:Sa(this)*Sa(g)===1?this:Pa};r.prototype.subtract=function(g){if(this.isFinite()&&g.isFinite()){var b=this.n-g.n;if(b===0&&g!==ua&&this===ua)return ua;return r.makeInstance(b)}else return isNaN(this.n)||isNaN(g.n)?Pa:!this.isFinite()&&!g.isFinite()?Sa(this)===Sa(g)?Pa:this:this.isFinite()?O(g,-1):this};r.prototype.negate=function(){if(this===ua)return r.makeInstance(0);else if(this.n===
0)return ua;return r.makeInstance(-this.n)};r.prototype.multiply=function(g){if(this.n===0||g.n===0){if(!(this===ua&&g===ua)&&(this===ua||g===ua))return ua;return fb}if(this.isFinite()&&g.isFinite()){var b=this.n*g.n;if(b!==0)return r.makeInstance(b);return Sa(this)*Sa(g)==1?r.makeInstance(0):ua}else return isNaN(this.n)||isNaN(g.n)?Pa:Sa(this)*Sa(g)===1?Xa:Va};r.prototype.divide=function(g){if(this.isFinite()&&g.isFinite()){if(g.n===0)return y("/: division by zero",this,g);return r.makeInstance(this.n/
g.n)}else return isNaN(this.n)||isNaN(g.n)?Pa:!this.isFinite()&&!g.isFinite()?Pa:this.isFinite()&&!g.isFinite()?r.makeInstance(0):!this.isFinite()&&g.isFinite()?Sa(this)*Sa(g)===1?Xa:Va:y("impossible",this,g)};r.prototype.toFixnum=function(){return this.n};r.prototype.numerator=function(){var b=this.n.toString().match(/^(.*)\.(.*)$/);if(b){var j=parseInt(b[2]),b=Math.pow(10,b[2].length),j=g(b,j);return r.makeInstance(Math.round(this.n*(b/j)))}else return this};r.prototype.denominator=function(){var b=
this.n.toString().match(/^(.*)\.(.*)$/);if(b){var j=parseInt(b[2]),b=Math.pow(10,b[2].length),j=g(b,j);return r.makeInstance(Math.round(b/j))}else return r.makeInstance(1)};r.prototype.floor=function(){return isFinite(this.n)?this===ua?this:r.makeInstance(Math.floor(this.n)):this};r.prototype.ceiling=function(){if(isFinite(this.n)){if(this===ua)return this}else return this;return r.makeInstance(Math.ceil(this.n))};r.prototype.greaterThan=function(g){return this.n>g.n};r.prototype.greaterThanOrEqual=
function(g){return this.n>=g.n};r.prototype.lessThan=function(g){return this.n<g.n};r.prototype.lessThanOrEqual=function(g){return this.n<=g.n};r.prototype.integerSqrt=function(){if(this===ua)return this;if(Q(this))return this.n>=0?r.makeInstance(Math.floor(Math.sqrt(this.n))):B.makeInstance(fb,r.makeInstance(Math.floor(Math.sqrt(-this.n))));else y("integerSqrt: can only be applied to an integer",this)};r.prototype.sqrt=function(){return this.n<0?B.makeInstance(0,r.makeInstance(Math.sqrt(-this.n))):
r.makeInstance(Math.sqrt(this.n))};r.prototype.abs=function(){return r.makeInstance(Math.abs(this.n))};r.prototype.log=function(){return this.n<0?(new B(this,0)).log():r.makeInstance(Math.log(this.n))};r.prototype.angle=function(){if(0===this.n)return 0;return this.n>0?0:r.pi};r.prototype.tan=function(){return r.makeInstance(Math.tan(this.n))};r.prototype.atan=function(){return r.makeInstance(Math.atan(this.n))};r.prototype.cos=function(){return r.makeInstance(Math.cos(this.n))};r.prototype.sin=function(){return r.makeInstance(Math.sin(this.n))};
r.prototype.expt=function(g){return this.n===1?(g.isFinite()||isNaN(g.n),this):r.makeInstance(Math.pow(this.n,g.n))};r.prototype.exp=function(){return r.makeInstance(Math.exp(this.n))};r.prototype.acos=function(){return r.makeInstance(Math.acos(this.n))};r.prototype.asin=function(){return r.makeInstance(Math.asin(this.n))};r.prototype.imaginaryPart=function(){return 0};r.prototype.realPart=function(){return this};r.prototype.round=function(){if(isFinite(this.n)){if(this===ua)return this;if(Math.abs(Math.floor(this.n)-
this.n)===0.5){if(Math.floor(this.n)%2===0)return r.makeInstance(Math.floor(this.n));return r.makeInstance(Math.ceil(this.n))}else return r.makeInstance(Math.round(this.n))}else return this};r.prototype.conjugate=function(){return this};r.prototype.magnitude=r.prototype.abs;var B=function(g,b){this.r=g;this.i=b};B.makeInstance=function(g,b){b===void 0&&(b=0);typeof g==="number"&&(g=e(g));typeof b==="number"&&(b=e(b));if(na(b)&&Q(b)&&j(b))return g;if(va(g)||va(b))g=wa(g),b=wa(b);return new B(g,b)};
B.prototype.toString=function(){var g=this.r.toString(),b=this.i.toString();return b[0]==="-"||b[0]==="+"?g+b+"i":g+"+"+b+"i"};B.prototype.isFinite=function(){return(typeof this.r==="number"?isFinite(this.r):this.r.isFinite())&&(typeof this.i==="number"?isFinite(this.i):this.i.isFinite())};B.prototype.isRational=function(){return $(this.r)&&ba(this.i,0)};B.prototype.isInteger=function(){return Q(this.r)&&ba(this.i,0)};B.prototype.toExact=function(){return B.makeInstance(H(this.r),H(this.i))};B.prototype.toInexact=
function(){return B.makeInstance(wa(this.r),wa(this.i))};B.prototype.isExact=function(){return na(this.r)&&na(this.i)};B.prototype.isInexact=function(){return va(this.r)||va(this.i)};B.prototype.level=3;B.prototype.liftTo=function(g){y("Don't know how to lift Complex number",this,g)};B.prototype.equals=function(g){return g instanceof B&&ia(this.r,g.r)&&ia(this.i,g.i)};B.prototype.greaterThan=function(g){(!this.isReal()||!g.isReal())&&y(">: expects argument of type real number",this,g);return o(this.r,
g.r)};B.prototype.greaterThanOrEqual=function(g){(!this.isReal()||!g.isReal())&&y(">=: expects argument of type real number",this,g);return ra(this.r,g.r)};B.prototype.lessThan=function(g){(!this.isReal()||!g.isReal())&&y("<: expects argument of type real number",this,g);return oa(this.r,g.r)};B.prototype.lessThanOrEqual=function(g){(!this.isReal()||!g.isReal())&&y("<=: expects argument of type real number",this,g);return l(this.r,g.r)};B.prototype.abs=function(){ia(this.i,0).valueOf()||y("abs: expects argument of type real number",
this);return u(this.r)};B.prototype.toFixnum=function(){ia(this.i,0).valueOf()||y("toFixnum: expects argument of type real number",this);return z(this.r)};B.prototype.numerator=function(){this.isReal()||y("numerator: can only be applied to real number",this);return za(this.n)};B.prototype.denominator=function(){this.isReal()||y("floor: can only be applied to real number",this);return qa(this.n)};B.prototype.add=function(g){return B.makeInstance(Y(this.r,g.r),Y(this.i,g.i))};B.prototype.subtract=function(g){return B.makeInstance(ma(this.r,
g.r),ma(this.i,g.i))};B.prototype.negate=function(){return B.makeInstance(Ba(this.r),Ba(this.i))};B.prototype.multiply=function(g){if(g.isReal())return B.makeInstance(O(this.r,g.r),O(this.i,g.r));var b=ma(O(this.r,g.r),O(this.i,g.i)),g=Y(O(this.r,g.i),O(this.i,g.r));return B.makeInstance(b,g)};B.prototype.divide=function(g){var b,j,e,c,p;if(g.isReal())return B.makeInstance(da(this.r,g.r),da(this.i,g.r));return this.isInexact()||g.isInexact()?(b=this.r,j=this.i,e=g.r,c=g.i,l(u(c),u(e))?(p=da(c,e),
g=da(Y(b,O(j,p)),Y(e,O(c,p))),b=da(ma(j,O(b,p)),Y(e,O(c,p)))):(p=da(e,c),g=da(Y(O(b,p),j),Y(O(e,p),c)),b=da(ma(O(j,p),b),Y(O(e,p),c))),B.makeInstance(g,b)):(j=Aa(g),b=O(this,j),j=pa(O(g,j)),B.makeInstance(da(pa(b),j),da(ta(b),j)))};B.prototype.conjugate=function(){return B.makeInstance(this.r,ma(0,this.i))};B.prototype.magnitude=function(){var g=Y(O(this.r,this.r),O(this.i,this.i));return Ea(g)};B.prototype.isReal=function(){return ba(this.i,0)};B.prototype.integerSqrt=function(){if(Q(this))return db(this.r);
else y("integerSqrt: can only be applied to an integer",this)};B.prototype.sqrt=function(){if(this.isReal())return Ea(this.r);var g=Y(this.magnitude(),this.r),b=Ea(da(g,2)),g=da(this.i,Ea(O(g,2)));return B.makeInstance(b,g)};B.prototype.log=function(){var g=this.magnitude(),b=this.angle();return Y(Oa(g),O(b,Ma))};B.prototype.angle=function(){if(this.isReal())return Ua(this.r);if(ia(0,this.r)){var g=da(r.pi,2);return o(this.i,0)?g:Ba(g)}else return g=Ya(da(u(this.i),u(this.r))),o(this.r,0)?o(this.i,
0)?g:Ba(g):o(this.i,0)?ma(r.pi,g):ma(g,r.pi)};var Ma=B.makeInstance(0,1),lb=B.makeInstance(0,-1);B.prototype.tan=function(){return da(this.sin(),this.cos())};B.prototype.atan=function(){if(ia(this,Ma)||ia(this,lb))return Va;return O(Ma,O(r.makeInstance(0.5),Oa(da(Y(Ma,this),Y(Ma,ma(0,this))))))};B.prototype.cos=function(){if(this.isReal())return xa(this.r);var g=O(this,Ma),b=Ba(g),g=Y(ya(g),ya(b));return da(g,2)};B.prototype.sin=function(){if(this.isReal())return Wa(this.r);var g=O(this,Ma),b=Ba(g),
j=B.makeInstance(0,2),g=ma(ya(g),ya(b));return da(g,j)};B.prototype.expt=function(g){if(U(g)&&ra(g,0))return ab(this,g);g=O(g,this.log());return ya(g)};B.prototype.exp=function(){var g=ya(this.r),b=xa(this.i),j=Wa(this.i);return O(g,Y(b,O(j,Ma)))};B.prototype.acos=function(){if(this.isReal())return R(this.r);var g=da(r.pi,2),b=O(this,Ma),j=Ea(ma(1,Ka(this))),b=Oa(Y(b,j)),b=O(b,Ma);return Y(g,b)};B.prototype.asin=function(){if(this.isReal())return i(this.r);var g=ma(1,Ka(this)),g=Ea(g);return O(2,
Ya(da(this,Y(1,g))))};B.prototype.ceiling=function(){this.isReal()||y("ceiling: can only be applied to real number",this);return ea(this.r)};B.prototype.floor=function(){this.isReal()||y("floor: can only be applied to real number",this);return Z(this.r)};B.prototype.imaginaryPart=function(){return this.i};B.prototype.realPart=function(){return this.r};B.prototype.round=function(){this.isReal()||y("round: can only be applied to real number",this);return Qa(this.r)};var qb=/^([+-]?\d+)\/(\d+)$/,mb=
/^([+-]?\d*)\.?(\d*)[Ee](\+?\d+)$/,rb=/^([+-]?[\d\w/\.]*)([+-])([\d\w/\.]*)i$/,sb=/^([+-]?\d*)\.?(\d*)$/,tb=/\d/,bb=function(g){var b=g.match(qb);if(b)return M.makeInstance(bb(b[1]),bb(b[2]));if(b=g.match(rb))return B.makeInstance(bb(b[1]||"0"),bb(b[2]+(b[3]||"1")));if(g==="+nan.0"||g==="-nan.0")return r.nan;if(g==="+inf.0")return r.inf;if(g==="-inf.0")return r.neginf;if(g==="-0.0")return ua;return g.match(tb)&&(g.match(sb)||g.match(mb))?(b=Number(g),La(b)?Fa(g):e(b)):!1};typeof navigator!=="undefined"&&
navigator.appName=="Microsoft Internet Explorer"?(d.prototype.am=c,ka=30):typeof navigator!=="undefined"&&navigator.appName!="Netscape"?(d.prototype.am=b,ka=26):(d.prototype.am=h,ka=28);d.prototype.DB=ka;d.prototype.DM=(1<<ka)-1;d.prototype.DV=1<<ka;d.prototype.FV=Math.pow(2,52);d.prototype.F1=52-ka;d.prototype.F2=2*ka-52;for(var cb=[],ka="0".charCodeAt(0),Ca=0;Ca<=9;++Ca)cb[ka++]=Ca;ka="a".charCodeAt(0);for(Ca=10;Ca<36;++Ca)cb[ka++]=Ca;ka="A".charCodeAt(0);for(Ca=10;Ca<36;++Ca)cb[ka++]=Ca;L.prototype.convert=
function(g){return g.s<0||g.compareTo(this.m)>=0?g.mod(this.m):g};L.prototype.revert=function(g){return g};L.prototype.reduce=function(g){g.divRemTo(this.m,null,g)};L.prototype.mulTo=function(g,b,j){g.multiplyTo(b,j);this.reduce(j)};L.prototype.sqrTo=function(g,b){g.squareTo(b);this.reduce(b)};T.prototype.convert=function(g){var b=m();g.abs().dlShiftTo(this.m.t,b);b.divRemTo(this.m,null,b);g.s<0&&b.compareTo(d.ZERO)>0&&this.m.subTo(b,b);return b};T.prototype.revert=function(g){var b=m();g.copyTo(b);
this.reduce(b);return b};T.prototype.reduce=function(g){for(;g.t<=this.mt2;)g[g.t++]=0;for(var b=0;b<this.m.t;++b){var j=g[b]&32767,e=j*this.mpl+((j*this.mph+(g[b]>>15)*this.mpl&this.um)<<15)&g.DM,j=b+this.m.t;for(g[j]+=this.m.am(0,e,g,b,0,this.m.t);g[j]>=g.DV;)g[j]-=g.DV,g[++j]++}g.clamp();g.drShiftTo(this.m.t,g);g.compareTo(this.m)>=0&&g.subTo(this.m,g)};T.prototype.mulTo=function(g,b,j){g.multiplyTo(b,j);this.reduce(j)};T.prototype.sqrTo=function(g,b){g.squareTo(b);this.reduce(b)};d.prototype.copyTo=
function(g){for(var b=this.t-1;b>=0;--b)g[b]=this[b];g.t=this.t;g.s=this.s};d.prototype.fromInt=function(g){this.t=1;this.s=g<0?-1:0;g>0?this[0]=g:g<-1?this[0]=g+DV:this.t=0};d.prototype.fromString=function(g,b){var j;if(b==16)j=4;else if(b==8)j=3;else if(b==256)j=8;else if(b==2)j=1;else if(b==32)j=5;else if(b==4)j=2;else{this.fromRadix(g,b);return}this.s=this.t=0;for(var e=g.length,c=!1,p=0;--e>=0;){var u=j==8?g[e]&255:q(g,e);u<0?g.charAt(e)=="-"&&(c=!0):(c=!1,p==0?this[this.t++]=u:p+j>this.DB?(this[this.t-
1]|=(u&(1<<this.DB-p)-1)<<p,this[this.t++]=u>>this.DB-p):this[this.t-1]|=u<<p,p+=j,p>=this.DB&&(p-=this.DB))}if(j==8&&(g[0]&128)!=0)this.s=-1,p>0&&(this[this.t-1]|=(1<<this.DB-p)-1<<p);this.clamp();c&&d.ZERO.subTo(this,this)};d.prototype.clamp=function(){for(var g=this.s&this.DM;this.t>0&&this[this.t-1]==g;)--this.t};d.prototype.dlShiftTo=function(g,b){var j;for(j=this.t-1;j>=0;--j)b[j+g]=this[j];for(j=g-1;j>=0;--j)b[j]=0;b.t=this.t+g;b.s=this.s};d.prototype.drShiftTo=function(g,b){for(var j=g;j<
this.t;++j)b[j-g]=this[j];b.t=Math.max(this.t-g,0);b.s=this.s};d.prototype.lShiftTo=function(g,b){var j=g%this.DB,e=this.DB-j,c=(1<<e)-1,p=Math.floor(g/this.DB),u=this.s<<j&this.DM,v;for(v=this.t-1;v>=0;--v)b[v+p+1]=this[v]>>e|u,u=(this[v]&c)<<j;for(v=p-1;v>=0;--v)b[v]=0;b[p]=u;b.t=this.t+p+1;b.s=this.s;b.clamp()};d.prototype.rShiftTo=function(g,b){b.s=this.s;var j=Math.floor(g/this.DB);if(j>=this.t)b.t=0;else{var e=g%this.DB,c=this.DB-e,p=(1<<e)-1;b[0]=this[j]>>e;for(var u=j+1;u<this.t;++u)b[u-j-
1]|=(this[u]&p)<<c,b[u-j]=this[u]>>e;e>0&&(b[this.t-j-1]|=(this.s&p)<<c);b.t=this.t-j;b.clamp()}};d.prototype.subTo=function(g,b){for(var j=0,e=0,c=Math.min(g.t,this.t);j<c;)e+=this[j]-g[j],b[j++]=e&this.DM,e>>=this.DB;if(g.t<this.t){for(e-=g.s;j<this.t;)e+=this[j],b[j++]=e&this.DM,e>>=this.DB;e+=this.s}else{for(e+=this.s;j<g.t;)e-=g[j],b[j++]=e&this.DM,e>>=this.DB;e-=g.s}b.s=e<0?-1:0;e<-1?b[j++]=this.DV+e:e>0&&(b[j++]=e);b.t=j;b.clamp()};d.prototype.multiplyTo=function(g,b){var j=this.abs(),e=g.abs(),
c=j.t;for(b.t=c+e.t;--c>=0;)b[c]=0;for(c=0;c<e.t;++c)b[c+j.t]=j.am(0,e[c],b,c,0,j.t);b.s=0;b.clamp();this.s!=g.s&&d.ZERO.subTo(b,b)};d.prototype.squareTo=function(g){for(var b=this.abs(),j=g.t=2*b.t;--j>=0;)g[j]=0;for(j=0;j<b.t-1;++j){var e=b.am(j,b[j],g,2*j,0,1);if((g[j+b.t]+=b.am(j+1,2*b[j],g,2*j+1,e,b.t-j-1))>=b.DV)g[j+b.t]-=b.DV,g[j+b.t+1]=1}g.t>0&&(g[g.t-1]+=b.am(j,b[j],g,2*j,0,1));g.s=0;g.clamp()};d.prototype.divRemTo=function(g,b,j){var e=g.abs();if(!(e.t<=0)){var c=this.abs();if(c.t<e.t)b!=
null&&b.fromInt(0),j!=null&&this.copyTo(j);else{j==null&&(j=m());var p=m(),u=this.s,g=g.s,v=this.DB-P(e[e.t-1]);v>0?(e.lShiftTo(v,p),c.lShiftTo(v,j)):(e.copyTo(p),c.copyTo(j));e=p.t;c=p[e-1];if(c!=0){var i=c*(1<<this.F1)+(e>1?p[e-2]>>this.F2:0),Ha=this.FV/i,i=(1<<this.F1)/i,l=1<<this.F2,o=j.t,Z=o-e,I=b==null?m():b;p.dlShiftTo(Z,I);j.compareTo(I)>=0&&(j[j.t++]=1,j.subTo(I,j));d.ONE.dlShiftTo(e,I);for(I.subTo(p,p);p.t<e;)p[p.t++]=0;for(;--Z>=0;){var y=j[--o]==c?this.DM:Math.floor(j[o]*Ha+(j[o-1]+l)*
i);if((j[o]+=p.am(0,y,j,Z,0,e))<y){p.dlShiftTo(Z,I);for(j.subTo(I,j);j[o]<--y;)j.subTo(I,j)}}b!=null&&(j.drShiftTo(e,b),u!=g&&d.ZERO.subTo(b,b));j.t=e;j.clamp();v>0&&j.rShiftTo(v,j);u<0&&d.ZERO.subTo(j,j)}}}};d.prototype.invDigit=function(){if(this.t<1)return 0;var g=this[0];if((g&1)==0)return 0;var b=g&3,b=b*(2-(g&15)*b)&15,b=b*(2-(g&255)*b)&255,b=b*(2-((g&65535)*b&65535))&65535,b=b*(2-g*b%this.DV)%this.DV;return b>0?this.DV-b:-b};d.prototype.isEven=function(){return(this.t>0?this[0]&1:this.s)==
0};d.prototype.exp=function(g,b){if(g>4294967295||g<1)return d.ONE;var j=m(),e=m(),c=b.convert(this),p=P(g)-1;for(c.copyTo(j);--p>=0;)if(b.sqrTo(j,e),(g&1<<p)>0)b.mulTo(e,c,j);else var u=j,j=e,e=u;return b.revert(j)};d.prototype.toString=function(g){if(this.s<0)return"-"+this.negate().toString(g);if(g==16)g=4;else if(g==8)g=3;else if(g==2)g=1;else if(g==32)g=5;else if(g==4)g=2;else return this.toRadix(g);var b=(1<<g)-1,j,e=!1,c=[],p=this.t,u=this.DB-p*this.DB%g;if(p-- >0){if(u<this.DB&&(j=this[p]>>
u)>0)e=!0,c.push("0123456789abcdefghijklmnopqrstuvwxyz".charAt(j));for(;p>=0;)u<g?(j=(this[p]&(1<<u)-1)<<g-u,j|=this[--p]>>(u+=this.DB-g)):(j=this[p]>>(u-=g)&b,u<=0&&(u+=this.DB,--p)),j>0&&(e=!0),e&&c.push("0123456789abcdefghijklmnopqrstuvwxyz".charAt(j))}return e?c.join(""):"0"};d.prototype.negate=function(){var g=m();d.ZERO.subTo(this,g);return g};d.prototype.abs=function(){return this.s<0?this.negate():this};d.prototype.compareTo=A;d.prototype.bitLength=function(){if(this.t<=0)return 0;return this.DB*
(this.t-1)+P(this[this.t-1]^this.s&this.DM)};d.prototype.mod=w;d.prototype.modPowInt=function(g,b){var j;j=g<256||b.isEven()?new L(b):new T(b);return this.exp(g,j)};d.ZERO=C(0);d.ONE=C(1);F.prototype.convert=ja;F.prototype.revert=ja;F.prototype.mulTo=function(g,b,j){g.multiplyTo(b,j)};F.prototype.sqrTo=function(g,b){g.squareTo(b)};V.prototype.convert=function(g){if(g.s<0||g.t>2*this.m.t)return g.mod(this.m);else if(g.compareTo(this.m)<0)return g;else{var b=m();g.copyTo(b);this.reduce(b);return b}};
V.prototype.revert=function(g){return g};V.prototype.reduce=function(g){g.drShiftTo(this.m.t-1,this.r2);if(g.t>this.m.t+1)g.t=this.m.t+1,g.clamp();this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3);for(this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);g.compareTo(this.r2)<0;)g.dAddOffset(1,this.m.t+1);for(g.subTo(this.r2,g);g.compareTo(this.m)>=0;)g.subTo(this.m,g)};V.prototype.mulTo=function(g,b,j){g.multiplyTo(b,j);this.reduce(j)};V.prototype.sqrTo=function(g,b){g.squareTo(b);this.reduce(b)};
var Ja=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],ub=67108864/Ja[Ja.length-1];d.prototype.chunkSize=function(g){return Math.floor(Math.LN2*this.DB/Math.log(g))};d.prototype.toRadix=function(g){g==
null&&(g=10);if(this.signum()==0||g<2||g>36)return"0";var b=this.chunkSize(g),b=Math.pow(g,b),j=C(b),e=m(),c=m(),p="";for(this.divRemTo(j,e,c);e.signum()>0;)p=(b+c.intValue()).toString(g).substr(1)+p,e.divRemTo(j,e,c);return c.intValue().toString(g)+p};d.prototype.fromRadix=function(g,b){this.fromInt(0);b==null&&(b=10);for(var j=this.chunkSize(b),e=Math.pow(b,j),c=!1,p=0,u=0,v=0;v<g.length;++v){var i=q(g,v);i<0?g.charAt(v)=="-"&&this.signum()==0&&(c=!0):(u=b*u+i,++p>=j&&(this.dMultiply(e),this.dAddOffset(u,
0),u=p=0))}p>0&&(this.dMultiply(Math.pow(b,p)),this.dAddOffset(u,0));c&&d.ZERO.subTo(this,this)};d.prototype.fromNumber=function(g,b,j){if("number"==typeof b)if(g<2)this.fromInt(1);else{this.fromNumber(g,j);this.testBit(g-1)||this.bitwiseTo(d.ONE.shiftLeft(g-1),ca,this);for(this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(b);)this.dAddOffset(2,0),this.bitLength()>g&&this.subTo(d.ONE.shiftLeft(g-1),this)}else{var j=[],e=g&7;j.length=(g>>3)+1;b.nextBytes(j);e>0?j[0]&=(1<<e)-1:j[0]=0;this.fromString(j,
256)}};d.prototype.bitwiseTo=function(g,b,j){var e,c,p=Math.min(g.t,this.t);for(e=0;e<p;++e)j[e]=b(this[e],g[e]);if(g.t<this.t){c=g.s&this.DM;for(e=p;e<this.t;++e)j[e]=b(this[e],c);j.t=this.t}else{c=this.s&this.DM;for(e=p;e<g.t;++e)j[e]=b(c,g[e]);j.t=g.t}j.s=b(this.s,g.s);j.clamp()};d.prototype.changeBit=function(g,b){var j=d.ONE.shiftLeft(g);this.bitwiseTo(j,b,j);return j};d.prototype.addTo=function(g,b){for(var j=0,e=0,c=Math.min(g.t,this.t);j<c;)e+=this[j]+g[j],b[j++]=e&this.DM,e>>=this.DB;if(g.t<
this.t){for(e+=g.s;j<this.t;)e+=this[j],b[j++]=e&this.DM,e>>=this.DB;e+=this.s}else{for(e+=this.s;j<g.t;)e+=g[j],b[j++]=e&this.DM,e>>=this.DB;e+=g.s}b.s=e<0?-1:0;e>0?b[j++]=e:e<-1&&(b[j++]=this.DV+e);b.t=j;b.clamp()};d.prototype.dMultiply=function(g){this[this.t]=this.am(0,g-1,this,0,0,this.t);++this.t;this.clamp()};d.prototype.dAddOffset=function(g,b){if(g!=0){for(;this.t<=b;)this[this.t++]=0;for(this[b]+=g;this[b]>=this.DV;)this[b]-=this.DV,++b>=this.t&&(this[this.t++]=0),++this[b]}};d.prototype.multiplyLowerTo=
function(g,b,j){var e=Math.min(this.t+g.t,b);j.s=0;for(j.t=e;e>0;)j[--e]=0;var c;for(c=j.t-this.t;e<c;++e)j[e+this.t]=this.am(0,g[e],j,e,0,this.t);for(c=Math.min(g.t,b);e<c;++e)this.am(0,g[e],j,e,0,b-e);j.clamp()};d.prototype.multiplyUpperTo=function(g,b,j){--b;var e=j.t=this.t+g.t-b;for(j.s=0;--e>=0;)j[e]=0;for(e=Math.max(b-this.t,0);e<g.t;++e)j[this.t+e-b]=this.am(b-e,g[e],j,0,0,this.t+e-b);j.clamp();j.drShiftTo(1,j)};d.prototype.modInt=function(g){if(g<=0)return 0;var b=this.DV%g,j=this.s<0?g-
1:0;if(this.t>0)if(b==0)j=this[0]%g;else for(var e=this.t-1;e>=0;--e)j=(b*j+this[e])%g;return j};d.prototype.millerRabin=function(g){var b=this.subtract(d.ONE),j=b.getLowestSetBit();if(j<=0)return!1;var e=b.shiftRight(j),g=g+1>>1;if(g>Ja.length)g=Ja.length;for(var c=m(),p=0;p<g;++p){c.fromInt(Ja[p]);var u=c.modPow(e,this);if(u.compareTo(d.ONE)!=0&&u.compareTo(b)!=0){for(var v=1;v++<j&&u.compareTo(b)!=0;)if(u=u.modPowInt(2,this),u.compareTo(d.ONE)==0)return!1;if(u.compareTo(b)!=0)return!1}}return!0};
d.prototype.clone=function(){var g=m();this.copyTo(g);return g};d.prototype.intValue=function(){if(this.s<0)if(this.t==1)return this[0]-this.DV;else{if(this.t==0)return-1}else if(this.t==1)return this[0];else if(this.t==0)return 0;return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]};d.prototype.byteValue=function(){return this.t==0?this.s:this[0]<<24>>24};d.prototype.shortValue=function(){return this.t==0?this.s:this[0]<<16>>16};d.prototype.signum=function(){return this.s<0?-1:this.t<=0||this.t==1&&
this[0]<=0?0:1};d.prototype.toByteArray=function(){var g=this.t,b=[];b[0]=this.s;var j=this.DB-g*this.DB%8,e,c=0;if(g-- >0){if(j<this.DB&&(e=this[g]>>j)!=(this.s&this.DM)>>j)b[c++]=e|this.s<<this.DB-j;for(;g>=0;)if(j<8?(e=(this[g]&(1<<j)-1)<<8-j,e|=this[--g]>>(j+=this.DB-8)):(e=this[g]>>(j-=8)&255,j<=0&&(j+=this.DB,--g)),(e&128)!=0&&(e|=-256),c==0&&(this.s&128)!=(e&128)&&++c,c>0||e!=this.s)b[c++]=e}return b};d.prototype.equals=X;d.prototype.min=function(g){return this.compareTo(g)<0?this:g};d.prototype.max=
function(g){return this.compareTo(g)>0?this:g};d.prototype.and=function(g){var b=m();this.bitwiseTo(g,J,b);return b};d.prototype.or=function(g){var b=m();this.bitwiseTo(g,ca,b);return b};d.prototype.xor=function(g){var b=m();this.bitwiseTo(g,la,b);return b};d.prototype.andNot=function(g){var b=m();this.bitwiseTo(g,D,b);return b};d.prototype.not=function(){for(var g=m(),b=0;b<this.t;++b)g[b]=this.DM&~this[b];g.t=this.t;g.s=~this.s;return g};d.prototype.shiftLeft=function(g){var b=m();g<0?this.rShiftTo(-g,
b):this.lShiftTo(g,b);return b};d.prototype.shiftRight=function(g){var b=m();g<0?this.lShiftTo(-g,b):this.rShiftTo(g,b);return b};d.prototype.getLowestSetBit=function(){for(var g=0;g<this.t;++g)if(this[g]!=0){var b=g*this.DB;g=this[g];if(g==0)g=-1;else{var j=0;(g&65535)==0&&(g>>=16,j+=16);(g&255)==0&&(g>>=8,j+=8);(g&15)==0&&(g>>=4,j+=4);(g&3)==0&&(g>>=2,j+=2);(g&1)==0&&++j;g=j}return b+g}if(this.s<0)return this.t*this.DB;return-1};d.prototype.bitCount=function(){for(var g=0,b=this.s&this.DM,j=0;j<
this.t;++j){for(var e=this[j]^b,c=0;e!=0;)e&=e-1,++c;g+=c}return g};d.prototype.testBit=function(g){var b=Math.floor(g/this.DB);if(b>=this.t)return this.s!=0;return(this[b]&1<<g%this.DB)!=0};d.prototype.setBit=function(g){return this.changeBit(g,ca)};d.prototype.clearBit=function(g){return this.changeBit(g,D)};d.prototype.flipBit=function(g){return this.changeBit(g,la)};d.prototype.add=W;d.prototype.subtract=ga;d.prototype.multiply=fa;d.prototype.divide=N;d.prototype.remainder=sa;d.prototype.divideAndRemainder=
aa;d.prototype.modPow=function(g,b){var j=g.bitLength(),e,c=C(1),p;if(j<=0)return c;else e=j<18?1:j<48?3:j<144?4:j<768?5:6;p=j<8?new L(b):b.isEven()?new V(b):new T(b);var u=[],v=3,i=e-1,d=(1<<e)-1;u[1]=p.convert(this);if(e>1){j=m();for(p.sqrTo(u[1],j);v<=d;)u[v]=m(),p.mulTo(j,u[v-2],u[v]),v+=2}for(var Ha=g.t-1,l,o=!0,Z=m(),j=P(g[Ha])-1;Ha>=0;){j>=i?l=g[Ha]>>j-i&d:(l=(g[Ha]&(1<<j+1)-1)<<i-j,Ha>0&&(l|=g[Ha-1]>>this.DB+j-i));for(v=e;(l&1)==0;)l>>=1,--v;if((j-=v)<0)j+=this.DB,--Ha;if(o)u[l].copyTo(c),
o=!1;else{for(;v>1;)p.sqrTo(c,Z),p.sqrTo(Z,c),v-=2;v>0?p.sqrTo(c,Z):(v=c,c=Z,Z=v);p.mulTo(Z,u[l],c)}for(;Ha>=0&&(g[Ha]&1<<j)==0;)p.sqrTo(c,Z),v=c,c=Z,Z=v,--j<0&&(j=this.DB-1,--Ha)}return p.revert(c)};d.prototype.modInverse=function(g){var b=g.isEven();if(this.isEven()&&b||g.signum()==0)return d.ZERO;for(var j=g.clone(),e=this.clone(),c=C(1),p=C(0),u=C(0),v=C(1);j.signum()!=0;){for(;j.isEven();){j.rShiftTo(1,j);if(b){if(!c.isEven()||!p.isEven())c.addTo(this,c),p.subTo(g,p);c.rShiftTo(1,c)}else p.isEven()||
p.subTo(g,p);p.rShiftTo(1,p)}for(;e.isEven();){e.rShiftTo(1,e);if(b){if(!u.isEven()||!v.isEven())u.addTo(this,u),v.subTo(g,v);u.rShiftTo(1,u)}else v.isEven()||v.subTo(g,v);v.rShiftTo(1,v)}j.compareTo(e)>=0?(j.subTo(e,j),b&&c.subTo(u,c),p.subTo(v,p)):(e.subTo(j,e),b&&u.subTo(c,u),v.subTo(p,v))}if(e.compareTo(d.ONE)!=0)return d.ZERO;if(v.compareTo(g)>=0)return v.subtract(g);if(v.signum()<0)v.addTo(g,v);else return v;return v.signum()<0?v.add(g):v};d.prototype.pow=K;d.prototype.gcd=ha;d.prototype.isProbablePrime=
function(g){var b,j=this.abs();if(j.t==1&&j[0]<=Ja[Ja.length-1]){for(b=0;b<Ja.length;++b)if(j[0]==Ja[b])return!0;return!1}if(j.isEven())return!1;for(b=1;b<Ja.length;){for(var e=Ja[b],c=b+1;c<Ja.length&&e<ub;)e*=Ja[c++];for(e=j.modInt(e);b<c;)if(e%Ja[b++]==0)return!1}return j.millerRabin(g)};d.NEGATIVE_ONE=d.ONE.negate();var Fa=function(g){typeof g==="number"&&(g+="");var b=g.match(mb);if(b){for(var g=b[1]+b[2],b=Number(b[3])-b[2].length,j=[],e=0;e<b;e++)j.push("0");b=j.join("");g=new d(g+b,10)}else g=
new d(g,10);return g};d.prototype.level=0;d.prototype.liftTo=function(g){if(g.level===1)return new M(this,1);if(g.level===2){g=this.toFixnum();if(g===Number.POSITIVE_INFINITY)return jb;if(g===Number.NEGATIVE_INFINITY)return kb;return new r(g)}if(g.level===3)return new B(this,0);return y("invalid level for BigInteger lift",this,g)};d.prototype.isFinite=function(){return!0};d.prototype.isInteger=function(){return!0};d.prototype.isRational=function(){return!0};d.prototype.isReal=function(){return!0};
d.prototype.isExact=function(){return!0};d.prototype.isInexact=function(){return!1};d.prototype.toExact=function(){return this};d.prototype.toInexact=function(){return r.makeInstance(this.toFixnum())};d.prototype.toFixnum=function(){var g=0,b=this.toString(),j;if(b[0]==="-"){for(j=1;j<b.length;j++)g=g*10+Number(b[j]);return-g}else{for(j=0;j<b.length;j++)g=g*10+Number(b[j]);return g}};d.prototype.greaterThan=function(g){return this.compareTo(g)>0};d.prototype.greaterThanOrEqual=function(g){return this.compareTo(g)>=
0};d.prototype.lessThan=function(g){return this.compareTo(g)<0};d.prototype.lessThanOrEqual=function(g){return this.compareTo(g)<=0};d.prototype.divide=function(g){var b=aa.call(this,g);return b[1].compareTo(d.ZERO)===0?b[0]:Y(b[0],M.makeInstance(b[1],g))};d.prototype.numerator=function(){return this};d.prototype.denominator=function(){return 1};(function(){var g=function(g,b){for(;!l(Ka(b),g)||!oa(g,Ka(Y(b,1)));)var j=Z(da(g,b)),b=Z(da(Y(b,j),2));return b};d.prototype.integerSqrt=function(){if(this.s==
0)return g(this,this);else{var b=O(this,-1);return B.makeInstance(0,g(b,b))}}})();(function(){d.prototype.sqrt=function(){var g=this.integerSqrt();ba(Ka(g),this);return g}})();d.prototype.floor=function(){return this};d.prototype.ceiling=function(){return this};d.prototype.expt=function(g){return K.call(this,g)};d.prototype.imaginaryPart=function(){return 0};d.prototype.realPart=function(){return this};ka=function(){return function(g,b,j){var e=512;if(j&&typeof j.limit!=="undefined")e=j.limit;Q(g)||
y("toRepeatingDecimal: n "+g.toString()+" is not an integer.");Q(b)||y("toRepeatingDecimal: d "+b.toString()+" is not an integer.");ia(b,0)&&y("toRepeatingDecimal: d equals 0");oa(b,0)&&y("toRepeatingDecimal: d < 0");j=oa(g,0)?"-":"";g=u(g);j+=Ra(g,b);a:{var g=Ta(g,b),c=e,e=[],p={};for(p[g]=!0;;){if(c--<=0){b=[e.join(""),"..."];break a}var v=Ra(O(g,10),b),g=Ta(O(g,10),b);e.push(v.toString());if(p[g])break;else p[g]=!0}p=g;for(c=[];;)if(v=Ra(O(g,10),b),g=Ta(O(g,10),b),c.push(v.toString()),ia(g,p))break;
b=e.join("");for(g=c.join("");b.length>=g.length&&b.substring(b.length-g.length)===g;)b=b.substring(0,b.length-g.length);b=[b,g]}return[j].concat(b)}}();t.fromFixnum=e;t.fromString=bb;t.makeBignum=Fa;t.makeRational=M.makeInstance;t.makeFloat=r.makeInstance;t.makeComplex=B.makeInstance;t.makeComplexPolar=function(g,b){if(ia(b,0))return g;return B.makeInstance(O(g,xa(b)),O(g,Wa(b)))};t.pi=r.pi;t.e=r.e;t.nan=r.nan;t.negative_inf=r.neginf;t.inf=r.inf;t.negative_one=-1;t.zero=0;t.one=1;t.i=Ma;t.negative_i=
lb;t.negative_zero=ua;t.onThrowRuntimeError=function(g){throw Error(g);};t.isSchemeNumber=E;t.isRational=$;t.isReal=G;t.isExact=na;t.isInexact=va;t.isInteger=Q;t.toFixnum=z;t.toExact=H;t.toInexact=wa;t.add=Y;t.subtract=ma;t.multiply=O;t.divide=da;t.equals=ia;t.eqv=ba;t.approxEquals=function(g,b,j){return oa(u(ma(g,b)),j)};t.greaterThanOrEqual=ra;t.lessThanOrEqual=l;t.greaterThan=o;t.lessThan=oa;t.expt=Ga;t.exp=ya;t.modulo=S;t.numerator=za;t.denominator=qa;t.integerSqrt=db;t.sqrt=Ea;t.abs=u;t.quotient=
Ra;t.remainder=Ta;t.floor=Z;t.ceiling=ea;t.conjugate=Aa;t.magnitude=function(g){if(typeof g==="number")return Math.abs(g);return g.magnitude()};t.log=Oa;t.angle=Ua;t.tan=Na;t.atan=Ya;t.cos=xa;t.sin=Wa;t.tan=Na;t.acos=R;t.asin=i;t.cosh=function(g){if(ba(g,0))return r.makeInstance(1);return da(Y(ya(g),ya(Ba(g))),2)};t.sinh=function(g){return da(ma(ya(g),ya(Ba(g))),2)};t.imaginaryPart=ta;t.realPart=pa;t.round=Qa;t.sqr=Ka;t.gcd=function(g,b){Q(g)||y("gcd: the argument "+g.toString()+" is not an integer.",
g);for(var e=u(g),c,p,v=0;v<b.length;v++){p=u(b[v]);for(Q(p)||y("gcd: the argument "+p.toString()+" is not an integer.",p);!j(p);)c=e,e=p,p=Za(c,p)}return e};t.lcm=function(b,e){Q(b)||y("lcm: the argument "+b.toString()+" is not an integer.",b);var c=u(b);if(j(c))return 0;for(var p=0;p<e.length;p++){Q(e[p])||y("lcm: the argument "+e[p].toString()+" is not an integer.",e[p]);var v=g(c,e[p]);if(j(v))return 0;c=da(O(c,e[p]),v)}return c};t.toRepeatingDecimal=ka})();
var _Hashtable=function(){function d(b){return typeof b==="function"}function m(b){if(typeof b==="string")return b;else if(d(b.hashCode)){b=b.hashCode();if(typeof b!=="string")return m(b);return b}else return d(b.toString)?b.toString():String(b)}function b(b,c){return b.equals(c)}function c(b,c){return d(c.equals)?c.equals(b):b===c}function h(b,c){return b===c}function q(b,c,d,h,A){for(var w,q=0,m=b.length;q<m;q++)if(w=b[q],A(c,d(w)))return h?[q,w]:!0;return!1}function C(b,c){if(d(b.splice))b.splice(c,
1);else if(c===b.length-1)b.length=c;else{var h=b.slice(c+1);b.length=c;for(var A=0,w=h.length;A<w;A++)b[c+A]=h[A]}}function A(b,c){if(b===null)throw Error("null is not a valid "+c);else if(typeof b==="undefined")throw Error(c+" must not be undefined");}function P(b,c,d){this.entries=[];this.addEntry(b,c);if(d!==null)this.getEqualityFunction=function(){return d}}function w(b){return b[0]}function L(b){return b[1]}function T(){}function X(b){return b[0]}function J(b,c){var d=b[c];if(d&&d instanceof
T)return d[1];return null}P.prototype={getEqualityFunction:function(h){return d(h.equals)?b:c},searchForEntry:function(b){return q(this.entries,b,w,!0,this.getEqualityFunction(b))},getEntryForKey:function(b){return this.searchForEntry(b)[1]},getEntryIndexForKey:function(b){return this.searchForEntry(b)[0]},removeEntryForKey:function(b){if(b=this.searchForEntry(b))return C(this.entries,b[0]),!0;return!1},addEntry:function(b,c){this.entries[this.entries.length]=[b,c]},size:function(){return this.entries.length},
keys:function(b){for(var c=b.length,d=0,h=this.entries.length;d<h;d++)b[c+d]=this.entries[d][0]},values:function(b){for(var c=b.length,d=0,h=this.entries.length;d<h;d++)b[c+d]=this.entries[d][1]},containsKey:function(b){return q(this.entries,b,w,!1,this.getEqualityFunction(b))},containsValue:function(b){return q(this.entries,b,L,!1,h)}};T.prototype=[];return function(b,c){var h=[],w={},b=d(b)?b:m,c=d(c)?c:null;this.put=function(d,q){A(d,"key");A(q,"value");var m=b(d),C=J(w,m);C?(m=C.getEntryForKey(d))?
m[1]=q:C.addEntry(d,q):(C=new T,C[0]=m,C[1]=new P(d,q,c),h[h.length]=C,w[m]=C)};this.get=function(c){A(c,"key");var d=b(c);if(d=J(w,d))if(c=d.getEntryForKey(c))return c[1];return null};this.containsKey=function(c){A(c,"key");var d=b(c);if(d=J(w,d))return d.containsKey(c);return!1};this.containsValue=function(b){A(b,"value");for(var c=0,d=h.length;c<d;c++)if(h[c][1].containsValue(b))return!0;return!1};this.clear=function(){h.length=0;w={}};this.isEmpty=function(){return h.length===0};this.keys=function(){for(var b=
[],c=0,d=h.length;c<d;c++)h[c][1].keys(b);return b};this.values=function(){for(var b=[],c=0,d=h.length;c<d;c++)h[c][1].values(b);return b};this.remove=function(c){A(c,"key");var d=b(c),m=J(w,d);m&&m.removeEntryForKey(c)&&m.size()===0&&(c=m.getEqualityFunction(c),c=q(h,d,X,!0,c),C(h,c[0]),delete w[d])};this.size=function(){for(var b=0,c=0,d=h.length;c<d;c++)b+=h[c][1].size();return b}}}(),types={};
(function(){var d=0;makeEqHashCode=function(){d++;return d};getEqHashCode=function(b){if(b&&!b._eqHashCode)b._eqHashCode=makeEqHashCode();if(b&&b._eqHashCode)return b._eqHashCode;if(typeof b=="string")return b;return 0};var m=function(){this.parentMap=ga()};m.prototype.find=function(b){var e=this.parentMap.containsKey(b)?this.parentMap.get(b):b;e!==b&&(e=this.find(e),this.parentMap.put(b,e));return e};m.prototype.merge=function(b,e){this.parentMap.put(this.find(b),this.find(e))};var b=function(){var b=
!1,e=/xyz/.test(function(){})?/\b_super\b/:/.*/,c=function(){};c.extend=function(c){var d=this.prototype;b=!0;var l=new this;b=!1;for(var o in c)l[o]=typeof c[o]=="function"&&typeof d[o]=="function"&&e.test(c[o])?function(b,e){return function(){var c=this._super;this._super=d[b];var u=e.apply(this,arguments);this._super=c;return u}}(o,c[o]):c[o];o=function(){!b&&this.init&&this.init.apply(this,arguments)};o.prototype=l;o.constructor=o;o.extend=arguments.callee;return o};return c}();StructType=function(b,
e,c,d,l,o,I,y,h){this.name=b;this.type=e;this.numberOfArgs=c;this.numberOfFields=d;this.firstField=l;this.constructor=o;this.predicate=I;this.accessor=y;this.mutator=h};StructType.prototype.toString=function(){return"#<struct-type:"+this.name+">"};StructType.prototype.isEqual=function(b){return this===b};var c=function(b,e,c,d,l,o){e||(e={type:h,numberOfArgs:0,numberOfFields:0,firstField:0});var I=e.numberOfArgs,y=e.type.extend({init:function(b,e){o||(o=function(b){if(arguments.length==3)b(arguments[1]);
else{for(var e=[],c=1;c<arguments.length-1;c++)e.push(arguments[c]);b(new $(e))}});var u=this;e.unshift(function(e){var e=e instanceof $?e.elts:[e],o=e.slice(0,I);u._super(b,o);for(o=0;o<c;o++)u._fields.push(e[o+I]);for(o=0;o<d;o++)u._fields.push(l)});e.push(T.makeInstance(b));o.apply(null,e)}});y.prototype.type=y;return new StructType(b,y,c+I,c+d,e.firstField+e.numberOfFields,function(){for(var e=[],c=0;c<arguments.length;c++)e.push(arguments[c]);return new y(b,e)},function(b){return b instanceof
y},function(b,e){return b._fields[e+this.firstField]},function(b,e,c){b._fields[e+this.firstField]=c})},h=b.extend({init:function(b){this._constructorName=b;this._fields=[]},toWrittenString:function(b){var e=[];e.push("(");e.push(this._constructorName);for(var c=0;c<this._fields.length;c++)e.push(" "),e.push(K(this._fields[c],b));e.push(")");return e.join("")},toDisplayedString:function(b){return this.toWrittenString(b)},toDomNode:function(b){var e=document.createElement("div");e.appendChild(document.createTextNode("("));
e.appendChild(document.createTextNode(this._constructorName));for(var c=0;c<this._fields.length;c++){e.appendChild(document.createTextNode(" "));var d=ha(this._fields[c],b);e.appendChild(d)}e.appendChild(document.createTextNode(")"));return e},isEqual:function(b,e){if(b.type==void 0||this.type!==b.type||!(b instanceof this.type))return!1;for(var c=0;c<this._fields.length;c++)if(!E(this._fields[c],b._fields[c],e))return!1;return!0}});h.prototype.type=h;var q=function(b){this.pattern=b},C=function(b){this.pattern=
b},A=function(b){this.path=b},P=function(b,e){this.bytes=b;this.mutable=e===void 0?!1:e};P.prototype.get=function(b){return this.bytes[b]};P.prototype.set=function(b,e){this.mutable&&(this.bytes[b]=e)};P.prototype.length=function(){return this.bytes.length};P.prototype.copy=function(b){return new P(this.bytes.slice(0),b)};P.prototype.subbytes=function(b,e){if(e==null||e==void 0)e=this.bytes.length;return new P(this.bytes.slice(b,e),!0)};P.prototype.toString=function(){for(var b="",e=0;e<this.bytes.length;e++)b+=
String.fromCharCode(this.bytes[e]);return b};P.prototype.toDisplayedString=P.prototype.toString;P.prototype.toWrittenString=function(){for(var b=['#"'],e=0;e<this.bytes.length;e++)b.push(w(this.bytes[e]));b.push('"');return b.join("")};var w=function(b){var e=[],c;switch(b){case 7:c="\\a";break;case 8:c="\\b";break;case 9:c="\\t";break;case 10:c="\\n";break;case 11:c="\\v";break;case 12:c="\\f";break;case 13:c="\\r";break;case 34:c='\\"';break;case 92:c="\\\\";break;default:val>=32&&val<=126?c=String.fromCharCode(val):
e.push("\\"+val.toString(8))}return c},L=function(b,e){this.val=b;this.mutable=e};L.prototype.unbox=function(){return this.val};L.prototype.set=function(b){if(this.mutable)this.val=b};L.prototype.toString=function(){return"#&"+this.val.toString()};L.prototype.toWrittenString=function(b){return"#&"+K(this.val,b)};L.prototype.toDisplayedString=function(b){return"#&"+V(this.val,b)};L.prototype.toDomNode=function(b){var e=document.createElement("span");e.appendChild(document.createTextNode("#&"));e.appendChild(ha(this.val,
b));return e};Logic={TRUE:!0,FALSE:!1};Boolean.prototype.toWrittenString=function(){if(this.valueOf())return"true";return"false"};Boolean.prototype.toDisplayedString=Boolean.prototype.toWrittenString;Boolean.prototype.toString=function(){return this.valueOf()?"true":"false"};Boolean.prototype.isEqual=function(b){return this==b};Char=function(b){this.val=b};Char.makeInstance=function(b){return new Char(b)};Char.prototype.toString=function(){var b=this.val.charCodeAt(0);switch(b){case 0:b="#\\nul";
break;case 8:b="#\\backspace";break;case 9:b="#\\tab";break;case 10:b="#\\newline";break;case 11:b="#\\vtab";break;case 12:b="#\\page";break;case 13:b="#\\return";break;case 20:b="#\\space";break;case 127:b="#\\rubout";break;default:if(b>=32&&b<=126)b="#\\"+this.val;else{for(b=b.toString(16).toUpperCase();b.length<4;)b="0"+b;b="#\\u"+b}}return b};Char.prototype.toWrittenString=Char.prototype.toString;Char.prototype.toDisplayedString=function(){return this.val};Char.prototype.getValue=function(){return this.val};
Char.prototype.isEqual=function(b){return b instanceof Char&&this.val==b.val};var T=function(b){this.val=b},X={};T.makeInstance=function(b){b in X||(X[b]=new T(b));return X[b]};T.prototype.isEqual=function(b){return b instanceof T&&this.val==b.val};T.prototype.toString=function(){return this.val};T.prototype.toWrittenString=function(){return this.val};T.prototype.toDisplayedString=function(){return this.val};var J=function(b){this.val=b},ca={};J.makeInstance=function(b){b in ca||(ca[b]=new J(b));
return ca[b]};J.prototype.isEqual=function(b){return b instanceof J&&this.val==b.val};J.prototype.toString=function(){return this.val};J.prototype.toWrittenString=function(){return this.val};J.prototype.toDisplayedString=function(){return this.val};Empty=function(){};Empty.EMPTY=new Empty;Empty.prototype.isEqual=function(b){return b instanceof Empty};Empty.prototype.reverse=function(){return this};Empty.prototype.first=function(){throwRuntimeError("first can't be applied on empty.")};Empty.prototype.rest=
function(){throwRuntimeError("rest can't be applied on empty.")};Empty.prototype.isEmpty=function(){return!0};Empty.prototype.toWrittenString=function(){return"empty"};Empty.prototype.toDisplayedString=function(){return"empty"};Empty.prototype.toString=function(){return"()"};Empty.prototype.append=function(b){return b};Cons=function(b,e){this.f=b;this.r=e};Cons.prototype.reverse=function(){for(var b=this,e=Empty.EMPTY;!b.isEmpty();)e=Cons.makeInstance(b.first(),e),b=b.rest();return e};Cons.makeInstance=
function(b,e){return new Cons(b,e)};Cons.prototype.isEqual=function(b,e){if(!(b instanceof Cons))return Logic.FALSE;return E(this.first(),b.first(),e)&&E(this.rest(),b.rest(),e)};Cons.prototype.first=function(){return this.f};Cons.prototype.rest=function(){return this.r};Cons.prototype.isEmpty=function(){return!1};Cons.prototype.append=function(b){if(b===Empty.EMPTY)return this;for(var e=this.reverse();!e.isEmpty();)b=Cons.makeInstance(e.first(),b),e=e.rest();return b};Cons.prototype.toWrittenString=
function(b){for(var e=["list"],c=this;c instanceof Cons;)e.push(K(c.first(),b)),c=c.rest();if(c!==Empty.EMPTY)return la(this,b,K);return"("+e.join(" ")+")"};var la=function(b,e,c){for(var d=[],l=[];b instanceof Cons;)d.push("(cons "),d.push(c(b.first(),e)),d.push(" "),l.push(")"),b=b.rest();d.push(c(b,e));return d.join("")+l.join("")};Cons.prototype.toString=Cons.prototype.toWrittenString;Cons.prototype.toDisplayedString=function(b){for(var e=["list"],c=this;c instanceof Cons;)e.push(V(c.first(),
b)),c=c.rest();if(c!==Empty.EMPTY)return la(this,b,V);return"("+e.join(" ")+")"};Cons.prototype.toDomNode=function(b){var e=document.createElement("span");e.appendChild(document.createTextNode("("));e.appendChild(document.createTextNode("list"));e.appendChild(document.createTextNode(" "));for(var c=this;c instanceof Cons;){var d=ha(c.first(),b);e.appendChild(d);c=c.rest();c!==Empty.EMPTY&&(d=document.createTextNode(" "),e.appendChild(d))}if(c!==Empty.EMPTY){d=this;for(c=e=document.createElement("span");d instanceof
Cons;){c.appendChild(document.createTextNode("("));c.appendChild(document.createTextNode("cons"));c.appendChild(document.createTextNode(" "));var l=ha(d.first(),b);c.appendChild(l);c.appendChild(document.createTextNode(" "));l=document.createElement("span");c.appendChild(l);c.appendChild(document.createTextNode(")"));c=l;d=d.rest()}b=ha(d,b);c.appendChild(b);return e}e.appendChild(document.createTextNode(")"));return e};Vector=function(b,e){this.elts=Array(b);if(e)for(var c=0;c<b;c++)this.elts[c]=
e[c];else for(c=0;c<b;c++)this.elts[c]=void 0;this.mutable=!0};Vector.makeInstance=function(b,e){return new Vector(b,e)};Vector.prototype.length=function(){return this.elts.length};Vector.prototype.ref=function(b){return this.elts[b]};Vector.prototype.set=function(b,e){this.elts[b]=e};Vector.prototype.isEqual=function(b,e){if(b!=null&&b!=void 0&&b instanceof Vector){if(b.length()!=this.length())return!1;for(var c=0;c<this.length();c++)if(!E(this.elts[c],b.elts[c],e))return!1;return!0}else return!1};
Vector.prototype.toList=function(){for(var b=Empty.EMPTY,e=this.length()-1;e>=0;e--)b=Cons.makeInstance(this.elts[e],b);return b};Vector.prototype.toWrittenString=function(b){for(var e=[],c=0;c<this.length();c++)e.push(K(this.ref(c),b));return"#("+e.join(" ")+")"};Vector.prototype.toDisplayedString=function(b){for(var e=[],c=0;c<this.length();c++)e.push(V(this.ref(c),b));return"#("+e.join(" ")+")"};Vector.prototype.toDomNode=function(b){var e=document.createElement("span");e.appendChild(document.createTextNode("#("));
for(var c=0;c<this.length();c++){var d=ha(this.ref(c),b);e.appendChild(d);c!==this.length()-1&&(d=document.createTextNode(" "),e.appendChild(d))}e.appendChild(document.createTextNode(")"));return e};var D=function(b){this.chars=b;this.length=b.length;this.mutable=!0};D.makeInstance=function(b){return new D(b)};D.fromString=function(b){return D.makeInstance(b.split(""))};D.prototype.toString=function(){return this.chars.join("")};D.prototype.toWrittenString=function(){return'"'+W(this.toString())+
'"'};D.prototype.toDisplayedString=D.prototype.toString;D.prototype.copy=function(){return D.makeInstance(this.chars.slice(0))};D.prototype.substring=function(b,e){if(e==null||e==void 0)e=this.length;return D.makeInstance(this.chars.slice(b,e))};D.prototype.charAt=function(b){return this.chars[b]};D.prototype.charCodeAt=function(b){return this.chars[b].charCodeAt(0)};D.prototype.replace=function(b,e){return D.fromString(this.toString().replace(b,e))};D.prototype.isEqual=function(b){if(!(b instanceof
D||typeof b=="string"))return!1;return this.toString()===b.toString()};D.prototype.set=function(b,e){this.chars[b]=e};D.prototype.toUpperCase=function(){return D.fromString(this.chars.join("").toUpperCase())};D.prototype.toLowerCase=function(){return D.fromString(this.chars.join("").toLowerCase())};D.prototype.match=function(b){return this.toString().match(b)};var W=function(b){for(var e=[],c=0;c<b.length;c++){var d=b.charCodeAt(c);switch(d){case 7:e.push("\\a");break;case 8:e.push("\\b");break;case 9:e.push("\\t");
break;case 10:e.push("\\n");break;case 11:e.push("\\v");break;case 12:e.push("\\f");break;case 13:e.push("\\r");break;case 34:e.push('\\"');break;case 92:e.push("\\\\");break;default:if(d>=32&&d<=126)e.push(b.charAt(c));else{for(d=d.toString(16).toUpperCase();d.length<4;)d="0"+d;e.push("\\u"+d)}}}return e.join("")},ga=function(){return new _Hashtable(function(b){return getEqHashCode(b)},function(b,e){return b===e})},fa=function(){this.hash=ga();this.mutable=!0};fa.prototype.toWrittenString=function(b){for(var e=
this.hash.keys(),c=[],d=0;d<e.length;d++){var l=types.toWrittenString(e[d],b),o=types.toWrittenString(this.hash.get(e[d]),b);c.push("("+l+" . "+o+")")}return"#hasheq("+c.join(" ")+")"};fa.prototype.toDisplayedString=function(b){for(var e=this.hash.keys(),c=[],d=0;d<e.length;d++){var l=types.toDisplayedString(e[d],b),o=types.toDisplayedString(this.hash.get(e[d]),b);c.push("("+l+" . "+o+")")}return"#hasheq("+c.join(" ")+")"};fa.prototype.isEqual=function(b,e){if(!(b instanceof fa))return!1;if(this.hash.keys().length!=
b.hash.keys().length)return!1;for(var c=this.hash.keys(),d=0;d<c.length;d++)if(!b.hash.containsKey(c[d])||!E(this.hash.get(c[d]),b.hash.get(c[d]),e))return!1;return!0};var N=function(){this.hash=new _Hashtable(function(b){return K(b)},function(b,e){return E(b,e,new m)});this.mutable=!0};N.prototype.toWrittenString=function(b){for(var e=this.hash.keys(),c=[],d=0;d<e.length;d++){var l=types.toWrittenString(e[d],b),o=types.toWrittenString(this.hash.get(e[d]),b);c.push("("+l+" . "+o+")")}return"#hash("+
c.join(" ")+")"};N.prototype.toDisplayedString=function(b){for(var e=this.hash.keys(),c=[],d=0;d<e.length;d++){var l=types.toDisplayedString(e[d],b),o=types.toDisplayedString(this.hash.get(e[d]),b);c.push("("+l+" . "+o+")")}return"#hash("+c.join(" ")+")"};N.prototype.isEqual=function(b,e){if(!(b instanceof N))return!1;if(this.hash.keys().length!=b.hash.keys().length)return!1;for(var c=this.hash.keys(),d=0;d<c.length;d++)if(!b.hash.containsKey(c[d])||!E(this.hash.get(c[d]),b.hash.get(c[d]),e))return!1;
return!0};var sa=function(b,e){this.name=b;this.obj=e};sa.prototype.toString=function(){return"#<js-object:"+typeof this.obj+":"+this.name+">"};sa.prototype.isEqual=function(b){return this.obj===b.obj};var aa=function(b,e,c){this.startup=b;this.shutdown=e;this.startupArgs=c;this.shutdownArg=void 0};aa.prototype.toString=function(){return"#<world-config>"};aa.prototype.isEqual=function(b,e){if(!E(this.startup,b.startup,e)||!E(this.shutdown,b.shutdown,e)||this.startupArgs.length!=b.startupArgs.length||
!E(this.shutdownArg,b.shutdownArg,e))return!1;for(var c=0;c<args.length;c++)if(!E(this.startupArgs[c],b.startupArgs[c],e))return!1;return!0};var F=c("effect",!1,0,0,!1,!1);F.type.prototype.invokeEffect=function(){helpers.raise(types.incompleteExn(types.exnFail,"effect type created without using make-effect-type",[]))};var ja=c("render-effect",!1,0,0,!1,!1);ja.type.prototype.callImplementation=function(){helpers.raise(types.incompleteExn(types.exnFail,"render effect created without using make-render-effect-type",
[]))};var K=function(b,e){e||(e=ga());if(typeof b=="object"){if(e.containsKey(b))return"...";e.put(b,!0)}if(b==void 0||b==null)return"#<undefined>";if(typeof b=="string")return'"'+W(b.toString())+'"';if(typeof b!="object"&&typeof b!="function")return b.toString();var c;c=typeof b.toWrittenString!=="undefined"?b.toWrittenString(e):typeof b.toDisplayedString!=="undefined"?b.toDisplayedString(e):b.toString();e.remove(b);return c},V=function(b,e){e||(e=ga());if(typeof b=="object"){if(e.containsKey(b))return"...";
e.put(b,!0)}if(b==void 0||b==null)return"#<undefined>";if(typeof b=="string")return b;if(typeof b!="object"&&typeof b!="function")return b.toString();var c;c=typeof b.toDisplayedString!=="undefined"?b.toDisplayedString(e):typeof b.toWrittenString!=="undefined"?b.toWrittenString(e):b.toString();e.remove(b);return c},ha=function(b,c){c||(c=ga());if(e(b))return t(b);if(typeof b=="object"){if(c.containsKey(b)){var d=document.createElement("span");d.appendChild(document.createTextNode("..."));return d}c.put(b,
!0)}if(b==void 0||b==null)return d=document.createElement("span"),d.appendChild(document.createTextNode("#<undefined>")),d;if(typeof b=="string"){var l=document.createElement("span");l.style["white-space"]="pre";d=document.createTextNode(K(b));l.appendChild(d);return l}if(typeof b!="object"&&typeof b!="function")return d=document.createElement("span"),d.appendChild(document.createTextNode(b.toString())),d;b.nodeType?d=b:typeof b.toDomNode!=="undefined"?d=b.toDomNode(c):typeof b.toWrittenString!==
"undefined"?(d=document.createElement("span"),d.appendChild(document.createTextNode(b.toWrittenString(c)))):typeof b.toDisplayedString!=="undefined"?(d=document.createElement("span"),d.appendChild(document.createTextNode(b.toDisplayedString(c)))):(d=document.createElement("span"),d.appendChild(document.createTextNode(b.toString())));c.remove(b);return d},t=function(b){var e;return jsnums.isExact(b)?jsnums.isInteger(b)?(e=document.createElement("span"),e.appendChild(document.createTextNode(b.toString())),
e):jsnums.isRational(b)?k(b):(I(b),e=document.createElement("span"),e.appendChild(document.createTextNode(b.toString())),e):(e=document.createElement("span"),e.appendChild(document.createTextNode(b.toString())),e)},k=function(b){var e=document.createElement("span"),c=jsnums.toRepeatingDecimal(jsnums.numerator(b),jsnums.denominator(b),{limit:25});e.appendChild(document.createTextNode(c[0]+"."));e.appendChild(document.createTextNode(c[1]));if(c[2]==="...")e.appendChild(document.createTextNode(c[2]));
else if(c[2]!=="0"){var d=document.createElement("span");d.style.textDecoration="overline";d.appendChild(document.createTextNode(c[2]));e.appendChild(d)}var l=document.createElement("span"),c=document.createElement("sup");c.appendChild(document.createTextNode(String(jsnums.numerator(b))));d=document.createElement("sub");d.appendChild(document.createTextNode(String(jsnums.denominator(b))));l.appendChild(c);l.appendChild(document.createTextNode("/"));l.appendChild(d);b=document.createElement("span");
b.appendChild(e);b.appendChild(l);l.style.display="none";var o=!0;b.onclick=function(){o=!o;e.style.display=o?"inline":"none";l.style.display=!o?"inline":"none"};b.style.cursor="pointer";return b},e=jsnums.isSchemeNumber,I=e,y=function(b){return typeof b==="string"||b instanceof D},E=function(b,c,d){if(b===c)return!0;if(e(b)&&e(c))return jsnums.equals(b,c);if(y(b)&&y(c))return b.toString()===c.toString();if(b==void 0||b==null)return c==void 0||c==null;if(typeof b=="object"&&typeof c=="object"&&b.isEqual&&
c.isEqual)return d.find(b)===d.find(c)?!0:(d.merge(b,c),b.isEqual(c,d));return!1},$=function(b){this.elts=b};$.prototype.toDomNode=function(b){var e=document.createElement("span");e.style["white-space"]="pre";if(this.elts.length>0){e.appendChild(ha(this.elts[0],b));for(var c=1;c<this.elts.length;c++)e.appendChild(document.createTextNode("\n")),e.appendChild(ha(this.elts[c],b))}return e};var G=function(){};G.prototype.toString=function(){return"#<undefined>"};var G=new G,na=function(){};na.prototype.toString=
function(){return"#<void>"};var va=new na,na=function(){};na.prototype.toString=function(){return"#<eof>"};var na=new na,Q=function(b,e,c,d,l,o){this.name=b;this.numParams=e;this.paramTypes=c;this.isRest=d;this.closureVals=l;this.body=o};Q.prototype.toString=function(){return this.name!==Empty.EMPTY?helpers.format("#<procedure:~a>",[this.name]):"#<procedure>"};var U=function(b,e){this.name=b;this.closures=e};U.prototype.toString=function(){return this.name!==Empty.EMPTY?helpers.format("#<case-lambda-procedure:~a>",
[this.name]):"#<case-lambda-procedure>"};var z=function(b,e){this.name=!1;this.vstack=b.slice(0);this.cstack=e.slice(0)};z.prototype.toString=function(){return this.name!==Empty.EMPTY?helpers.format("#<procedure:~a>",[this.name]):"#<procedure>"};var H=function(){this.slots=[];this.definedMask=[]};H.prototype.addSlot=function(b){b===void 0?(this.slots.push(types.UNDEFINED),this.definedMask.push(!1)):(this.slots.push(b),b instanceof wa?b.value===types.UNDEFINED?this.definedMask.push(!1):this.definedMask.push(!0):
this.definedMask.push(!0))};H.prototype.ref=function(b){if(this.slots[b]instanceof wa)if(this.definedMask[b])return this.slots[b].value;else helpers.raise(types.incompleteExn(types.exnFailContractVariable,"reference to an identifier before its definition: "+this.slots[b].name,[this.slots[b].name]));else if(this.definedMask[b])return this.slots[b];else helpers.raise(types.incompleteExn(types.exnFailContractVariable,"variable has not been defined",[!1]))};H.prototype.set=function(b,e){this.slots[b]instanceof
wa?this.slots[b].value=e:this.slots[b]=e;this.definedMask[b]=!0};H.prototype.length=function(){return this.slots.length};var wa=function(b,e){this.name=b;this.value=e},Y=function(b,e){this.prefix=b;this.pos=e};Y.prototype.ref=function(){return this.prefix.ref(this.pos)};Y.prototype.set=function(b){this.prefix.set(this.pos,b)};var ma=function(b){this.dict=b||ga()};ma.prototype.invoke=function(){};ma.prototype.update=function(b,e){for(var c=ga(),d=this.dict.keys(),l=0;l<d.length;l++)c.put(d[l],this.dict.get(d[l]));
c.put(b,e);return new ma(c)};var O=function(b){this.dict=b};O.prototype.toDomNode=function(){var b=document.createElement("span");b.appendChild(document.createTextNode("#<continuation-mark-set>"));return b};O.prototype.toWrittenString=function(){return"#<continuation-mark-set>"};O.prototype.toDisplayedString=function(){return"#<continuation-mark-set>"};O.prototype.ref=function(b){if(this.dict.containsKey(b))return this.dict.get(b);return[]};var da=function(){},ia=new da,ba=function(b,e,c,d,l){this.name=
b;this.numParams=e;this.isRest=c;this.usesState=d;this.impl=l};ba.prototype.toString=function(){return"#<procedure:"+this.name+">"};ba.prototype.toWrittenString=function(){return"#<procedure:"+this.name+">"};ba.prototype.toDisplayedString=function(){return"#<procedure:"+this.name+">"};ba.prototype.toDomNode=function(){var b=document.createElement("span");b.appendChild(document.createTextNode("#<procedure:"+this.name+">"));return b};var ra=function(b,e){this.name=b;this.cases=e};ra.prototype.toDomNode=
function(){var b=document.createElement("span");b.appendChild(document.createTextNode("#<procedure:"+this.name+">"));return b};ra.prototype.toWrittenString=function(){return"#<procedure:"+this.name+">"};ra.prototype.toDisplayedString=function(){return"#<procedure:"+this.name+">"};var l=c("posn",!1,2,0,!1,!1),o=c("color",!1,3,0,!1,!1),oa=c("arity-at-least",!1,1,0,!1,function(b,e,c){helpers.check(e,function(b){return jsnums.isExact(b)&&jsnums.isInteger(b)&&jsnums.greaterThanOrEqual(b,0)},c,"exact non-negative integer",
1);b(e)});types.symbol=T.makeInstance;types.rational=jsnums.makeRational;types["float"]=jsnums.makeFloat;types.complex=jsnums.makeComplex;types.bignum=jsnums.makeBignum;types.list=function(b){for(var e=Empty.EMPTY,c=b.length-1;c>=0;c--)e=Cons.makeInstance(b[c],e);return e};types.vector=function(b){return Vector.makeInstance(b.length,b)};types.regexp=function(b){return new q(b)};types.byteRegexp=function(b){return new C(b)};types["char"]=Char.makeInstance;types.string=function(b){if(b instanceof D)return b;
else if(b instanceof Array)return D.makeInstance(b);else if(typeof b==="string")return D.fromString(b);else throw types.internalError("makeString expects and array of 1-character strings or a string; given "+b.toString(),!1);};types.box=function(b){return new L(b,!0)};types.boxImmutable=function(b){return new L(b,!1)};types.path=function(b){return new A(b)};types.bytes=function(b,e){return new P(b,e)};types.keyword=function(b){return new J(b)};types.pair=function(b,e){return Cons.makeInstance(b,e)};
types.hash=function(b){for(var e=new N;!b.isEmpty();)e.hash.put(b.first().first(),b.first().rest()),b=b.rest();return e};types.hashEq=function(b){for(var e=new fa;!b.isEmpty();)e.hash.put(b.first().first(),b.first().rest()),b=b.rest();return e};types.jsObject=function(b,e){return new sa(b,e)};types.toWrittenString=K;types.toDisplayedString=V;types.toDomNode=ha;types.posn=l.constructor;types.posnX=function(b){return l.accessor(b,0)};types.posnY=function(b){return l.accessor(b,1)};types.color=o.constructor;
types.colorRed=function(b){return o.accessor(b,0)};types.colorGreen=function(b){return o.accessor(b,1)};types.colorBlue=function(b){return o.accessor(b,2)};types.arityAtLeast=oa.constructor;types.arityValue=function(b){return oa.accessor(b,0)};types.FALSE=Logic.FALSE;types.TRUE=Logic.TRUE;types.EMPTY=Empty.EMPTY;types.isEqual=E;types.isNumber=e;types.isSymbol=function(b){return b instanceof T};types.isChar=function(b){return b instanceof Char};types.isString=y;types.isPair=function(b){return b instanceof
Cons};types.isVector=function(b){return b instanceof Vector};types.isBox=function(b){return b instanceof L};types.isHash=function(b){return b instanceof fa||b instanceof N};types.isByteString=function(b){return b instanceof P};types.isStruct=function(b){return b instanceof h};types.isPosn=l.predicate;types.isArityAtLeast=oa.predicate;types.isColor=o.predicate;types.isFunction=function(b){return b instanceof ba||b instanceof ra||b instanceof Q||b instanceof U||b instanceof z};types.isJsObject=function(b){return b instanceof
sa};types.UnionFind=m;types.cons=Cons.makeInstance;types.UNDEFINED=G;types.VOID=va;types.EOF=na;types.ValuesWrapper=$;types.ClosureValue=Q;types.ContinuationPrompt=da;types.defaultContinuationPrompt=ia;types.ContinuationClosureValue=z;types.CaseLambdaValue=U;types.PrimProc=ba;types.CasePrimitive=ra;types.contMarkRecordControl=function(b){return new ma(b)};types.isContMarkRecordControl=function(b){return b instanceof ma};types.continuationMarkSet=function(b){return new O(b)};types.isContinuationMarkSet=
function(b){return b instanceof O};types.PrefixValue=H;types.GlobalBucket=wa;types.ModuleVariableRecord=function(b,e){this.resolvedModuleName=b;this.variableName=e};types.VariableReference=Y;types.Box=L;types.ThreadCell=function(b,e){this.v=b;this.isPreserved=e||!1};types.Class=b;types.makeStructureType=c;types.isStructType=function(b){return b instanceof StructType};types.makeLowLevelEqHash=ga;var Ga=function(b,e){this.val=b;this.contMarks=e?e:!1};types.internalError=function(b,e){return new Ga(b,
e)};types.isInternalError=function(b){return b instanceof Ga};var ya=function(b){this.val=b};types.schemeError=function(b){return new ya(b)};types.isSchemeError=function(b){return b instanceof ya};var S=function(b,e,c){this.constructor=b;this.msg=e;this.otherArgs=c};types.incompleteExn=function(b,e,c){return new S(b,e,c)};types.isIncompleteExn=function(b){return b instanceof S};var za=c("exn",!1,2,0,!1,function(b,e,c,d){helpers.check(e,y,d,"string",1,[e,c]);helpers.check(c,types.isContinuationMarkSet,
d,"continuation mark set",2);b(new $([e,c]))});types.exn=za.constructor;types.isExn=za.predicate;types.exnMessage=function(b){return za.accessor(b,0)};types.exnContMarks=function(b){return za.accessor(b,1)};types.exnSetContMarks=function(b,e){za.mutator(b,1,e)};var qa=c("exn:break",za,1,0,!1,function(b,e,c,d){b(new $([e,c,d]))});types.exnBreak=qa.constructor;types.isExnBreak=qa.predicate;types.exnBreakContinuation=function(b){return qa.accessor(b,0)};b=c("exn:fail",za,0,0,!1,!1);types.exnFail=b.constructor;
types.isExnFail=b.predicate;b=c("exn:fail:contract",b,0,0,!1,!1);types.exnFailContract=b.constructor;types.isExnFailContract=b.predicate;c("exn:fail:contract:arity",b,0,0,!1,!1);types.exnFailContractArity=b.constructor;types.isExnFailContractArity=b.predicate;var Ea=c("exn:fail:contract:variable",b,1,0,!1,!1);types.exnFailContractVariable=b.constructor;types.isExnFailContractVariable=b.predicate;types.exnFailContractVariableId=function(b){return Ea.accessor(b,0)};b=c("exn:fail:contract:division-by-zero",
b,0,0,!1,!1);types.exnFailContractDivisionByZero=b.constructor;types.isExnFailContractDivisionByZero=b.predicate;types.worldConfig=function(b,e,c){return new aa(b,e,c)};types.isWorldConfig=function(b){return b instanceof aa};types.makeEffectType=function(b,e,d,l,o,I){e||(e=F);var b=c(b,e,d,0,!1,o),y=b.firstField+b.numberOfFields;b.type.prototype.invokeEffect=function(b,e){var c=new ba("update-world",1,!1,!0,function(e,c){helpers.check(c,helpers.procArityContains(1),"update-world","procedure (arity 1)",
1);b(function(b,d){interpret.call(e,c,[b],d,function(b){throw b;})},function(){e.v=va})}),d=this._fields.slice(0,y);d.unshift(c);I(l,d,e)};return b};types.isEffectType=function(b){return b instanceof StructType&&b.type.prototype.invokeEffect?!0:!1};types.isEffect=F.predicate;types.makeRenderEffectType=function(b,e,d,l,o){e||(e=ja);var b=c(b,e,d,0,!1,o),I=b.firstField+b.numberOfFields;b.type.prototype.callImplementation=function(b,e){var c=this._fields.slice(0,I);b(l,c,e)};return b};types.isRenderEffectType=
function(b){return b instanceof StructType&&b.type.prototype.callImplementation?!0:!1};types.isRenderEffect=ja.predicate})();var state={};
(function(){var d=function(b){sys.print(types.toWrittenString(b)+"\n")},m=function(){throw Error("There is a software configuration error by the system's maintainer: the toplevel node has not been initialized yet.");},b=function(){this.v=[];this.vstack=[];this.cstack=[];this.heap={};this.globals={};this.hooks={printHook:d,displayHook:d,toplevelNodeHook:m,imageProxyHook:!1};this.invokedModules={};this.breakRequested=!1;this.breakRequestedListeners=[]};b.prototype.clearForEval=function(b){this.v=[];
this.vstack=[];this.cstack=[];if(!b||!b.preserveBreak)this.breakRequested=!1,this.breakRequestedListeners=[];if(b&&b.clearGlobals)this.globals={}};b.prototype.save=function(){return{v:this.v,vstack:this.vstack.slice(0),cstack:this.cstack.slice(0),heap:this.heap,globals:c(this.globals),hooks:this.hooks,breakRequested:this.breakRequested,breakRequestedListeners:c(this.breakRequestedListeners),invokedModules:this.invokedModules}};var c=function(b){var c={},d;for(d in b)b.hasOwnProperty(d)&&(c[d]=b[d]);
return c};b.prototype.restore=function(b){this.v=b.v;this.vstack=b.vstack;this.cstack=b.cstack;this.heap=b.heap;this.globals=b.globals;this.hooks=b.hooks;this.breakRequestListeners=b.breakRequestListeners;this.invokedModules=b.invokedModules};b.prototype.requestBreak=function(){this.breakRequested=!0;for(var b=0;b<this.breakRequestedListeners.length;b++)try{this.breakRequestedListeners[b]()}catch(c){helpers.reportError(c)}};b.prototype.addBreakRequestedListener=function(b){this.breakRequestedListeners.push(b)};
b.prototype.removeBreakRequestedListener=function(b){for(var c=this.breakRequestedListeners.length-1;c>=0;c--)this.breakRequestedListeners[c]===b&&this.breakRequestedListeners.splice(c,1)};b.prototype.pushControl=function(b){this.cstack.push(b)};b.prototype.pushManyControls=function(b){for(var c=0;c<b.length;c++)this.cstack.push(b[b.length-1-c])};b.prototype.isStuck=function(){return this.cstack.length===0};b.prototype.popControl=function(){if(this.cstack.length===0)throw types.internalError("cstack empty",
h(this));return this.cstack.pop()};b.prototype.pushValue=function(b){this.vstack.push(b)};b.prototype.popValue=function(){if(this.vstack.length===0)throw types.internalError("vstack empty",h(this));return this.vstack.pop()};b.prototype.pushn=function(b){for(var c=0;c<b;c++)this.vstack.push(types.UNDEFINED)};b.prototype.popn=function(b){for(var c=0;c<b;c++){if(this.vstack.length===0)throw types.internalError("vstack empty",h(this));this.vstack.pop()}};b.prototype.peekn=function(b){if(this.vstack.length-
1-(b||0)<0)throw types.internalError("vstack not long enough",h(this));return this.vstack[this.vstack.length-1-(b||0)]};b.prototype.setn=function(b,c){this.vstack[this.vstack.length-1-(b||0)]=c};b.prototype.refPrefix=function(b,c){var d=this.vstack[this.vstack.length-1-b].ref(c);if(d instanceof types.ModuleVariableRecord&&this.invokedModules[d.resolvedModuleName]){var h=this.invokedModules[d.resolvedModuleName];if(typeof h.providedValues[d.variableName]!=="undefined")return h.providedValues[d.variableName];
throw types.schemeError(types.exnFailContractVariable("reference to an identifier before its definition: "+d.variableName,!1,d.variableName));}return d};b.prototype.setPrefix=function(b,c,d){this.vstack[this.vstack.length-1-b].set(c,d)};b.prototype.setPrintHook=function(b){this.hooks.printHook=b};b.prototype.getPrintHook=function(){return this.hooks.printHook};b.prototype.setDisplayHook=function(b){this.hooks.displayHook=b};b.prototype.setImageProxyHook=function(b){this.hooks.imageProxyHook=b};b.prototype.getImageProxyHook=
function(){return this.hooks.imageProxyHook};b.prototype.getDisplayHook=function(){return this.hooks.displayHook};b.prototype.getToplevelNodeHook=function(){return this.hooks.toplevelNodeHook};b.prototype.setToplevelNodeHook=function(b){this.hooks.toplevelNodeHook=b};var h=function(b){for(var c=types.makeLowLevelEqHash(),d=0;d<b.cstack.length;d++)if(types.isContMarkRecordControl(b.cstack[d]))for(var h=b.cstack[d].dict,q=h.keys(),m=0;m<q.length;m++)c.put(q[m],c.get(q[m])||[]),c.get(q[m]).push(h.get(q[m]));
return types.continuationMarkSet(c)},q=types.symbol("moby-stack-record-continuation-mark-key"),C=function(b,c){for(var d in b)if(b.hasOwnProperty(d))if(c.hasOwnProperty(d)){if(b[d]!==c[d])return!1}else return!1;for(d in c)if(c.hasOwnProperty(d))if(b.hasOwnProperty(d)){if(b[d]!==c[d])return!1}else return!1;return!0};state.State=b;state.captureCurrentContinuationMarks=h;state.getStackTraceFromContinuationMarks=function(b){for(var c=[],b=b.ref(q),d=b.length-1;d>=0;d--){var h=b[d],m=h.ref(0),X=h.ref(1),
J=h.ref(2),ca=h.ref(3),h=h.ref(4),m={id:m,offset:X,line:J,column:ca,span:h};(c.length===0||!C(c[c.length-1],m))&&c.push(m)}return c}})();var world={};
(function(){world.config={};var d=function(){this.vals={changeWorld:!1,shutdownWorld:!1,initialEffect:!1,onRedraw:!1,onDraw:!1,onDrawCss:!1,tickDelay:!1,onTick:!1,onTickEffect:!1,onKey:!1,onKeyEffect:!1,onTilt:!1,onTiltEffect:!1,onAcceleration:!1,onAccelerationEffect:!1,onShake:!1,onShakeEffect:!1,onSmsReceive:!1,onSmsReceiveEffect:!1,onLocationChange:!1,onLocationChangeEffect:!1,onAnnounce:!1,onAnnounceEffect:!1,stopWhen:!1,stopWhenEffect:!1,connectToGame:!1,onGameStart:!1,onOpponentTurn:!1,onMyTurn:!1,
afterMyTurn:!1,onGameFinish:!1}};d.prototype.lookup=function(d){if(d in this.vals)return this.vals[d];else throw Error("Can't find "+d+" in the configuration");};d.prototype.updateAll=function(m){var b=new d,c=this.vals,h={},q;for(q in c)c.hasOwnProperty(q)&&(h[q]=c[q]);for(q in m)m.hasOwnProperty(q)&&(h[q]=m[q]);b.vals=h;return b};world.config.WorldConfig=d;world.config.CONFIG=new d;world.config.Kernel=world.config.Kernel||{};world.config.Kernel.getNoneEffect=function(){throw Error("getNoneEffect: We should not be calling effects!");
}})();
(function(){world.stimuli={};var d=[],m=function(){},b=function(b,c,h){this.config=b;this.caller=c;this.restarter=h;d.push(this)};b.prototype.doStimuli=function(b,c,d,h){var m=this;try{m.change(function(b,h){var q=[b].concat(d);c?m.caller(c,q,h):h(b)},h)}catch(L){this.onShutdown()}};b.prototype.onTilt=function(b,d){var h=this.lookup("onTilt");this.doStimuli(this.lookup("onTiltEffect"),h,helpers.map(c,b),d)};b.prototype.onAcceleration=function(b,d){var h=this.lookup("onAcceleration");this.doStimuli(this.lookup("onAccelerationEffect"),h,
helpers.map(c,b),d)};b.prototype.onShake=function(b,c){var d=this.lookup("onShake");this.doStimuli(this.lookup("onShakeEffect"),d,[],c)};b.prototype.onSmsReceive=function(b,c){var d=this.lookup("onSmsReceive");this.doStimuli(this.lookup("onSmsReceiveEffect"),d,[b[0]+"",b[1]+""],c)};b.prototype.onLocation=function(b,d){var h=this.lookup("onLocationChange");this.doStimuli(this.lookup("onLocationChangeEffect"),h,helpers.map(c,b),d)};b.prototype.onKey=function(b,c){var d=function(b){b=b.charCode||b.keyCode;
switch(b){case 16:b="shift";break;case 17:b="control";break;case 19:b="pause";break;case 27:b="escape";break;case 33:b="prior";break;case 34:b="next";break;case 35:b="end";break;case 36:b="home";break;case 37:b="left";break;case 38:b="up";break;case 39:b="right";break;case 40:b="down";break;case 42:b="print";break;case 45:b="insert";break;case 46:b=String.fromCharCode(127);break;case 106:b="*";break;case 107:b="+";break;case 109:b="-";break;case 110:b=".";break;case 111:b="/";break;case 144:b="numlock";
break;case 145:b="scroll";break;case 186:b=";";break;case 187:b="=";break;case 188:b=",";break;case 189:b="-";break;case 190:b=".";break;case 191:b="/";break;case 192:b="`";break;case 219:b="[";break;case 220:b="\\";break;case 221:b="]";break;case 222:b="'";break;default:b=b>=96&&b<=105?(b-96).toString():b>=112&&b<=123?"f"+(b-111):String.fromCharCode(b).toLowerCase()}return b}(b[0]),h=this.lookup("onKey");this.doStimuli(this.lookup("onKeyEffect"),h,[d],c)};b.prototype.onAnnounce=function(b,c){for(var d=
b[1],h=types.EMPTY,m=0;m<d.length;m++)h=types.cons(d[d.length-m-1],h);d=this.lookup("onAnnounce");m=this.lookup("onAnnounceEffect");this.doStimuli(d,m,[b[0],h],c)};b.prototype.onShutdown=function(){var b=d.indexOf(this);b!=-1&&d.splice(b,1);(b=this.lookup("shutdownWorld"))&&b()};var c=types["float"];b.prototype.lookup=function(b){return this.config.lookup(b)};b.prototype.change=function(b,c){this.lookup("changeWorld")?this.lookup("changeWorld")(b,c):c()};var h=function(b){return function(){for(var c=
arguments,h=0;h<d.length;h++)d[h][b](c,m)}};world.stimuli.StimuliHandler=b;world.stimuli.onTilt=h("onTilt");world.stimuli.onAcceleration=h("onAcceleration");world.stimuli.onShake=h("onShake");world.stimuli.onSmsReceive=h("onSmsReceive");world.stimuli.onLocation=h("onLocation");world.stimuli.onKey=h("onKey");world.stimuli.onAnnounce=h("onAnnounce");world.stimuli.massShutdown=function(){for(var b=0;b<d.length;b++){var c=d[b].lookup("shutdownWorld");c&&c()}d=[]}})();
typeof world==="undefined"&&(world={});
(function(){world.Kernel={};var d=[],m=function(b){var c=function(){};c.prototype=b;return new c},b=function(b){var c=function(){};c.prototype=b;c=new c;for(property in b)b.hasOwnProperty(property)&&(c[property]=b[property]);return c},c=[];world.Kernel.addAnnounceListener=function(b){c.push(b)};world.Kernel.removeAnnounceListener=function(b){b=c.indexOf(b);b!=-1&&c.splice(b,1)};world.Kernel.announce=function(b,d){for(var h=0;h<c.length;h++)try{c[h](b,d)}catch(k){}};world.Kernel.updateWorld=function(b){world=
b(world);for(b=0;b<d.length;b++)d[b](world)};world.Kernel.shutdownWorld=function(){};var h=function(b,c){this.pinholeX=b;this.pinholeY=c};world.Kernel.BaseImage=h;h.prototype.updatePinhole=function(e,c){var d=b(this);d.pinholeX=e;d.pinholeY=c;return d};h.prototype.getHeight=function(){return this.height};h.prototype.getWidth=function(){return this.width};h.prototype.getBaseline=function(){return this.height};h.prototype.render=function(){throw Error("BaseImage.render unimplemented!");};world.Kernel.makeCanvas=
function(b,c){var d=document.createElement("canvas");d.width=b;d.height=c;d.style.width=d.width+"px";d.style.height=d.height+"px";window&&typeof window.G_vmlCanvasManager!="undefined"&&(d=window.G_vmlCanvasManager.initElement(d));return d};h.prototype.toDomNode=function(){var b=this,c=b.getWidth(),d=b.getHeight(),h=world.Kernel.makeCanvas(c,d);h.afterAttach=function(){var c=h.getContext("2d");b.render(c,0,0)};return h};h.prototype.toWrittenString=function(){return"<image>"};h.prototype.toDisplayedString=
function(){return"<image>"};h.prototype.isEqual=function(b){return this.pinholeX==b.pinholeX&&this.pinholeY==b.pinholeY};var q=function(b){return b!=void 0&&b!=null&&b instanceof C},C=function(b,c,d,k){h.call(this,0,0);this.width=b;this.height=c;this.children=d;this.withBorder=k};C.prototype=m(h.prototype);C.prototype.add=function(b,c,d){return new C(this.width,this.height,this.children.concat([[b,c-b.pinholeX,d-b.pinholeY]]),this.withBorder)};C.prototype.render=function(b,c,d){var h,k,m,q;b.clearRect(c,
d,this.width,this.height);for(h=0;h<this.children.length;h++)k=this.children[h][0],m=this.children[h][1],q=this.children[h][2],b.save(),k.render(b,m+c,q+d),b.restore();if(this.withBorder)b.strokeStyle="black",b.strokeRect(c,d,this.width,this.height)};C.prototype.isEqual=function(b,c){if(!(b instanceof C))return!1;if(this.pinholeX!=b.pinholeX||this.pinholeY!=b.pinholeY||this.width!=b.width||this.height!=b.height||this.children.length!=b.children.length)return!1;for(var d=0;d<this.children.length;d++){var h=
this.children[d],k=b.children[d];if(h[1]!==k[1]||h[2]!==k[2]||!types.isEqual(h[0],k[0],c))return!1}return!0};var A=function(b,c,d){h.call(this,0,0);var k=this;this.src=b;this.isLoaded=!1;this.animationHackImg=void 0;c&&c.complete?(this.img=c,this.isLoaded=!0,this.pinholeX=k.img.width/2,this.pinholeY=k.img.height/2):(this.img=new Image,this.img.onload=function(){k.isLoaded=!0;k.pinholeX=k.img.width/2;k.pinholeY=k.img.height/2},this.img.onerror=function(){k.img.onerror="";k.img.src="http://www.wescheme.org/images/broken.png"},
this.img.src=b);this.installHackToSupportAnimatedGifs(d)};A.prototype=m(h.prototype);var P={};A.makeInstance=function(b,c,d){b in P?d(P[b]):P[b]=new A(b,c,d);return P[b]};A.installInstance=function(b,c,d){P[b]=new A(b,c,d)};A.installBrokenImage=function(b){P[b]=new aa("Unable to load "+b,10,k.get("red"),"normal","Optimer","","",!1)};A.prototype.render=function(b,c,d){b.drawImage(this.animationHackImg,c,d)};A.prototype.installHackToSupportAnimatedGifs=function(b){var c=this;this.animationHackImg=this.img.cloneNode(!0);
document.body.appendChild(this.animationHackImg);this.animationHackImg.width=0;this.animationHackImg.height=0;this.animationHackImg.complete?b(c):this.animationHackImg.onload=function(){b(c)}};A.prototype.getWidth=function(){return this.img.width};A.prototype.getHeight=function(){return this.img.height};A.prototype.toDomNode=function(){return this.img.cloneNode(!0)};A.prototype.isEqual=function(b){return b instanceof A&&this.pinholeX==b.pinholeX&&this.pinholeY==b.pinholeY&&this.src==b.src};var w=
function(b,c){h.call(this,0,0);var d=this;this.src=b;c?(this.video=c,this.width=d.video.videoWidth,this.height=d.video.videoHeight,this.pinholeX=d.width/2,this.pinholeY=d.height/2,this.video.volume=1,this.video.poster="http://www.wescheme.org/images/broken.png",this.video.autoplay=!0,this.video.autobuffer=!0,this.video.loop=!0,this.video.play()):(this.video=document.createElement("video"),this.video.src=b,this.video.addEventListener("canplay",function(){this.width=d.video.videoWidth;this.height=d.video.videoHeight;
this.pinholeX=d.width/2;this.pinholeY=d.height/2;this.video.poster="http://www.wescheme.org/images/broken.png";this.video.autoplay=!0;this.video.autobuffer=!0;this.video.loop=!0;this.video.play()}),this.video.addEventListener("error",function(){d.video.onerror="";d.video.poster="http://www.wescheme.org/images/broken.png"}))};w.prototype=m(h.prototype);videos={};w.makeInstance=function(b,c){b in w||(videos[b]=new w(b,c));return videos[b]};w.prototype.render=function(b,c,d){b.drawImage(this.video,c,
d)};w.prototype.isEqual=function(b){return b instanceof w&&this.pinholeX==b.pinholeX&&this.pinholeY==b.pinholeY&&this.src==b.src};var L=function(b,c,d,k){var m=b.getWidth()/2,F=b.getHeight()/2,t=c.getWidth()/2,K=c.getHeight()/2,d=d=="right"?m>t?c.getWidth()-(m+t):b.getWidth()-(m+t):d=="left"?m>t?b.getWidth()-(m+t):c.getWidth()-(m+t):d=="beside"?m+t:d=="middle"||d=="center"?0:d,k=k=="bottom"?F>K?c.getHeight()-(F+K):b.getHeight()-(F+K):k=="top"?F>K?b.getHeight()-(F+K):c.getHeight()-(F+K):k=="above"?
F+K:k=="baseline"?b.getBaseline()-c.getBaseline():k=="middle"||k=="center"?0:k;q(b)&&(d+=m,k+=m);q(c)&&(d-=t,k-=t);m=b.pinholeX-c.pinholeX+d;t=b.pinholeY-c.pinholeY+k;k=Math.min(0,m);F=Math.min(0,t);K=Math.max(m+c.getWidth(),b.getWidth());d=Math.max(t+c.getHeight(),b.getHeight());h.call(this,Math.floor((K-k)/2),Math.floor((d-F)/2));this.img1=b;this.img2=c;this.width=K-k;this.height=d-F;this.img1Dx=-k;this.img1Dy=-F;this.img2Dx=m-k;this.img2Dy=t-F};L.prototype=m(h.prototype);L.prototype.render=function(b,
c,d){b.save();this.img2.render(b,c+this.img2Dx,d+this.img2Dy);this.img1.render(b,c+this.img1Dx,d+this.img1Dy);b.restore()};L.prototype.isEqual=function(b,c){return b instanceof L&&this.pinholeX==b.pinholeX&&this.pinholeY==b.pinholeY&&this.width==b.width&&this.height==b.height&&this.img1Dx==b.img1Dx&&this.img1Dy==b.img1Dy&&this.img2Dx==b.img2Dx&&this.img2Dy==b.img2Dy&&types.isEqual(this.img1,b.img1,c)&&types.isEqual(this.img2,b.img2,c)};var T=function(b,c){var d=Math.sin(b*Math.PI/180),k=Math.cos(b*
Math.PI/180),m=Math.floor(k*c.getWidth()),q=Math.floor(d*c.getWidth()),F=Math.floor(-d*c.getHeight()),t=Math.floor(k*c.getHeight()),K=Math.floor(k*c.getWidth()-d*c.getHeight()),A=Math.floor(d*c.getWidth()+k*c.getHeight()),d=Math.min(0,m,F,K),k=Math.min(0,q,t,A),m=Math.max(0,m,F,K)-d,q=Math.max(0,q,t,A)-k;h.call(this,Math.floor(m/2),Math.floor(q/2));this.img=c;this.width=m;this.height=q;this.angle=b;this.translateX=-d;this.translateY=-k};T.prototype=m(h.prototype);T.prototype.render=function(b,c,d){b.save();
b.translate(c+this.translateX,d+this.translateY);b.rotate(this.angle*Math.PI/180);this.img.render(b,0,0);b.restore()};T.prototype.isEqual=function(b,c){return b instanceof T&&this.pinholeX==b.pinholeX&&this.pinholeY==b.pinholeY&&this.width==b.width&&this.height==b.height&&this.angle==b.angle&&this.translateX==b.translateX&&this.translateY==b.translateY&&types.isEqual(this.img,b.img,c)};var X=function(b,c,d){h.call(this,Math.floor(d.getWidth()*b/2),Math.floor(d.getHeight()*c/2));this.img=d;this.width=
Math.floor(d.getWidth()*b);this.height=Math.floor(d.getHeight()*c);this.xFactor=b;this.yFactor=c};X.prototype=m(h.prototype);X.prototype.render=function(b,c,d){b.save();b.scale(this.xFactor,this.yFactor);this.img.render(b,c/this.xFactor,d/this.yFactor);b.restore()};X.prototype.isEqual=function(b,c){return b instanceof X&&this.pinholeX==b.pinholeX&&this.pinholeY==b.pinholeY&&this.width==b.width&&this.height==b.height&&this.xFactor==b.xFactor&&this.yFactor==b.yFactor&&types.isEqual(this.img,b.img,c)};
var J=function(b,c,d,k,m){h.call(this,Math.floor(d/2),Math.floor(k/2));this.x=b;this.y=c;this.width=d;this.height=k;this.img=m};J.prototype=m(h.prototype);J.prototype.render=function(b,c,d){b.save();b.translate(-this.x,-this.y);this.img.render(b,c,d);b.restore()};J.prototype.isEqual=function(b,c){return b instanceof J&&this.pinholeX==b.pinholeX&&this.pinholeY==b.pinholeY&&this.width==b.width&&this.height==b.height&&this.x==b.x&&this.y==b.y&&types.isEqual(this.img,b.img,c)};var ca=function(b){h.call(this,
Math.floor(b.getWidth()/2),Math.floor(b.getHeight()/2));this.img=b;this.width=b.getWidth();this.height=b.getHeight()};ca.prototype=m(h.prototype);ca.prototype.render=function(b,c,d){b.save();this.img.render(b,c,d);b.beginPath();b.strokeStyle="black";b.strokeRect(c,d,this.width,this.height);b.closePath();b.restore()};ca.prototype.isEqual=function(b,c){return b instanceof ca&&this.pinholeX==b.pinholeX&&this.pinholeY==b.pinholeY&&types.isEqual(this.img,b.img,c)};var la=function(b,c){this.img=b;this.width=
b.getWidth();this.height=b.getHeight();this.direction=c;h.call(this,b.pinholeX,b.pinholeY)};la.prototype=m(h.prototype);la.prototype.render=function(b,c,d){b.save();this.direction=="horizontal"&&(b.scale(-1,1),b.translate(-(this.width+2*c),0),this.img.render(b,c,d));this.direction=="vertical"&&(b.scale(1,-1),b.translate(0,-(this.height+2*d)),this.img.render(b,c,d));b.restore()};la.prototype.getWidth=function(){return this.width};la.prototype.getHeight=function(){return this.height};la.prototype.isEqual=
function(b,c){return b instanceof la&&this.pinholeX==b.pinholeX&&this.pinholeY==b.pinholeY&&this.width==b.width&&this.height==b.height&&this.direction==b.direction&&types.isEqual(this.img,b.img,c)};var D=function(b){return"rgb("+types.colorRed(b)+","+types.colorGreen(b)+", "+types.colorBlue(b)+")"},W=function(b,c,d,k){h.call(this,b/2,c/2);this.width=b;this.height=c;this.style=d;this.color=k};W.prototype=m(h.prototype);W.prototype.render=function(b,c,d){this.style.toString().toLowerCase()=="outline"?
(b.save(),b.beginPath(),b.strokeStyle=D(this.color),b.strokeRect(c,d,this.width,this.height)):(b.save(),b.beginPath(),b.fillStyle=D(this.color),b.fillRect(c,d,this.width,this.height));b.closePath();b.restore()};W.prototype.getWidth=function(){return this.width};W.prototype.getHeight=function(){return this.height};W.prototype.isEqual=function(b,c){return b instanceof W&&this.pinholeX==b.pinholeX&&this.pinholeY==b.pinholeY&&this.width==b.width&&this.height==b.height&&this.style==b.style&&types.isEqual(this.color,
b.color,c)};var ga=function(b,c,d,k){this.width=Math.sin(c/2*Math.PI/180)*b*2;this.height=Math.abs(Math.cos(c/2*Math.PI/180))*b*2;h.call(this,this.width/2,this.height/2);this.side=b;this.angle=c;this.style=d;this.color=k};ga.prototype=m(h.prototype);ga.prototype.render=function(b,c,d){b.save();b.beginPath();b.moveTo(c+this.getWidth()/2,d);b.lineTo(c+this.getWidth(),d+this.getHeight()/2);b.lineTo(c+this.getWidth()/2,d+this.getHeight());b.lineTo(c,d+this.getHeight()/2);b.closePath();this.style.toString().toLowerCase()==
"outline"?(b.strokeStyle=D(this.color),b.stroke()):(b.fillStyle=D(this.color),b.fill());b.restore()};ga.prototype.getWidth=function(){return this.width};ga.prototype.getHeight=function(){return this.height};ga.prototype.isEqual=function(b,c){return b instanceof ga&&this.pinholeX==b.pinholeX&&this.pinholeY==b.pinholeY&&this.side==b.side&&this.angle==b.angle&&this.style==b.style&&types.isEqual(this.color,b.color,c)};var fa=function(b){h.call(this,0,0);this.imageData=b;this.width=b.width;this.height=
b.height};fa.prototype=m(h.prototype);fa.prototype.render=function(b,c,d){b.putImageData(this.imageData,c,d)};fa.prototype.getWidth=function(){return this.width};fa.prototype.getHeight=function(){return this.height};fa.prototype.isEqual=function(b){return b instanceof fa&&this.pinholeX==b.pinholeX&&this.pinholeY==b.pinholeY};var N=function(b,c,d,k,m){this.aVertices=[];var q=0,F=0,t=0,K=0;this.outerRadius=Math.floor(b/(2*Math.sin(Math.PI/c)));this.innerRadius=Math.floor(b/(2*Math.tan(Math.PI/c)));
for(var A=3*Math.PI/2+Math.PI/c,z=0,w=0;w<c;w++){z+=d*2*Math.PI/c;var C={x:this.outerRadius*Math.cos(z-A),y:this.outerRadius*Math.sin(z-A)};if(C.x<t)t=C.x;if(C.x>q)q=C.y;if(C.y<K)K=C.x;if(C.y>F)F=C.y;this.aVertices.push(C)}for(w=0;w<this.aVertices.length;w++)this.aVertices[w].x<t&&(t=this.aVertices[w].x-1),this.aVertices[w].x>q&&(q=this.aVertices[w].x+1),this.aVertices[w].y<K&&(K=this.aVertices[w].y-1),this.aVertices[w].y>F&&(F=this.aVertices[w].y+1);this.width=Math.floor(q-t);this.height=Math.floor(F-
K);this.length=b;this.count=c;this.step=d;this.style=k;this.color=m;h.call(this,Math.floor(this.width/2),Math.floor(this.height/2))};N.prototype=m(h.prototype);N.prototype.render=function(b,c,d){c+=Math.round(this.width/2);d+=this.count%2?this.outerRadius:this.innerRadius;b.save();b.beginPath();b.moveTo(c+this.aVertices[0].x,d+this.aVertices[0].y);for(var h=1;h<this.aVertices.length;h++)b.lineTo(c+this.aVertices[h].x,d+this.aVertices[h].y);b.lineTo(c+this.aVertices[0].x,d+this.aVertices[0].y);b.closePath();
this.style.toString().toLowerCase()=="outline"?(b.strokeStyle=D(this.color),b.stroke()):(b.fillStyle=D(this.color),b.fill());b.restore()};N.prototype.isEqual=function(b,c){return b instanceof N&&this.pinholeX==b.pinholeX&&this.pinholeY==b.pinholeY&&this.length==b.length&&this.step==b.step&&this.count==b.count&&this.style==b.style&&types.isEqual(this.color,b.color,c)};var sa=function(b){if(/ /.test(b))return'"'+b+'"';return b},aa=function(b,c,d,k,m,q,F,t){var K;this.msg=b;this.size=c;this.color=d;
this.face=k;this.family=m;this.style=q=="slant"?"oblique":q;this.weight=F=="light"?"lighter":F;this.underline=t;c=world.Kernel.makeCanvas(0,0).getContext("2d");this.font=this.weight+" "+this.style+" "+this.size+"px "+sa(this.face)+" "+sa(this.family);try{c.font=this.font}catch(w){this.fallbackOnFont(),c.font=this.font}try{K=c.measureText(b),this.width=K.width,this.height=Number(this.size)}catch(C){this.fallbackOnFont()}h.call(this,Math.round(this.width/2),0)};aa.prototype=m(h.prototype);aa.prototype.fallbackOnFont=
function(){this.font=this.size+"px "+sa(this.family);var b=world.Kernel.makeCanvas(0,0).getContext("2d");b.font=this.font;this.width=b.measureText(this.msg).width;this.height=Number(this.size)};aa.prototype.render=function(b,c,d){b.save();b.textAlign="left";b.textBaseline="top";b.fillStyle=D(this.color);b.font=this.font;try{b.fillText(this.msg,c,d)}catch(h){this.fallbackOnFont(),b.font=this.font,b.fillText(this.msg,c,d)}if(this.underline)b.beginPath(),b.moveTo(c,d+this.size),b.lineTo(c+this.width,
d+this.size),b.closePath(),b.strokeStyle=D(this.color),b.stroke();b.restore()};aa.prototype.getBaseline=function(){return this.size};aa.prototype.isEqual=function(b,c){return b instanceof aa&&this.pinholeX==b.pinholeX&&this.pinholeY==b.pinholeY&&this.msg==b.msg&&this.size==b.size&&this.face==b.face&&this.family==b.family&&this.style==b.style&&this.weight==b.weight&&this.underline==b.underline&&types.isEqual(this.color,b.color,c)&&this.font==b.font};var F=function(b,c,d,k,m){h.call(this,Math.max(c,
d),Math.max(c,d));this.points=b;this.outer=c;this.inner=d;this.style=k;this.color=m;this.radius=Math.max(this.inner,this.outer);this.width=this.radius*2;this.height=this.radius*2};F.prototype=m(h.prototype);var ja=Math.PI/180;F.prototype.render=function(b,c,d){b.save();b.beginPath();for(var h=0;h<this.points*2+1;h++){var k=360/(2*this.points)*h*ja-0.5,m=h%2==1?this.outer:this.inner;b.lineTo(c+this.radius+Math.sin(k)*m,d+this.radius+Math.cos(k)*m)}b.closePath();this.style.toString().toLowerCase()==
"outline"?(b.strokeStyle=D(this.color),b.stroke()):(b.fillStyle=D(this.color),b.fill());b.restore()};F.prototype.isEqual=function(b,c){return b instanceof F&&this.pinholeX==b.pinholeX&&this.pinholeY==b.pinholeY&&this.points==b.points&&this.outer==b.outer&&this.inner==b.inner&&this.style==b.style&&types.isEqual(this.color,b.color,c)};var K=function(b,c,d,k){this.width=Math.sin(c/2*Math.PI/180)*b*2;this.height=Math.floor(Math.abs(Math.cos(c/2*Math.PI/180))*b);h.call(this,Math.floor(this.width/2),Math.floor(this.height/
2));this.side=b;this.angle=c;this.style=d;this.color=k};K.prototype=m(h.prototype);K.prototype.render=function(b,c,d){var h=this.getWidth(),k=this.getHeight();b.save();b.beginPath();this.angle<180?(b.moveTo(c+h/2,d),b.lineTo(c,d+k),b.lineTo(c+h,d+k)):(b.moveTo(c+h/2,d+k),b.lineTo(c,d),b.lineTo(c+h,d));b.closePath();this.style.toString().toLowerCase()=="outline"?(b.strokeStyle=D(this.color),b.stroke()):(b.fillStyle=D(this.color),b.fill());b.restore()};K.prototype.isEqual=function(b,c){return b instanceof
K&&this.pinholeX==b.pinholeX&&this.pinholeY==b.pinholeY&&this.side==b.side&&this.angle==b.angle&&this.style==b.style&&types.isEqual(this.color,b.color,c)};var V=function(b,c,d,k){this.width=b;this.height=c;h.call(this,Math.floor(this.width/2),Math.floor(this.height/2));this.side1=b;this.side2=c;this.style=d;this.color=k};V.prototype=m(h.prototype);V.prototype.render=function(b,c,d){this.getWidth();this.getHeight();b.save();b.beginPath();b.moveTo(c,d+this.side2);b.lineTo(c+this.side1,d+this.side2);
b.lineTo(c,d);b.closePath();this.style.toString().toLowerCase()=="outline"?(b.strokeStyle=D(this.color),b.stroke()):(b.fillStyle=D(this.color),b.fill());b.restore()};V.prototype.isEqual=function(b,c){return b instanceof V&&this.pinholeX==b.pinholeX&&this.pinholeY==b.pinholeY&&this.side1==b.side1&&this.side2==b.side2&&this.style==b.style&&types.isEqual(this.color,b.color,c)};var ha=function(b,c,d,k){h.call(this,Math.floor(b/2),Math.floor(c/2));this.width=b;this.height=c;this.style=d;this.color=k};
ha.prototype=m(h.prototype);ha.prototype.render=function(b,c,d){b.save();b.beginPath();var h=this.width/2*0.5522848,k=this.height/2*0.5522848,m=c+this.width,q=d+this.height,F=c+this.width/2,t=d+this.height/2;b.moveTo(c,t);b.bezierCurveTo(c,t-k,F-h,d,F,d);b.bezierCurveTo(F+h,d,m,t-k,m,t);b.bezierCurveTo(m,t+k,F+h,q,F,q);b.bezierCurveTo(F-h,q,c,t+k,c,t);b.closePath();this.style.toString().toLowerCase()=="outline"?(b.strokeStyle=D(this.color),b.stroke()):(b.fillStyle=D(this.color),b.fill());b.restore()};
ha.prototype.isEqual=function(b,c){return b instanceof ha&&this.pinholeX==b.pinholeX&&this.pinholeY==b.pinholeY&&this.width==b.width&&this.height==b.height&&this.style==b.style&&types.isEqual(this.color,b.color,c)};var t=function(b,c,d,k){b>=0?c>=0?h.call(this,0,0):h.call(this,0,-c):c>=0?h.call(this,-b,0):h.call(this,-b,-c);this.x=b;this.y=c;this.color=d;this.width=Math.abs(b)+1;this.height=Math.abs(c)+1;if(k)this.pinholeX=this.width/2,this.pinholeY=this.height/2};t.prototype=m(h.prototype);t.prototype.render=
function(b,c,d){b.save();b.beginPath();b.strokeStyle=D(this.color);this.x>=0?this.y>=0?(b.moveTo(c,d),b.lineTo(c+this.x,d+this.y)):(b.moveTo(c,d+-this.y),b.lineTo(c+this.x,d)):this.y>=0?(b.moveTo(c+-this.x,d),b.lineTo(c,d+this.y)):(b.moveTo(c+-this.x,d+-this.y),b.lineTo(c,d));b.closePath();b.stroke();b.restore()};t.prototype.isEqual=function(b,c){return b instanceof t&&this.pinholeX==b.pinholeX&&this.pinholeY==b.pinholeY&&this.x==b.x&&this.y==b.y&&types.isEqual(this.color,b.color,c)};world.Kernel.applyEffect=
function(b){if(b!==types.EMPTY)if(types.isPair(b))return world.Kernel.applyEffect(b.first).concat(world.Kernel.applyEffect(b.rest));else if(b=b.run())return b;return[]};m=function(){this.colors={}};m.prototype.put=function(b,c){this.colors[b]=c};m.prototype.get=function(b){return this.colors[b.toString().toUpperCase()]};var k=new m;k.put("ORANGE",types.color(255,165,0));k.put("RED",types.color(255,0,0));k.put("ORANGERED",types.color(255,69,0));k.put("TOMATO",types.color(255,99,71));k.put("DARKRED",
types.color(139,0,0));k.put("RED",types.color(255,0,0));k.put("FIREBRICK",types.color(178,34,34));k.put("CRIMSON",types.color(220,20,60));k.put("DEEPPINK",types.color(255,20,147));k.put("MAROON",types.color(176,48,96));k.put("INDIAN RED",types.color(205,92,92));k.put("INDIANRED",types.color(205,92,92));k.put("MEDIUM VIOLET RED",types.color(199,21,133));k.put("MEDIUMVIOLETRED",types.color(199,21,133));k.put("VIOLET RED",types.color(208,32,144));k.put("VIOLETRED",types.color(208,32,144));k.put("LIGHTCORAL",
types.color(240,128,128));k.put("HOTPINK",types.color(255,105,180));k.put("PALEVIOLETRED",types.color(219,112,147));k.put("LIGHTPINK",types.color(255,182,193));k.put("ROSYBROWN",types.color(188,143,143));k.put("PINK",types.color(255,192,203));k.put("ORCHID",types.color(218,112,214));k.put("LAVENDERBLUSH",types.color(255,240,245));k.put("SNOW",types.color(255,250,250));k.put("CHOCOLATE",types.color(210,105,30));k.put("SADDLEBROWN",types.color(139,69,19));k.put("BROWN",types.color(132,60,36));k.put("DARKORANGE",
types.color(255,140,0));k.put("CORAL",types.color(255,127,80));k.put("SIENNA",types.color(160,82,45));k.put("ORANGE",types.color(255,165,0));k.put("SALMON",types.color(250,128,114));k.put("PERU",types.color(205,133,63));k.put("DARKGOLDENROD",types.color(184,134,11));k.put("GOLDENROD",types.color(218,165,32));k.put("SANDYBROWN",types.color(244,164,96));k.put("LIGHTSALMON",types.color(255,160,122));k.put("DARKSALMON",types.color(233,150,122));k.put("GOLD",types.color(255,215,0));k.put("YELLOW",types.color(255,
255,0));k.put("OLIVE",types.color(128,128,0));k.put("BURLYWOOD",types.color(222,184,135));k.put("TAN",types.color(210,180,140));k.put("NAVAJOWHITE",types.color(255,222,173));k.put("PEACHPUFF",types.color(255,218,185));k.put("KHAKI",types.color(240,230,140));k.put("DARKKHAKI",types.color(189,183,107));k.put("MOCCASIN",types.color(255,228,181));k.put("WHEAT",types.color(245,222,179));k.put("BISQUE",types.color(255,228,196));k.put("PALEGOLDENROD",types.color(238,232,170));k.put("BLANCHEDALMOND",types.color(255,
235,205));k.put("MEDIUM GOLDENROD",types.color(234,234,173));k.put("MEDIUMGOLDENROD",types.color(234,234,173));k.put("PAPAYAWHIP",types.color(255,239,213));k.put("MISTYROSE",types.color(255,228,225));k.put("LEMONCHIFFON",types.color(255,250,205));k.put("ANTIQUEWHITE",types.color(250,235,215));k.put("CORNSILK",types.color(255,248,220));k.put("LIGHTGOLDENRODYELLOW",types.color(250,250,210));k.put("OLDLACE",types.color(253,245,230));k.put("LINEN",types.color(250,240,230));k.put("LIGHTYELLOW",types.color(255,
255,224));k.put("SEASHELL",types.color(255,245,238));k.put("BEIGE",types.color(245,245,220));k.put("FLORALWHITE",types.color(255,250,240));k.put("IVORY",types.color(255,255,240));k.put("GREEN",types.color(0,255,0));k.put("LAWNGREEN",types.color(124,252,0));k.put("CHARTREUSE",types.color(127,255,0));k.put("GREEN YELLOW",types.color(173,255,47));k.put("GREENYELLOW",types.color(173,255,47));k.put("YELLOW GREEN",types.color(154,205,50));k.put("YELLOWGREEN",types.color(154,205,50));k.put("MEDIUM FOREST GREEN",
types.color(107,142,35));k.put("OLIVEDRAB",types.color(107,142,35));k.put("MEDIUMFORESTGREEN",types.color(107,142,35));k.put("DARK OLIVE GREEN",types.color(85,107,47));k.put("DARKOLIVEGREEN",types.color(85,107,47));k.put("DARKSEAGREEN",types.color(143,188,139));k.put("LIME",types.color(0,255,0));k.put("DARK GREEN",types.color(0,100,0));k.put("DARKGREEN",types.color(0,100,0));k.put("LIME GREEN",types.color(50,205,50));k.put("LIMEGREEN",types.color(50,205,50));k.put("FOREST GREEN",types.color(34,139,
34));k.put("FORESTGREEN",types.color(34,139,34));k.put("SPRING GREEN",types.color(0,255,127));k.put("SPRINGGREEN",types.color(0,255,127));k.put("MEDIUM SPRING GREEN",types.color(0,250,154));k.put("MEDIUMSPRINGGREEN",types.color(0,250,154));k.put("SEA GREEN",types.color(46,139,87));k.put("SEAGREEN",types.color(46,139,87));k.put("MEDIUM SEA GREEN",types.color(60,179,113));k.put("MEDIUMSEAGREEN",types.color(60,179,113));k.put("AQUAMARINE",types.color(112,216,144));k.put("LIGHTGREEN",types.color(144,
238,144));k.put("PALE GREEN",types.color(152,251,152));k.put("PALEGREEN",types.color(152,251,152));k.put("MEDIUM AQUAMARINE",types.color(102,205,170));k.put("MEDIUMAQUAMARINE",types.color(102,205,170));k.put("TURQUOISE",types.color(64,224,208));k.put("LIGHTSEAGREEN",types.color(32,178,170));k.put("MEDIUM TURQUOISE",types.color(72,209,204));k.put("MEDIUMTURQUOISE",types.color(72,209,204));k.put("HONEYDEW",types.color(240,255,240));k.put("MINTCREAM",types.color(245,255,250));k.put("ROYALBLUE",types.color(65,
105,225));k.put("DODGERBLUE",types.color(30,144,255));k.put("DEEPSKYBLUE",types.color(0,191,255));k.put("CORNFLOWERBLUE",types.color(100,149,237));k.put("STEEL BLUE",types.color(70,130,180));k.put("STEELBLUE",types.color(70,130,180));k.put("LIGHTSKYBLUE",types.color(135,206,250));k.put("DARK TURQUOISE",types.color(0,206,209));k.put("DARKTURQUOISE",types.color(0,206,209));k.put("CYAN",types.color(0,255,255));k.put("AQUA",types.color(0,255,255));k.put("DARKCYAN",types.color(0,139,139));k.put("TEAL",
types.color(0,128,128));k.put("SKY BLUE",types.color(135,206,235));k.put("SKYBLUE",types.color(135,206,235));k.put("CADET BLUE",types.color(96,160,160));k.put("CADETBLUE",types.color(95,158,160));k.put("DARK SLATE GRAY",types.color(47,79,79));k.put("DARKSLATEGRAY",types.color(47,79,79));k.put("LIGHTSLATEGRAY",types.color(119,136,153));k.put("SLATEGRAY",types.color(112,128,144));k.put("LIGHT STEEL BLUE",types.color(176,196,222));k.put("LIGHTSTEELBLUE",types.color(176,196,222));k.put("LIGHT BLUE",types.color(173,
216,230));k.put("LIGHTBLUE",types.color(173,216,230));k.put("POWDERBLUE",types.color(176,224,230));k.put("PALETURQUOISE",types.color(175,238,238));k.put("LIGHTCYAN",types.color(224,255,255));k.put("ALICEBLUE",types.color(240,248,255));k.put("AZURE",types.color(240,255,255));k.put("MEDIUM BLUE",types.color(0,0,205));k.put("MEDIUMBLUE",types.color(0,0,205));k.put("DARKBLUE",types.color(0,0,139));k.put("MIDNIGHT BLUE",types.color(25,25,112));k.put("MIDNIGHTBLUE",types.color(25,25,112));k.put("NAVY",
types.color(36,36,140));k.put("BLUE",types.color(0,0,255));k.put("INDIGO",types.color(75,0,130));k.put("BLUE VIOLET",types.color(138,43,226));k.put("BLUEVIOLET",types.color(138,43,226));k.put("MEDIUM SLATE BLUE",types.color(123,104,238));k.put("MEDIUMSLATEBLUE",types.color(123,104,238));k.put("SLATE BLUE",types.color(106,90,205));k.put("SLATEBLUE",types.color(106,90,205));k.put("PURPLE",types.color(160,32,240));k.put("DARK SLATE BLUE",types.color(72,61,139));k.put("DARKSLATEBLUE",types.color(72,61,
139));k.put("DARKVIOLET",types.color(148,0,211));k.put("DARK ORCHID",types.color(153,50,204));k.put("DARKORCHID",types.color(153,50,204));k.put("MEDIUMPURPLE",types.color(147,112,219));k.put("CORNFLOWER BLUE",types.color(68,64,108));k.put("MEDIUM ORCHID",types.color(186,85,211));k.put("MEDIUMORCHID",types.color(186,85,211));k.put("MAGENTA",types.color(255,0,255));k.put("FUCHSIA",types.color(255,0,255));k.put("DARKMAGENTA",types.color(139,0,139));k.put("VIOLET",types.color(238,130,238));k.put("PLUM",
types.color(221,160,221));k.put("LAVENDER",types.color(230,230,250));k.put("THISTLE",types.color(216,191,216));k.put("GHOSTWHITE",types.color(248,248,255));k.put("WHITE",types.color(255,255,255));k.put("WHITESMOKE",types.color(245,245,245));k.put("GAINSBORO",types.color(220,220,220));k.put("LIGHT GRAY",types.color(211,211,211));k.put("LIGHTGRAY",types.color(211,211,211));k.put("SILVER",types.color(192,192,192));k.put("GRAY",types.color(190,190,190));k.put("DARK GRAY",types.color(169,169,169));k.put("DARKGRAY",
types.color(169,169,169));k.put("DIM GRAY",types.color(105,105,105));k.put("DIMGRAY",types.color(105,105,105));k.put("BLACK",types.color(0,0,0));world.Kernel.isImage=function(b){return b!==null&&b!==void 0&&b instanceof h};world.Kernel.isScene=q;world.Kernel.isColor=function(b){return types.isColor(b)||(types.isString(b)||types.isSymbol(b))&&typeof k.get(b)!="undefined"};world.Kernel.colorDb=k;world.Kernel.sceneImage=function(b,c,d,h){return new C(b,c,d,h)};world.Kernel.circleImage=function(b,c,d){return new ha(2*
b,2*b,c,d)};world.Kernel.starImage=function(b,c,d,h,k){return new F(b,c,d,h,k)};world.Kernel.rectangleImage=function(b,c,d,h){return new W(b,c,d,h)};world.Kernel.rhombusImage=function(b,c,d,h){return new ga(b,c,d,h)};world.Kernel.polygonImage=function(b,c,d,h,k){return new N(b,c,d,h,k)};world.Kernel.squareImage=function(b,c,d){return new W(b,b,c,d)};world.Kernel.rightTriangleImage=function(b,c,d,h){return new V(b,c,d,h)};world.Kernel.triangleImage=function(b,c,d,h){return new K(b,c,d,h)};world.Kernel.ellipseImage=
function(b,c,d,h){return new ha(b,c,d,h)};world.Kernel.lineImage=function(b,c,d,h){return new t(b,c,d,h)};world.Kernel.overlayImage=function(b,c,d,h){return new L(b,c,d,h)};world.Kernel.rotateImage=function(b,c){return new T(b,c)};world.Kernel.scaleImage=function(b,c,d){return new X(b,c,d)};world.Kernel.cropImage=function(b,c,d,h,k){return new J(b,c,d,h,k)};world.Kernel.frameImage=function(b){return new ca(b)};world.Kernel.flipImage=function(b,c){return new la(b,c)};world.Kernel.textImage=function(b,
c,d,h,k,m,q,F){return new aa(b,c,d,h,k,m,q,F)};world.Kernel.imageDataImage=function(b){return new fa(b)};world.Kernel.fileImage=function(b,c,d){return A.makeInstance(b,c,d)};world.Kernel.videoImage=function(b,c){return w.makeInstance(b,c)};world.Kernel.isSceneImage=function(b){return b instanceof C};world.Kernel.isStarImage=function(b){return b instanceof F};world.Kernel.isRectangleImage=function(b){return b instanceof W};world.Kernel.isPolygonImage=function(b){return b instanceof N};world.Kernel.isRhombusImage=
function(b){return b instanceof ga};world.Kernel.isSquareImage=function(b){return b instanceof SquareImage};world.Kernel.isTriangleImage=function(b){return b instanceof K};world.Kernel.isRightTriangleImage=function(b){return b instanceof V};world.Kernel.isEllipseImage=function(b){return b instanceof ha};world.Kernel.isLineImage=function(b){return b instanceof t};world.Kernel.isOverlayImage=function(b){return b instanceof L};world.Kernel.isRotateImage=function(b){return b instanceof T};world.Kernel.isScaleImage=
function(b){return b instanceof X};world.Kernel.isCropImage=function(b){return b instanceof J};world.Kernel.isFrameImage=function(b){return b instanceof ca};world.Kernel.isFlipImage=function(b){return b instanceof la};world.Kernel.isTextImage=function(b){return b instanceof aa};world.Kernel.isFileImage=function(b){return b instanceof A};world.Kernel.isFileVideo=function(b){return b instanceof FileVideo}})();
(function(){var d=jsworld.MobyJsworld={},m=jsworld.Jsworld,b,c=function(c){b=function(b,d,h){c(b,d,h,aa)}},h=function(){b=function(){throw Error("caller not defined!");}};h();var q,C=function(b){var c=!1;q=function(d){if(c)throw Error("Cannot restart twice!");c=!0;b(d)}};(function(){q=function(){throw Error("restarter not defined!");}})();var A,P=function(b){A=b},w=function(){A=function(){throw Error("terminator not defined!");}};w();var L=[],T=function(c){helpers.forEachK(L,function(c,d){b(c.startup,
c.startupArgs,function(b){c.shutdownArg=b;d()})},aa,c)},X=function(c){var d=L;L=[];helpers.forEachK(d,function(c,d){b(c.shutdown,[c.shutdownArg],d)},aa,c)},J=function(c){return types.jsObject("function",function(){for(var h=[],m=0;m<arguments.length;m++)h.push(helpers.wrapJsObject(arguments[m]));d.updateWorld(function(d,m){var q=[d].concat(h);b(c,q,m)},function(){})})},ca=function(c,d){types.isJsObject(c)?d(c.obj):types.isRenderEffect(c)?c.callImplementation(b,function(b){ca(b,d)}):types.isPair(c)?
ca(c.first(),function(b){ca(c.rest(),function(c){d(types.cons(b,c))})}):d(c)},la=types.isPair;d.printWorldHook=function(b,c){var d;c.lastChild==null?(d=types.toDomNode(b),c.appendChild(d)):(d=types.toDomNode(b),c.replaceChild(d,c.lastChild));helpers.maybeCallAfterAttach(d)};var D=function(b,c,d){var h=function(b,c){throw types.schemeError(types.incompleteExn(types.exnFailContract,helpers.format(b,c),[]));};if(!m.isPage(b))if(types.isPair(b)){var q=b.first(),d=b.rest();typeof q.nodeType!="undefined"||
h("on-draw: expected a dom-element, but received ~s instead, the first element within ~s",[q,c]);q.nodeType==Node.TEXT_NODE&&!d.isEmpty()&&h("on-draw: the text node ~s must not have children.  It has ~s",[q,d]);for(c=2;!d.isEmpty();)D(d.first(),b,c),d=d.rest(),c++}else q="on-draw: expected a dom-s-expression, but received ~s instead",b=[b],d!=void 0&&(q+=", the ~a element within ~s",b.push(helpers.ordinalize(d)),b.push(c)),q+=".",h(q,b)},W=function(b,c,d){b.addEventListener?b.addEventListener(c,d,
!1):b.attachEvent("on"+c,d,!1);return function(){ga(b,c,d)}},ga=function(b,c,d){b.addEventListener?b.removeEventListener(c,d,!1):b.detachEvent("on"+c,d,!1)},fa=function(b){b.preventDefault?b.preventDefault():b.returnValue=!1},N=function(b){b.stopPropagation?b.stopPropagation():b.cancelBubble=!0};d.bigBang=function(F,ja,K,V,ha){var t=[];c(V);C(ha);P(function(b){ga(ja,"click",e);X(function(){h();w();q(b)})});var k=types.EMPTY;ja.tabIndex=0;var e=function(b){fa(b);N(b);return!1};W(ja,"click",e);t.push(function(){ga(ja,
"click",e)});for(var I=new world.config.WorldConfig,V=0;V<K.length;V++)if(la(K[V])||K[V]===types.EMPTY)k=K[V];else if(typeof K[V]=="function")I=K[V](I);else if(types.isWorldConfig(K[V]))K[V].startupArgs=helpers.map(J,K[V].startupArgs),L.push(K[V]);var I=I.updateAll({changeWorld:d.updateWorld,shutdownWorld:d.shutdownWorld}),K=new world.stimuli.StimuliHandler(I,b,q),y=[];if(I.lookup("onDraw"))V=function(c,d){try{b(I.lookup("onDraw"),[c],function(b){ca(b,function(b){D(b,b,void 0);b=[ja,helpers.deepListToArray(b)];
d(b)})})}catch(e){aa(e)}},ha=I.lookup("onDrawCss")?function(c,d){try{b(I.lookup("onDrawCss"),[c],function(b){b=helpers.deepListToArray(b);d(b)})}catch(e){aa(e)}}:function(b,c){c([])},y.push(m.on_draw(V,ha));else if(I.lookup("onRedraw")){var E=void 0,$=void 0;y.push(m.on_draw(function(c,d){try{b(I.lookup("onRedraw"),[c],function(b){if(world.Kernel.isImage(b)){var c=b.getWidth(),e=b.getHeight();if(!E)E=world.Kernel.makeCanvas(c,e),E.jsworldOpaque=!0,$=m.node_to_tree(E);setTimeout(function(){E.width=
c;E.height=e;var d=E.getContext("2d");b.render(d,0,0)},0);d([ja,$])}else d([ja,m.node_to_tree(types.toDomNode(b))])})}catch(e){aa(e)}},function(b,c){c([[E,["width",E.width+"px"],["height",E.height+"px"]]])}))}else y.push(m.on_world_change(function(b,c){d.printWorldHook(b,ja);c()}));I.lookup("tickDelay")&&(V=jsnums.toFixnum(I.lookup("tickDelay")),y.push(m.on_tick(V,function(c,d){b(I.lookup("onTick"),[c],d)})));I.lookup("stopWhen")&&y.push(m.stop_when(function(c,d){b(I.lookup("stopWhen"),[c],function(b){d(b)})}));
if(I.lookup("onKey")){var G=sa(K,ja);t.push(function(){G()});y.push(m.on_key(function(c,d,e){b(I.lookup("onKey"),[c,helpers.getKeyCodeName(d)],e)}));ja.focus()}T(function(){m.big_bang(ja,F,y,helpers.assocListToHash(k),A)});return{breaker:function(){aa(types.schemeError(types.incompleteExn(types.exnBreak,"user break",[])))}}};var sa=function(b,c){var d=function(c,d,e){c=document.createElement("input");c.type="button";c.value=d;c.style.width="20px";c.style.height="20px";c.onclick=function(c){b.onKey([{keyCode:e}],
function(){});fa(c);N(c)};return c},h=d("up-virtual-button","U",38),m=d("down-virtual-button","D",40),q=d("left-virtual-button","L",37),k=d("right-virtual-button","R",39),e=d("space-virtual-button"," ",32);h.style.position="fixed";h.style.bottom="60px";h.style.right="50px";m.style.position="fixed";m.style.bottom="0px";m.style.right="50px";q.style.position="fixed";q.style.bottom="30px";q.style.right="80px";k.style.position="fixed";k.style.bottom="30px";k.style.right="20px";e.style.position="fixed";
e.style.bottom="30px";e.style.right="50px";c.appendChild(h);c.appendChild(m);c.appendChild(q);c.appendChild(k);c.appendChild(e);return function(){c.removeChild(h);c.removeChild(m);c.removeChild(q);c.removeChild(k);c.removeChild(e)}},aa=function(b){world.stimuli.massShutdown();X(function(){typeof console!=="undefined"&&console.log&&(b.stack?console.log(b.stack):console.log(b));types.isSchemeError(b)?A(b):types.isInternalError(b)?A(b):typeof b=="string"?A(types.schemeError(types.incompleteExn(types.exnFail,
b,[]))):b instanceof Error?A(types.schemeError(types.incompleteExn(types.exnFail,b.message,[]))):A(types.schemeError(b))})};d.updateWorld=function(b,c){m.change_world(function(c,d){try{b(c,d)}catch(h){typeof console!=="undefined"&&console.log&&h.stack&&console.log(h.stack),aa(h)}},c)};d.shutdownWorld=function(){m.shutdown()};d.p=m.p;d.div=m.div;d.buttonBang=function(c,d,h){return m.button(function(d,h,m){try{b(c,[d],function(b){m(b)})}catch(k){typeof console!=="undefined"&&console.log&&k.stack&&console.log(k.stack),
aa(k)}},h)};d.input=function(c,d,h){return m.input(c,function(c,h,m){b(d,[c,h],m)},h)};d.get_dash_input_dash_value=function(b){return types.isString(b)?document.getElementById(b).value||"":b.value||""};d.img=m.img;d.text=m.text;d.select=function(c,d,h){return m.select(h,c,function(c,h,m){b(d,[c,h.target.value],m)})};d.emptyPage=m.emptyPage;d.placeOnPage=function(b,c,d,h){b=types.toDomNode(ca(b));return m.placeOnPage(b,c,d,h)}})();var primitive={};
(function(){var d,m,b={},c=types.PrimProc,h=types.CasePrimitive,q=function(b){return b},C=function(b,c){return c instanceof types.ValuesWrapper?d(b,c.elts,q):d(b,[c],q)},A=function(b){b=b.splice(0);b.sort(function(b,g){return types.isArityAtLeast(b)&&types.isArityAtLeast(g)?types.arityValue(b)-types.arityValue(g):types.isArityAtLeast(b)?types.arityValue(b)-g-0.5:types.isArityAtLeast(g)?b-types.arityValue(g)+0.5:b-g});for(var c=0;c<b.length-1;c++)if(types.isArityAtLeast(b[c]))return b.splice(0,c+1);
return b},P=helpers.procArityContains,w=function(b){ta(b,"length",1,[b]);for(var c=0;!b.isEmpty();b=b.rest())c+=1;return c},L=function(b){if(b.length==0)return types.EMPTY;var c=b.slice(0,b.length-1),d=b[b.length-1];R(c,function(c,j){ta(c,"append",j+1,b)});for(var e=c.length-1;e>=0;e--)d=c[e].append(d);return d},T=function(b,c,e){if(e[0].isEmpty())return c;for(var v=[],i=[],l=0;l<e.length;l++)v.push(e[l].first()),i.push(e[l].rest());v.push(c);return d(b,v,function(c){return T(b,c,i)})},X=function(g){return function(j,
e){ta(j,g,1,arguments);i(e,P(2),g,"procedure (arity 2)",2,arguments);var v=function(g){if(g.isEmpty())return types.EMPTY;var j=new c("compYes",1,!1,!1,function(b){return d(e,[b,g.first()],q)}),i=new c("compNo",1,!1,!1,function(b){return d(e,[b,g.first()],function(b){return!b})}),l=new c("quicksort",1,!1,!1,v);return d(b.filter,[j,g.rest()],function(c){return d(l,[c],function(c){return d(b.filter,[i,g.rest()],function(b){return d(l,[b],function(b){return L([c,types.list([g.first()]),b])})})})})};return v(j)}},
J=function(b,c){for(var d=b[0],e=1;e<b.length;e++){if(!c(d,b[e]))return!1;d=b[e]}return!0},ca=function(b){for(var c=0;c<b.length;c++)if(!(b.charAt(c)>="a"&&b.charAt(c)<="z"||b.charAt(c)>="A"&&b.charAt(c)<="Z"))return!1;return!0},la=function(){var b=/^\s*$/;return function(c){return c.match(b)?!0:!1}}(),D=types.Class.extend({init:function(b){this.name=b},configure:function(){throw types.internalError("unimplemented",!1);},toDomNode:function(){var b=document.createElement("div");b.appendChild(document.createTextNode("("+
this.name+" ...)"));return b},toWrittenString:function(){return"("+this.name+" ...)"},toDisplayedString:function(){return"("+this.name+" ...)"}}),W=function(b,j,d){return function(e){return ga(b,j)(e,new c("",d,!1,!1,function(){return types.EMPTY}))}},ga=function(b,c){return function(d,e){i(d,o,b,"procedure",1,arguments);i(e,o,b,"procedure",2,arguments);return new (D.extend({init:function(){this._super(b)},configure:function(b){var g={};g[c]=d;g[c+"Effect"]=e;return b.updateAll(g)}}))}},fa=helpers.assocListToHash,
N=helpers.raise,sa=function(b){var c=function(b){typeof console!=="undefined"&&console.log&&(console.log("There was an error in a procedure converted from scheme to javascript"),b.stack?console.log(b.stack):console.log(b));throw b;};return function(d,e,i){return interpret.call(b,d,e,i,c)}},aa=function(b,c){var d=function(c,j,d){return interpret.call(b,c,j,d,function(b){throw b;})};return function(b){for(var g=[],e=1;e<arguments.length;e++)g.push(arguments[e]);d(c,g,b)}},F=function(b,j,d,e,i,l){c.call(this,
j,d,e,i,l);this.typeName=b};F.prototype=c.prototype;var ja=function(){F.apply(this,arguments)};ja.prototype=F.prototype;var K=function(){F.apply(this,arguments)};K.prototype=F.prototype;var V=function(){F.apply(this,arguments)};V.prototype=F.prototype;var ha=function(){F.apply(this,arguments)};ha.prototype=F.prototype;var t=function(b){var c=b.name;return new types.ValuesWrapper([b,new ja(c,"make-"+c,b.numberOfArgs,!1,!1,b.constructor),new K(c,c+"?",1,!1,!1,b.predicate),new V(c,c+"-ref",2,!1,!1,function(d,
e){i(d,b.predicate,c+"-ref","struct:"+c,1,arguments);i(e,E,c+"-ref","non-negative exact integer",2,arguments);var l=b.numberOfFields;jsnums.greaterThanOrEqual(e,l)&&N(types.incompleteExn(types.exnFailContract,c+"-ref: slot index for <struct:"+c+"> not in [0, "+(l-1)+"]: "+e,[]));return b.accessor(d,jsnums.toFixnum(e))}),new ha(c,c+"-set!",3,!1,!1,function(d,e,l){i(d,b.predicate,c+"-set!","struct:"+c,1,arguments);i(e,E,c+"-set!","non-negative exact integer",2,arguments);var h=b.numberOfFields;jsnums.greaterThanOrEqual(e,
h)&&N(types.incompleteExn(types.exnFailContract,c+"-set!: slot index for <struct"+c+"> not in [0, "+(h-1)+"]: "+e,[]));b.mutator(d,jsnums.toFixnum(e),l)})])},k=jsnums.isSchemeNumber,e=jsnums.isReal,I=jsnums.isRational,y=jsnums.isInteger,E=function(b){return jsnums.isExact(b)&&y(b)&&jsnums.greaterThanOrEqual(b,0)},$=function(b){return e(b)&&jsnums.greaterThanOrEqual(b,0)},G=function(b){return e(b)&&jsnums.greaterThanOrEqual(b,0)&&jsnums.lessThan(b,360)},na=function(b){return y(b)&&jsnums.greaterThanOrEqual(b,
3)},va=function(b){return y(b)&&jsnums.greaterThanOrEqual(b,1)},Q=types.isSymbol,U=types.isChar,z=types.isString,H=types.isPair,wa=function(b){return b===types.EMPTY},Y=helpers.isList,ma=helpers.isListOf,O=types.isVector,da=types.isBox,ia=types.isHash,ba=types.isByteString,ra=function(b){return E(b)&&jsnums.lessThanOrEqual(b,255)},l=function(b){return b===!0||b===!1},o=types.isFunction,oa=function(b,c){return types.isEqual(b,c,new types.UnionFind)},Ga=function(b,c){return b===c},ya=function(b,c){if(k(b)&&
k(c))return jsnums.eqv(b,c);else if(U(b)&&U(c))return b.val===c.val;return b===c},S=world.Kernel.isImage,za=world.Kernel.isScene,qa=world.Kernel.isColor,Ea=function(b){return(z(b)||Q(b))&&(b.toString().toLowerCase()=="default"||b.toString().toLowerCase()=="decorative"||b.toString().toLowerCase()=="roman"||b.toString().toLowerCase()=="script"||b.toString().toLowerCase()=="swiss"||b.toString().toLowerCase()=="modern"||b.toString().toLowerCase()=="symbol"||b.toString().toLowerCase()=="system")||!b},
u=function(b){return(z(b)||Q(b))&&(b.toString().toLowerCase()=="normal"||b.toString().toLowerCase()=="italic"||b.toString().toLowerCase()=="slant")||!b},Z=function(b){return(z(b)||Q(b))&&(b.toString().toLowerCase()=="normal"||b.toString().toLowerCase()=="bold"||b.toString().toLowerCase()=="light")||!b},ea=world.Kernel.colorDb,Aa=function(b){return(z(b)||Q(b))&&(b.toString().toLowerCase()=="solid"||b.toString().toLowerCase()=="outline")},Oa=function(b){return(z(b)||Q(b))&&(b.toString().toLowerCase()==
"left"||b.toString().toLowerCase()=="right"||b.toString().toLowerCase()=="center"||b.toString().toLowerCase()=="middle")},Ua=function(b){return(z(b)||Q(b))&&(b.toString().toLowerCase()=="top"||b.toString().toLowerCase()=="bottom"||b.toString().toLowerCase()=="baseline"||b.toString().toLowerCase()=="center"||b.toString().toLowerCase()=="middle")},Na=function(b){return H(b)&&H(b.rest())&&wa(b.rest().rest())},Ya=function(b){return types.isEffect(b)||ma(b,Ya)},xa=types.isJsObject,Wa=function(b){return xa(b)&&
typeof b.obj=="function"},R=function(b,c){for(var d=0;d<b.length;d++)c.call(null,b[d],d)},i=helpers.check,ta=function(b,c,d,e){Y(b)||helpers.throwCheckError([c,"list",helpers.ordinalize(d),b],d,e)},pa=helpers.checkListOf,Qa=function(b,c,d,e,i){(!Y(b)||w(b)<c)&&helpers.throwCheckError([d,"list with "+c+" or more elements",helpers.ordinalize(e),b],e,i)},Ka=function(b,c,d){if(b.length!=0){var e=w(b[0]);R(b,function(b){w(b)!=e&&(helpers.map(function(){return" ~s"},d).join(""),b=helpers.format(c+": all lists must have the same size; arguments were:"+
argStr,d),N(types.incompleteExn(types.exnFailContract,b,[])))})}};b["verify-boolean-branch-value"]=new c("verify-boolean-branch-value",2,!1,!1,function(b,c){if(b!==!0&&b!==!1)throw Error("the value "+sys.inspect(b)+" is not boolean type at "+c);return b});b["throw-cond-exhausted-error"]=new c("throw-cond-exhausted-error",1,!1,!1,function(){throw types.schemeError(types.incompleteExn(types.exnFail,"cond: all question results were false",[]));});b["print-values"]=new c("print-values",0,!0,!0,function(b,
c){for(var d=!1,e=0;e<c.length;e++)c[e]!==types.VOID&&(b.getPrintHook()(c[e]),d=!0);d&&b.getDisplayHook()("\n");b.v=types.VOID});b["check-expect"]=new c("check-expect",2,!1,!0,function(b,c,d){(o(c)||o(d))&&N(types.incompleteExn(types.exnFailContract,"check-expect cannot compare functions",[]));if(!oa(c,d)){c=helpers.format("check-expect: actual value ~s differs from ~s, the expected value.\n",[c,d]);b.getDisplayHook()(c);c=state.getStackTraceFromContinuationMarks(state.captureCurrentContinuationMarks(b));
for(d=0;d<c.length;d++)b.getPrintHook()(helpers.makeLocationDom(c[d]))}b.v=types.VOID});b.EXAMPLE=b["check-expect"];b["check-within"]=new c("check-within",3,!1,!0,function(b,c,d,v){if(!$(v)){var i=helpers.format("check-within requires a non-negative real number for range, given ~s.",[v]);N(types.incompleteExn(types.exnFailContract,i,[]))}(o(c)||o(d))&&N(types.incompleteExn(types.exnFailContract,"check-within cannot compare functions",[]));if(!(oa(c,d)||e(c)&&e(d)&&jsnums.lessThanOrEqual(jsnums.abs(jsnums.subtract(c,
d)),v))){i=helpers.format("check-within: actual value ~s is not within ~s of expected value ~s.",[c,v,d]);b.getDisplayHook()(i);c=state.getStackTraceFromContinuationMarks(state.captureCurrentContinuationMarks(b));for(d=0;d<c.length;d++)b.getPrintHook()(helpers.makeLocationDom(c[d]))}b.v=types.VOID});var db=new c("print",1,!1,!0,function(b,c){b.getPrintHook()(types.toWrittenString(c));b.v=types.VOID});b.write=new h("write",[new c("write",1,!1,!0,function(b,c){b.getPrintHook()(c);b.v=types.VOID}),new c("write",
2,!1,!0,function(){throw types.internalError("write to a port not implemented yet.",!1);})]);b.display=new h("display",[new c("display",1,!1,!0,function(b,c){b.getDisplayHook()(c);b.v=types.VOID}),new c("display",2,!1,!0,function(){throw types.internalError("display to a port not implemented yet.",!1);})]);b.newline=new h("newline",[new c("newline",0,!1,!0,function(b){b.getDisplayHook()("\n");b.v=types.VOID}),new c("newline",1,!1,!1,function(){throw types.internalError("newline to a port not implemented yet.",
!1);})]);b["current-print"]=new c("current-print",0,!1,!1,function(){return db});b["current-continuation-marks"]=new c("current-continuation-marks",0,!1,!0,function(b){b.v=state.captureCurrentContinuationMarks(b)});b["continuation-mark-set->list"]=new c("continuation-mark-set->list",2,!1,!0,function(b,c,d){i(c,types.isContinuationMarkSet,"continuation-mark-set->list","continuation-mark-set",1,[c,d]);b.v=types.list(c.ref(d))});b["for-each"]=new c("for-each",2,!0,!1,function(b,c,e){var v=[b,c].concat(e);
e.unshift(c);i(b,o,"for-each","procedure",1,v);R(e,function(b,g){ta(b,"for-each",g+2,v)});Ka(e,"for-each",v);var l=function(c){if(c[0].isEmpty())return types.VOID;for(var j=[],e=[],p=0;p<c.length;p++)j.push(c[p].first()),e.push(c[p].rest());return d(b,j,function(){return l(e)})};return l(e)});b["make-thread-cell"]=new h("make-thread-cell",[new c("make-thread-cell",1,!1,!1,function(b){return new types.ThreadCell(b,!1)}),new c("make-thread-cell",2,!1,!1,function(b,c){return new types.ThreadCell(b,c)})]);
b["make-continuation-prompt-tag"]=new h("make-continuation-prompt-tag",[new c("make-continuation-prompt-tag",0,!1,!1,function(){return new types.ThreadCell}),new c("make-continuation-prompt-tag",1,!1,!1,function(b){return new types.ThreadCell(b)})]);var Ra=function(b,j,d,e,i){for(var l=function(l){return new c(b,j+l,!1,e,function(){assert.equal(arguments.length,j+l+(e?1:0));for(var b=[arguments],g=0;g<arguments.length;g++)b.push(arguments[g]);return i.apply(i,b.concat(d.slice(g-j-(e?1:0))))})},o=
[],k=0;k<=d.length;k++)o.push(l(k));return new h(b,o)};b["make-struct-type"]=Ra("make-struct-type",4,[!1,types.EMPTY,types.symbol("prefab"),!1,types.EMPTY,!1],!0,function(b,c,d,e,l,h,k,m,q,oa,u,w){i(d,Q,"make-struct-type","symbol",1,b);i(e,function(b){return b===!1||types.isStructType(b)},"make-struct-type","struct-type or #f",2,b);i(l,E,"make-struct-type","exact non-negative integer",3,b);i(h,E,"make-struct-type","exact non-negative integer",4,b);pa(u,E,"make-struct-type","exact non-negative integer",
9,b);i(w,function(b){return b===!1||o(b)},"make-struct-type","procedure or #f",10,b);b=l+1+(e?e.numberOfArgs:0);w&&!P(b)(w)&&N(types.incompleteExn(types.exnFailContract,helpers.format("make-struct-type: guard procedure does not accept ~a arguments (one more than the number constructor arguments): ~s",[b,w]),[]));w=w?aa(c,w):!1;d=types.makeStructureType(d.toString(),e,jsnums.toFixnum(l),jsnums.toFixnum(h),k,w);c.v=t(d)});b["make-struct-field-accessor"]=Ra("make-struct-field-accessor",2,[!1],!1,function(b,
c,d,e){i(c,function(b){return b instanceof V&&b.numParams>1},"make-struct-field-accessor","accessor procedure that requires a field index",1,b);i(d,E,"make-struct-field-accessor","exact non-negative integer",2,b);i(e,function(b){return b===!1||Q(b)},"make-struct-field-accessor","symbol or #f",3,b);var l=jsnums.toFixnum(d);return new V(c.typeName,c.typeName+"-"+(e?e.toString():"field"+l),1,!1,!1,function(b){return c.impl(b,l)})});b["make-struct-field-mutator"]=Ra("make-struct-field-mutator",2,[!1],
!1,function(b,c,d,e){i(c,function(b){return b instanceof ha&&b.numParams>1},"make-struct-field-mutator","mutator procedure that requires a field index",1,b);i(d,E,"make-struct-field-mutator","exact non-negative integer",2,b);i(e,function(b){return b===!1||Q(b)},"make-struct-field-mutator","symbol or #f",3,b);var l=jsnums.toFixnum(d);return new ha(c.typeName,c.typeName+"-"+(e?e.toString():"field"+l),2,!1,!1,function(b,g){return c.impl(b,l,g)})});b["struct-type?"]=new c("struct-type?",1,!1,!1,types.isStructType);
b["struct-constructor-procedure?"]=new c("struct-constructor-procedure?",1,!1,!1,function(b){return b instanceof ja});b["struct-predicate-procedure?"]=new c("struct-predicate-procedure?",1,!1,!1,function(b){return b instanceof K});b["struct-accessor-procedure?"]=new c("struct-accessor-procedure?",1,!1,!1,function(b){return b instanceof V});b["struct-mutator-procedure?"]=new c("struct-mutator-procedure?",1,!1,!1,function(b){return b instanceof ha});b["procedure-arity"]=new c("procedure-arity",1,!1,
!1,function(b){i(b,o,"procedure-arity","procedure",1,[b]);var j=function(b){return b instanceof types.ContinuationClosureValue?types.arityAtLeast(0):b.isRest?types.arityAtLeast(b.numParams):b.numParams};if(b instanceof c||b instanceof types.ClosureValue||b instanceof types.ContinuationClosureValue)return j(b);else{if(b instanceof h)b=b.cases;else if(b instanceof types.CaseLambdaValue)b=b.closures;else throw types.internalError("procedure-arity given wrong type that passed isFunction!",!1);for(var d=
[],e=0;e<b.length;e++)d.push(j(b[e]));d=A(d);if(d.length==1)return d[0];return types.list(d)}});b.apply=new c("apply",2,!0,!1,function(b,c,e){var v=[b,c].concat(e);i(b,o,"apply","procedure",1,v);e.unshift(c);c=e.pop();ta(c,"apply",e.length+2,v);e=e.concat(helpers.schemeListToArray(c));return d(b,e,q)});b.values=new c("values",0,!0,!1,function(b){if(b.length===1)return b[0];return new types.ValuesWrapper(b)});b["call-with-values"]=new c("call-with-values",2,!1,!1,function(b,c){i(b,P(0),"call-with-values",
"procedure (arity 0)",1,arguments);i(c,o,"call-with-values","procedure",2,arguments);return d(b,[],function(b){return C(c,b)})});b.compose=new c("compose",0,!0,!1,function(g){R(g,function(b,c){i(b,o,"compose","procedure",c+1,g)});if(g.length==0)return b.values;var j=types.list(g).reverse(),e=function(b,g){if(g.isEmpty())return b;return d(new c("",1,!1,!1,function(b){return C(g.first(),b)}),[b],function(b){return e(b,g.rest())})};return new c("",0,!0,!1,function(b){if(b.length===1)return e(b[0],j);
return e(new types.ValuesWrapper(b),j)})});b["current-inexact-milliseconds"]=new c("current-inexact-milliseconds",0,!1,!1,function(){return jsnums.makeFloat((new Date).valueOf())});b["current-seconds"]=new c("current-seconds",0,!1,!1,function(){return Math.floor((new Date).getTime()/1E3)});b.not=new c("not",1,!1,!1,function(b){return b===!1});b["void"]=new c("void",0,!0,!1,function(){return types.VOID});b.random=new h("random",[new c("random",0,!1,!1,function(){return types["float"](Math.random())}),
new c("random",1,!1,!1,function(b){i(b,E,"random","non-negative exact integer",1,arguments);return Math.floor(Math.random()*jsnums.toFixnum(b))})]);b.sleep=new h("sleep",[new c("sleep",0,!1,!1,function(){return types.VOID}),new c("sleep",1,!1,!1,function(b){i(b,$,"sleep","non-negative real number",1);var c=jsnums.toFixnum(jsnums.multiply(b,1E3));return m(function(b){setTimeout(function(){b(types.VOID)},c)})})]);b.identity=new c("identity",1,!1,!1,q);b.raise=new c("raise",1,!1,!1,N);b.error=new c("error",
1,!0,!1,function(b,c){var d=[b].concat(c);i(b,function(b){return Q(b)||z(b)},"error","symbol or string",1,d);if(Q(b)){c.length===0&&N(types.incompleteExn(types.exnFail,"error: "+b.val,[]));var e=c.shift();i(e,z,"error","string",2,d);c.unshift(b);N(types.incompleteExn(types.exnFail,helpers.format("~s: "+e.toString(),c),[]))}else{d=[b.toString()];for(e=0;e<c.length;e++)d.push(types.toWrittenString(c[e]));N(types.incompleteExn(types.exnFail,d.join(""),[]))}});b["make-exn"]=new c("make-exn",2,!1,!1,types.exn);
b["exn-message"]=new c("exn-message",1,!1,!1,function(b){i(b,types.isExn,"exn-message","exn",1,[b]);return types.exnMessage(b)});b["exn-continuation-marks"]=new c("exn-continuation-marks",1,!1,!1,function(b){i(b,types.isExn,"exn-continuation-marks","exn",1,[b]);return types.exnContMarks(b)});b["make-exn:fail"]=new c("make-exn:fail",2,!1,!1,types.exnFail);b["make-exn:fail:contract"]=new c("make-exn:fail:contract",2,!1,!1,types.exnFailContract);b["make-exn:fail:contract:division-by-zero"]=new c("make-exn:fail:contract:division-by-zero",
2,!1,!1,types.exnFailContractDivisionByZero);b["*"]=new c("*",0,!0,!1,function(b){R(b,function(c,j){i(c,k,"*","number",j+1,b)});for(var c=types.rational(1),d=0;d<b.length;d++)c=jsnums.multiply(b[d],c);return c});b["-"]=new c("-",1,!0,!1,function(b,c){var d=[b].concat(c);i(b,k,"-","number",1,d);R(c,function(b,g){i(b,k,"-","number",g+2,d)});if(c.length==0)return jsnums.subtract(0,b);for(var e=b,l=0;l<c.length;l++)e=jsnums.subtract(e,c[l]);return e});b["+"]=new c("+",0,!0,!1,function(b){R(b,function(c,
j){i(c,k,"+","number",j+1,b)});if(b.length==0)return 0;for(var c=b[0],d=1;d<b.length;d++)c=jsnums.add(c,b[d]);return c});b["="]=new c("=",2,!0,!1,function(b,c,d){d.unshift(c);d.unshift(b);R(d,function(b,g){i(b,k,"=","number",g+1,d)});return J(d,jsnums.equals)});b["=~"]=new c("=~",3,!1,!1,function(b,c,d){i(b,e,"=~","real",1,arguments);i(c,e,"=~","real",2,arguments);i(d,$,"=~","non-negative-real",3,arguments);return jsnums.lessThanOrEqual(jsnums.abs(jsnums.subtract(b,c)),d)});b["/"]=new c("/",1,!0,
!1,function(b,c){var d=[b].concat(c);i(b,k,"/","number",1,d);R(c,function(b,g){i(b,k,"/","number",g+2,d)});if(c.length==0)return jsnums.equals(b,0)&&N(types.incompleteExn(types.exnFailContractDivisionByZero,"/: division by zero",[])),jsnums.divide(1,b);for(var e=b,l=0;l<c.length;l++)jsnums.equals(c[l],0)&&N(types.incompleteExn(types.exnFailContractDivisionByZero,"/: division by zero",[])),e=jsnums.divide(e,c[l]);return e});b.sub1=new c("sub1",1,!1,!1,function(b){i(b,k,"sub1","number",1,[b]);return jsnums.subtract(b,
1)});b.add1=new c("add1",1,!1,!1,function(b){i(b,k,"add1","number",1,[b]);return jsnums.add(b,1)});b["<"]=new c("<",2,!0,!1,function(b,c,d){d.unshift(c);d.unshift(b);R(d,function(b,g){i(b,k,"<","number",g+1,d)});return J(d,jsnums.lessThan)});b[">"]=new c(">",2,!0,!1,function(b,c,d){d.unshift(c);d.unshift(b);R(d,function(b,g){i(b,k,">","number",g+1,d)});return J(d,jsnums.greaterThan)});b["<="]=new c("<=",2,!0,!1,function(b,c,d){d.unshift(c);d.unshift(b);R(d,function(b,g){i(b,k,"<=","number",g+1,d)});
return J(d,jsnums.lessThanOrEqual)});b[">="]=new c(">=",2,!0,!1,function(b,c,d){d.unshift(c);d.unshift(b);R(d,function(b,g){i(b,k,">=","number",g+1,d)});return J(d,jsnums.greaterThanOrEqual)});b.abs=new c("abs",1,!1,!1,function(b){i(b,e,"abs","real",1);return jsnums.abs(b)});b.quotient=new c("quotient",2,!1,!1,function(b,c){i(b,y,"quotient","integer",1,arguments);i(c,y,"quotient","integer",2,arguments);return jsnums.quotient(b,c)});b.remainder=new c("remainder",2,!1,!1,function(b,c){i(b,y,"remainder",
"integer",1,arguments);i(c,y,"remainder","integer",2,arguments);return jsnums.remainder(b,c)});b.modulo=new c("modulo",2,!1,!1,function(b,c){i(b,y,"modulo","integer",1,arguments);i(c,y,"modulo","integer",2,arguments);return jsnums.modulo(b,c)});b.max=new c("max",1,!0,!1,function(b,c){c.unshift(b);R(c,function(b,g){i(b,e,"max","real",g+1,c)});for(var d=b,v=1;v<c.length;v++)jsnums.greaterThan(c[v],d)&&(d=c[v]);return d});b.min=new c("min",1,!0,!1,function(b,c){c.unshift(b);R(c,function(b,g){i(b,e,"min",
"real",g+1,c)});for(var d=b,v=1;v<c.length;v++)jsnums.lessThan(c[v],d)&&(d=c[v]);return d});b.gcd=new c("gcd",1,!0,!1,function(b,c){var d=[b].concat(c);i(b,y,"gcd","integer",1,d);R(c,function(b,g){i(b,y,"gcd","integer",g+2,d)});return jsnums.gcd(b,c)});b.lcm=new c("lcm",1,!0,!1,function(b,c){var d=[b].concat(c);i(b,y,"lcm","integer",1,d);R(c,function(b,g){i(b,y,"lcm","integer",g+2,d)});return jsnums.lcm(b,c)});b.floor=new c("floor",1,!1,!1,function(b){i(b,e,"floor","real",1);return jsnums.floor(b)});
b.ceiling=new c("ceiling",1,!1,!1,function(b){i(b,e,"ceiling","real",1);return jsnums.ceiling(b)});b.round=new c("round",1,!1,!1,function(b){i(b,e,"round","real",1);return jsnums.round(b)});b.numerator=new c("numerator",1,!1,!1,function(b){i(b,I,"numerator","rational number",1);return jsnums.numerator(b)});b.denominator=new c("denominator",1,!1,!1,function(b){i(b,I,"denominator","rational number",1);return jsnums.denominator(b)});b.expt=new c("expt",2,!1,!1,function(b,c){i(b,k,"expt","number",1,arguments);
i(c,k,"expt","number",2,arguments);return jsnums.expt(b,c)});b.exp=new c("exp",1,!1,!1,function(b){i(b,k,"exp","number",1);return jsnums.exp(b)});b.log=new c("log",1,!1,!1,function(b){i(b,k,"log","number",1);return jsnums.log(b)});b.sin=new c("sin",1,!1,!1,function(b){i(b,k,"sin","number",1);return jsnums.sin(b)});b.cos=new c("cos",1,!1,!1,function(b){i(b,k,"cos","number",1);return jsnums.cos(b)});b.tan=new c("tan",1,!1,!1,function(b){i(b,k,"tan","number",1);return jsnums.tan(b)});b.asin=new c("asin",
1,!1,!1,function(b){i(b,k,"asin","number",1);return jsnums.asin(b)});b.acos=new c("acos",1,!1,!1,function(b){i(b,k,"acos","number",1);return jsnums.acos(b)});b.atan=new c("atan",1,!1,!1,function(b){i(b,k,"atan","number",1);return jsnums.atan(b)});b.sinh=new c("sinh",1,!1,!1,function(b){i(b,k,"sinh","number",1);return jsnums.sinh(b)});b.cosh=new c("cosh",1,!1,!1,function(b){i(b,k,"cosh","number",1);return jsnums.cosh(b)});b.sqr=new c("sqr",1,!1,!1,function(b){i(b,k,"sqr","number",1);return jsnums.sqr(b)});
b.sqrt=new c("sqrt",1,!1,!1,function(b){i(b,k,"sqrt","number",1);return jsnums.sqrt(b)});b["integer-sqrt"]=new c("integer-sqrt",1,!1,!1,function(b){i(b,y,"integer-sqrt","integer",1);return jsnums.integerSqrt(b)});b["make-rectangular"]=new c("make-rectangular",2,!1,!1,function(b,c){i(b,e,"make-rectangular","real",1,arguments);i(c,e,"make-rectangular","real",2,arguments);return types.complex(b,c)});b["make-polar"]=new c("make-polar",2,!1,!1,function(b,c){i(b,e,"make-polar","real",1,arguments);i(b,e,
"make-polar","real",2,arguments);return jsnums.makeComplexPolar(b,c)});b["real-part"]=new c("real-part",1,!1,!1,function(b){i(b,k,"real-part","number",1);return jsnums.realPart(b)});b["imag-part"]=new c("imag-part",1,!1,!1,function(b){i(b,k,"imag-part","number",1);return jsnums.imaginaryPart(b)});b.angle=new c("angle",1,!1,!1,function(b){i(b,k,"angle","number",1);return jsnums.angle(b)});b.magnitude=new c("magnitude",1,!1,!1,function(b){i(b,k,"magnitude","number",1);return jsnums.magnitude(b)});b.conjugate=
new c("conjugate",1,!1,!1,function(b){i(b,k,"conjugate","number",1);return jsnums.conjugate(b)});b.sgn=new c("sgn",1,!1,!1,function(b){i(b,e,"sgn","real number",1);return jsnums.greaterThan(b,0)?1:jsnums.lessThan(b,0)?-1:0});b["inexact->exact"]=new c("inexact->exact",1,!1,!1,function(b){i(b,k,"inexact->exact","number",1);try{return jsnums.toExact(b)}catch(c){N(types.exnFailContract("inexact->exact: no exact representation for "+types.toWrittenString(b),!1))}});b["exact->inexact"]=new c("exact->inexact",
1,!1,!1,function(b){i(b,k,"exact->inexact","number",1);return jsnums.toInexact(b)});b["number->string"]=new c("number->string",1,!1,!1,function(b){i(b,k,"number->string","number",1);return types.string(b+"")});b["string->number"]=new c("string->number",1,!1,!1,function(b){i(b,z,"string->number","string",1);return jsnums.fromString(b)});b["xml->s-exp"]=new c("xml->s-exp",1,!1,!1,function(b){i(b,z,"xml->s-exp","string",1);if(b.length==0)return types.string("");var c;try{c=new ActiveXObject("Microsoft.XMLDOM"),
c.async="false",c.loadXML(s)}catch(d){c=(new DOMParser).parseFromString(s,"text/xml")}var e=function(b){for(var g=types.EMPTY,c=0;c<b.length;c++)var j=types.cons(types.symbol(b.item(c).nodeName),types.cons(b.item(c).nodeValue,types.EMPTY)),g=types.cons(j,g);return types.cons(types.symbol("@"),g).reverse()},l=function(b){if(b.nodeType==Node.ELEMENT_NODE){for(var g=types.EMPTY,c=b.firstChild;c!=null;)var j=l(c),g=z(j)&&!g.isEmpty()&&z(g.first())?types.cons(g.first()+j,g.rest()):types.cons(j,g),c=c.nextSibling;
g=g.reverse();g=types.cons(e(b.attributes),g);return g=types.cons(types.symbol(b.nodeName),g)}else return b.nodeType==Node.TEXT_NODE?b.textContent:b.nodeType==Node.CDATA_SECTION_NODE?b.data:types.EMPTY};return l(c.firstChild)});b["procedure?"]=new c("procedure?",1,!1,!1,o);b["pair?"]=new c("pair?",1,!1,!1,H);b["cons?"]=new c("cons?",1,!1,!1,H);b["empty?"]=new c("empty?",1,!1,!1,wa);b["null?"]=new c("null?",1,!1,!1,wa);b["undefined?"]=new c("undefined?",1,!1,!1,function(b){return b===types.UNDEFINED});
b["void?"]=new c("void?",1,!1,!1,function(b){return b===types.VOID});b["symbol?"]=new c("symbol?",1,!1,!1,Q);b["string?"]=new c("string?",1,!1,!1,z);b["char?"]=new c("char?",1,!1,!1,U);b["boolean?"]=new c("boolean?",1,!1,!1,l);b["vector?"]=new c("vector?",1,!1,!1,O);b["struct?"]=new c("struct?",1,!1,!1,types.isStruct);b["eof-object?"]=new c("eof-object?",1,!1,!1,function(b){return b===types.EOF});b["posn?"]=new c("posn?",1,!1,!1,types.isPosn);b["bytes?"]=new c("bytes?",1,!1,!1,ba);b["byte?"]=new c("byte?",
1,!1,!1,ra);b["number?"]=new c("number?",1,!1,!1,k);b["complex?"]=new c("complex?",1,!1,!1,k);b["real?"]=new c("real?",1,!1,!1,e);b["rational?"]=new c("rational?",1,!1,!1,I);b["integer?"]=new c("integer?",1,!1,!1,y);b["exact?"]=new c("exact?",1,!1,!1,function(b){i(b,k,"exact?","number",1);return jsnums.isExact(b)});b["inexact?"]=new c("inexact?",1,!1,!1,function(b){i(b,k,"inexact?","number",1);return jsnums.isInexact(b)});b["odd?"]=new c("odd?",1,!1,!1,function(b){i(b,y,"odd?","integer",1);return jsnums.equals(jsnums.modulo(b,
2),1)});b["even?"]=new c("even?",1,!1,!1,function(b){i(b,y,"even?","integer",1);return jsnums.equals(jsnums.modulo(b,2),0)});b["zero?"]=new c("zero?",1,!1,!1,function(b){return jsnums.equals(0,b)});b["positive?"]=new c("positive?",1,!1,!1,function(b){i(b,e,"positive?","real",1);return jsnums.greaterThan(b,0)});b["negative?"]=new c("negative?",1,!1,!1,function(b){i(b,e,"negative?","real",1);return jsnums.lessThan(b,0)});b["box?"]=new c("box?",1,!1,!1,da);b["hash?"]=new c("hash?",1,!1,!1,ia);b["eq?"]=
new c("eq?",2,!1,!1,Ga);b["eqv?"]=new c("eqv?",2,!1,!1,ya);b["equal?"]=new c("equal?",2,!1,!1,oa);b["equal~?"]=new c("equal~?",3,!1,!1,function(b,c,d){i(d,$,"equal~?","non-negative-real",3,arguments);return oa(b,c)||e(b)&&e(c)&&jsnums.lessThanOrEqual(jsnums.abs(jsnums.subtract(b,c)),d)});b["false?"]=new c("false?",1,!1,!1,function(b){return b===!1});b["boolean=?"]=new c("boolean=?",2,!1,!1,function(b,c){i(b,l,"boolean=?","boolean",1,arguments);i(c,l,"boolean=?","boolean",2,arguments);return b===c});
b["symbol=?"]=new c("symbol=?",2,!1,!1,function(b,c){i(b,Q,"symbol=?","symbol",1,arguments);i(c,Q,"symbol=?","symbol",2,arguments);return oa(b,c)});b["js-object?"]=new c("js-object?",1,!1,!1,xa);b.cons=new c("cons",2,!1,!1,function(b,c){return types.cons(b,c)});b.car=new c("car",1,!1,!1,function(b){i(b,H,"car","pair",1);return b.first()});b.cdr=new c("cdr",1,!1,!1,function(b){i(b,H,"cdr","pair",1);return b.rest()});b.caar=new c("caar",1,!1,!1,function(b){i(b,function(b){return H(b)&&H(b.first())},
"caar","caarable value",1);return b.first().first()});b.cadr=new c("cadr",1,!1,!1,function(b){i(b,function(b){return H(b)&&H(b.rest())},"cadr","cadrable value",1);return b.rest().first()});b.cdar=new c("cdar",1,!1,!1,function(b){i(b,function(b){return H(b)&&H(b.first())},"cdar","cdarable value",1);return b.first().rest()});b.cddr=new c("cddr",1,!1,!1,function(b){i(b,function(b){return H(b)&&H(b.rest())},"cddr","cddrable value",1);return b.rest().rest()});b.caaar=new c("caaar",1,!1,!1,function(b){i(b,
function(b){return H(b)&&H(b.first())&&H(b.first().first())},"caaar","caaarable value",1);return b.first().first().first()});b.caadr=new c("caadr",1,!1,!1,function(b){i(b,function(b){return H(b)&&H(b.rest())&&H(b.rest().first())},"caadr","caadrable value",1);return b.rest().first().first()});b.cadar=new c("cadar",1,!1,!1,function(b){i(b,function(b){return H(b)&&H(b.first())&&H(b.first().rest())},"cadar","cadarable value",1);return b.first().rest().first()});b.cdaar=new c("cdaar",1,!1,!1,function(b){i(b,
function(b){return H(b)&&H(b.first())&&H(b.first().first())},"cdaar","cdaarable value",1);return b.first().first().rest()});b.cdadr=new c("cdadr",1,!1,!1,function(b){i(b,function(b){return H(b)&&H(b.rest())&&H(b.rest().first())},"cdadr","cdadrable value",1);return b.rest().first().rest()});b.cddar=new c("cddar",1,!1,!1,function(b){i(b,function(b){return H(b)&&H(b.first())&&H(b.first().rest())},"cddar","cddarable value",1);return b.first().rest().rest()});b.caddr=new c("caddr",1,!1,!1,function(b){i(b,
function(b){return H(b)&&H(b.rest())&&H(b.rest().rest())},"caddr","caddrable value",1);return b.rest().rest().first()});b.cdddr=new c("cdddr",1,!1,!1,function(b){i(b,function(b){return H(b)&&H(b.rest())&&H(b.rest().rest())},"cdddr","cdddrable value",1);return b.rest().rest().rest()});b.cadddr=new c("cadddr",1,!1,!1,function(b){i(b,function(b){return H(b)&&H(b.rest())&&H(b.rest().rest())&&H(b.rest().rest().rest())},"cadddr","cadddrable value",1);return b.rest().rest().rest().first()});b.rest=new c("rest",
1,!1,!1,function(b){i(b,function(b){return Y(b)&&!wa(b)},"rest","non-empty list",1);return b.rest()});b.first=new c("first",1,!1,!1,function(b){i(b,function(b){return Y(b)&&!wa(b)},"first","non-empty list",1);return b.first()});b.second=new c("second",1,!1,!1,function(b){Qa(b,2,"second",1);return b.rest().first()});b.third=new c("third",1,!1,!1,function(b){Qa(b,3,"third",1);return b.rest().rest().first()});b.fourth=new c("fourth",1,!1,!1,function(b){Qa(b,4,"fourth",1);return b.rest().rest().rest().first()});
b.fifth=new c("fifth",1,!1,!1,function(b){Qa(b,5,"fifth",1);return b.rest().rest().rest().rest().first()});b.sixth=new c("sixth",1,!1,!1,function(b){Qa(b,6,"sixth",1);return b.rest().rest().rest().rest().rest().first()});b.seventh=new c("seventh",1,!1,!1,function(b){Qa(b,7,"seventh",1);return b.rest().rest().rest().rest().rest().rest().first()});b.eighth=new c("eighth",1,!1,!1,function(b){Qa(b,8,"eighth",1);return b.rest().rest().rest().rest().rest().rest().rest().first()});b.length=new c("length",
1,!1,!1,function(b){return jsnums.makeRational(w(b))});b["list?"]=new c("list?",1,!1,!1,Y);b.list=new c("list",0,!0,!1,types.list);b["list*"]=new c("list*",1,!0,!1,function(b,c){var d=[b].concat(c);if(c.length==0)return b;var e=c.pop();ta(e,"list*",c.length+2,d);c.unshift(b);return L([types.list(c),e])});b["list-ref"]=new c("list-ref",2,!1,!1,function(b,c){ta(b,"list-ref",1,arguments);i(c,E,"list-ref","non-negative exact integer",2,arguments);for(var d=b,e=jsnums.toFixnum(c),l=0;l<e;l++){if(d.isEmpty()){var h=
"list-ref: index "+e+" is too large for list: "+types.toWrittenString(b);N(types.incompleteExn(types.exnFailContract,h,[]))}d=d.rest()}return d.first()});b["list-tail"]=new c("list-tail",2,!1,!1,function(b,c){ta(b,"list-tail",1,arguments);i(x,E,"list-tail","non-negative exact integer",2,arguments);for(var b=origList,d=jsnums.toFixnum(c),e=0;e<d;e++){if(b.isEmpty()){var l="list-tail: index "+d+" is too large for list: "+types.toWrittenString(origList);N(types.incompleteExn(types.exnFailContract,l,
[]))}b=b.rest()}return b});b.append=new c("append",0,!0,!1,L);b.reverse=new c("reverse",1,!1,!1,function(b){ta(b,"reverse",1);return b.reverse()});b.map=new c("map",2,!0,!1,function(b,c,e){var v=[b,c].concat(e);e.unshift(c);i(b,o,"map","procedure",1,v);R(e,function(b,g){ta(b,"map",g+2,v)});Ka(e,"map",v);var l=function(b,g,c){if(g[0].isEmpty())return c.reverse();for(var e=[],j=[],p=0;p<g.length;p++)e.push(g[p].first()),j.push(g[p].rest());return d(b,e,function(g){return l(b,j,types.cons(g,c))})};return l(b,
e,types.EMPTY)});b.andmap=new c("andmap",2,!0,!1,function(b,c,e){var v=[b,c].concat(e);e.unshift(c);i(b,o,"andmap","procedure",1,v);R(e,function(b,g){ta(b,"andmap",g+2,v)});Ka(e,"andmap",v);var l=function(b,g){if(g[0].isEmpty())return!0;for(var c=[],e=[],j=0;j<g.length;j++)c.push(g[j].first()),e.push(g[j].rest());return d(b,c,function(g){return g&&l(b,e)})};return l(b,e)});b.ormap=new c("ormap",2,!0,!1,function(b,c,e){var v=[b,c].concat(e);e.unshift(c);i(b,o,"ormap","procedure",1,v);R(e,function(b,
g){ta(b,"ormap",g+2,v)});Ka(e,"ormap",v);var l=function(b,g){if(g[0].isEmpty())return!1;for(var c=[],e=[],j=0;j<g.length;j++)c.push(g[j].first()),e.push(g[j].rest());return d(b,c,function(g){return g||l(b,e)})};return l(b,e)});b.memq=new c("memq",2,!1,!1,function(b,c){for(ta(c,"memq",2,arguments);!c.isEmpty();){if(Ga(b,c.first()))return c;c=c.rest()}return!1});b.memv=new c("memv",2,!1,!1,function(b,c){for(ta(c,"memv",2,arguments);!c.isEmpty();){if(ya(b,c.first()))return c;c=c.rest()}return!1});b.member=
new c("member",2,!1,!1,function(b,c){for(ta(c,"member",2,arguments);!c.isEmpty();){if(oa(b,c.first()))return c;c=c.rest()}return!1});b.memf=new c("memf",2,!1,!1,function(b,c){i(b,o,"memf","procedure",1,arguments);ta(c,"memf",2,arguments);var e=function(c){if(c.isEmpty())return!1;return d(b,[c.first()],function(b){if(b)return c;return e(c.rest())})};return e(c)});b.assq=new c("assq",2,!1,!1,function(b,c){for(pa(c,H,"assq","pair",2,arguments);!c.isEmpty();){if(Ga(b,c.first().first()))return c.first();
c=c.rest()}return!1});b.assv=new c("assv",2,!1,!1,function(b,c){for(pa(c,H,"assv","pair",2,arguments);!c.isEmpty();){if(ya(b,c.first().first()))return c.first();c=c.rest()}return!1});b.assoc=new c("assoc",2,!1,!1,function(b,c){for(pa(c,H,"assoc","pair",2,arguments);!c.isEmpty();){if(oa(b,c.first().first()))return c.first();c=c.rest()}return!1});b.remove=new c("remove",2,!1,!1,function(b,c){ta(c,"remove",2,arguments);for(var d=c,e=types.EMPTY;!c.isEmpty();)if(oa(b,c.first()))return L([e.reverse(),
c.rest()]);else e=types.cons(c.first(),e),c=c.rest();return d});b.filter=new c("filter",2,!1,!1,function(b,c){i(b,P(1),"filter","procedure (arity 1)",1,arguments);ta(c,"filter",2);var e=function(b,g,c){if(g.isEmpty())return c.reverse();return d(b,[g.first()],function(d){return d?e(b,g.rest(),types.cons(g.first(),c)):e(b,g.rest(),c)})};return e(b,c,types.EMPTY)});b.foldl=new c("foldl",3,!0,!1,function(b,c,d,e){e.unshift(d);var l=[b,c].concat(e);i(b,o,"foldl","procedure",1,l);R(e,function(b,g){ta(b,
"foldl",g+3,l)});Ka(e,"foldl",l);return T(b,c,e)});b.foldr=new c("foldr",3,!0,!1,function(b,c,d,e){e.unshift(d);var l=[b,c].concat(e);i(b,o,"foldr","procedure",1,l);R(e,function(b,g){ta(b,"foldr",g+3,l)});Ka(e,"foldr",l);for(d=0;d<e.length;d++)e[d]=e[d].reverse();return T(b,c,e)});b.quicksort=new c("quicksort",2,!1,!1,X("quicksort"));b.sort=new c("sort",2,!1,!1,X("sort"));b.argmax=new c("argmax",2,!1,!1,function(b,c){var p=arguments;i(b,o,"argmax","procedure",1,p);i(c,H,"argmax","non-empty list",
2,p);var l=function(c,j,h){if(c.isEmpty())return h;return d(b,[c.first()],function(b){i(b,e,"argmax","procedure that returns real numbers",1,p);return jsnums.greaterThan(b,j)?l(c.rest(),b,c.first()):l(c.rest(),j,h)})};return d(b,[c.first()],function(b){i(b,e,"argmax","procedure that returns real numbers",1,p);return l(c.rest(),b,c.first())})});b.argmin=new c("argmin",2,!1,!1,function(b,c){var p=arguments;i(b,o,"argmin","procedure",1,p);i(c,H,"argmin","non-empty list",2,p);var l=function(c,j,h){if(c.isEmpty())return h;
return d(b,[c.first()],function(b){i(b,e,"argmin","procedure that returns real numbers",1,p);return jsnums.lessThan(b,j)?l(c.rest(),b,c.first()):l(c.rest(),j,h)})};return d(b,[c.first()],function(b){i(b,e,"argmin","procedure that returns real numbers",1,p);return l(c.rest(),b,c.first())})});b["build-list"]=new c("build-list",2,!1,!1,function(b,c){i(b,E,"build-list","non-negative exact integer",1,arguments);i(c,o,"build-list","procedure",2,arguments);var e=function(i,l){if(jsnums.greaterThanOrEqual(i,
b))return l.reverse();return d(c,[i],function(b){return e(i+1,types.cons(b,l))})};return e(0,types.EMPTY)});b.box=new c("box",1,!1,!1,types.box);b["box-immutable"]=new c("box-immutable",1,!1,!1,types.boxImmutable);b.unbox=new c("unbox",1,!1,!1,function(b){i(b,da,"unbox","box",1);return b.unbox()});b["set-box!"]=new c("set-box!",2,!1,!1,function(b,c){i(b,function(b){return da(b)&&b.mutable},"set-box!","mutable box",1,arguments);b.set(c);return types.VOID});b["make-hash"]=new h("make-hash",[new c("make-hash",
0,!1,!1,function(){return types.hash(types.EMPTY)}),new c("make-hash",1,!1,!1,function(b){pa(b,H,"make-hash","list of pairs",1);return types.hash(b)})]);b["make-hasheq"]=new h("make-hasheq",[new c("make-hasheq",0,!1,!1,function(){return types.hashEq(types.EMPTY)}),new c("make-hasheq",1,!1,!1,function(b){pa(b,H,"make-hasheq","list of pairs",1);return types.hashEq(b)})]);b["hash-set!"]=new c("hash-set!",3,!1,!1,function(b,c,d){i(b,ia,"hash-set!","hash",1,arguments);b.hash.put(c,d);return types.VOID});
b["hash-ref"]=new h("hash-ref",[new c("hash-ref",2,!1,!1,function(b,c){i(b,ia,"hash-ref","hash",1,arguments);if(!b.hash.containsKey(c)){var d="hash-ref: no value found for key: "+types.toWrittenString(c);N(types.incompleteExn(types.exnFailContract,d,[]))}return b.hash.get(c)}),new c("hash-ref",3,!1,!1,function(b,c,e){i(b,ia,"hash-ref","hash",1,arguments);if(b.hash.containsKey(c))return b.hash.get(c);else{if(o(e))return d(e,[],q);return e}})]);b["hash-remove!"]=new c("hash-remove",2,!1,!1,function(b,
c){i(b,ia,"hash-remove!","hash",1,arguments);b.hash.remove(c);return types.VOID});b["hash-map"]=new c("hash-map",2,!1,!1,function(b,c){i(b,ia,"hash-map","hash",1,arguments);i(c,o,"hash-map","procedure",2,arguments);var e=b.hash.keys(),l=function(i,h){if(i>=e.length)return h;var o=b.hash.get(e[i]);return d(c,[e[i],o],function(b){return l(i+1,types.cons(b,h))})};return l(0,types.EMPTY)});b["hash-for-each"]=new c("hash-for-each",2,!1,!1,function(b,c){i(b,ia,"hash-for-each","hash",1,arguments);i(c,o,
"hash-for-each","procedure",2,arguments);var e=b.hash.keys(),l=function(i){if(i>=e.length)return types.VOID;var h=b.hash.get(e[i]);return d(c,[e[i],h],function(){return l(i+1)})};return l(0)});b["make-string"]=new c("make-string",2,!1,!1,function(b,c){i(b,E,"make-string","non-negative exact integer",1,arguments);i(c,U,"make-string","char",2,arguments);for(var d=[],e=0;jsnums.lessThan(e,b);e++)d.push(c.val);return types.string(d)});b.replicate=new c("replicate",2,!1,!1,function(b,c){i(b,E,"replicate",
"non-negative exact integer",1,arguments);i(c,z,"replicate","string",2,arguments);for(var d="",e=c.toString(),l=0;jsnums.lessThan(l,b);l++)d+=e;return types.string(d)});b.string=new c("string",0,!0,!1,function(b){R(b,function(c,d){i(c,U,"string","char",d+1,b)});for(var c=[],d=0;d<b.length;d++)c.push(b[d].val);return types.string(c)});b["string-length"]=new c("string-length",1,!1,!1,function(b){i(b,z,"string-length","string",1);return b.length});b["string-ref"]=new c("string-ref",2,!1,!1,function(b,
c){i(b,z,"string-ref","string",1,arguments);i(c,E,"string-ref","non-negative exact integer",2,arguments);var d=jsnums.toFixnum(c);if(d>=b.length){var e="string-ref: index "+d+" out of range [0, "+(b.length-1)+"] for string: "+types.toWrittenString(b);N(types.incompleteExn(types.exnFailContract,e,[]))}return types["char"](b.charAt(d))});b["string=?"]=new c("string=?",2,!0,!1,function(b,c,d){d.unshift(c);d.unshift(b);R(d,function(b,c){i(b,z,"string=?","string",c+1,d)});return J(d,function(b,c){return b.toString()===
c.toString()})});b["string-ci=?"]=new c("string-ci=?",2,!0,!1,function(b,c,d){d.unshift(c);d.unshift(b);for(b=0;b<d.length;b++)i(d[b],z,"string-ci=?","string",b+1,d),d[b]=d[b].toString().toLowerCase();return J(d,function(b,c){return b===c})});b["string<?"]=new c("string<?",2,!0,!1,function(b,c,d){d.unshift(c);d.unshift(b);R(d,function(b,c){i(b,z,"string<?","string",c+1,d)});return J(d,function(b,c){return b.toString()<c.toString()})});b["string>?"]=new c("string>?",2,!0,!1,function(b,c,d){d.unshift(c);
d.unshift(b);R(d,function(b,c){i(b,z,"string>?","string",c+1,d)});return J(d,function(b,c){return b.toString()>c.toString()})});b["string<=?"]=new c("string<=?",2,!0,!1,function(b,c,d){d.unshift(c);d.unshift(b);R(d,function(b,c){i(b,z,"string<=?","string",c+1,d)});return J(d,function(b,c){return b.toString()<=c.toString()})});b["string>=?"]=new c("string>=?",2,!0,!1,function(b,c,d){d.unshift(c);d.unshift(b);R(d,function(b,c){i(b,z,"string>=?","string",c+1,d)});return J(d,function(b,c){return b.toString()>=
c.toString()})});b["string-ci<?"]=new c("string-ci<?",2,!0,!1,function(b,c,d){d.unshift(c);d.unshift(b);for(b=0;b<d.length;b++)i(d[b],z,"string-ci<?","string",b+1,d),d[b]=d[b].toString().toLowerCase();return J(d,function(b,c){return b<c})});b["string-ci>?"]=new c("string-ci>?",2,!0,!1,function(b,c,d){d.unshift(c);d.unshift(b);for(b=0;b<d.length;b++)i(d[b],z,"string-ci>?","string",b+1,d),d[b]=d[b].toString().toLowerCase();return J(d,function(b,c){return b>c})});b["string-ci<=?"]=new c("string-ci<=?",
2,!0,!1,function(b,c,d){d.unshift(c);d.unshift(b);for(b=0;b<d.length;b++)i(d[b],z,"string-ci<=?","string",b+1,d),d[b]=d[b].toString().toLowerCase();return J(d,function(b,c){return b<=c})});b["string-ci>=?"]=new c("string-ci>=?",2,!0,!1,function(b,c,d){d.unshift(c);d.unshift(b);for(b=0;b<d.length;b++)i(d[b],z,"string-ci>=?","string",b+1,d),d[b]=d[b].toString().toLowerCase();return J(d,function(b,c){return b>=c})});b.substring=new h("substring",[new c("substring",2,!1,!1,function(b,c){i(b,z,"substring",
"string",1,arguments);i(c,E,"substring","non-negative exact integer",2,arguments);var d=jsnums.toFixnum(c);if(d>b.length)d="substring: starting index "+d+" out of range [0, "+b.length+"] for string: "+types.toWrittenString(b),N(types.incompleteExn(types.exnFailContract,d,[]));else return types.string(b.substring(jsnums.toFixnum(d)))}),new c("substring",3,!1,!1,function(b,c,d){i(b,z,"substring","string",1,arguments);i(c,E,"substring","non-negative exact integer",2,arguments);i(d,E,"substring","non-negative exact integer",
3,arguments);var e=jsnums.toFixnum(c),l=jsnums.toFixnum(d);if(e>b.length){var h="substring: starting index "+e+" out of range [0, "+b.length+"] for string: "+types.toWrittenString(b);N(types.incompleteExn(types.exnFailContract,h,[]))}if(l<e||l>b.length)h="substring: ending index "+l+" out of range ["+e+", "+b.length+"] for string: "+types.toWrittenString(b),N(types.incompleteExn(types.exnFailContract,h,[]));return types.string(b.substring(e,l))})]);b["string-append"]=new c("string-append",0,!0,!1,
function(b){R(b,function(c,d){i(c,z,"string-append","string",d+1,b)});for(var c=0;c<b.length;c++)b[c]=b[c].toString();return types.string(b.join(""))});b["string->list"]=new c("string->list",1,!1,!1,function(b){i(b,z,"string->list","string",1);for(var c=types.EMPTY,d=b.length-1;d>=0;d--)c=types.cons(types["char"](b.charAt(d)),c);return c});b["list->string"]=new c("list->string",1,!1,!1,function(b){pa(b,U,"list->string","char",1);for(var c=[];!b.isEmpty();)c.push(b.first().val),b=b.rest();return types.string(c)});
b["string-copy"]=new c("string-copy",1,!1,!1,function(b){i(b,z,"string-copy","string",1);return types.string(b.toString())});b["string->symbol"]=new c("string->symbol",1,!1,!1,function(b){i(b,z,"string->symbol","string",1);return types.symbol(b.toString())});b["symbol->string"]=new c("symbol->string",1,!1,!1,function(b){i(b,Q,"symbol->string","symbol",1);return types.string(b.toString())});b.format=new c("format",1,!0,!1,function(b,c){i(b,z,"format","string",1,[b].concat(c));return types.string(helpers.format(b,
c,"format"))});b.printf=new c("printf",1,!0,!0,function(b,c,d){i(c,z,"printf","string",1,[c].concat(d));c=helpers.format(c,d,"printf");b.getDisplayHook()(c);b.v=types.VOID});b["string->int"]=new c("string->int",1,!1,!1,function(b){i(b,function(b){return z(b)&&b.length==1},"string->int","1-letter string",1);return b.charCodeAt(0)});b["int->string"]=new c("int->string",1,!1,!1,function(b){i(b,function(b){if(!y(b))return!1;b=jsnums.toFixnum(b);return b>=0&&b<55296||b>57343&&b<=1114111},"int->string",
"exact integer in [0,55295] or [57344,1114111]",1);return types.string(String.fromCharCode(jsnums.toFixnum(b)))});b.explode=new c("explode",1,!1,!1,function(b){i(b,z,"explode","string",1);for(var c=types.EMPTY,d=b.length-1;d>=0;d--)c=types.cons(types.string(b.charAt(d)),c);return c});b.implode=new c("implode",1,!1,!1,function(b){pa(b,function(b){return z(b)&&b.length==1},"implode","list of 1-letter strings",1);for(var c=[];!b.isEmpty();)c.push(b.first().toString()),b=b.rest();return types.string(c)});
b["string-alphabetic?"]=new c("string-alphabetic?",1,!1,!1,function(b){i(b,z,"string-alphabetic?","string",1);return ca(b)});b["string-ith"]=new c("string-ith",2,!1,!1,function(b,c){i(b,z,"string-ith","string",1,arguments);i(c,function(c){return E(c)&&jsnums.lessThan(c,b.length)},"string-ith","exact integer in [0, length of the given string minus 1 ("+(b.length-1)+")]",2,arguments);return types.string(b.charAt(jsnums.toFixnum(c)))});b["string-lower-case?"]=new c("string-lower-case?",1,!1,!1,function(b){i(b,
z,"string-lower-case?","string",1);var c=b.toString();return ca(b)&&c.toLowerCase()===c});b["string-numeric?"]=new c("string-numeric?",1,!1,!1,function(b){i(b,z,"string-numeric?","string",1);a:{for(var c=0;c<b.length;c++)if(!(b.charAt(c)>="0"&&b.charAt(c)<="9")){b=!1;break a}b=!0}return b});b["string-upper-case?"]=new c("string-upper-case?",1,!1,!1,function(b){i(b,z,"string-upper-case?","string",1);var c=b.toString();return ca(b)&&c.toUpperCase()===c});b["string-whitespace?"]=new c("string-whitespace?",
1,!1,!1,function(b){i(b,z,"string-whitespace?","string",1);return la(b)});b["build-string"]=new c("build-string",2,!1,!1,function(b,c){i(b,E,"build-string","non-negative exact integer",1,arguments);i(c,o,"build-string","procedure",2,arguments);var e=function(l,h){if(jsnums.greaterThanOrEqual(l,b))return types.string(h);return d(c,[l],function(b){i(b,U,"build-string","procedure that returns a char",2);return e(l+1,h.push(b.val))})};return e(0,[])});b["string->immutable-string"]=new c("string->immutable-string",
1,!1,!1,function(b){i(b,z,"string->immutable-string","string",1);return b.toString()});b["string-set!"]=new c("string-set!",3,!1,!1,function(b,c,d){i(b,function(b){return z(b)&&typeof b!="string"},"string-set!","mutable string",1,arguments);i(c,E,"string-set!","non-negative exact integer",2,arguments);i(d,U,"string-set!","char",3,arguments);if(jsnums.greaterThanOrEqual(c,b.length)){var e="string-set!: index "+n+" out of range [0, "+(b.length-1)+"] for string: "+types.toWrittenString(b);N(types.incompleteExn(types.exnFailContract,
e,[]))}b.set(jsnums.toFixnum(c),d.val);return types.VOID});b["string-fill!"]=new c("string-fill!",2,!1,!1,function(b,c){i(b,function(b){return z(b)&&typeof b!="string"},"string-fill!","mutable string",1,arguments);i(c,U,"string-fill!","char",2,arguments);for(var d=0;d<b.length;d++)b.set(d,c.val);return types.VOID});b["make-bytes"]=new h("make-bytes",[new c("make-bytes",1,!1,!1,function(b){i(b,E,"make-bytes","non-negative exact integer",1);for(var c=[],d=0;d<jsnums.toFixnum(b);d++)c.push(0);return types.bytes(c,
!0)}),new c("make-bytes",2,!1,!1,function(b,c){i(b,E,"make-bytes","non-negative exact integer",1,arguments);i(c,ra,"make-bytes","byte",2,arguments);for(var d=[],e=0;e<jsnums.toFixnum(b);e++)d.push(c);return types.bytes(d,!0)})]);b.bytes=new c("bytes",0,!0,!1,function(b){R(b,function(c,d){i(c,ra,"bytes","byte",d+1,b)});return types.bytes(b,!0)});b["bytes->immutable-bytes"]=new c("bytes->immutable-bytes",1,!1,!1,function(b){i(b,ba,"bytes->immutable-bytes","byte string",1);return b.mutable?b.copy(!1):
b});b["bytes-length"]=new c("bytes-length",1,!1,!1,function(b){i(b,ba,"bytes-length","byte string",1);return b.length()});b["bytes-ref"]=new c("bytes-ref",2,!1,!1,function(b,c){i(b,ba,"bytes-ref","byte string",1,arguments);i(c,E,"bytes-ref","non-negative exact integer",2,arguments);var d=jsnums.toFixnum(c);if(d>=b.length()){var e="bytes-ref: index "+d+" out of range [0, "+(b.length-1)+"] for byte-string: "+types.toWrittenString(b);N(types.incompleteExn(types.exnFailContract,e,[]))}return b.get(d)});
b["bytes-set!"]=new c("bytes-set!",3,!1,!1,function(b,c,d){i(b,function(b){return ba(b)&&b.mutable},"bytes-set!","mutable byte string",1,arguments);i(c,E,"bytes-set!","non-negative exact integer",2,arguments);i(d,ra,"bytes-set!","byte",3,arguments);var e=jsnums.toFixnum(c);if(e>=b.length()){var l="bytes-set!: index "+e+" out of range [0, "+(b.length-1)+"] for byte-string: "+types.toWrittenString(b);N(types.incompleteExn(types.exnFailContract,l,[]))}b.set(e,d);return types.VOID});b.subbytes=new h("subbytes",
[new c("subbytes",2,!1,!1,function(b,c){i(b,ba,"subbytes","bytes string",1,arguments);i(c,E,"subbytes","non-negative exact integer",2,arguments);var d=jsnums.toFixnum(c);if(d>b.length())d="subbytes: starting index "+d+" out of range [0, "+b.length+"] for byte-string: "+types.toWrittenString(b),N(types.incompleteExn(types.exnFailContract,d,[]));else return b.subbytes(jsnums.toFixnum(d))}),new c("subbytes",3,!1,!1,function(b,c,d){i(b,ba,"subbytes","byte string",1,arguments);i(c,E,"subbytes","non-negative exact integer",
2,arguments);i(d,E,"subbytes","non-negative exact integer",3,arguments);var e=jsnums.toFixnum(c),l=jsnums.toFixnum(d);if(e>b.length()){var h="subbytes: starting index "+e+" out of range [0, "+b.length()+"] for byte-string: "+types.toWrittenString(b);N(types.incompleteExn(types.exnFailContract,h,[]))}if(l<e||l>b.length())h="subbytes: ending index "+l+" out of range ["+e+", "+b.length()+"] for byte-string: "+types.toWrittenString(b),N(types.incompleteExn(types.exnFailContract,h,[]));else return b.subbytes(e,
l)})]);b["bytes-copy"]=new c("bytes-copy",1,!1,!1,function(b){i(b,ba,"bytes-copy","byte string",1);return b.copy(!0)});b["bytes-fill!"]=new c("bytes-fill!",2,!1,!1,function(b,c){i(b,function(b){return ba(b)&&b.mutable},"bytes-fill!","mutable byte string",1,arguments);i(c,ra,"bytes-fill!","byte",2,arguments);for(var d=0;d<b.length();d++)b.set(d,c);return types.VOID});b["bytes-append"]=new c("bytes-append",0,!0,!1,function(b){R(b,function(c,d){i(c,ba,"bytes-append","byte string",d+1,b)});for(var c=
[],d=0;d<b.length;d++)c=c.concat(b[d].bytes);return types.bytes(c,!0)});b["bytes->list"]=new c("bytes->list",1,!1,!1,function(b){i(b,ba,"bytes->list","byte string",1);for(var c=types.EMPTY,d=b.length()-1;d>=0;d--)c=types.cons(b.get(d),c);return c});b["list->bytes"]=new c("list->bytes",1,!1,!1,function(b){pa(b,ra,"list->bytes","byte",1);for(var c=[];!b.isEmpty();)c.push(b.first()),b=b.rest();return types.bytes(c,!0)});b["bytes=?"]=new c("bytes=?",2,!0,!1,function(b,c,d){d.unshift(c);d.unshift(b);R(d,
function(b,c){i(b,ba,"bytes=?","byte string",c+1,d)});return J(d,function(b,c){return b.toString()===c.toString()})});b["bytes<?"]=new c("bytes<?",2,!0,!1,function(b,c,d){d.unshift(c);d.unshift(b);R(d,function(b,c){i(b,ba,"bytes<?","byte string",c+1,d)});return J(d,function(b,c){return b.toString()<c.toString()})});b["bytes>?"]=new c("bytes>?",2,!0,!1,function(b,c,d){d.unshift(c);d.unshift(b);R(d,function(b,c){i(b,ba,"bytes>?","byte string",c+1,d)});return J(d,function(b,c){return b.toString()>c.toString()})});
b["make-vector"]=new c("make-vector",2,!1,!1,function(b,c){i(b,E,"make-vector","non-negative exact integer",1,arguments);for(var d=jsnums.toFixnum(b),e=[],l=0;l<d;l++)e.push(c);return types.vector(e)});b.vector=new c("vector",0,!0,!1,function(b){return types.vector(b)});b["vector-length"]=new c("vector-length",1,!1,!1,function(b){i(b,O,"vector-length","vector",1);return b.length()});b["vector-ref"]=new c("vector-ref",2,!1,!1,function(b,c){i(b,O,"vector-ref","vector",1,arguments);i(c,E,"vector-ref",
"non-negative exact integer",2,arguments);var d=jsnums.toFixnum(c);if(d>=b.length()){var e="vector-ref: index "+d+" out of range [0, "+(b.length()-1)+"] for vector: "+types.toWrittenString(b);N(types.incompleteExn(types.exnFailContract,e,[]))}return b.ref(d)});b["vector-set!"]=new c("vector-set!",3,!1,!1,function(b,c,d){i(b,O,"vector-set!","vector",1,arguments);i(c,E,"vector-set!","non-negative exact integer",2,arguments);var e=jsnums.toFixnum(c);if(e>=b.length()){var l="vector-set!: index "+e+" out of range [0, "+
(b.length()-1)+"] for vector: "+types.toWrittenString(b);N(types.incompleteExn(types.exnFailContract,l,[]))}b.set(e,d);return types.VOID});b["vector->list"]=new c("vector->list",1,!1,!1,function(b){i(b,O,"vector->list","vector",1);return b.toList()});b["list->vector"]=new c("list->vector",1,!1,!1,function(b){ta(b,"list->vector",1);return types.vector(helpers.schemeListToArray(b))});b["build-vector"]=new c("build-vector",2,!1,!1,function(b,c){i(b,E,"build-vector","non-negative exact integer",1,arguments);
i(c,o,"build-vector","procedure",2,arguments);var e=function(l,i){if(jsnums.greaterThanOrEqual(l,b))return types.vector(i);return d(c,[l],function(b){return e(l+1,i.push(b))})};return e(0,[])});b["char=?"]=new c("char=?",2,!0,!1,function(b,c,d){d.unshift(c);d.unshift(b);R(d,function(b,c){i(b,U,"char=?","char",c+1,d)});return J(d,function(b,c){return b.val===c.val})});b["char<?"]=new c("char<?",2,!0,!1,function(b,c,d){d.unshift(c);d.unshift(b);R(d,function(b,c){i(b,U,"char<?","char",c+1,d)});return J(d,
function(b,c){return b.val<c.val})});b["char>?"]=new c("char>?",2,!0,!1,function(b,c,d){d.unshift(c);d.unshift(b);R(d,function(b,c){i(b,U,"char>?","char",c+1,d)});return J(d,function(b,c){return b.val>c.val})});b["char<=?"]=new c("char<=?",2,!0,!1,function(b,c,d){d.unshift(c);d.unshift(b);R(d,function(b,c){i(b,U,"char<=?","char",c+1,d)});return J(d,function(b,c){return b.val<=c.val})});b["char>=?"]=new c("char>=?",2,!0,!1,function(b,c,d){d.unshift(c);d.unshift(b);R(d,function(b,c){i(b,U,"char>=?",
"char",c+1,d)});return J(d,function(b,c){return b.val>=c.val})});b["char-ci=?"]=new c("char-ci=?",2,!0,!1,function(b,c,d){d.unshift(c);d.unshift(b);R(d,function(b,c){i(b,U,"char-ci=?","char",c+1,d)});return J(d,function(b,c){return b.val.toLowerCase()===c.val.toLowerCase()})});b["char-ci<?"]=new c("char-ci<?",2,!0,!1,function(b,c,d){d.unshift(c);d.unshift(b);R(d,function(b,c){i(b,U,"char-ci<?","char",c+1,d)});return J(d,function(b,c){return b.val.toLowerCase()<c.val.toLowerCase()})});b["char-ci>?"]=
new c("char-ci>?",2,!0,!1,function(b,c,d){d.unshift(c);d.unshift(b);R(d,function(b,c){i(b,U,"char-ci>?","char",c+1,d)});return J(d,function(b,c){return b.val.toLowerCase()>c.val.toLowerCase()})});b["char-ci<=?"]=new c("char-ci<=?",2,!0,!1,function(b,c,d){d.unshift(c);d.unshift(b);R(d,function(b,c){i(b,U,"char-ci<=?","char",c+1,d)});return J(d,function(b,c){return b.val.toLowerCase()<=c.val.toLowerCase()})});b["char-ci>=?"]=new c("char-ci>=?",2,!0,!1,function(b,c,d){d.unshift(c);d.unshift(b);R(d,function(b,
c){i(b,U,"char-ci>=?","char",c+1,d)});return J(d,function(b,c){return b.val.toLowerCase()>=c.val.toLowerCase()})});b["char-alphabetic?"]=new c("char-alphabetic?",1,!1,!1,function(b){i(b,U,"char-alphabetic?","char",1);return ca(b.val)});b["char-numeric?"]=new c("char-numeric?",1,!1,!1,function(b){i(b,U,"char-numeric?","char",1);return b.val>="0"&&b.val<="9"});b["char-whitespace?"]=new c("char-whitespace?",1,!1,!1,function(b){i(b,U,"char-whitespace?","char",1);return la(b.val)});b["char-upper-case?"]=
new c("char-upper-case?",1,!1,!1,function(b){i(b,U,"char-upper-case?","char",1);return ca(b.val)&&b.val.toUpperCase()===b.val});b["char-lower-case?"]=new c("char-lower-case?",1,!1,!1,function(b){i(b,U,"char-lower-case?","char",1);return ca(b.val)&&b.val.toLowerCase()===b.val});b["char->integer"]=new c("char->integer",1,!1,!1,function(b){i(b,U,"char->integer","char",1);return b.val.charCodeAt(0)});b["integer->char"]=new c("integer->char",1,!1,!1,function(b){i(b,function(b){if(!y(b))return!1;b=jsnums.toFixnum(b);
return b>=0&&b<55296||b>57343&&b<=1114111},"integer->char","exact integer in [0,#x10FFFF], not in [#xD800,#xDFFF]",1);return types["char"](String.fromCharCode(jsnums.toFixnum(b)))});b["char-upcase"]=new c("char-upcase",1,!1,!1,function(b){i(b,U,"char-upcase","char",1);return types["char"](b.val.toUpperCase())});b["char-downcase"]=new c("char-downcase",1,!1,!1,function(b){i(b,U,"char-downcase","char",1);return types["char"](b.val.toLowerCase())});b["make-posn"]=new c("make-posn",2,!1,!1,function(b,
c){return types.posn(b,c)});b["posn-x"]=new c("posn-x",1,!1,!1,function(b){i(b,types.isPosn,"posn-x","posn",1);return types.posnX(b)});b["posn-y"]=new c("posn-y",1,!1,!1,function(b){i(b,types.isPosn,"posn-y","posn",1);return types.posnY(b)});b["key=?"]=new c("key=?",2,!1,!1,function(b,c){types.isChar(b)&&(b=b.getValue());types.isChar(c)&&(c=c.getValue());return b.toString().toLowerCase()===c.toString().toLowerCase()});b["image?"]=new c("image?",1,!1,!1,S);b["image=?"]=new c("image=?",2,!1,!1,function(b,
c){i(b,S,"image=?","image",1);i(c,S,"image=?","image",2);return oa(b,c)});b["make-color"]=new c("make-color",3,!1,!1,function(b,c,d){i(b,ra,"make-color","number between 0 and 255",1,arguments);i(c,ra,"make-color","number between 0 and 255",2,arguments);i(d,ra,"make-color","number between 0 and 255",3,arguments);return types.color(jsnums.toFixnum(b),jsnums.toFixnum(c),jsnums.toFixnum(d))});b["color-red"]=new c("color-red",1,!1,!1,function(b){i(b,types.isColor,"color-red","color",1);return types.colorRed(b)});
b["color-green"]=new c("color-green",1,!1,!1,function(b){i(b,types.isColor,"color-green","color",1);return types.colorGreen(b)});b["color-blue"]=new c("color-blue",1,!1,!1,function(b){i(b,types.isColor,"color-blue","color",1);return types.colorBlue(b)});b["empty-scene"]=new c("empty-scene",2,!1,!1,function(b,c){i(b,$,"empty-scene","non-negative number",1,arguments);i(c,$,"empty-scene","non-negative number",2,arguments);return world.Kernel.sceneImage(jsnums.toFixnum(b),jsnums.toFixnum(c),[],!0)});
b["place-image"]=new c("place-image",4,!1,!1,function(b,c,d,l){i(b,S,"place-image","image",1,arguments);i(c,e,"place-image","real",2,arguments);i(d,e,"place-image","real",3,arguments);i(l,function(b){return za(b)||S(b)},"place-image","image",4,arguments);if(za(l))return l.add(b,jsnums.toFixnum(c),jsnums.toFixnum(d));else{var h=world.Kernel.sceneImage(l.getWidth(),l.getHeight(),[],!1),h=h.add(l.updatePinhole(0,0),0,0);return h=h.add(b,jsnums.toFixnum(c),jsnums.toFixnum(d))}});b["place-image/align"]=
new c("place-image/align",6,!1,!1,function(b,c,d,l,h,o){i(b,S,"place-image/align","image",1,arguments);i(c,e,"place-image/align","real",2,arguments);i(d,e,"place-image/align","real",3,arguments);i(l,Oa,"place-image/align","x-place",4,arguments);i(h,Ua,"place-image/align","y-place",5,arguments);i(o,function(b){return za(b)||S(b)},"place-image/align","image",6,arguments);l=="left"?c+=b.pinholeX:l=="right"&&(c-=b.pinholeX);h=="top"?d+=b.pinholeY:h=="bottom"&&(d-=b.pinholeY);if(za(o))return o.add(b,jsnums.toFixnum(c),
jsnums.toFixnum(d));else{var k=world.Kernel.sceneImage(o.getWidth(),o.getHeight(),[],!1),k=k.add(o.updatePinhole(0,0),0,0);return k=k.add(b,jsnums.toFixnum(c),jsnums.toFixnum(d))}});b["scene+line"]=new c("scene+line",6,!1,!1,function(b,c,d,l,h,o){i(b,S,"scene+line","image",1,arguments);i(c,e,"scene+line","finite real number",2,arguments);i(d,e,"scene+line","finite real number",3,arguments);i(l,e,"scene+line","finite real number",4,arguments);i(h,e,"scene+line","finite real number",5,arguments);i(o,
qa,"scene+line","color",6,arguments);ea.get(o)&&(o=ea.get(o));newScene=world.Kernel.sceneImage(jsnums.toFixnum(b.getWidth()),jsnums.toFixnum(b.getHeight()),[],!0);newScene=newScene.add(b.updatePinhole(0,0),0,0);line=world.Kernel.lineImage(jsnums.toFixnum(l-c),jsnums.toFixnum(h-d),o,!1);return newScene.add(line,jsnums.toFixnum(c),jsnums.toFixnum(d))});b["put-pinhole"]=new c("put-pinhole",3,!1,!1,function(b,c,d){i(b,S,"put-pinhole","image",1,arguments);i(c,e,"put-pinhole","real",2,arguments);i(d,e,
"put-pinhole","real",3,arguments);return b.updatePinhole(jsnums.toFixnum(c),jsnums.toFixnum(d))});b.circle=new c("circle",3,!1,!1,function(b,c,d){i(b,$,"circle","non-negative number",1,arguments);i(c,Aa,"circle","style",2,arguments);i(d,qa,"circle","color",3,arguments);ea.get(d)&&(d=ea.get(d));return world.Kernel.circleImage(jsnums.toFixnum(b),c.toString(),d)});b.star=new h("star",[new c("star",5,!1,!1,function(b,c,d,e,l){i(b,na,"star","positive integer greater than or equal to 3",1,arguments);i(c,
$,"star","positive number",2,arguments);i(d,$,"star","positive number",3,arguments);i(e,Aa,"star","style",4,arguments);i(l,qa,"star","color",5,arguments);ea.get(l)&&(l=ea.get(l));return world.Kernel.starImage(jsnums.toFixnum(b),jsnums.toFixnum(c),jsnums.toFixnum(d),e.toString(),l)}),new c("star",3,!1,!1,function(b,c,d){i(b,$,"star","non-negative number",1,arguments);i(c,Aa,"star","style",2,arguments);i(d,qa,"star","color",3,arguments);ea.get(d)&&(d=ea.get(d));return world.Kernel.polygonImage(jsnums.toFixnum(b),
jsnums.toFixnum(5),jsnums.toFixnum(2),c.toString(),d)})]);b["radial-star"]=new c("radial-star",5,!1,!1,function(b,c,d,l,h){i(b,function(b){return E(b)&&jsnums.greaterThanOrEqual(b,2)},"radial-star","positive integer greater than or equal to 2",1,arguments);i(c,function(b){return e(b)&&jsnums.greaterThan(b,0)},"radial-star","positive number",2,arguments);i(d,function(b){return e(b)&&jsnums.greaterThan(b,0)},"radial-star","positive number",2,arguments);i(l,Aa,"radial-star","style",4,arguments);i(h,
qa,"radial-star","color",5,arguments);ea.get(h)&&(h=ea.get(h));return world.Kernel.starImage(jsnums.toFixnum(b),jsnums.toFixnum(c),jsnums.toFixnum(d),l.toString(),h)});b["nw:rectangle"]=new c("nw:rectangle",4,!1,!1,function(b,c,d,e){i(b,$,"nw:rectangle","non-negative number",1,arguments);i(c,$,"nw:rectangle","non-negative number",2,arguments);i(d,Aa,"nw:rectangle","style",3,arguments);i(e,qa,"nw:rectangle","color",4,arguments);ea.get(e)&&(e=ea.get(e));return world.Kernel.rectangleImage(jsnums.toFixnum(b),
jsnums.toFixnum(c),d.toString(),e).updatePinhole(0,0)});b.rectangle=new c("rectangle",4,!1,!1,function(b,c,d,e){i(b,$,"rectangle","non-negative number",1,arguments);i(c,$,"rectangle","non-negative number",2,arguments);i(d,Aa,"rectangle","style",3,arguments);i(e,qa,"rectangle","color",4,arguments);ea.get(e)&&(e=ea.get(e));return world.Kernel.rectangleImage(jsnums.toFixnum(b),jsnums.toFixnum(c),d.toString(),e)});b["regular-polygon"]=new c("regular-polygon",4,!1,!1,function(b,c,d,e){i(b,$,"regular-polygon",
"non-negative number",1,arguments);i(c,na,"regular-polygon","positive integer greater than or equal to 3",2,arguments);i(d,Aa,"regular-polygon","style",3,arguments);i(e,qa,"regular-polygon","color",4,arguments);ea.get(e)&&(e=ea.get(e));return world.Kernel.polygonImage(jsnums.toFixnum(b),jsnums.toFixnum(c),jsnums.toFixnum(1),d.toString(),e)});b["star-polygon"]=new c("star-polygon",5,!1,!1,function(b,c,d,e,l){i(b,$,"star-polygon","non-negative number",1,arguments);i(c,na,"star-polygon","positive integer greater than or equal to 3",
2,arguments);i(d,va,"star-polygon","positive integer greater than or equal to 1",3,arguments);i(e,Aa,"star-polygon","style",4,arguments);i(l,qa,"star-polygon","color",5,arguments);ea.get(l)&&(l=ea.get(l));return world.Kernel.polygonImage(jsnums.toFixnum(b),jsnums.toFixnum(c),jsnums.toFixnum(d),e.toString(),l)});b.rhombus=new c("rhombus",4,!1,!1,function(b,c,d,e){i(b,$,"rhombus","non-negative number",1,arguments);i(c,$,"rhombus","non-negative number",2,arguments);i(d,Aa,"rhombus","style",3,arguments);
i(e,qa,"rhombus","color",4,arguments);ea.get(e)&&(e=ea.get(e));return world.Kernel.rhombusImage(jsnums.toFixnum(b),jsnums.toFixnum(c),d.toString(),e)});b.square=new c("square",3,!1,!1,function(b,c,d){i(b,$,"square","non-negative number",1,arguments);i(c,Aa,"square","style",3,arguments);i(d,qa,"square","color",4,arguments);ea.get(d)&&(d=ea.get(d));return world.Kernel.squareImage(jsnums.toFixnum(b),c.toString(),d)});b.triangle=new c("triangle",3,!1,!1,function(b,c,d){i(b,$,"triangle","non-negative number",
1,arguments);i(c,Aa,"triangle","style",2,arguments);i(d,qa,"triangle","color",3,arguments);ea.get(d)&&(d=ea.get(d));return world.Kernel.triangleImage(jsnums.toFixnum(b),60,c.toString(),d)});b["right-triangle"]=new c("right-triangle",4,!1,!1,function(b,c,d,e){i(b,$,"right-triangle","non-negative number",1,arguments);i(c,$,"right-triangle","non-negative number",2,arguments);i(d,Aa,"right-triangle","style",3,arguments);i(e,qa,"right-triangle","color",4,arguments);ea.get(e)&&(e=ea.get(e));return world.Kernel.rightTriangleImage(jsnums.toFixnum(b),
jsnums.toFixnum(c),d.toString(),e)});b["isosceles-triangle"]=new c("isosceles-triangle",4,!1,!1,function(b,c,d,e){i(b,$,"isosceles-triangle","non-negative number",1,arguments);i(c,G,"isosceles-triangle","finite real number between 0 and 360",2,arguments);i(d,Aa,"isosceles-triangle","style",3,arguments);i(e,qa,"isosceles-triangle","color",4,arguments);ea.get(e)&&(e=ea.get(e));return world.Kernel.triangleImage(jsnums.toFixnum(b),jsnums.toFixnum(c),d.toString(),e)});b.ellipse=new c("ellipse",4,!1,!1,
function(b,c,d,e){i(b,$,"ellipse","non-negative number",1,arguments);i(c,$,"ellipse","non-negative number",2,arguments);i(d,Aa,"ellipse","string",3,arguments);i(e,qa,"ellipse","color",4,arguments);ea.get(e)&&(e=ea.get(e));return world.Kernel.ellipseImage(jsnums.toFixnum(b),jsnums.toFixnum(c),d.toString(),e)});b.line=new c("line",3,!1,!1,function(b,c,d){i(b,e,"line","finite real number",1,arguments);i(c,e,"line","finite real number",2,arguments);i(d,qa,"line","color",3,arguments);ea.get(d)&&(d=ea.get(d));
return world.Kernel.lineImage(jsnums.toFixnum(b),jsnums.toFixnum(c),d,!0)});b["add-line"]=new c("add-line",6,!1,!1,function(b,c,d,l,h,o){i(b,S,"add-line","image",1,arguments);i(c,e,"add-line","finite real number",2,arguments);i(d,e,"add-line","finite real number",3,arguments);i(l,e,"add-line","finite real number",4,arguments);i(h,e,"add-line","finite real number",5,arguments);i(o,qa,"add-line","color",6,arguments);ea.get(o)&&(o=ea.get(o));line=world.Kernel.lineImage(jsnums.toFixnum(l-c),jsnums.toFixnum(h-
d),o,!0);return world.Kernel.overlayImage(line,b,c,d)});b.overlay=new c("overlay",2,!0,!1,function(b,c,d){i(b,S,"overlay","image",1,arguments);i(c,S,"overlay","image",2,arguments);R(d,function(b,c){i(b,S,"overlay","image",c+3)},arguments);for(var e=world.Kernel.overlayImage(b,c,"middle","middle"),l=0;l<d.length;l++)e=world.Kernel.overlayImage(e,d[l],"middle","middle");return e});b["overlay/xy"]=new c("overlay/xy",4,!1,!1,function(b,c,d,l){i(b,S,"overlay/xy","image",1,arguments);i(c,e,"overlay/xy",
"finite real number",2,arguments);i(d,e,"overlay/xy","finite real number",3,arguments);i(l,S,"overlay/xy","image",4,arguments);return world.Kernel.overlayImage(b.updatePinhole(0,0),l.updatePinhole(0,0),jsnums.toFixnum(c),jsnums.toFixnum(d))});b["overlay/align"]=new c("overlay/align",4,!0,!1,function(b,c,d,e,l){i(b,Oa,"overlay/align","x-place",1,arguments);i(c,Ua,"overlay/align","y-place",2,arguments);i(d,S,"overlay/align","image",3,arguments);i(e,S,"overlay/align","image",4,arguments);R(l,function(b,
c){i(b,S,"overlay/align","image",c+4)},arguments);for(var h=world.Kernel.overlayImage(d,e,b.toString(),c.toString()),o=0;o<l.length;o++)h=world.Kernel.overlayImage(h,l[o],b.toString(),c.toString());return h});b.underlay=new c("underlay",2,!0,!1,function(b,c,d){i(b,S,"underlay","image",1,arguments);i(c,S,"underlay","image",2,arguments);R(d,function(b,c){i(b,S,"underlay","image",c+3)},arguments);for(var e=world.Kernel.overlayImage(c,b,0,0),l=0;l<d.length;l++)e=world.Kernel.overlayImage(d[l],e,0,0);
return e});b["underlay/xy"]=new c("underlay/xy",4,!1,!1,function(b,c,d,l){i(b,S,"underlay/xy","image",1,arguments);i(c,e,"underlay/xy","finite real number",2,arguments);i(d,e,"underlay/xy","finite real number",3,arguments);i(l,S,"underlay/xy","image",4,arguments);return world.Kernel.overlayImage(l.updatePinhole(0,0),b.updatePinhole(0,0),-jsnums.toFixnum(c),-jsnums.toFixnum(d))});b["underlay/align"]=new c("underlay/align",4,!0,!1,function(b,c,d,e,l){i(b,Oa,"underlay/align","x-place",1,arguments);i(c,
Ua,"underlay/align","y-place",2,arguments);i(d,S,"underlay/align","image",3,arguments);i(e,S,"underlay/align","image",4,arguments);R(l,function(b,c){i(b,S,"underlay/align","image",c+4)},arguments);for(var h=world.Kernel.overlayImage(e,d,b.toString(),c.toString()),o=0;o<l.length;o++)h=world.Kernel.overlayImage(l[o],h,b.toString(),c.toString());return h});b.beside=new c("beside",2,!0,!1,function(b,c,d){i(b,S,"beside","image",1,arguments);i(c,S,"beside","image",2,arguments);R(d,function(b,c){i(b,S,"beside",
"image",c+4)},arguments);for(var e=world.Kernel.overlayImage(b,c,"beside","middle"),l=0;l<d.length;l++)e=world.Kernel.overlayImage(e,d[l],"beside","middle");return e});b["beside/align"]=new c("beside/align",3,!0,!1,function(b,c,d,e){i(b,Ua,"beside/align","y-place",1,arguments);i(c,S,"beside/align","image",2,arguments);i(d,S,"beside/align","image",3,arguments);R(e,function(b,c){i(b,S,"beside","image",c+3)},arguments);for(var l=world.Kernel.overlayImage(c,d,"beside",b.toString()),h=0;h<e.length;h++)l=
world.Kernel.overlayImage(l,e[h],"beside",b.toString());return l});b.above=new c("above",2,!0,!1,function(b,c,d){i(b,S,"above","image",1,arguments);i(c,S,"above","image",2,arguments);R(d,function(b,c){i(b,S,"above","image",c+4)},arguments);for(var e=world.Kernel.overlayImage(b,c,"middle","above"),l=0;l<d.length;l++)e=world.Kernel.overlayImage(e,d[l],"middle","above");return e});b["above/align"]=new c("above/align",3,!0,!1,function(b,c,d,e){i(b,Oa,"above/align","x-place",1,arguments);i(c,S,"above/align",
"image",1,arguments);i(d,S,"above/align","image",2,arguments);R(e,function(b,c){i(b,S,"above/align","image",c+4)},arguments);for(var l=world.Kernel.overlayImage(c,d,b.toString(),"above"),h=0;h<e.length;h++)l=world.Kernel.overlayImage(l,e[h],b.toString(),"above");return l});b.rotate=new c("rotate",2,!1,!1,function(b,c){i(b,G,"rotate","finite real number between 0 and 360",1,arguments);i(c,S,"rotate","image",2,arguments);return world.Kernel.rotateImage(jsnums.toFixnum(-b),c)});b["scale/xy"]=new c("scale/xy",
3,!1,!1,function(b,c,d){i(b,e,"scale/xy","finite real number",1,arguments);i(c,e,"scale/xy","finite real number",2,arguments);i(d,S,"scale/xy","image",3,arguments);return world.Kernel.scaleImage(jsnums.toFixnum(b),jsnums.toFixnum(c),d)});b.scale=new c("scale",2,!1,!1,function(b,c){i(b,e,"scale","finite real number",1,arguments);i(c,S,"scale","image",2,arguments);return world.Kernel.scaleImage(jsnums.toFixnum(b),jsnums.toFixnum(b),c)});b.crop=new c("crop",5,!1,!1,function(b,c,d,l,h){i(b,e,"crop","finite real number",
1,arguments);i(c,e,"crop","finite real number",2,arguments);i(d,$,"crop","positive real number",3,arguments);i(l,$,"crop","positive real number",4,arguments);i(h,S,"crop","image",5,arguments);return world.Kernel.cropImage(jsnums.toFixnum(b),jsnums.toFixnum(c),jsnums.toFixnum(d),jsnums.toFixnum(l),h)});b.frame=new c("frame",1,!1,!1,function(b){i(b,S,"frame","image",1,arguments);return world.Kernel.frameImage(b)});b["flip-vertical"]=new c("flip-vertical",1,!1,!1,function(b){i(b,S,"flip-vertical","image",
1,arguments);return world.Kernel.flipImage(b,"vertical")});b["flip-horizontal"]=new c("flip-horizontal",1,!1,!1,function(b){i(b,S,"flip-horizontal","image",1,arguments);return world.Kernel.flipImage(b,"horizontal")});b.text=new c("text",3,!1,!1,function(b,c,d){i(b,z,"text","string",1,arguments);i(c,function(b){return E(b)&&jsnums.greaterThan(b,0)&&ra(b)},"text","exact integer between 1 and 255",2,arguments);i(d,qa,"text","color",3,arguments);ea.get(d)&&(d=ea.get(d));return world.Kernel.textImage(b.toString(),
jsnums.toFixnum(c),d,"normal","Optimer","","",!1)});b["text/font"]=new c("text/font",8,!1,!1,function(b,c,d,e,h,o,k,m){i(b,z,"text/font","string",1,arguments);i(c,function(b){return E(b)&&jsnums.greaterThan(b,0)&&ra(b)},"text/font","exact integer between 1 and 255",2,arguments);i(d,qa,"text/font","color",3,arguments);i(e,function(b){return z(b)||!b},"text/font","face",4,arguments);i(h,Ea,"text/font","family",5,arguments);i(o,u,"text/font","style",6,arguments);i(k,Z,"text/font","weight",7,arguments);
i(m,l,"text/font","underline?",8,arguments);ea.get(d)&&(d=ea.get(d));try{return world.Kernel.textImage(b.toString(),jsnums.toFixnum(c),d,e.toString(),h.toString(),o.toString(),k.toString(),m)}catch(q){return world.Kernel.textImage(b.toString(),jsnums.toFixnum(c),d,"normal","Optimer","","",!1)}});b["bitmap/url"]=b["image-url"]=new c("image-url",1,!1,!0,function(b,c){i(c,z,"image-url","string",1);var d=c.toString(),c=b.getImageProxyHook()?b.getImageProxyHook()+"?url="+encodeURIComponent(c.toString()):
c.toString();return m(function(b){var g=new Image;g.onload=function(){world.Kernel.fileImage(c,g,b)};g.onerror=function(){b(types.schemeError(types.incompleteExn(types.exnFail," (unable to load: "+d+")",[])))};g.src=c})});b["open-image-url"]=b["image-url"];b["video-url"]=new c("video-url",1,!1,!0,function(b,c){i(c,z,"video-url","string",1);return m(function(b){var d=document.createElement("video");d.src=c.toString();d.addEventListener("canplay",function(){b(world.Kernel.videoImage(c.toString(),d))});
d.addEventListener("error",function(){b(types.schemeError(types.incompleteExn(types.exnFail," (unable to load: "+c+")",[])))});d.src=c.toString()})});b["image-width"]=new c("image-width",1,!1,!1,function(b){i(b,S,"image-width","image",1);return b.getWidth()});b["image-height"]=new c("image-height",1,!1,!1,function(b){i(b,S,"image-height","image",1);return b.getHeight()});b["image-baseline"]=new c("image-baseline",1,!1,!1,function(b){i(b,S,"image-baseline","image",1);return b.getBaseline()});b["image->color-list"]=
new c("image->color-list",1,!1,!1,function(b){i(b,S,"image->color-list","image",1);var c=b.getWidth(),d=b.getHeight(),e=world.Kernel.makeCanvas(c,d).getContext("2d"),l;b.render(e,0,0);for(var b=e.getImageData(0,0,c,d).data,h=[],c=0;c<b.length;c+=4)d=b[c],e=b[c+1],l=b[c+2],h.push(types.color(d,e,l));return types.list(h)});b["color-list->image"]=new c("color-list->image",5,!1,!1,function(b,c,d,e,l){pa(b,qa,"color-list->image","image",1);i(c,E,"color-list->image","natural",2);i(d,E,"color-list->image",
"natural",3);i(e,E,"color-list->image","natural",4);i(l,E,"color-list->image","natural",5);c=world.Kernel.makeCanvas(jsnums.toFixnum(c),jsnums.toFixnum(d)).getContext("2d").createImageData(jsnums.toFixnum(c),jsnums.toFixnum(d));d=c.data;for(l=0;b!==types.EMPTY;)e=b.first(),d[l]=jsnums.toFixnum(types.colorRed(e)),d[l+1]=jsnums.toFixnum(types.colorGreen(e)),d[l+2]=jsnums.toFixnum(types.colorBlue(e)),d[l+3]=255,l+=4,b=b.rest();return world.Kernel.imageDataImage(c)});b["mode?"]=new c("mode?",1,!1,!1,
Aa);b["image-color?"]=new c("image-color?",1,!1,!1,qa);b["x-place?"]=new c("x-place?",1,!1,!1,Oa);b["y-place?"]=new c("y-place?",1,!1,!1,Ua);b["angle?"]=new c("angle?",1,!1,!1,G);b["side-count?"]=new c("side-count?",1,!1,!1,na);b["step-count?"]=new c("step-count?",1,!1,!1,va);var Ta=D.extend({init:function(b,c,d){this._super("on-tick");this.handler=b;this.effectHandler=c;this.aDelay=d},configure:function(b){var c={onTick:this.handler,onTickEffect:this.effectHandler,tickDelay:jsnums.toFixnum(jsnums.multiply(1E3,
this.aDelay))};return b.updateAll(c)}}),La=types.rational(1,28);b["on-tick"]=new h("on-tick",[new c("on-tick",1,!1,!1,function(b){i(b,o,"on-tick","procedure",1);return new Ta(b,new c("",1,!1,!1,function(){return types.effectDoNothing()}),La)}),new c("on-tick",2,!1,!1,function(b,d){i(b,o,"on-tick","procedure",1,arguments);i(d,k,"on-tick","number",2,arguments);return new Ta(b,new c("",1,!1,!1,function(){return types.effectDoNothing()}),d)})]);b["on-tick!"]=new h("on-tick!",[new c("on-tick!",2,!1,!1,
function(b,c){i(b,o,"on-tick!","procedure",1,arguments);i(c,o,"on-tick!","procedure",2,arguments);return new Ta(b,c,La)}),new c("on-tick!",3,!1,!1,function(b,c,d){i(b,o,"on-tick!","procedure",1,arguments);i(c,o,"on-tick!","procedure",2,arguments);i(d,k,"on-tick!","number",3,arguments);return new Ta(b,c,d)})]);b["on-key"]=new c("on-key",1,!1,!1,W("on-key","onKey",2));b["on-key!"]=new c("on-key!",2,!1,!1,ga("on-key!","onKey"));b["stop-when"]=new c("stop-when",1,!1,!1,W("stop-when","stopWhen",1));b["stop-when!"]=
new c("stop-when!",2,!1,!1,ga("stop-when!","stopWhen"));b["on-redraw"]=new c("on-redraw",1,!1,!1,function(b){i(b,o,"on-redraw","procedure",1);return new (D.extend({init:function(){this._super("on-redraw")},configure:function(c){return c.updateAll({onRedraw:b})}}))});b["to-draw"]=new c("to-draw",1,!1,!1,function(b){i(b,o,"to-draw","procedure",1);return new (D.extend({init:function(){this._super("on-redraw")},configure:function(c){return c.updateAll({onRedraw:b})}}))});b["on-draw"]=new h("on-draw",
[new c("on-draw",1,!1,!1,function(b){i(b,o,"on-draw","procedure",1);return new (D.extend({init:function(){this._super("on-draw")},configure:function(c){return c.updateAll({onDraw:b})}}))}),new c("on-draw",2,!1,!1,function(b,c){i(b,o,"on-draw","procedure",1,arguments);i(c,o,"on-draw","procedure",2,arguments);return new (D.extend({init:function(){this._super("on-draw")},configure:function(d){return d.updateAll({onDraw:b,onDrawCss:c})}}))})]);b["initial-effect"]=new c("initial-effect",1,!1,!1,function(b){return new (D.extend({init:function(){this._super("initial-effect")},
configure:function(c){return c.updateAll({initialEffect:b})}}))});var Ba=function(b){pa(b,function(b){return Y(b)&&w(b)==2},"js-p","list of (list of X Y)",1);var b=fa(b),c=jsworld.MobyJsworld.p(b);c.toWrittenString=function(){return"(js-p)"};c.toDisplayedString=c.toWrittenString;c.toDomNode=function(){return c};return helpers.wrapJsObject(c)};b["js-p"]=new h("js-p",[new c("js-p",0,!1,!1,function(){return Ba(types.EMPTY)}),new c("js-p",1,!1,!1,Ba)]);var ab=function(b){pa(b,Na,"js-div","(listof X Y)",
1);var b=fa(b),c=jsworld.MobyJsworld.div(b);c.toWrittenString=function(){return"(js-div)"};c.toDisplayedString=c.toWrittenString;c.toDomNode=function(){return c};return helpers.wrapJsObject(c)};b["js-div"]=new h("js-div",[new c("js-div",0,!1,!1,function(){return ab(types.EMPTY)}),new c("js-div",1,!1,!1,ab)]);var ka=function(b){return function(c,d,e){i(c,o,b,"procedure",1);i(d,o,b,"procedure",2);pa(e,Na,b,"(listof X Y)",3);var e=e?fa(e):{},l=jsworld.MobyJsworld.buttonBang(c,d,e);l.toWrittenString=
function(){return"("+b+" ...)"};l.toDisplayedString=l.toWrittenString;l.toDomNode=function(){return l};return helpers.wrapJsObject(l)}},X=function(b,c){var d=new types.PrimProc("",1,!1,!1,function(){return types.EMPTY});return ka("js-button")(b,d,c)};b["js-button"]=new h("js-button",[new c("js-button",1,!1,!1,X),new c("js-button",2,!1,!1,X)]);b["js-button!"]=new h("js-button!",[new c("js-button!",2,!1,!1,ka("js-button!")),new c("js-button!",3,!1,!1,ka("js-button!"))]);X=function(b,c,d){i(b,z,"js-input",
"string",1);i(c,o,"js-input","procedure",2);pa(d,Na,"js-input","(listof X Y)",3);var d=d?fa(d):{},e=jsworld.MobyJsworld.input(b,c,d);e.toWrittenString=function(){return"(js-input ...)"};e.toDisplayedString=e.toWrittenString;e.toDomNode=function(){return e};return helpers.wrapJsObject(e)};b["js-input"]=new h("js-input",[new c("js-input",2,!1,!1,X),new c("js-input",3,!1,!1,X)]);var Ca=function(b,c){i(b,z,"js-img","string",1);pa(c,Na,"js-img","(listof X Y)",2);var d=fa(c),e=jsworld.MobyJsworld.img(b,
d);e.toWrittenString=function(){return"(js-img ...)"};e.toDisplayedString=e.toWrittenString;e.toDomNode=function(){return e};return helpers.wrapJsObject(e)};b["js-img"]=new h("js-img",[new c("js-img",1,!1,!1,function(b){return Ca(b,types.EMPTY)}),new c("js-img",2,!1,!1,Ca)]);b["js-text"]=new c("js-text",1,!1,!1,function(b){i(b,z,"js-text","string",1);var c=jsworld.MobyJsworld.text(b,[]);c.toWrittenString=function(){return"(js-text ...)"};c.toDisplayedString=c.toWrittenString;c.toDomNode=function(){return c};
return helpers.wrapJsObject(c)});X=function(b,c,d){pa(b,z,"js-select","listof string",1);i(c,o,"js-select","procedure",2);pa(d,Na,"js-select","(listof X Y)",3);var d=d?fa(d):{},b=helpers.deepListToArray(b),e=jsworld.MobyJsworld.select(b,c,d);e.toWrittenString=function(){return"(js-select ...)"};e.toDisplayedString=e.toWrittenString;e.toDomNode=function(){return e};return helpers.wrapJsObject(e)};b["js-select"]=new h("js-select",[new c("js-select",2,!1,!1,X),new c("js-select",3,!1,!1,X)]);b["big-bang"]=
b["js-big-bang"]=new c("js-big-bang",1,!0,!0,function(b,c,d){R(d,function(b,c){i(b,function(b){return b instanceof D||Y(b)||types.isWorldConfig(b)},"js-big-bang","handler or attribute list",c+2)});var e=helpers.map(function(b){return b instanceof D?function(c){return b.configure(c)}:b},d);return m(function(d,l){var i,h=function(){i.breaker()};b.addBreakRequestedListener(h);i=jsworld.MobyJsworld.bigBang(c,b.getToplevelNodeHook()(),e,l,function(c){b.removeBreakRequestedListener(h);d(c)})})});var Za=
function(b){pa(b,Na,"empty-page","(listof X Y)",1);b=fa(b);return jsworld.MobyJsworld.emptyPage(b)};b["empty-page"]=new h("empty-page",[new c("empty-page",0,!1,!1,function(){return Za(types.EMPTY)}),new c("empty-page",1,!1,!1,Za)]);b["place-on-page"]=new c("empty-page",4,!1,!1,function(b,c,d,e){return jsworld.MobyJsworld.placeOnPage(b,c,d,e)});b["make-world-config"]=new c("make-world-config",2,!0,!1,function(b,c,d){var e=[b,c].concat(d);i(b,o,"make-world-config","procedure",1,e);i(c,P(1),"make-world-config",
"procedure (arity 1)",2,e);R(d,function(b,c){i(b,o,"make-world-config","handler",c+3,e)});P(d.length)(b)||N(types.incompleteExn(types.exnFailContract,"make-world-config: 1st argument must have arity equal to the number of arguments after the second",[]));return types.worldConfig(b,c,d)});b["make-effect-type"]=Ra("make-effect-type",4,[!1],!0,function(b,c,d,e,l,h,k){i(d,Q,"make-effect-type","string",1,b);i(e,function(b){return b===!1||types.isEffectType(b)},"make-effect-type","effect type or #f",2,
b);i(l,E,"make-effect-type","exact non-negative integer",3,b);i(h,o,"make-effect-type","procedure",4,b);i(k,function(b){return b===!1||o(b)},"make-effect-type","procedure or #f",6,b);b=l+1+(e?e.numberOfArgs:0);k&&!P(b)(k)&&N(types.incompleteExn(types.exnFailContract,helpers.format("make-effect-type: guard procedure does not accept ~a arguments (one more than the number constructor arguments): ~s",[b,k]),[]));k=k?aa(c,k):!1;d=types.makeEffectType(d.toString(),e,l,h,k,sa(c));c.v=t(d)});b["effect-type?"]=
new c("effect-type?",1,!1,!1,types.isEffectType);b["effect?"]=new c("effect?",1,!1,!1,types.isEffect);b["make-render-effect-type"]=Ra("make-render-effect-type",4,[!1],!0,function(b,c,d,e,l,h,k){i(d,Q,"make-render-effect-type","string",1,b);i(e,function(b){return b===!1||types.isEffectType(b)},"make-render-effect-type","effect type or #f",2,b);i(l,E,"make-render-effect-type","exact non-negative integer",3,b);i(h,o,"make-render-effect-type","procedure",4,b);i(k,function(b){return b===!1||o(b)},"make-render-effect-type",
"procedure or #f",6,b);b=l+1+(e?e.numberOfArgs:0);k&&!P(b)(k)&&N(types.incompleteExn(types.exnFailContract,helpers.format("make-effect-type: guard procedure does not accept ~a arguments (one more than the number constructor arguments): ~s",[b,k]),[]));k=k?aa(c,k):!1;d=types.makeRenderEffectType(d.toString(),e,l,h,k);c.v=t(d)});b["render-effect-type?"]=new c("render-effect-type?",1,!1,!1,types.isRenderEffectType);b["render-effect?"]=new c("render-effect?",1,!1,!1,types.isRenderEffect);b["world-with-effects"]=
new c("world-with-effects",2,!1,!1,function(b,c){i(b,Ya,"world-with-effects","compound effect",1,arguments);return jsworld.Jsworld.with_multiple_effects(c,helpers.flattenSchemeListToArray(b))});b["make-render-effect"]=new c("make-render-effect",2,!1,!1,types.makeRenderEffect);b["render-effect?"]=new c("render-effect?",1,!1,!1,types.isRenderEffect);b["render-effect-dom-node"]=new c("render-effect-dom-node",1,!1,!1,function(b){i(b,types.isRenderEffect,"render-effect-dom-node","render-effect",1);return types.renderEffectDomNode(b)});
b["render-effect-effects"]=new c("render-effect-effects",1,!1,!1,function(b){i(b,types.isRenderEffect,"render-effect-effects","render-effect",1);return types.renderEffectEffects(b)});b["scheme->prim-js"]=new c("scheme->prim-js",1,!1,!1,function(b){i(b,function(b){return e(b)||z(b)||Q(b)||U(b)||l(b)||O(b)},"scheme->prim-js","real number, string, symbol, char, boolean, or vector",1);var c;e(b)?(!jsnums.equals(b,jsnums.nan)&&!jsnums.equals(b,jsnums.inf)&&!jsnums.equals(b,jsnums.negative_inf)&&(jsnums.greaterThan(b,
9E15)||jsnums.lessThan(b,-9E15))&&N(types.incompleteExn(types.exnFailContract,helpers.format("scheme->primitive-js: only numbers in [-9e15, 9e15] are accurately representable in javascript; given: ~s",[b]),[])),c=jsnums.toFixnum(b)):z(b)?c=b.toString():Q(b)||U(b)?c=b.val:l(b)?c=b:O(b)&&(c=b.elts.slice(0));return helpers.wrapJsObject(c)});b["prim-js->scheme"]=new c("prim-js->scheme",1,!1,!1,function(b){i(b,function(b){return xa(b)&&(typeof b.obj=="number"||typeof b.obj=="string"||typeof b.obj=="boolean"||
typeof b.obj=="function"||b.obj instanceof Array)},"prim-js->scheme","javascript number, string, boolean, function, or array",1);if(typeof b.obj==="number")return types["float"](b.obj);else if(typeof b.obj==="string"||typeof b.obj==="boolean")return b.obj;else if(typeof b.obj==="function")return new c("",0,!0,!1,function(c){return b.obj.apply(null,c)});else if(b.obj instanceof Array)return types.vector(b.obj.slice(0))});b["procedure->cps-js-fun"]=new c("procedure->cps-js-fun",1,!1,!0,function(b,c){i(c,
o,"procedure->cps-js-fun","procedure",1);var d=sa(b);b.v=types.jsObject(c.name+" (cps)",function(){var b=helpers.map(helpers.wrapJsObject,arguments),g=b.length==0?function(){}:b.shift();d(c,b,g)})});b["procedure->void-js-fun"]=new c("procedure->void-js-fun",1,!1,!0,function(b,c){i(c,o,"procedure->void-js-fun","procedure",1);var d=sa(b);b.v=types.jsObject(c.name+" (void)",function(){var b=helpers.map(helpers.wrapJsObject,arguments);d(c,b,function(){})})});b["js-==="]=new c("js-===",2,!1,!1,function(b,
c){i(b,xa,"js-===","javascript value",1);i(c,xa,"js-===","javascript value",2);return b.obj===c.obj});b["js-get-named-object"]=new c("js-get-named-object",1,!1,!1,function(b){i(b,z,"js-get-named-object","string",1);b=b.toString();return types.jsObject(b,b==="window"?window:window[b])});b["js-get-field"]=new c("js-get-field",2,!0,!1,function(b,c,d){d.unshift(c);var e=[b].concat(d);i(b,xa,"js-get-field","js-object",1,e);R(d,function(b,c){i(b,z,"js-get-field","string",c+2,e)});for(var c=[b.name],b=b.obj,
l=0;l<d.length;l++){if(b===void 0){var h=c.join("");N(types.incompleteExn(types.exnFailContract,helpers.format("js-get-field: tried to access field ~a of ~a, but ~a was undefined",[d[l],h,h]),[]))}c.push('["'+d[l].toString()+'"]');b=b[d[l].toString()]}return types.jsObject(c.join(""),b)});b["js-set-field!"]=new c("js-set-field!",3,!1,!1,function(b,c,d){i(b,function(b){return xa(b)&&typeof b.obj=="object"},"js-set-field!","javascript object",1,arguments);i(c,z,"js-set-field!","string",2,arguments);
b.obj[c.toString()]=xa(d)?d.obj:d;return types.VOID});b["js-typeof"]=new c("js-typeof",1,!1,!1,function(b){i(b,xa,"js-typeof","js-object",1);return typeof b.obj});b["js-instanceof"]=new c("js-instanceof",2,!1,!1,function(b,c){i(b,xa,"js-instanceof","js-object",1,arguments);i(c,Wa,"js-instanceof","javascript function",2,arguments);return b.obj instanceof c.obj});b["js-call"]=new c("js-call",2,!0,!1,function(b,c,d){var e=[b,c].concat(d);i(b,Wa,"js-call","javascript function",1,e);i(c,function(b){return b===
!1||xa(b)&&typeof b.obj=="object"},"js-call","javascript object or false",2,e);d=helpers.map(function(b){return xa(b)?b.obj:b},d);b=b.obj.apply(c?c.obj:null,d);return b===void 0?types.VOID:helpers.wrapJsObject(b)});b["js-new"]=new c("js-new",1,!0,!1,function(b,c){i(b,Wa,"js-new","javascript function",1);var d=helpers.map(function(b){return xa(b)?b.obj:b},c),e=function(){b.obj.apply(this,d)};e.prototype=b.obj.prototype;return helpers.wrapJsObject(new e)});b["js-make-hash"]=new h("js-make-hash",[new c("js-make-hash",
0,!1,!1,function(){return types.jsObject("hash",{})}),new c("js-make-hash",1,!1,!1,function(b){pa(b,function(b){return Na(b)&&z(b.first())},"js-make-hash","(listof string X)",1);for(var c={};!b.isEmpty();){var d=b.first().first().toString(),e=b.first().rest().first();c[d]=xa(e)?e.obj:e;b=b.rest()}return types.jsObject("hash",c)})]);b.eof=types.EOF;b.e=jsnums.e;b.empty=types.EMPTY;b["false"]=!1;b["true"]=!0;b.pi=jsnums.pi;b["null"]=types.EMPTY;b["js-undefined"]=types.jsObject("undefined",void 0);b["js-null"]=
types.jsObject("null",null);primitive.getPrimitive=function(c){return b[c]};primitive.isPrimitive=function(b){return b instanceof c};primitive.addPrimitive=function(c,d){b[c]=d};primitive.Primitive=c;primitive.CasePrimitive=h;primitive.setCALL=function(b){d=function(c,d,e){return new b(c,d,e)}};primitive.setPAUSE=function(b){m=function(c){return new b(c)}}})();var control={};
(function(){var d=function(b){this.depth=b};d.prototype.invoke=function(b){debug("SET "+this.depth);if(b.vstack.length-1-(this.depth||0)<0)throw types.internalError("vstack not long enough",b.captureCurrentContinuationMarks(aState));b.setn(this.depth,b.v)};var m=function(b){this.n=b};m.prototype.invoke=function(b){b.pushn(this.n)};var b=function(b){this.depth=b};b.prototype.invoke=function(b){debug("SWAP "+this.depth);if(b.vstack.length-1-(this.depth||0)<0)throw types.internalError("vstack not long enough",
b.captureCurrentContinuationMarks(aState));var c=b.vstack[b.vstack.length-1-(this.depth||0)];b.vstack[b.vstack.length-1-(this.depth||0)]=b.v;b.v=c};var c=function(b){this.n=b};c.prototype.invoke=function(b){b.popn(this.n)};var h=function(b,c){this.prefix=b;this.body=c};h.prototype.invoke=function(b){q(b,this.prefix);for(var c=[],d=0;d<this.body.length;d++)c.push(this.body[d]);b.pushManyControls(c)};var q=function(b,c){for(var d=c.numLifts,e=new types.PrefixValue,h=0;h<c.toplevels.length+d;h++){var k=
c.toplevels[h];if(k===!1)e.addSlot();else if(k.$==="module-variable"){var m=b,q=e,t=k,k=t.modidx.path,t=t.sym+"",u=primitive.getPrimitive(t,k);m.globals[t]=typeof u!=="undefined"?new types.GlobalBucket(t,u):new types.GlobalBucket(t,new types.ModuleVariableRecord(k,t));q.addSlot(m.globals[t])}else if(k.$==="global-bucket")m=b,q=e,k=k.value+"",m.globals[k]||(m.globals[k]=new types.GlobalBucket(k,types.UNDEFINED)),q.addSlot(m.globals[k]);else throw types.internalError("unable to install toplevel element "+
k,state.captureCurrentContinuationMarks(b));}b.vstack.push(e)},C=function(b){this.value=b};C.prototype.invoke=function(b){b.v=this.value};var A=function(b,c,d){this.test=b;this.thenPart=c;this.elsePart=d};A.prototype.invoke=function(b){var c=[];c.push(this.test);c.push(new P(this.thenPart,this.elsePart));b.pushManyControls(c)};var P=function(b,c){this.thenPart=b;this.elsePart=c};P.prototype.invoke=function(b){debug("BRANCH");b.v!==!1&&b.v!==void 0?b.pushControl(this.thenPart):b.pushControl(this.elsePart)};
var w=function(b){this.name=b};w.prototype.invoke=function(b){var c=this;throw new ha(function(d){b.invokedModules[c.name]?d(types.VOID):typeof COLLECTIONS!=="undefined"&&COLLECTIONS[c.name]?L(b,COLLECTIONS[c.name],d):d(types.schemeError(types.exn("unable to load "+c.name+": it isn't in the set of known collections")))});};var L=function(b,c,d){b.clearForEval({preserveBreak:!0,clearGlobals:!0});interpret.load(c.bytecode,b);interpret.run(b,function(){for(var e={},h=0;h<c.provides.length;h++){var k=
c.provides[h],m=b.globals[k];if(m)e[k]=m.value;else{d(types.schemeError(types.exn("module "+c.name+" is missing an expected definition for "+k)));return}}b.invokedModules[c.name]={record:c,providedValues:e};d(types.VOID)},function(b){d(b)})},T=function(b){this.forms=b};T.prototype.invoke=function(b){for(var c=this.forms,d=[],e=0;e<c.length;e++)d.push(c[e]);b.pushManyControls(d)};var X=function(b){this.seq=b};X.prototype.invoke=function(b){if(this.seq.length===1)b.pushControl(this.seq[0]);else{for(var c=
[],d=1;d<this.seq.length;d++)c.push(this.seq[d]);b.pushManyControls([this.seq[0],new J(c)])}};var J=function(b){this.rest=b};J.prototype.invoke=function(b){b.pushControl(new C(b.v));b.pushManyControls(this.rest)};var ca=function(b,c){this.depth=b;this.pos=c};ca.prototype.invoke=function(b){b.v=b.refPrefix(this.depth,this.pos)};var la=function(b,c){this.pos=b;this.isUnbox=c};la.prototype.invoke=function(b){var c=b.peekn(this.pos);this.isUnbox&&(c=c.unbox());b.v=c};var D=function(b){this.name=b+""};
D.prototype.invoke=function(b){var c=primitive.getPrimitive(this.name,void 0);if(!c)throw types.internalError("Primitive "+this.name+" not implemented!",state.captureCurrentContinuationMarks(b));b.v=c};var W=function(b){this.name=b.name;this.numParams=b.numParams;this.paramTypes=b.paramTypes;this.isRest=b.isRest;this.closureMap=b.closureMap;this.closureTypes=b.closureTypes;this.body=b.body};W.prototype.invoke=function(b){b.v=new types.ClosureValue(this.name,this.numParams,this.paramTypes,this.isRest,
ga(b,this.closureMap,this.closureTypes),this.body)};var ga=function(b,c){for(var d=[],e=0;e<c.length;e++){var h;h=b.peekn(c[e]);d.push(h)}return d},fa=function(b,c){this.procs=b;this.body=c};fa.prototype.invoke=function(b){for(var c=[],e=this.procs.length,h=0;h<e;h++)c.push(this.procs[h]),c.push(new d(e-1-h));c.push(new N(this.procs));c.push(this.body);b.pushManyControls(c)};var N=function(b){this.procs=b};N.prototype.invoke=function(b){for(var c=this.procs.length,d=0;d<c;d++){var e=this.procs[d];
b.peekn(c-1-d).closureVals=ga(b,e.closureMap,e.closureTypes)}};var sa=function(b,c){this.ids=b;this.body=c};sa.prototype.invoke=function(b){var c=[];c.push(this.body);c.push(new aa(this.ids));b.pushManyControls(c)};var aa=function(b){this.ids=b};aa.prototype.invoke=function(b){debug("DEF_VALUES");var c=b.v;if(c instanceof types.ValuesWrapper){this.ids.length!==c.elts.length&&helpers.raise(types.exnFailContractArity("define-values: expected "+this.ids.length+" values, but received "+c.elts.length,
state.captureCurrentContinuationMarks(b)));for(var d=0;d<this.ids.length;d++)b.setPrefix(this.ids[d].depth,this.ids[d].pos,c.elts[d])}else this.ids.length!==1?helpers.raise(types.exnFailContractArity("define-values: expected "+this.ids.length+" values, but only received one: "+c,state.captureCurrentContinuationMarks(b))):b.setPrefix(this.ids[0].depth,this.ids[0].pos,c)};var F=function(b,c){this.rator=b;this.rands=c};F.prototype.invoke=function(c){var e=this.rator,h=this.rands,k=[];h.length!==0&&k.push(new m(h.length));
k.push(e);h.length!==0&&k.push(new d(h.length-1));for(e=0;e<h.length;e++)e!==h.length-1?(k.push(h[e]),k.push(new d(e))):(k.push(h[h.length-1]),k.push(new b(h.length-1)));k.push(new ja(h.length));c.pushManyControls(k)};var ja=function(b){this.n=b};ja.prototype.invoke=function(b){debug("CALL "+this.n);for(var c=[],d=0;d<this.n;d++)c.push(b.popValue());K(b,b.v,this.n,c)};var K=function(b,d,e,h){d=I(e,d,h);if(primitive.isPrimitive(d)){b.cstack.length!==0&&b.cstack[b.cstack.length-1]instanceof c&&b.cstack.pop().invoke(b);
var k=[];d.usesState&&k.push(b);if(d.isRest){for(var m=0;m<d.numParams;m++)k.push(h.shift());for(var q=[],m=0;m<e-d.numParams;m++)q.push(h.shift());k.push(q)}else for(m=0;m<d.numParams;m++)k.push(h.shift());e=d.impl.apply(d.impl,k);V(b,e,d)}else if(d instanceof types.ClosureValue)b.cstack.length!==0&&b.cstack[b.cstack.length-1]instanceof c?(b.cstack.pop().invoke(b),e=y(b,d,h,e),b.pushControl(new c(e))):b.cstack.length>=2&&types.isContMarkRecordControl(b.cstack[b.cstack.length-1])&&b.cstack[b.cstack.length-
2]instanceof c?(b.cstack[b.cstack.length-2].invoke(b),e=y(b,d,h,e),b.cstack[b.cstack.length-2]=new c(e)):(e=y(b,d,h,e),b.pushControl(new c(e))),b.pushControl(d.body);else if(d instanceof types.ContinuationClosureValue)b.v=e===1?h[0]:new types.ValuesWrapper(h),b.vstack=d.vstack,b.cstack=d.cstack;else throw types.internalError("Something went wrong with checking procedures!",state.captureCurrentContinuationMarks(b));},V=function(b,c,d){if(c instanceof t)b.cstack.push(new k(c.k,d)),K(b,c.operator,c.operands.length,
c.operands);else if(c instanceof e)throw new ha(c.onPause);else if(!d.usesState)b.v=c},ha=function(b){this.onPause=b},t=function(b,c,d){this.operator=b;this.operands=c;this.k=d},k=function(b,c){this.k=b;this.procValue=c};k.prototype.invoke=function(b){V(b,this.k(b.v),this.procValue)};primitive.setCALL(t);var e=function(b){this.onPause=b};primitive.setPAUSE(e);var I=function(b,c,d){var e=function(){var b="";if(d.length>0){for(var b=[":"],c=0;c<d.length;c++)b.push(types.toWrittenString(d[c]));b=b.join(" ")}return b};
types.isFunction(c)||(e("; arguments were:"),helpers.raise(types.incompleteExn(types.exnFailContract,helpers.format("procedure application: expected procedure, given: ~s~a",[c,d.length==0?" (no arguments)":"; arguments were"+e()]),[])));if(c instanceof types.CaseLambdaValue){for(var h=0;h<c.closures.length;h++)if(b===c.closures[h].numParams||b>c.closures[h].numParams&&c.closures[h].isRest)return c.closures[h];for(var h=[],k=0;k<c.closures.length;k++)h.push(c.closures[k].numParams+"");helpers.raise(types.incompleteExn(types.exnFailContractArity,
helpers.format("~a: expects [~a] arguments, given ~s~a",[c.name?c.name:"#<case-lambda-procedure>",h.join(", "),b,e()]),[]))}else if(c instanceof primitive.CasePrimitive){for(h=0;h<c.cases.length;h++)if(b===c.cases[h].numParams||b>c.cases[h].numParams&&c.cases[h].isRest)return c.cases[h];h=[];for(k=0;k<c.cases.length;k++)h.push(c.cases[k].numParams+"");helpers.raise(types.incompleteExn(types.exnFailContractArity,helpers.format("~a: expects [~a] arguments, given ~s~a",[c.name,h.join(", "),b,e()]),[]))}if(c instanceof
types.ContinuationClosureValue)return c;else if(b===c.numParams||b>c.numParams&&c.isRest)return c;else helpers.raise(types.incompleteExn(types.exnFailContractArity,helpers.format("~a: expects ~a ~a argument~a, given ~s~a",[c.name!==types.EMPTY?c.name:"#<procedure>",c.isRest?"at least":"",c.numParams,c.numParams==1?"":"s",b,e()]),[]))},y=function(b,c,d,e){var h=0;if(c.isRest){for(var k=types.EMPTY,m=0;m<e-c.numParams;m++)k=types.cons(d.pop(),k);b.pushValue(k);h++}for(m=d.length-1;m>=0;m--)b.pushValue(d[m]),
h++;for(m=c.closureVals.length-1;m>=0;m--)b.pushValue(c.closureVals[m]),h++;return h},E=function(b,c,d){this.key=b;this.val=c;this.body=d};E.prototype.invoke=function(b){var c=[];c.push(this.key);c.push(new $(this.val,this.body));b.pushManyControls(c)};var $=function(b,c){this.val=b;this.body=c};$.prototype.invoke=function(b){var c=b.v,d=[];d.push(this.val);d.push(new G(c,this.body));b.pushManyControls(d)};var G=function(b,c){this.key=b;this.body=c};G.prototype.invoke=function(b){var c=b.v;if(b.cstack.length!==
0&&types.isContMarkRecordControl(b.cstack[b.cstack.length-1]))b.pushControl(b.cstack.pop().update(this.key,c));else{var d=types.makeLowLevelEqHash();d.put(this.key,c);b.pushControl(types.contMarkRecordControl(d))}b.pushControl(this.body)};var na=function(b,c){this.proc=b;this.argsExpr=c};na.prototype.invoke=function(b){var c=[];c.push(this.proc);c.push(new va(this.argsExpr));b.pushManyControls(c)};var va=function(b){this.expr=b};va.prototype.invoke=function(b){var c=[];c.push(this.expr);c.push(new Q(b.v));
b.pushManyControls(c)};var Q=function(b){this.procVal=b};Q.prototype.invoke=function(b){var c=b.v;b.v=this.procVal;if(c instanceof types.ValuesWrapper){for(var c=c.elts,d=c.length-1;d>=0;d--)b.pushValue(c[d]);b.pushControl(new ja(c.length))}else b.pushValue(c),b.pushControl(new ja(1))};var U=function(b,c){this.rhs=b;this.body=c};U.prototype.invoke=function(b){var e=[];b.pushn(1);e.push(this.rhs);e.push(new d(0));e.push(this.body);e.push(new c(1));b.pushManyControls(e)};var z=function(b){this.count=
b.count;this.isBoxes=b.isBoxes;this.body=b.body};z.prototype.invoke=function(b){var d=[],e=this.count;b.pushn(e);if(this.isBoxes)for(var h=0;h<e;h++)b.setn(h,types.box(types.UNDEFINED));d.push(this.body);d.push(new c(e));b.pushManyControls(d)};var H=function(b,c){this.pos=b;this.body=c};H.prototype.invoke=function(b){b.setn(this.pos,types.box(b.peekn(this.pos)));b.pushControl(this.body)};var wa=function(b){this.count=b.count;this.pos=b.pos;this.isBoxes=b.isBoxes;this.rhs=b.rhs;this.body=b.body};wa.prototype.invoke=
function(b){var c=[];c.push(this.rhs);c.push(new Y(this.count,this.pos,this.isBoxes,this.body));b.pushManyControls(c)};var Y=function(b,c,d,e){this.count=b;this.pos=c;this.isBoxes=d;this.body=e};Y.prototype.invoke=function(b){var c=b.v,d=[];c instanceof types.ValuesWrapper?(this.count!==c.elts.length&&helpers.raise(types.exnFailContractArity("expected "+this.count+" values, but received "+c.elts.length,b.captureCurrentContinuationMarks(aState))),d=c.elts):(this.count!==1&&helpers.raise(types.exnFailContractArity("expected "+
this.count+" values, but received one",b.captureCurrentContinuationMarks(aState))),d=[c]);if(this.isBoxes)for(c=0;c<this.count;c++)b.peekn(c+this.pos).set(d[c]);else for(c=0;c<this.count;c++)b.setn(c+this.pos,d[c]);b.pushControl(this.body)};var ma=function(b){this.id=b.id;this.rhs=b.rhs;this.isUndefOk=b.isUndefOk};ma.prototype.invoke=function(b){var c=[];c.push(this.rhs);c.push(new O(this.id.depth,this.id.pos,this.isUndefOk));b.pushManyControls(c)};var O=function(b,c,d){this.depth=b;this.pos=c;this.isUndefOk=
d};O.prototype.invoke=function(b){debug("SET_TOPLEVEL "+this.depth+", "+this.pos);if(b.vstack.length-1-(this.depth||0)<0)throw types.internalError("vstack not long enough",state.captureCurrentContinuationMarks(b));b.setPrefix(this.depth,this.pos,b.v)};var da=function(b){this.toplevel=b};da.prototype.invoke=function(b){b.v=new types.VariableReference(b.vstack[b.vstack.length-1-this.toplevel.depth],this.toplevel.pos)};var ia=function(b){this.genId=b+""};ia.prototype.invoke=function(b){b.v=b.heap[this.genId]};
var ba=function(b,c){this.name=b;this.clauses=c};ba.prototype.invoke=function(b){var c=this.clauses;c.length===0?b.v=new types.CaseLambdaValue(this.name,[]):(b.pushControl(new ra(this.name,types.list(c).rest(),types.list([]))),b.pushControl(c[0]))};var ra=function(b,c,d){this.name=b;this.lamsToEvaluate=c;this.evaluatedLams=d};ra.prototype.invoke=function(b){var c=b.v;if(this.lamsToEvaluate.isEmpty()){for(var c=types.cons(c,this.evaluatedLams).reverse(),d=[];!c.isEmpty();)d.push(c.first()),c=c.rest();
b.v=new types.CaseLambdaValue(this.name,d)}else b.pushControl(new ra(this.name,this.lamsToEvaluate.rest(),types.cons(c,this.evaluatedLams))),b.pushControl(this.lamsToEvaluate.first())};control.processPrefix=q;control.ConstantControl=C;control.BranchControl=A;control.SeqControl=T;control.Beg0Control=X;control.ModControl=h;control.Prefix=function(b){this.numLifts=b.numLifts;this.toplevels=b.toplevels};control.ToplevelControl=ca;control.DefValuesControl=sa;control.LamControl=W;control.PrimvalControl=
D;control.ApplicationControl=F;control.LocalrefControl=la;control.ApplyValuesControl=na;control.LetOneControl=U;control.LetVoidControl=z;control.BoxenvControl=H;control.InstallValueControl=wa;control.WithContMarkControl=E;control.AssignControl=ma;control.VarrefControl=da;control.ClosureControl=ia;control.CaseLamControl=ba;control.LetRecControl=fa;control.CallControl=ja;control.RequireControl=w;control.PauseException=ha})();var loader={};
(function(){var d=function(c,h){switch(h.$){case "mod":return new control.ModControl(b(h.prefix),m(c,h.body));case "def-values":return new control.DefValuesControl(h.ids,d(c,h.body));case "indirect":return new control.ConstantControl(c.heap[h.value]);case "apply-values":return new control.ApplyValuesControl(d(c,h.proc),d(c,h["args-expr"]));case "toplevel":return new control.ToplevelControl(h.depth,h.pos);case "constant":return new control.ConstantControl(h.value);case "req":return new control.RequireControl(h.reqs+
"");case "seq":return new control.SeqControl(m(c,h.forms));case "application":return new control.ApplicationControl(d(c,h.rator),m(c,h.rands));case "localref":return new control.LocalrefControl(h.pos,h["unbox?"]);case "primval":return new control.PrimvalControl(h.value);case "branch":return new control.BranchControl(d(c,h.test),d(c,h.then),d(c,h["else"]));case "lam":return new control.LamControl({name:h.name,numParams:h["num-params"],paramTypes:h["param-types"],isRest:h["rest?"],closureMap:h["closure-map"],
closureTypes:h["closure-types"],body:d(c,h.body)});case "let-one":return new control.LetOneControl(d(c,h.rhs),d(c,h.body));case "let-void":return new control.LetVoidControl({count:h.count,isBoxes:h["boxes?"],body:d(c,h.body)});case "beg0":return new control.Beg0Control(m(c,h.seq));case "boxenv":return new control.BoxenvControl(h.pos,d(c,h.body));case "install-value":return new control.InstallValueControl({count:h.count,pos:h.pos,isBoxes:h["boxes?"],rhs:d(c,h.rhs),body:d(c,h.body)});case "with-cont-mark":return new control.WithContMarkControl(d(c,
h.key),d(c,h.val),d(c,h.body));case "assign":return new control.AssignControl({id:d(c,h.id),rhs:d(c,h.rhs),isUndefOk:h["undef-ok?"]});case "varref":return new control.VarrefControl(d(c,h.toplevel));case "closure":return new control.ClosureCommand(h["gen-id"]);case "case-lam":return new control.CaseLamControl(h.name,m(c,h.clauses));case "let-rec":return new control.LetRecControl(m(c,h.procs),d(c,h.body));default:throw types.internalError("I don't know how to handle "+sys.inspect(h),state.captureCurrentContinuationMarks(c));
}},m=function(b,h){for(var m=[],C=0;C<h.length;C++)m.push(d(b,h[C]));return m},b=function(b){return new control.Prefix({numLifts:b["num-lifts"],toplevels:b.toplevels})};loader.loadCode=d;loader.loadPrefix=b})();var interpret={};
(function(){var d=function(m,C,A){C||(C=function(){});A||(A=function(b){throw b;});try{for(var P=1E4;!m.isStuck()&&P>0;)h(m),P--;if(m.breakRequested)A(types.schemeError(types.exnBreak("user break",state.captureCurrentContinuationMarks(m),new types.ContinuationClosureValue(m.vstack,m.cstack))));else if(P<=0){var w=m.save();setTimeout(function(){m.restore(w);d(m,C,A)},0)}else C(m.v)}catch(L){if(L instanceof control.PauseException){var P=c(m,C,A),T=b(m);L.onPause(P,T)}else types.isSchemeError(L)&&types.isIncompleteExn(L.val)&&
(P=state.captureCurrentContinuationMarks(m),L=types.schemeError(L.val.constructor.apply(null,[L.val.msg,P].concat(L.val.otherArgs)))),A(L)}},m=function(b,c,h,m,w){var L=b.save();b.clearForEval({preserveBreak:!0});b.pushControl(new control.ApplicationControl(new control.ConstantControl(c),helpers.map(function(b){return new control.ConstantControl(b)},h)));try{d(b,function(c){b.restore(L);m(c)},function(c){b.restore(L);w(c)})}catch(T){throw b.restore(L),T;}},b=function(b){return function(c,d,h,w){return m(b,
c,d,h,w)}},c=function(b,c,h){var m=b.save();b.clearForEval({preserveBreak:!0});return function(w){b.restore(m);if(types.isSchemeError(w)){if(types.isIncompleteExn(w.val))var L=state.captureCurrentContinuationMarks(b),w=types.schemeError(w.val.constructor.apply(null,[w.val.msg,L].concat(w.val.otherArgs)));h(w)}else types.isInternalError(w)?h(w):(b.v=w,d(b,c,h))}},h=function(b){var c=b.popControl();debugF(function(){return sys.inspect(c)});if(typeof c==="object"&&c.invoke)c.invoke(b);else throw types.internalError("I don't know how to handle "+
sys.inspect(c),state.captureCurrentContinuationMarks(b));};primitive.addPrimitive("call/cc",new primitive.Primitive("call/cc",1,!1,!0,function(b,c){var d=new types.ContinuationClosureValue(b.vstack,b.cstack);b.pushValue(d);b.v=c;b.pushControl(new control.CallControl(1))}));interpret.load=function(b,c){c||(c=new state.State);try{for(var d=c,h=b["compiled-indirects"],m=0;m<h.length;m++){for(var L=h[m],T=L.lam,X=T["num-params"],J=T["param-types"],ca=T["rest?"],la,D=d,W=T["closure-map"],ga=[],fa=0;fa<
W.length;fa++){var N;N=D.peekn(W[fa]);ga.push(N)}la=ga;var sa=new control.ConstantControl(!1);d.heap[L.id]=new types.ClosureValue(L.id,X,J,ca,la,sa)}for(m=0;m<h.length;m++)L=h[m],T=L.lam,d.heap[L.id].body=loader.loadCode(d,T.body);var aa=loader.loadPrefix(b.prefix);control.processPrefix(c,aa);c.pushControl(loader.loadCode(c,b.code))}catch(F){throw types.isSchemeError(F)&&types.isExn(F.val)&&!types.isContinuationMarkSet(types.exnContMarks(F.val))&&types.exnSetContMarks(F.val,state.captureCurrentContinuationMarks(c)),
F;}return c};interpret.step=h;interpret.run=d;interpret.call=m})();
