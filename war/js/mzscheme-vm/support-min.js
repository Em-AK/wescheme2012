var sys={print:function(m){m=m.toString().replace(RegExp("\n","g"),"<br />");document.write(m)},error:function(m){"undefined"!==typeof console&&console.log?m.stack?console.log(m.stack):console.log("Error: "+str):(m=m.toString().replace(RegExp("\n","g"),"<br />"),document.write("<br />Error: "+m+"<br />"))},inspect:function(m){return m+""}},DEBUG_ON=!1,setDebug=function(m){DEBUG_ON=m},debug=function(m){DEBUG_ON&&sys.print(m)},debugF=function(m){DEBUG_ON&&sys.print(m())},hasOwnProperty={}.hasOwnProperty,
deepEqual=function(m,q){if(m===q)return!0;var c;if(m instanceof Array){if(q instanceof Array){for(c=0;c<m.length;c++)if(!deepEqual(m[c],q[c]))return!1;return!0}return!1}if("string"===typeof m||"number"===typeof m)return m===q;for(c in m)if(hasOwnProperty.call(m,c)&&"_eqHashCode"!==c&&"_isList"!==c&&(!hasOwnProperty.call(q,c)||!deepEqual(m[c],q[c])))return!1;for(c in q)if(hasOwnProperty.call(q,c)&&"_eqHashCode"!==c&&"_isList"!==c&&(!hasOwnProperty.call(m,c)||!deepEqual(m[c],q[c])))return!1;return!0},
assert={equal:function(m,q){if(m!==q)throw Error("AssertError: "+m+" equal "+q);},deepEqual:function(m,q){if(!deepEqual(m,q))throw Error("AssertError: "+m+" deepEqual "+q);},ok:function(m){if(!m)throw Error("AssertError: not ok: "+m);},throwsExn:function(m){try{m.apply(null,[])}catch(q){return}throw Error("AssertError: Throw expected, none received.");}};this.JSON||(this.JSON={});
(function(){function m(b){return 10>b?"0"+b:b}function q(b){e.lastIndex=0;return e.test(b)?'"'+b.replace(e,function(b){var c=w[b];return"string"===typeof c?c:"\\u"+("0000"+b.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+b+'"'}function c(b,m){var e,w,W,C,ca=o,X,R=m[b];R&&"object"===typeof R&&"function"===typeof R.toJSON&&(R=R.toJSON(b));"function"===typeof k&&(R=k.call(m,b,R));switch(typeof R){case "string":return q(R);case "number":return isFinite(R)?""+R:"null";case "boolean":case "null":return""+
R;case "object":if(!R)return"null";o+=J;X=[];if("[object Array]"===Object.prototype.toString.apply(R)){C=R.length;for(e=0;e<C;e+=1)X[e]=c(e,R)||"null";W=0===X.length?"[]":o?"[\n"+o+X.join(",\n"+o)+"\n"+ca+"]":"["+X.join(",")+"]";o=ca;return W}if(k&&"object"===typeof k){C=k.length;for(e=0;e<C;e+=1)w=k[e],"string"===typeof w&&(W=c(w,R))&&X.push(q(w)+(o?": ":":")+W)}else for(w in R)Object.hasOwnProperty.call(R,w)&&(W=c(w,R))&&X.push(q(w)+(o?": ":":")+W);W=0===X.length?"{}":o?"{\n"+o+X.join(",\n"+o)+
"\n"+ca+"}":"{"+X.join(",")+"}";o=ca;return W}}"function"!==typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+m(this.getUTCMonth()+1)+"-"+m(this.getUTCDate())+"T"+m(this.getUTCHours())+":"+m(this.getUTCMinutes())+":"+m(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var b=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
e=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,o,J,w={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},k;"function"!==typeof JSON.stringify&&(JSON.stringify=function(b,m,e){var w;J=o="";if("number"===typeof e)for(w=0;w<e;w+=1)J+=" ";else"string"===typeof e&&(J=e);if((k=m)&&"function"!==typeof m&&("object"!==typeof m||"number"!==typeof m.length))throw Error("JSON.stringify");return c("",
{"":b})});"function"!==typeof JSON.parse&&(JSON.parse=function(c,k){function o(b,c){var A,m,e=b[c];if(e&&"object"===typeof e)for(A in e)Object.hasOwnProperty.call(e,A)&&(m=o(e,A),void 0!==m?e[A]=m:delete e[A]);return k.call(b,c,e)}var m,c=""+c;b.lastIndex=0;b.test(c)&&(c=c.replace(b,function(b){return"\\u"+("0000"+b.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(c.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return m=eval("("+c+")"),"function"===typeof k?o({"":m},""):m;throw new SyntaxError("JSON.parse");})})();var helpers={};
(function(){var m=function(b){throw types.schemeError(b);},q=function(b,c,o,e){var b=state.captureCurrentContinuationMarks(b).ref(types.symbol("moby-application-position-key")),w=b[b.length-1],J=function(b){var c=[],k,A=[];for(k=0;k<e.length;k++)!state.isState(e[k])&&!(void 0!==e[k].name&&""===e[k].name)&&A.push(e[k]);window.wtf=e[2];for(k=0;k<A.length;k++)b.isEmpty()||(k!=o-1&&c.push(new types.ColoredPart(types.toWrittenString(A[k])+" ",b.first())),b=b.rest());0<c.length&&(b=c[c.length-1].text,b=
b.substring(0,b.length-1),c[c.length-1]=new types.ColoredPart(b,c[c.length-1].location));return c},b=function(b){var c=w,k;for(k=0;k<b;k++)c=c.rest();return c.first()},C=c.typeName+"",q=C.substring(0,1);e&&(J=J(w.rest()),0<J.length&&m(types.incompleteExn(types.exnFailContract,new types.Message([new types.ColoredPart(c.functionName,w.first()),": expects ","a"===q||"e"===q||"i"===q||"o"===q||"u"===q?"an ":"a ",C," as ",c.ordinalPosition," argument, but given: ",new types.ColoredPart(types.toWrittenString(c.actualValue),
b(o)),"; other arguments were: ",new types.GradientPart(J)]),[])));m(types.incompleteExn(types.exnFailContract,new types.Message([new types.ColoredPart(c.functionName,w.first()),": expects ","a"===q||"e"===q||"i"===q||"o"===q||"u"===q?"an ":"a ",C," as ",c.ordinalPosition," argument, but given: ",new types.ColoredPart(types.toWrittenString(c.actualValue),b(o))]),[]))},c=function(b,c,o,e){if(b instanceof state.State){var w=state.captureCurrentContinuationMarks(b).ref(types.symbol("moby-application-position-key"));
void 0!==w[w.length-1]&&q(b,c,o,e)}if(e&&1<e.length){b=["~a: expects type ~a as ~a arguments, but given: ~s; other arguments were:"];for(w=0;w<e.length;w++)w!=o-1&&b.push(types.toWrittenString(e[w]));o=b.join(" ");m(types.incompleteExn(types.exnFailContract,helpers.format(o,[c.functionName,c.typeName,c.ordinalPosition,c.actualValue]),[]))}else m(types.incompleteExn(types.exnFailContract,helpers.format("~a: expects argument of type ~a, but given: ~s",[c.functionName,c.typeName,c.actualValue]),[]))},
b=function(b,A,o,m,e,w,C){o(A)||c(b,{functionName:m,typeName:e,ordinalPosition:helpers.ordinalize(w),actualValue:A},w,C)},e=function(b){var c,b=c=b;if(c===types.EMPTY)return!0;for(;;){if(!types.isPair(c))return!1;if(types.isPair(b)){if(!0===b._isList)return!0;b=b.rest()}c=c.rest();if(types.isPair(c)){if(c._isList)return b._isList=!0;c=c.rest();if(types.isPair(c)&&c._isList)return b._isList=!0}if(c===types.EMPTY)return b._isList=!0;if(b===c)return!1}},o=function(b,c){if(!e(b))return!1;for(;types.isPair(b);){if(!c(b.first()))return!1;
b=b.rest()}return b===types.EMPTY},J=function(b){var c=b;if(c===types.EMPTY)return[];if(types.isPair(c))for(b=[];!c.isEmpty();)b.push(J(c.first())),c=c.rest();return b},w=function(b){if(!e(b))return[b];for(var c=[];!b.isEmpty();)c=c.concat(w(b.first())),b=b.rest();return c};helpers.format=function(b,c,o){var e=function(){o=o||"#<function>";for(var C=b.match(RegExp("~[sSaA]","g")),C=[o+": format string requires "+(null==C?0:C.length)+" arguments, but given "+c.length+"; arguments were:",types.toWrittenString(b)],
e=0;e<c.length;e++)C.push(types.toWrittenString(c[e]));m(types.incompleteExn(types.exnFailContract,C.join(" "),[]))},w=RegExp("~[sSaAn%~]","g"),q=c.slice(0),w=b.replace(w,function(b){if("~~"==b)return"~";if("~n"==b||"~%"==b)return"\n";if("~s"==b||"~S"==b)return 0==q.length&&e(),types.toWrittenString(q.shift());if("~a"==b||"~A"==b)return 0==q.length&&e(),types.toDisplayedString(q.shift());throw types.internalError("format: string.replace matched invalid regexp",!1);});0<q.length&&e();return w};helpers.forEachK=
function(b,c,o,e){var m=function(w){if(w>=b.length)e&&e();else try{c(b[w],function(){m(w+1)})}catch(C){o(C)}};m(0)};helpers.reportError=function(b){var c;c="undefined"!=typeof console&&"undefined"!=typeof console.log?function(b){console.log(b)}:function(b){alert(b)};"string"==typeof b?c(b):types.isSchemeError(b)?types.isExn(b.val)?c(""+types.exnMessage(b.val)):c(b.val):b.message?c(b.message):c(b.toString())};helpers.raise=m;helpers.procArityContains=function(b){return function(c){var o=function(c){return c instanceof
types.ContinuationClosureValue?!0:c.numParams==b||c.isRest&&c.numParams<=b},e=[];if(c instanceof types.ContinuationClosureValue||c instanceof types.ClosureValue||c instanceof types.PrimProc)return o(c);c instanceof types.CasePrimitive?e=c.cases:c instanceof types.CaseLambdaValue&&(e=c.closures);for(c=0;c<e.length;c++)if(o(e[c]))return!0;return!1}};helpers.throwCheckError=c;helpers.isList=e;helpers.isListOf=o;helpers.check=b;helpers.checkVarArity=function(c,A,o,e,m,w,C){if(0<C.length&&C[C.length-1]instanceof
Array){var q=[],J;for(J=0;J<C.length-1;J++)q.push(C[J]);C=q.concat(C[C.length-1])}b(c,A,o,e,m,w,C)};helpers.checkListOf=function(b,c,e,m,w,q,C){o(c,e)||helpers.throwCheckError(b,{functionName:m,typeName:"list of "+w,ordinalPosition:helpers.ordinalize(q),actualValue:c},q,C)};helpers.map=function(b,c){for(var o=Array(c.length),e=0;e<c.length;e++)o[e]=b(c[e]);return o};helpers.schemeListToArray=function(b){for(var c=[];!b.isEmpty();)c.push(b.first()),b=b.rest();return c};helpers.deepListToArray=J;helpers.flattenSchemeListToArray=
w;helpers.assocListToHash=function(b){for(var c={};!b.isEmpty();){var e=b.first().first(),o=b.first().rest().first();c[e]=o;b=b.rest()}return c};helpers.ordinalize=function(b){if(11==b%100)return b+"th";var c=b;switch(b%10){case 1:c+="st";break;case 2:c+="nd";break;case 3:c+="rd";break;default:c+="th"}return c};helpers.wrapJsObject=function(b){return void 0===b?types.jsObject("undefined",b):null===b?types.jsObject("null",b):"function"==typeof b?types.jsObject("function",b):b instanceof Array?types.jsObject("array",
b):"string"==typeof b?types.jsObject("'"+b.toString()+"'",b):types.jsObject(b.toString(),b)};helpers.getKeyCodeName=function(b){b=b.charCode||b.keyCode;switch(b){case 16:b="shift";break;case 17:b="control";break;case 19:b="pause";break;case 27:b="escape";break;case 33:b="prior";break;case 34:b="next";break;case 35:b="end";break;case 36:b="home";break;case 37:b="left";break;case 38:b="up";break;case 39:b="right";break;case 40:b="down";break;case 42:b="print";break;case 45:b="insert";break;case 46:b=
String.fromCharCode(127);break;case 106:b="*";break;case 107:b="+";break;case 109:b="-";break;case 110:b=".";break;case 111:b="/";break;case 144:b="numlock";break;case 145:b="scroll";break;case 186:b=";";break;case 187:b="=";break;case 188:b=",";break;case 189:b="-";break;case 190:b=".";break;case 191:b="/";break;case 192:b="`";break;case 219:b="[";break;case 220:b="\\";break;case 221:b="]";break;case 222:b="'";break;default:b=96<=b&&105>=b?(b-96).toString():112<=b&&123>=b?"f"+(b-111):String.fromCharCode(b).toLowerCase()}return b};
helpers.maybeCallAfterAttach=function(b){for(b=[b];0!==b.length;){var c=b.pop();c.afterAttach&&c.afterAttach(c);if(c.hasChildNodes&&c.hasChildNodes())for(var c=c.childNodes,e=0;e<c.length;e++)b.push(c[e])}};helpers.makeLocationDom=function(b){var c=document.createElement("span"),e=document.createElement("span"),o=document.createElement("span"),m=document.createElement("span"),w=document.createElement("span"),C=document.createElement("span");c.className="location-reference";e.className="location-id";
o.className="location-offset";m.className="location-line";w.className="location-column";C.className="location-span";e.appendChild(document.createTextNode(b.id+""));o.appendChild(document.createTextNode(b.offset+""));m.appendChild(document.createTextNode(b.line+""));w.appendChild(document.createTextNode(b.column+""));C.appendChild(document.createTextNode(b.span+""));c.appendChild(e);c.appendChild(o);c.appendChild(m);c.appendChild(w);c.appendChild(C);return c};helpers.isLocationDom=function(b){return b&&
(b.nodeType===Node.TEXT_NODE||b.nodeType===Node.ELEMENT_NODE)&&"location-reference"===b.className}})();var jsworld={};
(function(){function m(){}function q(b){U.push(b)}function c(b){b=U.indexOf(b);-1!=b&&U.splice(b,1)}function b(){fa=new m;U=[];for(var b=0;b<I.length;b++)I[b]();I=[];Y=!1}function e(b,c){if(Y)setTimeout(function(){e(b,c)},100);else{var j=fa;Y=!0;var l=function(b,c){b(fa,j,c)},z=function(b){fa=j;throw b;},o=function(){helpers.forEachK(U,l,z,function(){Y=!1;c()})};try{b(fa,function(b){fa=b;fa instanceof u?(b=fa.getEffects(),helpers.forEachK(b,function(b,c){b.invokeEffect(e,c)},function(b){throw b;},
function(){fa=fa.getWorld();o()})):o()})}catch(k){throw fa=j,"undefined"!==typeof console&&console.log&&k.stack&&console.log(k.stack),k;}}}function o(b,c){for(var j=Array(b.length),l=0;l<b.length;l++)j[l]=c(b[l]);return j}function J(b,c){for(var j=[],l=0;l<b.length;l++)j=j.concat(c(b[l]));return j}function w(b,c){for(var j=0;j<b.length;j++)if(b[j]==c)return!0;return!1}function k(b){for(var c=[b],b=b.firstChild;null!=b;b=b.nextSibling)c.push(k(b));return c}function A(b){var c=[b.node];if(!0==b.node.jsworldOpaque)return c;
for(var j=0;j<b.children.length;j++)c=c.concat(A(b.children[j]));return c}function aa(b){var c=[];if(!0==b.node.jsworldOpaque)return[];for(var j=0;j<b.children.length;j++)c.push({relation:"parent",parent:b.node,child:b.children[j].node});for(j=0;j<b.children.length-1;j++)c.push({relation:"neighbor",left:b.children[j].node,right:b.children[j+1].node});for(j=0;j<b.children.length;j++)c=c.concat(aa(b.children[j]));return c}function T(b,c,j){function l(b,c){var j=b.compareDocumentPosition(c);return j&
b.DOCUMENT_POSITION_CONTAINED_BY?1:j&b.DOCUMENT_POSITION_CONTAINS||j&b.DOCUMENT_POSITION_FOLLOWING?-1:j&b.DOCUMENT_POSITION_PRECEDING?1:0}for(var u=0;u<j.length;u++)if("parent"==j[u].relation){var z=j[u].parent,e=j[u].child;e.parentNode&&z&&e.parentNode===z||z.appendChild(e)}for(z=!0;z;){z=!1;for(u=0;u<j.length;u++)if("neighbor"==j[u].relation){var e=j[u].left,k=j[u].right;if(!e.nextSibling||!(k&&e.nextSibling===k))e.parentNode.insertBefore(e,k),z=!0}}var o;try{o=c.concat(b).sort(l)}catch(la){o=null}j=
b;for(b=b.parentNode;j!=b;){for(;!(null==j.firstChild||j.jsworldOpaque);)j=j.firstChild;for(;j!=b;){e=j.nextSibling;z=j.parentNode;k=!1;if(null!=o)for(;0<o.length&&0<=l(j,o[0]);){if((u=o.shift())&&j&&u===j){k=!0;break}}else for(u=0;u<c.length;u++)if(c[u]&&j&&c[u]===j){k=!0;break}if(!k){if(!j.isJsworldOpaque)for(;null!=j.firstChild;)j.parentNode.appendChild(j.firstChild);e=j.nextSibling;j.parentNode.removeChild(j)}if(null==e)j=z;else{j=e;break}}}ca(c)}function sa(b){return b.replace(/\-(.)/g,function(b,
c){return c.toUpperCase()})}function W(b,c){for(var j=0;j<c.length;j++)b.style[sa(c[j].attrib)]=c[j].values.join(" ")}function C(b,c){for(var j=0;j<b.length;j++);for(j=0;j<c.length;j++)if("id"in c[j])for(var l=0;l<b.length;l++)(c[j].id.match(/^\./)?"class"in b[l]&&w(b[l]["class"].split(/\s+/),c[j].id.substring(1)):"id"in b[l]&&b[l].id==c[j].id)&&W(b[l],c[j].attribs);else W(c[j].node,c[j].attribs)}function ca(b){for(var c=0;c<b.length;c++)if(b[c].onWorldChange)b[c].onWorldChange(fa)}function X(b,c,
j,l,u,e){c instanceof m?l(b,function(c){var l=p(c),H=A(l);u(b,function(b){C(H,J(b,z));T(j,H,aa(l));e()})}):R(function(e){l(c,function(k){l(b,function(l){u(c,function(c){u(b,function(b){var u=p(l),ja=A(u);k!==l?(C(ja,J(b,z)),T(j,ja,aa(u))):c!==b&&C(ja,J(b,z));e()})})})})},e)}function R(b,c){var j;void 0!=da?(j=new ia,b(function(){j.restore();c()})):b(c)}function ia(){this.focused=da;this.selectionStart=da.selectionStart;this.selectionEnd=da.selectionEnd}function L(b,c,j,l,u){this.top=b;this.world=
c;this.handlers=l;this.handlerCreators=j;this.attribs=u}function pa(c,j,l,u,z){b();var k=o(l,function(b){return b()});0<B.length&&B[B.length-1].pause();var la=new L(c,j,l,k,u);B.push(la);q(function(b,c,j){la.world=b;j()});for(var p=new y(function(b,c){c(!1)},function(b,c){c(b)}),l=0;l<k.length;l++)if(k[l]instanceof y)p=k[l];else k[l].onRegister(c);q(function(b,c,j){p.test(b,function(c){c?(E.shutdown(),z(b)):j()})});F(c,u);e(function(b,c){c(j)},D)}function y(b,c){this.test=b;this.receiver=c}function V(b,
c,j){b.addEventListener?b.addEventListener(c,j,!1):b.attachEvent("on"+c,j,!1)}function Z(b,c,j){var l=function(b){e(function(c,l){j(c,b,l)},D)};V(b,c,l);I.push(function(){Fa(b,c,l)})}function ha(b,c,j){var l=function(b){setTimeout(function(){e(function(c,l){j(c,b,l)},D)},0)};V(b,c,l);I.push(function(){Fa(b,c,l)})}function ma(b){V(b,"focus",function(){da=b});V(b,"blur",function(){da=void 0});return b}function p(b){return isPage(b)?p(k(b.toDomNode())):void 0==b.length?{node:b,children:[]}:{node:b[0],
children:o(b.slice(1),p)}}function j(b){return{attrib:b[0],values:b.slice(1)}}function z(b){var c=o(b.slice(1),j);return"string"==typeof b[0]?[{id:b[0],attribs:c}]:"length"in b[0]?o(b[0],function(b){return{id:b,attribs:c}}):[{node:b[0],attribs:c}]}function la(b,c){if(!isPage(b))if(!b instanceof Array&&qa(b,c),0==b.length&&qa(b,c),b[0].nodeType==Node.TEXT_NODE){if(1<b.length)throw new M(helpers.format("Text node ~s can not have children",[b]),b);}else if(b[0].nodeType==Node.ELEMENT_NODE)for(var j=
1;j<b.length;j++)la(b[j],b);else throw new M(helpers.format("expected a Text or an Element, received ~s within ~s",[b,c]),b[0]);}function M(b,c){this.msg=b;this.elt=c}function F(b,c){if(c)for(a in c)Object.hasOwnProperty.call(c,a)&&("function"==typeof c[a]?Z(b,a,c[a]):b[a]=c[a]);return b}function Ka(b){return ma(F(document.createElement("div"),b))}function ra(b){var c=document.createElement("div");c.appendChild(document.createTextNode(b));c.style["white-space"]="pre";c.jsworldOpaque=!0;return c}function Q(b){var c=
document.createElement("option");c.text=b.value;c.value=b.value;return c}jsworld.Jsworld={};var E=jsworld.Jsworld,da=!1,D=function(){},fa=new m,Y=!1,U=[],I=[],B=[];E.shutdown=function(){for(;0<B.length;){var c=B.pop();c&&c.pause()}b()};E.change_world=e;Number.prototype.NaN0=function(){return isNaN(this)?0:this};E.getPosition=function(b){for(var c=0,j=0;b.offsetParent;)c+=b.offsetLeft+(b.currentStyle?parseInt(b.currentStyle.borderLeftWidth).NaN0():0),j+=b.offsetTop+(b.currentStyle?parseInt(b.currentStyle.borderTopWidth).NaN0():
0),b=b.offsetParent;c+=b.offsetLeft+(b.currentStyle?parseInt(b.currentStyle.borderLeftWidth).NaN0():0);j+=b.offsetTop+(b.currentStyle?parseInt(b.currentStyle.borderTopWidth).NaN0():0);return{x:c,y:j}};var xa=0;E.gensym=function(){return xa++};E.map=o;E.mapi=function(b,c){for(var j=Array(b.length),l=0;l<b.length;l++)j[l]=c(b[l],l);return j};E.fold=function(b,c,j){for(var l=0;l<b.length;l++)c=j(b[l],c);return c};E.augment=function(b,c){var j={},l;for(l in b)j[l]=b[l];for(l in c)j[l]=c[l];return j};
E.assoc_cons=function(b,c,j){var l={},u;for(u in b)l[u]=b[u];l[c]=j;return l};E.cons=function(b,c){return[b].concat(c)};E.append=function(b,c){return b.concat(c)};E.array_join=function(b,c){for(var j=[],l=0;l<b.length;l++)j.push([b[l],c[l]]);return j};E.removeq=function(b,c){for(var j=0;j<b.length;j++)if(b[j]===c)return b.slice(0,j).concat(b.slice(j+1));return b};E.removef=function(b){for(var c=0;c<b.length;c++)if(f(b[c]))return b.slice(0,c).concat(b.slice(c+1));return b};E.filter=function(b,c){for(var j=
[],l=0;l<b.length;l++)c(b[l])&&j.push(b[l]);return j};E.without=function(b,c){var j={},l;for(l in b)l!=c&&(j[l]=b[l]);return j};E.memberq=function(b,c){for(var j=0;j<b.length;j++)if(b[j]===c)return!0;return!1};E.member=w;E.head=function(b){return b[0]};E.tail=function(b){return b.slice(1,b.length)};E.node_to_tree=k;ia.prototype.restore=function(){if(this.focused.parentNode)this.focused.selectionStart=this.selectionStart,this.focused.selectionEnd=this.selectionEnd,this.focused.focus();else if(this.focused.id){var b=
document.getElementById(this.focused.id);b&&(b.selectionStart=this.selectionStart,b.selectionEnd=this.selectionEnd,b.focus())}};L.prototype.restart=function(){pa(this.top,this.world,this.handlerCreators,this.attribs)};L.prototype.pause=function(){for(var b=0;b<this.handlers.length;b++)if(!(this.handlers[b]instanceof y))this.handlers[b].onUnregister(top)};E.big_bang=pa;E.on_tick=function(b,c){return function(){var j,l=function(){j=setTimeout(u,b)},u=function(){e(c,l)};return{onRegister:function(){l()},
onUnregister:function(){j&&clearTimeout(j)}}}};E.on_key=function(b){return function(){var c=!1,j=function(){c=!1},l,u=function(c,j){b(c,l,j)},z=function(b){27!=b.keyCode&&(l=b,za(l),va(l),c||(c=!0,e(u,j)))};return{onRegister:function(b){V(b,"keydown",z)},onUnregister:function(b){Fa(b,"keydown",z)}}}};E.on_tap=function(b){return function(){var c,j,l=!1,u=function(){l=!1},z=function(j,l){b(j,c,l)},k=function(b){c=b;j&&j.focus();za(c);va(c);l||(l=!0,e(z,u))};return{onRegister:function(b){j=b;V(j,"mousedown",
k);V(j,"touchstart",k)},onUnregister:function(b){Fa(b,"mousedown",k);Fa(b,"touchstart",k)}}}};E.on_tilt=function(b){return function(){var c,j=0,l=0,u,z=function(c,u){b(c,j,l,u)},k=function(){e(z,o)},o=function(){u=setTimeout(k,250)};return window.DeviceOrientationEvent?(c=function(b){za(b);va(b);null===b.gamma||null===b.beta?u&&(clearTimeout(u),u=void 0):0===window.orientation?(j=b.gamma,l=b.beta):90===window.orientation?(j=b.beta,l=-b.gamma):-90===window.orientation?(j=-b.beta,l=b.gamma):180===window.orientation?
(j=-b.gamma,l=-b.beta):(j=b.gamma,l=b.beta)},{onRegister:function(){V(window,"deviceorientation",c);o()},onUnregister:function(){u&&clearTimeout(u);Fa(window,"deviceorientation",c)}}):{onRegister:function(){},onUnregister:function(){}}}};E.on_draw=function(b,j){var l,u=function(b){la(b,b);l(b)},z=function(c,j){l=j;b(c,u)};return function(){var b={_top:null,_listener:function(c,l,u){X(c,l,b._top,z,j,u)},onRegister:function(c){b._top=c;q(b._listener)},onUnregister:function(){c(b._listener)}};return b}};
E.stop_when=function(b,c){return function(){void 0==c&&(c=function(b,c){c(b)});return new y(b,c)}};E.on_world_change=function(b){var j=function(c,j,l){b(c,l)};return function(){return{onRegister:function(){q(j)},onUnregister:function(){c(j)}}}};var Fa=function(b,c,j){b.addEventListener?b.removeEventListener(c,j,!1):b.detachEvent("on"+c,j,!1)},qa=function(b,c){throw new M(helpers.format("Expected a non-empty array, received ~s within ~s",[b,c]),b);};M.prototype.toString=function(){return"on-draw: "+
this.msg};E.p=function(b){return ma(F(document.createElement("p"),b))};E.div=Ka;E.button=function(b,c){var j=document.createElement("button");j.onclick=function(){return!1};Z(j,"click",b);return ma(F(j,c))};var za=function(b){b.preventDefault?b.preventDefault():b.returnValue=!1},va=function(b){b.stopPropagation?b.stopPropagation():b.cancelBubble=!0},$=function(b){V(b,"click",function(b){va(b)});return b};E.input=function(b,c,j){var b=b.toLowerCase(),u={text:ea,password:ea,checkbox:l};if(u[b])return u[b](b,
c,j);throw Error("js-input: does not currently support type "+b);};var ea=function(b,c,j){var l=document.createElement("input");l.type=b;ha(l,"keypress",function(b,j,u){c(b,l.value,u)});var u=l.value,z=setInterval(function(){l.parentNode?u!=l.value&&(u=l.value,e(function(b,j){c(b,l.value,j)},D)):clearInterval(z)},1E3);return $(ma(F(l,j)))},l=function(b,c,j){var l=document.createElement("input");l.type=b;ha(l,"change",function(b,j,u){c(b,l.checked,u)});V(l,"click",function(b){va(b)});return F(l,j)};
E.text=ra;E.select=function(b,c,j){for(var l=document.createElement("select"),u=0;u<c.length;u++)l.add(Q({value:c[u]}),null);l.jsworldOpaque=!0;Z(l,"change",j);return ma(F(l,b))};E.textarea=function(b){return ma(F(document.createElement("textarea"),b))};E.h1=function(b){return ma(F(document.createElement("h1"),b))};E.canvas=function(b){return ma(F(document.createElement("canvas"),b))};E.img=function(b,c){var j=document.createElement("img");j.src=b;return ma(F(j,c))};E.raw_node=function(b,c){return ma(F(b,
c))};var u=function(b,c){b instanceof u?(this.w=b.w,this.e=b.e.concat(c)):(this.w=b,this.e=c)};u.prototype.getWorld=function(){return this.w};u.prototype.getEffects=function(){return this.e};E.with_effect=function(b,c){return new u(b,[c])};E.with_multiple_effects=function(b,c){return new u(b,c)};E.has_effects=function(b){return b instanceof u};E.alert_effect=function(b){return new ua(b)};var ua=function(b){this.msg=b};ua.prototype.invokeEffect=function(b){alert(this.msg);b()};E.music_effect=function(b){return new ba(b)};
var ba=function(b){this.musicUrl=b};ba.prototype.invokeEffect=function(b){(new Audio(url)).play();b()};var N=function(b,c){"undefined"===typeof b&&(b=[]);this.elts=b;this.attribs=c};N.prototype.add=function(b,c,j){return new N(this.elts.concat([{elt:b,positionTop:j,positionLeft:c}]),this.attribs)};N.prototype.toDomNode=function(){for(var b=Ka(),c=0;c<this.elts.length;c++){var j=this.elts[c].elt;j.style||(j.style="");j.style.position="absolute";j.style.left=this.elts[c].positionLeft+"px";j.style.top=
this.elts[c].positionTop+"px";b.appendChild(j)}F(b,this.attribs);return b};isPage=function(b){return b instanceof N};E.isPage=isPage;E.emptyPage=function(b){return new N([],b)};E.placeOnPage=function(b,c,j,l){"string"===typeof b&&(b=ra(b));return l.add(b,c,j)};E.getCurrentWorld=function(){return fa}})();var __PLTNUMBERS_TOP__;"undefined"!==typeof exports?__PLTNUMBERS_TOP__=exports:(this.jsnums||(this.jsnums={}),__PLTNUMBERS_TOP__=this.jsnums);
(function(){function m(d){return RegExp("^([+-]?["+d+"]+)/(["+d+"]+)$")}function q(d){return RegExp("^([+-]?["+d+"\\w/\\.]*)([+-])(["+d+"\\w/\\.]*)i$")}function c(d){return RegExp("^[+-]?["+d+"]+$")}function b(d){return RegExp("^(?:([+-]?)"+("(["+d+"]*)\\.(["+d+"]+)")+"|"+("(["+d+"]+)\\.(["+d+"]*)")+")$")}function e(d,h){return RegExp("^(?:([+-]?(?:"+("["+d+"]")+"|"+("["+d+"]*\\.["+d+"]+")+"|"+("["+d+"]+\\.["+d+"]*")+"))["+h+"](\\+?["+d+"]+))$")}function o(d){return 2===d?"01":8===d?"0-7":10===d?
"0-9":16===d?"0-9a-fA-F":B("digitsForRadix: invalid radix",this,d)}function J(d){return 2===d||8===d||10===d?"defsl":16===d?"sl":B("expMarkForRadix: invalid radix",this,d)}function w(Ga,h,g,t){var i=Ga.match(m(o(h)));if(i)return K.makeInstance(w(i[1],h,g),w(i[2],h,g));if("+nan.0"===Ga||"-nan.0"===Ga)return v.nan;if("+inf.0"===Ga)return v.inf;if("-inf.0"===Ga)return v.neginf;if("-0.0"===Ga)return Ua;if(i=Ga.match(b(o(h))))return Ga=i[1],t=void 0!==i[2]?i[2]:i[4],g=void 0!==i[3]?i[3]:i[5],Ga="-"==Ga?
-1:1,t=""===t?0:parseInt(t,h),i=parseInt(g,h),h=Math.pow(h,g.length),v.makeInstance(Ga*(t+(""===g?0:i/h)));if(i=Ga.match(e(o(h),J(h))))return Ga=w(i[1],h,g),g=parseInt(i[2],h,g),v.makeInstance(Ga*Math.pow(h,g));if(Ga.match(c(o(h))))return h=parseInt(Ga,h),d(h)?Ca(Ga):h;if(t)0===Ga.length&&B("no digits"),B("cannot parse "+Ga+" as an "+(g?"exact":"inexact")+" base "+h+" number",this);else return!1}function k(d,h,b){null!=d&&("number"==typeof d?this.fromNumber(d,h,b):null==h&&"string"!=typeof d?this.fromString(d,
256):this.fromString(d,h))}function A(){return new k(null)}function aa(d,h,b,g,t,c){for(;0<=--c;){var i=h*this[d++]+b[g]+t,t=Math.floor(i/67108864);b[g++]=i&67108863}return t}function T(d,h,b,g,t,c){for(var i=h&32767,h=h>>15;0<=--c;){var j=this[d]&32767,na=this[d++]>>15,l=h*j+na*i,j=i*j+((l&32767)<<15)+b[g]+(t&1073741823),t=(j>>>30)+(l>>>15)+h*na+(t>>>30);b[g++]=j&1073741823}return t}function sa(d,h,b,g,t,c){for(var i=h&16383,h=h>>14;0<=--c;){var j=this[d]&16383,na=this[d++]>>14,l=h*j+na*i,j=i*j+
((l&16383)<<14)+b[g]+t,t=(j>>28)+(l>>14)+h*na;b[g++]=j&268435455}return t}function W(d,h){var b=nb[d.charCodeAt(h)];return null==b?-1:b}function C(d){var h=A();h.fromInt(d);return h}function ca(d){var h=this.s-d.s;if(0!=h)return h;var b=this.t,h=0>this.s?d.t-b:b-d.t;if(0!=h)return h;for(;0<=--b;)if(0!=(h=this[b]-d[b]))return h;return 0}function X(d){var h=1,b;if(0!=(b=d>>>16))d=b,h+=16;if(0!=(b=d>>8))d=b,h+=8;if(0!=(b=d>>4))d=b,h+=4;if(0!=(b=d>>2))d=b,h+=2;0!=d>>1&&(h+=1);return h}function R(d){var h=
A();this.abs().divRemTo(d,null,h);0>this.s&&0<h.compareTo(k.ZERO)&&d.subTo(h,h);return h}function ia(d){this.m=d}function L(d){this.m=d;this.mp=d.invDigit();this.mpl=this.mp&32767;this.mph=this.mp>>15;this.um=(1<<d.DB-15)-1;this.mt2=2*d.t}function pa(d){return 0==this.compareTo(d)}function y(d,h){return d&h}function V(d,h){return d|h}function Z(d,h){return d^h}function ha(d,h){return d&~h}function ma(d){var h=A();this.addTo(d,h);return h}function p(d){var h=A();this.subTo(d,h);return h}function j(d){var h=
A();this.multiplyTo(d,h);return h}function z(d){var h=A();this.divRemTo(d,h,null);return h}function la(d){var h=A();this.divRemTo(d,null,h);return h}function M(d){var h=A(),b=A();this.divRemTo(d,h,b);return[h,b]}function F(){}function Ka(d){return d}function ra(d){return this.bnpExp(d,new F)}function Q(d){this.r2=A();this.q3=A();k.ONE.dlShiftTo(2*d.t,this.r2);this.mu=this.r2.divide(d);this.m=d}function E(d){var h=0>this.s?this.negate():this.clone(),d=0>d.s?d.negate():d.clone();if(0>h.compareTo(d))var b=
h,h=d,d=b;var b=h.getLowestSetBit(),g=d.getLowestSetBit();if(0>g)return h;b<g&&(g=b);0<g&&(h.rShiftTo(g,h),d.rShiftTo(g,d));for(;0<h.signum();)0<(b=h.getLowestSetBit())&&h.rShiftTo(b,h),0<(b=d.getLowestSetBit())&&d.rShiftTo(b,d),0<=h.compareTo(d)?(h.subTo(d,h),h.rShiftTo(1,h)):(d.subTo(h,d),d.rShiftTo(1,d));0<g&&d.lShiftTo(g,d);return d}function da(d){return function(){var h=this.toInexact();return h[d].apply(h,arguments)}}var D=__PLTNUMBERS_TOP__,fa=function(d,h,b){b=b||{};return function(g,t){if(b.isXSpecialCase&&
b.isXSpecialCase(g))return b.onXSpecialCase(g,t);if(b.isYSpecialCase&&b.isYSpecialCase(t))return b.onYSpecialCase(g,t);if("number"===typeof g&&"number"===typeof t)return d(g,t);"number"===typeof g&&(g=I(g,t));"number"===typeof t&&(t=I(t,g));g.level<t.level&&(g=g.liftTo(t));t.level<g.level&&(t=t.liftTo(g));return h(g,t)}},Y=function(d){var h=d.match(e);return h?(d=h[1].match(/^([^.]*)(.*)$/),h=Number(h[2]),0===d[2].length?d[1]+U(h):h>=d[2].length-1?d[1]+d[2].substring(1)+U(h-(d[2].length-1)):d[1]+
d[2].substring(1,1+h)):d},U=function(d){var h=[];h.length=d;for(var b=0;b<d;b++)h[b]="0";return h.join("")},I=function(d,h){switch(h.level){case 0:return Ca(d);case 1:return new K(d,1);case 2:return new v(d);case 3:return new G(d,0);default:B("IMPOSSIBLE: cannot lift fixnum integer to "+h.toString(),d,h)}},B=function(d,h,b){D.onThrowRuntimeError(d,h,b)},xa=function(d){return"number"===typeof d||d instanceof K||d instanceof v||d instanceof G||d instanceof k},Fa=function(d){return"number"===typeof d||
xa(d)&&d.isRational()},qa=function(d){return"number"===typeof d||xa(d)&&d.isReal()},za=function(d){return"number"===typeof d||xa(d)&&d.isExact()},va=function(d){return"number"===typeof d?!1:xa(d)&&d.isInexact()},$=function(d){return"number"===typeof d||xa(d)&&d.isInteger()},ea=function(d){return"number"===typeof d||xa(d)&&d.isInteger()&&d.isExact()},l=function(d){return"number"===typeof d?d:d.toFixnum()},u=function(d){return"number"===typeof d?d:d.toExact()},ua=function(d){return"number"===typeof d?
v.makeInstance(d):d.toInexact()},ba=function(h,b){return"number"===typeof h&&"number"===typeof b&&d(h+b)?Ca(h).add(Ca(b)):h instanceof v&&b instanceof v?h.add(b):N(h,b)},N=fa(function(h,b){var g=h+b;return d(g)?Ca(h).add(Ca(b)):g},function(d,h){return d.add(h)},{isXSpecialCase:function(d){return ea(d)&&Da(d)},onXSpecialCase:function(d,h){return h},isYSpecialCase:function(d){return ea(d)&&Da(d)},onYSpecialCase:function(d){return d}}),ja=fa(function(h,b){var g=h-b;return d(g)?Ca(h).subtract(Ca(b)):
g},function(d,h){return d.subtract(h)},{isXSpecialCase:function(d){return ea(d)&&Da(d)},onXSpecialCase:function(d,h){return t(h)},isYSpecialCase:function(d){return ea(d)&&Da(d)},onYSpecialCase:function(d){return d}}),H=function(h,b){var g;return"number"===typeof h&&"number"===typeof b?(g=h*b,d(g)?Ca(h).multiply(Ca(b)):g):h instanceof v&&b instanceof v?h.multiply(b):$a(h,b)},$a=fa(function(h,b){var g=h*b;return d(g)?Ca(h).multiply(Ca(b)):g},function(d,h){return d.multiply(h)},{isXSpecialCase:function(d){return ea(d)&&
(Da(d)||ab(d)||ob(d))},onXSpecialCase:function(d,h){if(Da(d))return 0;if(ab(d))return h;if(ob(d))return t(h)},isYSpecialCase:function(d){return ea(d)&&(Da(d)||ab(d)||ob(d))},onYSpecialCase:function(d,h){if(Da(h))return 0;if(ab(h))return d;if(ob(h))return t(d)}}),ka=fa(function(h,b){Da(b)&&B("/: division by zero",h,b);var g=h/b;return d(g)?Ca(h).divide(Ca(b)):Math.floor(g)!==g?K.makeInstance(h,b):g},function(d,h){return d.divide(h)},{isXSpecialCase:function(d){return ta(d,0)},onXSpecialCase:function(d,
h){ta(h,0)&&B("/: division by zero",d,h);return 0},isYSpecialCase:function(d){return ta(d,0)},onYSpecialCase:function(d,h){B("/: division by zero",d,h)}}),wa=fa(function(d,h){return d===h},function(d,h){return d.equals(h)}),ta=function(d,h){if(d===h)return!0;if("number"===typeof d&&"number"===typeof h||d===Ua||h===Ua)return d===h;if(d instanceof G||h instanceof G)return ta(Oa(d),Oa(h))&&ta(Va(d),Va(h));var b=za(d),g=za(h);return(b&&g||!b&&!g)&&wa(d,h)},O=fa(function(d,h){return d>=h},function(d,h){(!qa(d)||
!qa(h))&&B(">=: couldn't be applied to complex number",d,h);return d.greaterThanOrEqual(h)}),oa=fa(function(d,h){return d<=h},function(d,h){(!qa(d)||!qa(h))&&B("<=: couldn't be applied to complex number",d,h);return d.lessThanOrEqual(h)}),Ia=fa(function(d,h){return d>h},function(d,h){(!qa(d)||!qa(h))&&B(">: couldn't be applied to complex number",d,h);return d.greaterThan(h)}),Ea=fa(function(d,h){return d<h},function(d,h){(!qa(d)||!qa(h))&&B("<: couldn't be applied to complex number",d,h);return d.lessThan(h)}),
Na=function(){var h=fa(function(h,b){var g=Math.pow(h,b);return d(g)?Ca(h).expt(Ca(b)):g},function(d,h){return wa(h,0)?ba(h,1):d.expt(h)});return function(d,b){return wa(b,0)?ba(b,1):qa(b)&&Ea(b,0)?h(ka(1,d),t(b)):h(d,b)}}(),ya=function(d){return ta(d,0)?1:"number"===typeof d?v.makeInstance(Math.exp(d)):d.exp()},Ba=function(d,h){$(d)||B("modulo: the first argument "+d+" is not an integer.",d,h);$(h)||B("modulo: the second argument "+h+" is not an integer.",d,h);var b;if("number"===typeof d)return b=
d%h,0>h?0>=b?b:b+h:0>b?b+h:b;b=db(ga(d),ga(h));return Ea(h,0)?oa(b,0)?b:ba(b,h):Ea(b,0)?ba(b,h):b},Qa=function(d){return"number"===typeof d?d:d.numerator()},P=function(d){return"number"===typeof d?1:d.denominator()},g=function(d){return"number"===typeof d?0<=d?(d=Math.sqrt(d),Math.floor(d)===d?d:v.makeInstance(d)):G.makeInstance(0,g(-d)):d.sqrt()},S=function(d){return"number"===typeof d?Math.abs(d):d.abs()},ga=function(d){return"number"===typeof d?d:d.floor()},Aa=function(d){return"number"===typeof d?
d:d.ceiling()},Ta=function(d){return"number"===typeof d?d:d.conjugate()},Ra=function(d){return ta(d,1)?0:"number"===typeof d?v.makeInstance(Math.log(d)):d.log()},pb=function(d){return"number"===typeof d?0<d?0:v.pi:d.angle()},Ya=function(d){return ta(d,0)?0:"number"===typeof d?v.makeInstance(Math.tan(d)):d.tan()},eb=function(d){return ta(d,0)?0:"number"===typeof d?v.makeInstance(Math.atan(d)):d.atan()},Wa=function(d){return ta(d,0)?1:"number"===typeof d?v.makeInstance(Math.cos(d)):d.cos()},bb=function(d){return ta(d,
0)?0:"number"===typeof d?v.makeInstance(Math.sin(d)):d.sin()},gb=function(d){return ta(d,1)?0:"number"===typeof d?v.makeInstance(Math.acos(d)):d.acos()},hb=function(d){return ta(d,0)?0:"number"===typeof d?v.makeInstance(Math.asin(d)):d.asin()},Va=function(d){return"number"===typeof d?0:d.imaginaryPart()},Oa=function(d){return"number"===typeof d?d:d.realPart()},ib=function(d){return"number"===typeof d?d:d.round()},Xa=function(d){return H(d,d)},jb=function(d){$(d)||B("integer-sqrt: the argument "+d.toString()+
" is not an integer.",d);return"number"===typeof d?0>d?G.makeInstance(0,Math.floor(Math.sqrt(-d))):Math.floor(Math.sqrt(d)):d.integerSqrt()},cb=function(d,h){$(d)||B("quotient: the first argument "+d.toString()+" is not an integer.",d);$(h)||B("quotient: the second argument "+h.toString()+" is not an integer.",h);return kb(d,h)},h=function(d,h){$(d)||B("remainder: the first argument "+d.toString()+" is not an integer.",d);$(h)||B("remainder: the second argument "+h.toString()+" is not an integer.",
h);return Ab(d,h)},d=function(d){return-9E15>d||9E15<d},t=function(d){return"number"===typeof d?-d:d.negate()},i=function(d,h){for(var b=1;;){if(Da(h))return b;wa(Ba(h,2),0)?(d=H(d,d),h=ka(h,2)):(b=H(b,d),h=ja(h,1))}},na=function(h,b,g){g=g||{};return function(t,c){t instanceof K?t=Qa(t):t instanceof G&&(t=Oa(t));c instanceof K?c=Qa(c):c instanceof G&&(c=Oa(c));if("number"===typeof t&&"number"===typeof c){var i=h(t,c);if(!d(i)||g.ignoreOverflow)return i}if(t instanceof v||c instanceof v)return g.doNotCoerseToFloating?
h(l(t),l(c)):v.makeInstance(h(l(t),l(c)));"number"===typeof t&&(t=Ca(t));"number"===typeof c&&(c=Ca(c));return b(t,c)}},Ja=function(h,b,g){g=g||{};return function(t){t instanceof K?t=Qa(t):t instanceof G&&(t=Oa(t));if("number"===typeof t){var c=h(t);if(!d(c)||g.ignoreOverflow)return c}if(t instanceof v)return h(l(t));"number"===typeof t&&(t=Ca(t));return b(t)}},db=na(function(d,h){return d%h},function(d,h){return R.call(d,h)}),qb=na(function(d,h){for(var b;0!==h;)b=d,d=h,h=b%h;return d},function(d,
h){return E.call(d,h)}),Da=Ja(function(d){return 0===d},function(d){return pa.call(d,k.ZERO)}),ab=Ja(function(d){return 1===d},function(d){return pa.call(d,k.ONE)}),ob=Ja(function(d){return-1===d},function(d){return pa.call(d,k.NEGATIVE_ONE)}),Bb=na(function(d,h){return d+h},function(d,h){return ma.call(d,h)}),Cb=na(function(d,h){return d-h},function(d,h){return p.call(d,h)}),Ha=na(function(d,h){return d*h},function(d,h){return j.call(d,h)}),kb=na(function(d,h){return(d-d%h)/h},function(d,h){return z.call(d,
h)}),Ab=na(function(d,h){return d%h},function(d,h){return la.call(d,h)}),La=na(function(d,h){return d/h},function(d,h){return l(d)/l(h)},{ignoreOverflow:!0,doNotCoerseToFloating:!0}),sb=na(function(d,h){return d===h},function(d,h){return pa.call(d,h)},{doNotCoerseToFloating:!0}),tb=na(function(d,h){return d>h},function(d,h){return 0<ca.call(d,h)},{doNotCoerseToFloating:!0}),rb=na(function(d,h){return d<h},function(d,h){return 0>ca.call(d,h)},{doNotCoerseToFloating:!0}),ub=na(function(d,h){return d>=
h},function(d,h){return 0<=ca.call(d,h)},{doNotCoerseToFloating:!0}),Db=na(function(d,h){return d<=h},function(d,h){return 0>=ca.call(d,h)},{doNotCoerseToFloating:!0}),K=function(d,h){this.n=d;this.d=h};K.prototype.toString=function(){return ab(this.d)?this.n.toString()+"":this.n.toString()+"/"+this.d.toString()};K.prototype.level=1;K.prototype.liftTo=function(d){return 2===d.level?new v(La(this.n,this.d)):3===d.level?new G(this,0):B("invalid level of Number",this,d)};K.prototype.isFinite=function(){return!0};
K.prototype.equals=function(d){return d instanceof K&&sb(this.n,d.n)&&sb(this.d,d.d)};K.prototype.isInteger=function(){return ab(this.d)};K.prototype.isRational=function(){return!0};K.prototype.isReal=function(){return!0};K.prototype.add=function(d){return K.makeInstance(Bb(Ha(this.n,d.d),Ha(this.d,d.n)),Ha(this.d,d.d))};K.prototype.subtract=function(d){return K.makeInstance(Cb(Ha(this.n,d.d),Ha(this.d,d.n)),Ha(this.d,d.d))};K.prototype.negate=function(){return K.makeInstance(-this.n,this.d)};K.prototype.multiply=
function(d){return K.makeInstance(Ha(this.n,d.n),Ha(this.d,d.d))};K.prototype.divide=function(d){(Da(this.d)||Da(d.n))&&B("/: division by zero",this,d);return K.makeInstance(Ha(this.n,d.d),Ha(this.d,d.n))};K.prototype.toExact=function(){return this};K.prototype.toInexact=function(){return v.makeInstance(this.toFixnum())};K.prototype.isExact=function(){return!0};K.prototype.isInexact=function(){return!1};K.prototype.toFixnum=function(){return La(this.n,this.d)};K.prototype.numerator=function(){return this.n};
K.prototype.denominator=function(){return this.d};K.prototype.greaterThan=function(d){return tb(Ha(this.n,d.d),Ha(this.d,d.n))};K.prototype.greaterThanOrEqual=function(d){return ub(Ha(this.n,d.d),Ha(this.d,d.n))};K.prototype.lessThan=function(d){return rb(Ha(this.n,d.d),Ha(this.d,d.n))};K.prototype.lessThanOrEqual=function(d){return Db(Ha(this.n,d.d),Ha(this.d,d.n))};K.prototype.integerSqrt=function(){var d=g(this);return Fa(d)?u(ga(d)):qa(d)?u(ga(d)):G.makeInstance(u(ga(Oa(d))),u(ga(Va(d))))};K.prototype.sqrt=
function(){if(ub(this.n,0)){var d=g(this.n),h=g(this.d);return wa(ga(d),d)&&wa(ga(h),h)?K.makeInstance(d,h):v.makeInstance(La(d,h))}d=g(t(this.n));h=g(this.d);return wa(ga(d),d)&&wa(ga(h),h)?G.makeInstance(0,K.makeInstance(d,h)):G.makeInstance(0,v.makeInstance(La(d,h)))};K.prototype.abs=function(){return K.makeInstance(S(this.n),this.d)};K.prototype.floor=function(){var d=kb(this.n,this.d);return rb(this.n,0)?ja(d,1):d};K.prototype.ceiling=function(){var d=kb(this.n,this.d);return rb(this.n,0)?d:
ba(d,1)};K.prototype.conjugate=function(){return this};K.prototype.magnitude=K.prototype.abs;K.prototype.log=function(){return v.makeInstance(Math.log(this.n/this.d))};K.prototype.angle=function(){return Da(this.n)?0:tb(this.n,0)?0:v.pi};K.prototype.tan=function(){return v.makeInstance(Math.tan(La(this.n,this.d)))};K.prototype.atan=function(){return v.makeInstance(Math.atan(La(this.n,this.d)))};K.prototype.cos=function(){return v.makeInstance(Math.cos(La(this.n,this.d)))};K.prototype.sin=function(){return v.makeInstance(Math.sin(La(this.n,
this.d)))};K.prototype.expt=function(d){return ea(d)&&O(d,0)?i(this,d):v.makeInstance(Math.pow(La(this.n,this.d),La(d.n,d.d)))};K.prototype.exp=function(){return v.makeInstance(Math.exp(La(this.n,this.d)))};K.prototype.acos=function(){return v.makeInstance(Math.acos(La(this.n,this.d)))};K.prototype.asin=function(){return v.makeInstance(Math.asin(La(this.n,this.d)))};K.prototype.imaginaryPart=function(){return 0};K.prototype.realPart=function(){return this};K.prototype.round=function(){if(wa(this.d,
2)){var d=La(this.n,this.d),h=Math.floor(d),d=Math.ceil(d);return Da(h%2)?h:d}return Math.round(this.n/this.d)};K.makeInstance=function(d,h){void 0===d&&B("n undefined",d,h);void 0===h&&(h=1);Da(h)&&B("division by zero: "+d+"/"+h);rb(h,0)&&(d=t(d),h=t(h));var b=qb(S(d),S(h)),d=kb(d,b),h=kb(h,b);return ab(h)||Da(d)?d:new K(d,h)};var v=function(d){this.n=d},lb=new v(Number.NaN),Eb=new v(Number.POSITIVE_INFINITY),vb=new v(Number.NEGATIVE_INFINITY),wb=new v(Number.POSITIVE_INFINITY),xb=new v(Number.NEGATIVE_INFINITY),
Ua=new v(-0.0),yb=new v(0);v.pi=new v(Math.PI);v.e=new v(Math.E);v.nan=lb;v.inf=Eb;v.neginf=vb;v.makeInstance=function(d){return isNaN(d)?v.nan:d===Number.POSITIVE_INFINITY?v.inf:d===Number.NEGATIVE_INFINITY?v.neginf:0===d?-Infinity===1/d?Ua:yb:new v(d)};v.prototype.isExact=function(){return!1};v.prototype.isInexact=function(){return!0};v.prototype.isFinite=function(){return isFinite(this.n)||this===wb||this===xb};v.prototype.toExact=function(){(!isFinite(this.n)||isNaN(this.n))&&B("toExact: no exact representation for "+
this,this);var d=this.n.toString().match(/^(.*)\.(.*)$/);return d?(parseInt(d[1]),parseInt(d[2]),d=Math.pow(10,d[2].length),K.makeInstance(Math.round(this.n*d),d)):this.n};v.prototype.toInexact=function(){return this};v.prototype.isInexact=function(){return!0};v.prototype.level=2;v.prototype.liftTo=function(d){return 3===d.level?new G(this,0):B("invalid level of Number",this,d)};v.prototype.toString=function(){if(isNaN(this.n))return"+nan.0";if(this.n===Number.POSITIVE_INFINITY)return"+inf.0";if(this.n===
Number.NEGATIVE_INFINITY)return"-inf.0";if(this===Ua)return"-0.0";var d=this.n.toString();return d.match("\\.")?d:d+".0"};v.prototype.equals=function(d){return d instanceof v&&this.n===d.n};v.prototype.isRational=function(){return this.isFinite()};v.prototype.isInteger=function(){return this.isFinite()&&this.n===Math.floor(this.n)};v.prototype.isReal=function(){return!0};var mb=function(d){return Ea(d,0)?-1:Ia(d,0)?1:d===Ua?-1:0};v.prototype.add=function(d){return this.isFinite()&&d.isFinite()?v.makeInstance(this.n+
d.n):isNaN(this.n)||isNaN(d.n)?lb:this.isFinite()&&!d.isFinite()?d:!this.isFinite()&&d.isFinite()?this:1===mb(this)*mb(d)?this:lb};v.prototype.subtract=function(d){return this.isFinite()&&d.isFinite()?v.makeInstance(this.n-d.n):isNaN(this.n)||isNaN(d.n)?lb:!this.isFinite()&&!d.isFinite()?mb(this)===mb(d)?lb:this:this.isFinite()?H(d,-1):this};v.prototype.negate=function(){return v.makeInstance(-this.n)};v.prototype.multiply=function(d){return v.makeInstance(this.n*d.n)};v.prototype.divide=function(d){return v.makeInstance(this.n/
d.n)};v.prototype.toFixnum=function(){return this.n};v.prototype.numerator=function(){var d=this.n.toString().match(/^(.*)\.(.*)$/);if(d){var h=parseInt(d[2]),d=Math.pow(10,d[2].length),h=qb(d,h);return v.makeInstance(Math.round(this.n*(d/h)))}return this};v.prototype.denominator=function(){var d=this.n.toString().match(/^(.*)\.(.*)$/);if(d){var h=parseInt(d[2]),d=Math.pow(10,d[2].length),h=qb(d,h);return v.makeInstance(Math.round(d/h))}return v.makeInstance(1)};v.prototype.floor=function(){return v.makeInstance(Math.floor(this.n))};
v.prototype.ceiling=function(){return v.makeInstance(Math.ceil(this.n))};v.prototype.greaterThan=function(d){return this.n>d.n};v.prototype.greaterThanOrEqual=function(d){return this.n>=d.n};v.prototype.lessThan=function(d){return this.n<d.n};v.prototype.lessThanOrEqual=function(d){return this.n<=d.n};v.prototype.integerSqrt=function(){if(this===Ua)return this;if($(this))return 0<=this.n?v.makeInstance(Math.floor(Math.sqrt(this.n))):G.makeInstance(yb,v.makeInstance(Math.floor(Math.sqrt(-this.n))));
B("integerSqrt: can only be applied to an integer",this)};v.prototype.sqrt=function(){return 0>this.n?G.makeInstance(0,v.makeInstance(Math.sqrt(-this.n))):v.makeInstance(Math.sqrt(this.n))};v.prototype.abs=function(){return v.makeInstance(Math.abs(this.n))};v.prototype.log=function(){return 0>this.n?(new G(this,0)).log():v.makeInstance(Math.log(this.n))};v.prototype.angle=function(){return 0===this.n?0:0<this.n?0:v.pi};v.prototype.tan=function(){return v.makeInstance(Math.tan(this.n))};v.prototype.atan=
function(){return v.makeInstance(Math.atan(this.n))};v.prototype.cos=function(){return v.makeInstance(Math.cos(this.n))};v.prototype.sin=function(){return v.makeInstance(Math.sin(this.n))};v.prototype.expt=function(d){return 1===this.n?(d.isFinite()||isNaN(d.n),this):v.makeInstance(Math.pow(this.n,d.n))};v.prototype.exp=function(){return v.makeInstance(Math.exp(this.n))};v.prototype.acos=function(){return v.makeInstance(Math.acos(this.n))};v.prototype.asin=function(){return v.makeInstance(Math.asin(this.n))};
v.prototype.imaginaryPart=function(){return 0};v.prototype.realPart=function(){return this};v.prototype.round=function(){return isFinite(this.n)?this===Ua?this:0.5===Math.abs(Math.floor(this.n)-this.n)?0===Math.floor(this.n)%2?v.makeInstance(Math.floor(this.n)):v.makeInstance(Math.ceil(this.n)):v.makeInstance(Math.round(this.n)):this};v.prototype.conjugate=function(){return this};v.prototype.magnitude=v.prototype.abs;var G=function(d,h){this.r=d;this.i=h};G.makeInstance=function(d,h){void 0===h&&
(h=0);if(za(h)&&$(h)&&Da(h))return d;if(va(d)||va(h))d=ua(d),h=ua(h);return new G(d,h)};G.prototype.toString=function(){var d=this.r.toString(),h=this.i.toString();return"-"===h[0]||"+"===h[0]?d+h+"i":d+"+"+h+"i"};G.prototype.isFinite=function(){return("number"===typeof this.r?isFinite(this.r):this.r.isFinite())&&("number"===typeof this.i?isFinite(this.i):this.i.isFinite())};G.prototype.isRational=function(){return Fa(this.r)&&ta(this.i,0)};G.prototype.isInteger=function(){return $(this.r)&&ta(this.i,
0)};G.prototype.toExact=function(){return G.makeInstance(u(this.r),u(this.i))};G.prototype.toInexact=function(){return G.makeInstance(ua(this.r),ua(this.i))};G.prototype.isExact=function(){return za(this.r)&&za(this.i)};G.prototype.isInexact=function(){return va(this.r)||va(this.i)};G.prototype.level=3;G.prototype.liftTo=function(d){B("Don't know how to lift Complex number",this,d)};G.prototype.equals=function(d){return d instanceof G&&wa(this.r,d.r)&&wa(this.i,d.i)};G.prototype.greaterThan=function(d){(!this.isReal()||
!d.isReal())&&B(">: expects argument of type real number",this,d);return Ia(this.r,d.r)};G.prototype.greaterThanOrEqual=function(d){(!this.isReal()||!d.isReal())&&B(">=: expects argument of type real number",this,d);return O(this.r,d.r)};G.prototype.lessThan=function(d){(!this.isReal()||!d.isReal())&&B("<: expects argument of type real number",this,d);return Ea(this.r,d.r)};G.prototype.lessThanOrEqual=function(d){(!this.isReal()||!d.isReal())&&B("<=: expects argument of type real number",this,d);
return oa(this.r,d.r)};G.prototype.abs=function(){wa(this.i,0).valueOf()||B("abs: expects argument of type real number",this);return S(this.r)};G.prototype.toFixnum=function(){wa(this.i,0).valueOf()||B("toFixnum: expects argument of type real number",this);return l(this.r)};G.prototype.numerator=function(){this.isReal()||B("numerator: can only be applied to real number",this);return Qa(this.n)};G.prototype.denominator=function(){this.isReal()||B("floor: can only be applied to real number",this);return P(this.n)};
G.prototype.add=function(d){return G.makeInstance(ba(this.r,d.r),ba(this.i,d.i))};G.prototype.subtract=function(d){return G.makeInstance(ja(this.r,d.r),ja(this.i,d.i))};G.prototype.negate=function(){return G.makeInstance(t(this.r),t(this.i))};G.prototype.multiply=function(d){if(d.isReal())return G.makeInstance(H(this.r,d.r),H(this.i,d.r));var h=ja(H(this.r,d.r),H(this.i,d.i)),d=ba(H(this.r,d.i),H(this.i,d.r));return G.makeInstance(h,d)};G.prototype.divide=function(d){var h,b,g,t,c;if(d.isReal())return G.makeInstance(ka(this.r,
d.r),ka(this.i,d.r));if(this.isInexact()||d.isInexact())return h=this.r,b=this.i,g=d.r,t=d.i,oa(S(t),S(g))?(c=ka(t,g),d=ka(ba(h,H(b,c)),ba(g,H(t,c))),h=ka(ja(b,H(h,c)),ba(g,H(t,c)))):(c=ka(g,t),d=ka(ba(H(h,c),b),ba(H(g,c),t)),h=ka(ja(H(b,c),h),ba(H(g,c),t))),G.makeInstance(d,h);b=Ta(d);h=H(this,b);b=Oa(H(d,b));return G.makeInstance(ka(Oa(h),b),ka(Va(h),b))};G.prototype.conjugate=function(){return G.makeInstance(this.r,ja(0,this.i))};G.prototype.magnitude=function(){var d=ba(H(this.r,this.r),H(this.i,
this.i));return g(d)};G.prototype.isReal=function(){return ta(this.i,0)};G.prototype.integerSqrt=function(){if($(this))return jb(this.r);B("integerSqrt: can only be applied to an integer",this)};G.prototype.sqrt=function(){if(this.isReal())return g(this.r);var d=ba(this.magnitude(),this.r),h=g(ka(d,2)),d=ka(this.i,g(H(d,2)));return G.makeInstance(h,d)};G.prototype.log=function(){var d=this.magnitude(),h=this.angle();return ba(Ra(d),H(h,Sa))};G.prototype.angle=function(){if(this.isReal())return pb(this.r);
if(wa(0,this.r)){var d=ka(v.pi,2);return Ia(this.i,0)?d:t(d)}d=eb(ka(S(this.i),S(this.r)));return Ia(this.r,0)?Ia(this.i,0)?d:t(d):Ia(this.i,0)?ja(v.pi,d):ja(d,v.pi)};var Sa=G.makeInstance(0,1),zb=G.makeInstance(0,-1);G.prototype.tan=function(){return ka(this.sin(),this.cos())};G.prototype.atan=function(){return wa(this,Sa)||wa(this,zb)?vb:H(Sa,H(v.makeInstance(0.5),Ra(ka(ba(Sa,this),ba(Sa,ja(0,this))))))};G.prototype.cos=function(){if(this.isReal())return Wa(this.r);var d=H(this,Sa),h=t(d),d=ba(ya(d),
ya(h));return ka(d,2)};G.prototype.sin=function(){if(this.isReal())return bb(this.r);var d=H(this,Sa),h=t(d),b=G.makeInstance(0,2),d=ja(ya(d),ya(h));return ka(d,b)};G.prototype.expt=function(d){if(ea(d)&&O(d,0))return i(this,d);d=H(d,this.log());return ya(d)};G.prototype.exp=function(){var d=ya(this.r),h=Wa(this.i),b=bb(this.i);return H(d,ba(h,H(b,Sa)))};G.prototype.acos=function(){if(this.isReal())return gb(this.r);var d=ka(v.pi,2),h=H(this,Sa),b=g(ja(1,Xa(this))),h=Ra(ba(h,b)),h=H(h,Sa);return ba(d,
h)};G.prototype.asin=function(){if(this.isReal())return hb(this.r);var d=ja(1,Xa(this)),d=g(d);return H(2,eb(ka(this,ba(1,d))))};G.prototype.ceiling=function(){this.isReal()||B("ceiling: can only be applied to real number",this);return Aa(this.r)};G.prototype.floor=function(){this.isReal()||B("floor: can only be applied to real number",this);return ga(this.r)};G.prototype.imaginaryPart=function(){return this.i};G.prototype.realPart=function(){return this.r};G.prototype.round=function(){this.isReal()||
B("round: can only be applied to real number",this);return ib(this.r)};var Fb=/^(#[ei]#[bodx]|#[bodx]#[ei]|#[bodxei])(.*)$/,Za;"undefined"!==typeof navigator&&"Microsoft Internet Explorer"==navigator.appName?(k.prototype.am=T,Za=30):"undefined"!==typeof navigator&&"Netscape"!=navigator.appName?(k.prototype.am=aa,Za=26):(k.prototype.am=sa,Za=28);k.prototype.DB=Za;k.prototype.DM=(1<<Za)-1;k.prototype.DV=1<<Za;k.prototype.FV=Math.pow(2,52);k.prototype.F1=52-Za;k.prototype.F2=2*Za-52;var nb=[],fb,Pa;
fb=48;for(Pa=0;9>=Pa;++Pa)nb[fb++]=Pa;fb=97;for(Pa=10;36>Pa;++Pa)nb[fb++]=Pa;fb=65;for(Pa=10;36>Pa;++Pa)nb[fb++]=Pa;ia.prototype.convert=function(d){return 0>d.s||0<=d.compareTo(this.m)?d.mod(this.m):d};ia.prototype.revert=function(d){return d};ia.prototype.reduce=function(d){d.divRemTo(this.m,null,d)};ia.prototype.mulTo=function(d,h,b){d.multiplyTo(h,b);this.reduce(b)};ia.prototype.sqrTo=function(d,h){d.squareTo(h);this.reduce(h)};L.prototype.convert=function(d){var h=A();d.abs().dlShiftTo(this.m.t,
h);h.divRemTo(this.m,null,h);0>d.s&&0<h.compareTo(k.ZERO)&&this.m.subTo(h,h);return h};L.prototype.revert=function(d){var h=A();d.copyTo(h);this.reduce(h);return h};L.prototype.reduce=function(d){for(;d.t<=this.mt2;)d[d.t++]=0;for(var h=0;h<this.m.t;++h){var b=d[h]&32767,g=b*this.mpl+((b*this.mph+(d[h]>>15)*this.mpl&this.um)<<15)&d.DM,b=h+this.m.t;for(d[b]+=this.m.am(0,g,d,h,0,this.m.t);d[b]>=d.DV;)d[b]-=d.DV,d[++b]++}d.clamp();d.drShiftTo(this.m.t,d);0<=d.compareTo(this.m)&&d.subTo(this.m,d)};L.prototype.mulTo=
function(d,h,b){d.multiplyTo(h,b);this.reduce(b)};L.prototype.sqrTo=function(d,h){d.squareTo(h);this.reduce(h)};k.prototype.copyTo=function(d){for(var h=this.t-1;0<=h;--h)d[h]=this[h];d.t=this.t;d.s=this.s};k.prototype.fromInt=function(d){this.t=1;this.s=0>d?-1:0;0<d?this[0]=d:-1>d?this[0]=d+DV:this.t=0};k.prototype.fromString=function(d,h){var b;if(16==h)b=4;else if(8==h)b=3;else if(256==h)b=8;else if(2==h)b=1;else if(32==h)b=5;else if(4==h)b=2;else{this.fromRadix(d,h);return}this.s=this.t=0;for(var g=
d.length,t=!1,c=0;0<=--g;){var i=8==b?d[g]&255:W(d,g);0>i?"-"==d.charAt(g)&&(t=!0):(t=!1,0==c?this[this.t++]=i:c+b>this.DB?(this[this.t-1]|=(i&(1<<this.DB-c)-1)<<c,this[this.t++]=i>>this.DB-c):this[this.t-1]|=i<<c,c+=b,c>=this.DB&&(c-=this.DB))}8==b&&0!=(d[0]&128)&&(this.s=-1,0<c&&(this[this.t-1]|=(1<<this.DB-c)-1<<c));this.clamp();t&&k.ZERO.subTo(this,this)};k.prototype.clamp=function(){for(var d=this.s&this.DM;0<this.t&&this[this.t-1]==d;)--this.t};k.prototype.dlShiftTo=function(d,h){var b;for(b=
this.t-1;0<=b;--b)h[b+d]=this[b];for(b=d-1;0<=b;--b)h[b]=0;h.t=this.t+d;h.s=this.s};k.prototype.drShiftTo=function(d,h){for(var b=d;b<this.t;++b)h[b-d]=this[b];h.t=Math.max(this.t-d,0);h.s=this.s};k.prototype.lShiftTo=function(d,h){var b=d%this.DB,g=this.DB-b,t=(1<<g)-1,c=Math.floor(d/this.DB),i=this.s<<b&this.DM,j;for(j=this.t-1;0<=j;--j)h[j+c+1]=this[j]>>g|i,i=(this[j]&t)<<b;for(j=c-1;0<=j;--j)h[j]=0;h[c]=i;h.t=this.t+c+1;h.s=this.s;h.clamp()};k.prototype.rShiftTo=function(d,h){h.s=this.s;var b=
Math.floor(d/this.DB);if(b>=this.t)h.t=0;else{var g=d%this.DB,t=this.DB-g,c=(1<<g)-1;h[0]=this[b]>>g;for(var i=b+1;i<this.t;++i)h[i-b-1]|=(this[i]&c)<<t,h[i-b]=this[i]>>g;0<g&&(h[this.t-b-1]|=(this.s&c)<<t);h.t=this.t-b;h.clamp()}};k.prototype.subTo=function(d,h){for(var b=0,g=0,t=Math.min(d.t,this.t);b<t;)g+=this[b]-d[b],h[b++]=g&this.DM,g>>=this.DB;if(d.t<this.t){for(g-=d.s;b<this.t;)g+=this[b],h[b++]=g&this.DM,g>>=this.DB;g+=this.s}else{for(g+=this.s;b<d.t;)g-=d[b],h[b++]=g&this.DM,g>>=this.DB;
g-=d.s}h.s=0>g?-1:0;-1>g?h[b++]=this.DV+g:0<g&&(h[b++]=g);h.t=b;h.clamp()};k.prototype.multiplyTo=function(d,h){var b=this.abs(),g=d.abs(),t=b.t;for(h.t=t+g.t;0<=--t;)h[t]=0;for(t=0;t<g.t;++t)h[t+b.t]=b.am(0,g[t],h,t,0,b.t);h.s=0;h.clamp();this.s!=d.s&&k.ZERO.subTo(h,h)};k.prototype.squareTo=function(d){for(var h=this.abs(),b=d.t=2*h.t;0<=--b;)d[b]=0;for(b=0;b<h.t-1;++b){var g=h.am(b,h[b],d,2*b,0,1);if((d[b+h.t]+=h.am(b+1,2*h[b],d,2*b+1,g,h.t-b-1))>=h.DV)d[b+h.t]-=h.DV,d[b+h.t+1]=1}0<d.t&&(d[d.t-
1]+=h.am(b,h[b],d,2*b,0,1));d.s=0;d.clamp()};k.prototype.divRemTo=function(d,h,b){var g=d.abs();if(!(0>=g.t)){var t=this.abs();if(t.t<g.t)null!=h&&h.fromInt(0),null!=b&&this.copyTo(b);else{null==b&&(b=A());var c=A(),i=this.s,d=d.s,j=this.DB-X(g[g.t-1]);0<j?(g.lShiftTo(j,c),t.lShiftTo(j,b)):(g.copyTo(c),t.copyTo(b));g=c.t;t=c[g-1];if(0!=t){var na=t*(1<<this.F1)+(1<g?c[g-2]>>this.F2:0),l=this.FV/na,na=(1<<this.F1)/na,Ja=1<<this.F2,u=b.t,S=u-g,z=null==h?A():h;c.dlShiftTo(S,z);0<=b.compareTo(z)&&(b[b.t++]=
1,b.subTo(z,b));k.ONE.dlShiftTo(g,z);for(z.subTo(c,c);c.t<g;)c[c.t++]=0;for(;0<=--S;){var db=b[--u]==t?this.DM:Math.floor(b[u]*l+(b[u-1]+Ja)*na);if((b[u]+=c.am(0,db,b,S,0,g))<db){c.dlShiftTo(S,z);for(b.subTo(z,b);b[u]<--db;)b.subTo(z,b)}}null!=h&&(b.drShiftTo(g,h),i!=d&&k.ZERO.subTo(h,h));b.t=g;b.clamp();0<j&&b.rShiftTo(j,b);0>i&&k.ZERO.subTo(b,b)}}}};k.prototype.invDigit=function(){if(1>this.t)return 0;var d=this[0];if(0==(d&1))return 0;var h=d&3,h=h*(2-(d&15)*h)&15,h=h*(2-(d&255)*h)&255,h=h*(2-
((d&65535)*h&65535))&65535,h=h*(2-d*h%this.DV)%this.DV;return 0<h?this.DV-h:-h};k.prototype.isEven=function(){return 0==(0<this.t?this[0]&1:this.s)};k.prototype.bnpExp=function(d,h){if(4294967295<d||1>d)return k.ONE;var b=A(),g=A(),t=h.convert(this),c=X(d)-1;for(t.copyTo(b);0<=--c;)if(h.sqrTo(b,g),0<(d&1<<c))h.mulTo(g,t,b);else var i=b,b=g,g=i;return h.revert(b)};k.prototype.toString=function(d){if(0>this.s)return"-"+this.negate().toString(d);if(16==d)d=4;else if(8==d)d=3;else if(2==d)d=1;else if(32==
d)d=5;else if(4==d)d=2;else return this.toRadix(d);var h=(1<<d)-1,b,g=!1,t=[],c=this.t,i=this.DB-c*this.DB%d;if(0<c--){if(i<this.DB&&0<(b=this[c]>>i))g=!0,t.push("0123456789abcdefghijklmnopqrstuvwxyz".charAt(b));for(;0<=c;)i<d?(b=(this[c]&(1<<i)-1)<<d-i,b|=this[--c]>>(i+=this.DB-d)):(b=this[c]>>(i-=d)&h,0>=i&&(i+=this.DB,--c)),0<b&&(g=!0),g&&t.push("0123456789abcdefghijklmnopqrstuvwxyz".charAt(b))}return g?t.join(""):"0"};k.prototype.negate=function(){var d=A();k.ZERO.subTo(this,d);return d};k.prototype.abs=
function(){return 0>this.s?this.negate():this};k.prototype.compareTo=ca;k.prototype.bitLength=function(){return 0>=this.t?0:this.DB*(this.t-1)+X(this[this.t-1]^this.s&this.DM)};k.prototype.mod=R;k.prototype.modPowInt=function(d,h){var b;b=256>d||h.isEven()?new ia(h):new L(h);return this.exp(d,b)};k.ZERO=C(0);k.ONE=C(1);F.prototype.convert=Ka;F.prototype.revert=Ka;F.prototype.mulTo=function(d,h,b){d.multiplyTo(h,b)};F.prototype.sqrTo=function(d,h){d.squareTo(h)};Q.prototype.convert=function(d){if(0>
d.s||d.t>2*this.m.t)return d.mod(this.m);if(0>d.compareTo(this.m))return d;var h=A();d.copyTo(h);this.reduce(h);return h};Q.prototype.revert=function(d){return d};Q.prototype.reduce=function(d){d.drShiftTo(this.m.t-1,this.r2);d.t>this.m.t+1&&(d.t=this.m.t+1,d.clamp());this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3);for(this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);0>d.compareTo(this.r2);)d.dAddOffset(1,this.m.t+1);for(d.subTo(this.r2,d);0<=d.compareTo(this.m);)d.subTo(this.m,d)};Q.prototype.mulTo=
function(d,h,b){d.multiplyTo(h,b);this.reduce(b)};Q.prototype.sqrTo=function(d,h){d.squareTo(h);this.reduce(h)};var Ma=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],Gb=67108864/Ma[Ma.length-
1];k.prototype.chunkSize=function(d){return Math.floor(Math.LN2*this.DB/Math.log(d))};k.prototype.toRadix=function(d){null==d&&(d=10);if(0==this.signum()||2>d||36<d)return"0";var h=this.chunkSize(d),h=Math.pow(d,h),b=C(h),g=A(),t=A(),c="";for(this.divRemTo(b,g,t);0<g.signum();)c=(h+t.intValue()).toString(d).substr(1)+c,g.divRemTo(b,g,t);return t.intValue().toString(d)+c};k.prototype.fromRadix=function(d,h){this.fromInt(0);null==h&&(h=10);for(var b=this.chunkSize(h),g=Math.pow(h,b),t=!1,c=0,i=0,j=
0;j<d.length;++j){var na=W(d,j);0>na?"-"==d.charAt(j)&&0==this.signum()&&(t=!0):(i=h*i+na,++c>=b&&(this.dMultiply(g),this.dAddOffset(i,0),i=c=0))}0<c&&(this.dMultiply(Math.pow(h,c)),this.dAddOffset(i,0));t&&k.ZERO.subTo(this,this)};k.prototype.fromNumber=function(d,h,b){if("number"==typeof h)if(2>d)this.fromInt(1);else{this.fromNumber(d,b);this.testBit(d-1)||this.bitwiseTo(k.ONE.shiftLeft(d-1),V,this);for(this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(h);)this.dAddOffset(2,0),this.bitLength()>
d&&this.subTo(k.ONE.shiftLeft(d-1),this)}else{var b=[],g=d&7;b.length=(d>>3)+1;h.nextBytes(b);b[0]=0<g?b[0]&(1<<g)-1:0;this.fromString(b,256)}};k.prototype.bitwiseTo=function(d,h,b){var g,t,c=Math.min(d.t,this.t);for(g=0;g<c;++g)b[g]=h(this[g],d[g]);if(d.t<this.t){t=d.s&this.DM;for(g=c;g<this.t;++g)b[g]=h(this[g],t);b.t=this.t}else{t=this.s&this.DM;for(g=c;g<d.t;++g)b[g]=h(t,d[g]);b.t=d.t}b.s=h(this.s,d.s);b.clamp()};k.prototype.changeBit=function(d,h){var b=k.ONE.shiftLeft(d);this.bitwiseTo(b,h,
b);return b};k.prototype.addTo=function(d,h){for(var b=0,g=0,t=Math.min(d.t,this.t);b<t;)g+=this[b]+d[b],h[b++]=g&this.DM,g>>=this.DB;if(d.t<this.t){for(g+=d.s;b<this.t;)g+=this[b],h[b++]=g&this.DM,g>>=this.DB;g+=this.s}else{for(g+=this.s;b<d.t;)g+=d[b],h[b++]=g&this.DM,g>>=this.DB;g+=d.s}h.s=0>g?-1:0;0<g?h[b++]=g:-1>g&&(h[b++]=this.DV+g);h.t=b;h.clamp()};k.prototype.dMultiply=function(d){this[this.t]=this.am(0,d-1,this,0,0,this.t);++this.t;this.clamp()};k.prototype.dAddOffset=function(d,h){if(0!=
d){for(;this.t<=h;)this[this.t++]=0;for(this[h]+=d;this[h]>=this.DV;)this[h]-=this.DV,++h>=this.t&&(this[this.t++]=0),++this[h]}};k.prototype.multiplyLowerTo=function(d,h,b){var g=Math.min(this.t+d.t,h);b.s=0;for(b.t=g;0<g;)b[--g]=0;var t;for(t=b.t-this.t;g<t;++g)b[g+this.t]=this.am(0,d[g],b,g,0,this.t);for(t=Math.min(d.t,h);g<t;++g)this.am(0,d[g],b,g,0,h-g);b.clamp()};k.prototype.multiplyUpperTo=function(d,h,b){--h;var g=b.t=this.t+d.t-h;for(b.s=0;0<=--g;)b[g]=0;for(g=Math.max(h-this.t,0);g<d.t;++g)b[this.t+
g-h]=this.am(h-g,d[g],b,0,0,this.t+g-h);b.clamp();b.drShiftTo(1,b)};k.prototype.modInt=function(d){if(0>=d)return 0;var h=this.DV%d,b=0>this.s?d-1:0;if(0<this.t)if(0==h)b=this[0]%d;else for(var g=this.t-1;0<=g;--g)b=(h*b+this[g])%d;return b};k.prototype.millerRabin=function(d){var h=this.subtract(k.ONE),b=h.getLowestSetBit();if(0>=b)return!1;var g=h.shiftRight(b),d=d+1>>1;d>Ma.length&&(d=Ma.length);for(var t=A(),c=0;c<d;++c){t.fromInt(Ma[c]);var i=t.modPow(g,this);if(0!=i.compareTo(k.ONE)&&0!=i.compareTo(h)){for(var j=
1;j++<b&&0!=i.compareTo(h);)if(i=i.modPowInt(2,this),0==i.compareTo(k.ONE))return!1;if(0!=i.compareTo(h))return!1}}return!0};k.prototype.clone=function(){var d=A();this.copyTo(d);return d};k.prototype.intValue=function(){if(0>this.s){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]};k.prototype.byteValue=function(){return 0==this.t?this.s:this[0]<<24>>24};k.prototype.shortValue=function(){return 0==
this.t?this.s:this[0]<<16>>16};k.prototype.signum=function(){return 0>this.s?-1:0>=this.t||1==this.t&&0>=this[0]?0:1};k.prototype.toByteArray=function(){var d=this.t,h=[];h[0]=this.s;var b=this.DB-d*this.DB%8,g,t=0;if(0<d--){if(b<this.DB&&(g=this[d]>>b)!=(this.s&this.DM)>>b)h[t++]=g|this.s<<this.DB-b;for(;0<=d;)if(8>b?(g=(this[d]&(1<<b)-1)<<8-b,g|=this[--d]>>(b+=this.DB-8)):(g=this[d]>>(b-=8)&255,0>=b&&(b+=this.DB,--d)),0!=(g&128)&&(g|=-256),0==t&&(this.s&128)!=(g&128)&&++t,0<t||g!=this.s)h[t++]=
g}return h};k.prototype.equals=pa;k.prototype.min=function(d){return 0>this.compareTo(d)?this:d};k.prototype.max=function(d){return 0<this.compareTo(d)?this:d};k.prototype.and=function(d){var h=A();this.bitwiseTo(d,y,h);return h};k.prototype.or=function(d){var h=A();this.bitwiseTo(d,V,h);return h};k.prototype.xor=function(d){var h=A();this.bitwiseTo(d,Z,h);return h};k.prototype.andNot=function(d){var h=A();this.bitwiseTo(d,ha,h);return h};k.prototype.not=function(){for(var d=A(),h=0;h<this.t;++h)d[h]=
this.DM&~this[h];d.t=this.t;d.s=~this.s;return d};k.prototype.shiftLeft=function(d){var h=A();0>d?this.rShiftTo(-d,h):this.lShiftTo(d,h);return h};k.prototype.shiftRight=function(d){var h=A();0>d?this.lShiftTo(-d,h):this.rShiftTo(d,h);return h};k.prototype.getLowestSetBit=function(){for(var d=0;d<this.t;++d)if(0!=this[d]){var h=d*this.DB;d=this[d];if(0==d)d=-1;else{var b=0;0==(d&65535)&&(d>>=16,b+=16);0==(d&255)&&(d>>=8,b+=8);0==(d&15)&&(d>>=4,b+=4);0==(d&3)&&(d>>=2,b+=2);0==(d&1)&&++b;d=b}return h+
d}return 0>this.s?this.t*this.DB:-1};k.prototype.bitCount=function(){for(var d=0,h=this.s&this.DM,b=0;b<this.t;++b){for(var g=this[b]^h,t=0;0!=g;)g&=g-1,++t;d+=t}return d};k.prototype.testBit=function(d){var h=Math.floor(d/this.DB);return h>=this.t?0!=this.s:0!=(this[h]&1<<d%this.DB)};k.prototype.setBit=function(d){return this.changeBit(d,V)};k.prototype.clearBit=function(d){return this.changeBit(d,ha)};k.prototype.flipBit=function(d){return this.changeBit(d,Z)};k.prototype.add=ma;k.prototype.subtract=
p;k.prototype.multiply=j;k.prototype.divide=z;k.prototype.remainder=la;k.prototype.divideAndRemainder=M;k.prototype.modPow=function(d,h){var b=d.bitLength(),g,t=C(1),c;if(0>=b)return t;g=18>b?1:48>b?3:144>b?4:768>b?5:6;c=8>b?new ia(h):h.isEven()?new Q(h):new L(h);var i=[],j=3,na=g-1,l=(1<<g)-1;i[1]=c.convert(this);if(1<g){b=A();for(c.sqrTo(i[1],b);j<=l;)i[j]=A(),c.mulTo(b,i[j-2],i[j]),j+=2}for(var Ja=d.t-1,u,S=!0,z=A(),b=X(d[Ja])-1;0<=Ja;){b>=na?u=d[Ja]>>b-na&l:(u=(d[Ja]&(1<<b+1)-1)<<na-b,0<Ja&&(u|=
d[Ja-1]>>this.DB+b-na));for(j=g;0==(u&1);)u>>=1,--j;if(0>(b-=j))b+=this.DB,--Ja;if(S)i[u].copyTo(t),S=!1;else{for(;1<j;)c.sqrTo(t,z),c.sqrTo(z,t),j-=2;0<j?c.sqrTo(t,z):(j=t,t=z,z=j);c.mulTo(z,i[u],t)}for(;0<=Ja&&0==(d[Ja]&1<<b);)c.sqrTo(t,z),j=t,t=z,z=j,0>--b&&(b=this.DB-1,--Ja)}return c.revert(t)};k.prototype.modInverse=function(d){var h=d.isEven();if(this.isEven()&&h||0==d.signum())return k.ZERO;for(var b=d.clone(),g=this.clone(),t=C(1),c=C(0),i=C(0),j=C(1);0!=b.signum();){for(;b.isEven();){b.rShiftTo(1,
b);if(h){if(!t.isEven()||!c.isEven())t.addTo(this,t),c.subTo(d,c);t.rShiftTo(1,t)}else c.isEven()||c.subTo(d,c);c.rShiftTo(1,c)}for(;g.isEven();){g.rShiftTo(1,g);if(h){if(!i.isEven()||!j.isEven())i.addTo(this,i),j.subTo(d,j);i.rShiftTo(1,i)}else j.isEven()||j.subTo(d,j);j.rShiftTo(1,j)}0<=b.compareTo(g)?(b.subTo(g,b),h&&t.subTo(i,t),c.subTo(j,c)):(g.subTo(b,g),h&&i.subTo(t,i),j.subTo(c,j))}if(0!=g.compareTo(k.ONE))return k.ZERO;if(0<=j.compareTo(d))return j.subtract(d);if(0>j.signum())j.addTo(d,j);
else return j;return 0>j.signum()?j.add(d):j};k.prototype.pow=ra;k.prototype.expt=ra;k.prototype.gcd=E;k.prototype.isProbablePrime=function(d){var h,b=this.abs();if(1==b.t&&b[0]<=Ma[Ma.length-1]){for(h=0;h<Ma.length;++h)if(b[0]==Ma[h])return!0;return!1}if(b.isEven())return!1;for(h=1;h<Ma.length;){for(var g=Ma[h],t=h+1;t<Ma.length&&g<Gb;)g*=Ma[t++];for(g=b.modInt(g);h<t;)if(0==g%Ma[h++])return!1}return b.millerRabin(d)};k.NEGATIVE_ONE=k.ONE.negate();var Ca=function(d){"number"===typeof d&&(d+="");
d=Y(d);return new k(d,10)};k.prototype.level=0;k.prototype.liftTo=function(d){if(1===d.level)return new K(this,1);return 2===d.level?(d=this.toFixnum(),d===Number.POSITIVE_INFINITY?wb:d===Number.NEGATIVE_INFINITY?xb:new v(d)):3===d.level?new G(this,0):B("invalid level for BigInteger lift",this,d)};k.prototype.isFinite=function(){return!0};k.prototype.isInteger=function(){return!0};k.prototype.isRational=function(){return!0};k.prototype.isReal=function(){return!0};k.prototype.isExact=function(){return!0};
k.prototype.isInexact=function(){return!1};k.prototype.toExact=function(){return this};k.prototype.toInexact=function(){return v.makeInstance(this.toFixnum())};k.prototype.toFixnum=function(){var d=0,h=this.toString(),b;if("-"===h[0]){for(b=1;b<h.length;b++)d=10*d+Number(h[b]);return-d}for(b=0;b<h.length;b++)d=10*d+Number(h[b]);return d};k.prototype.greaterThan=function(d){return 0<this.compareTo(d)};k.prototype.greaterThanOrEqual=function(d){return 0<=this.compareTo(d)};k.prototype.lessThan=function(d){return 0>
this.compareTo(d)};k.prototype.lessThanOrEqual=function(d){return 0>=this.compareTo(d)};k.prototype.divide=function(d){var h=M.call(this,d);return 0===h[1].compareTo(k.ZERO)?h[0]:ba(h[0],K.makeInstance(h[1],d))};k.prototype.numerator=function(){return this};k.prototype.denominator=function(){return 1};(function(){var d=function(d,h){for(;!oa(Xa(h),d)||!Ea(d,Xa(ba(h,1)));)h=ga(ka(ba(h,ga(ka(d,h))),2));return h};k.prototype.integerSqrt=function(){var h;if(0<=mb(this))return d(this,this);h=this.negate();
return G.makeInstance(0,d(h,h))}})();(function(){k.prototype.sqrt=function(){var d=this.integerSqrt(),h;if(ta(Xa(d),this))return d;h=l(this);return isFinite(h)?0<=h?v.makeInstance(Math.sqrt(h)):G.makeInstance(0,v.makeInstance(Math.sqrt(-h))):d}})();k.prototype.floor=function(){return this};k.prototype.ceiling=function(){return this};k.prototype.conjugate=da("conjugate");k.prototype.magnitude=da("magnitude");k.prototype.log=da("log");k.prototype.angle=da("angle");k.prototype.atan=da("atan");k.prototype.acos=
da("acos");k.prototype.asin=da("asin");k.prototype.tan=da("tan");k.prototype.cos=da("cos");k.prototype.sin=da("sin");k.prototype.exp=da("exp");k.prototype.imaginaryPart=function(){return 0};k.prototype.realPart=function(){return this};k.prototype.round=function(){return this};var Hb=function(){return function(d,b,g){var t=512;g&&"undefined"!==typeof g.limit&&(t=g.limit);$(d)||B("toRepeatingDecimal: n "+d.toString()+" is not an integer.");$(b)||B("toRepeatingDecimal: d "+b.toString()+" is not an integer.");
wa(b,0)&&B("toRepeatingDecimal: d equals 0");Ea(b,0)&&B("toRepeatingDecimal: d < 0");g=Ea(d,0)?"-":"";d=S(d);g+=cb(d,b);a:{var d=h(d,b),c=t,t=[],i={};for(i[d]=!0;;){if(0>=c--){b=[t.join(""),"..."];break a}var j=cb(H(d,10),b),d=h(H(d,10),b);t.push(j.toString());if(i[d])break;else i[d]=!0}i=d;for(c=[];!(j=cb(H(d,10),b),d=h(H(d,10),b),c.push(j.toString()),wa(d,i)););b=t.join("");for(d=c.join("");b.length>=d.length&&b.substring(b.length-d.length)===d;)b=b.substring(0,b.length-d.length);b=[b,d]}return[g].concat(b)}}();
D.fromFixnum=function(h){if(isNaN(h)||!isFinite(h))return v.makeInstance(h);var b=Math.floor(h);return b===h?d(b)?Ca(Y(h+"")):b:v.makeInstance(h)};D.fromString=function(d){var h=10,b=!1,g=d.toLowerCase().match(Fb);if(g){var t=g[1].toLowerCase(),c=t.match(/(#[ei])/),t=t.match(/(#[bodx])/);c&&(c=c[1].charAt(1),b="e"===c?!0:"i"===c?!1:B("invalid exactness flag",this,r));t&&(c=t[1].charAt(1),h="b"===c?2:"o"===c?8:"d"===c?10:"x"===c?16:B("invalid radix flag",this,r))}d=g?g[2]:d;g=g?!0:!1;return(c=d.match(q(o(h))))?
G.makeInstance(w(c[1]||"0",h,b),w(c[2]+(c[3]||"1"),h,b)):w(d,h,b,g)};D.makeBignum=Ca;D.makeRational=K.makeInstance;D.makeFloat=v.makeInstance;D.makeComplex=G.makeInstance;D.makeComplexPolar=function(d,h){return ta(h,0)?d:G.makeInstance(H(d,Wa(h)),H(d,bb(h)))};D.pi=v.pi;D.e=v.e;D.nan=v.nan;D.negative_inf=v.neginf;D.inf=v.inf;D.negative_one=-1;D.zero=0;D.one=1;D.i=Sa;D.negative_i=zb;D.negative_zero=Ua;D.onThrowRuntimeError=function(d){throw Error(d);};D.isSchemeNumber=xa;D.isRational=Fa;D.isReal=qa;
D.isExact=za;D.isInexact=va;D.isInteger=$;D.toFixnum=l;D.toExact=u;D.toInexact=ua;D.add=ba;D.subtract=ja;D.multiply=H;D.divide=ka;D.equals=wa;D.eqv=ta;D.approxEquals=function(d,h,b){return Ea(S(ja(d,h)),b)};D.greaterThanOrEqual=O;D.lessThanOrEqual=oa;D.greaterThan=Ia;D.lessThan=Ea;D.expt=Na;D.exp=ya;D.modulo=Ba;D.numerator=Qa;D.denominator=P;D.integerSqrt=jb;D.sqrt=g;D.abs=S;D.quotient=cb;D.remainder=h;D.floor=ga;D.ceiling=Aa;D.conjugate=Ta;D.magnitude=function(d){return"number"===typeof d?Math.abs(d):
d.magnitude()};D.log=Ra;D.angle=pb;D.tan=Ya;D.atan=eb;D.cos=Wa;D.sin=bb;D.tan=Ya;D.acos=gb;D.asin=hb;D.cosh=function(d){return ta(d,0)?v.makeInstance(1):ka(ba(ya(d),ya(t(d))),2)};D.sinh=function(d){return ka(ja(ya(d),ya(t(d))),2)};D.imaginaryPart=Va;D.realPart=Oa;D.round=ib;D.sqr=Xa;D.gcd=function(d,h){$(d)||B("gcd: the argument "+d.toString()+" is not an integer.",d);for(var b=S(d),g,t,c=0;c<h.length;c++){t=S(h[c]);for($(t)||B("gcd: the argument "+t.toString()+" is not an integer.",t);!Da(t);)g=
b,b=t,t=db(g,t)}return b};D.lcm=function(d,h){$(d)||B("lcm: the argument "+d.toString()+" is not an integer.",d);var b=S(d);if(Da(b))return 0;for(var g=0;g<h.length;g++){$(h[g])||B("lcm: the argument "+h[g].toString()+" is not an integer.",h[g]);var t=qb(b,h[g]);if(Da(t))return 0;b=ka(H(b,h[g]),t)}return b};D.toRepeatingDecimal=Hb;D.BigInteger=k;D.Rational=K;D.FloatPoint=v;D.Complex=G;D.MIN_FIXNUM=-9E15;D.MAX_FIXNUM=9E15})();
var _Hashtable=function(){function m(b){return"function"===typeof b}function q(b){if("string"===typeof b)return b;return m(b.hashCode)?(b=b.hashCode(),"string"!==typeof b?q(b):b):m(b.toString)?b.toString():""+b}function c(b,c){return b.equals(c)}function b(b,c){return m(c.equals)?c.equals(b):b===c}function e(b,c){return b===c}function o(b,c,k,e,o){for(var m,A=0,w=b.length;A<w;A++)if(m=b[A],o(c,k(m)))return e?[A,m]:!0;return!1}function J(b,c){if(m(b.splice))b.splice(c,1);else if(c===b.length-1)b.length=
c;else{var k=b.slice(c+1);b.length=c;for(var e=0,o=k.length;e<o;e++)b[c+e]=k[e]}}function w(b,c){if(null===b)throw Error("null is not a valid "+c);if("undefined"===typeof b)throw Error(c+" must not be undefined");}function k(b,c,k){this.entries=[];this.addEntry(b,c);null!==k&&(this.getEqualityFunction=function(){return k})}function A(b){return b[0]}function aa(b){return b[1]}function T(){}function sa(b){return b[0]}function W(b,c){var k=b[c];return k&&k instanceof T?k[1]:null}k.prototype={getEqualityFunction:function(k){return m(k.equals)?
c:b},searchForEntry:function(b){return o(this.entries,b,A,!0,this.getEqualityFunction(b))},getEntryForKey:function(b){return this.searchForEntry(b)[1]},getEntryIndexForKey:function(b){return this.searchForEntry(b)[0]},removeEntryForKey:function(b){return(b=this.searchForEntry(b))?(J(this.entries,b[0]),!0):!1},addEntry:function(b,c){this.entries[this.entries.length]=[b,c]},size:function(){return this.entries.length},keys:function(b){for(var c=b.length,k=0,e=this.entries.length;k<e;k++)b[c+k]=this.entries[k][0]},
values:function(b){for(var c=b.length,k=0,e=this.entries.length;k<e;k++)b[c+k]=this.entries[k][1]},containsKey:function(b){return o(this.entries,b,A,!1,this.getEqualityFunction(b))},containsValue:function(b){return o(this.entries,b,aa,!1,e)}};T.prototype=[];return function(b,c){var e=[],A={},b=m(b)?b:q,c=m(c)?c:null;this.put=function(o,m){w(o,"key");w(m,"value");var q=b(o),y=W(A,q);y?(q=y.getEntryForKey(o))?q[1]=m:y.addEntry(o,m):(y=new T,y[0]=q,y[1]=new k(o,m,c),e[e.length]=y,A[q]=y)};this.get=function(c){w(c,
"key");var k=b(c);if(k=W(A,k))if(c=k.getEntryForKey(c))return c[1];return null};this.containsKey=function(c){w(c,"key");var k=b(c);return(k=W(A,k))?k.containsKey(c):!1};this.containsValue=function(b){w(b,"value");for(var c=0,k=e.length;c<k;c++)if(e[c][1].containsValue(b))return!0;return!1};this.clear=function(){e.length=0;A={}};this.isEmpty=function(){return 0===e.length};this.keys=function(){for(var b=[],c=0,k=e.length;c<k;c++)e[c][1].keys(b);return b};this.values=function(){for(var b=[],c=0,k=e.length;c<
k;c++)e[c][1].values(b);return b};this.remove=function(c){w(c,"key");var k=b(c),m=W(A,k);m&&m.removeEntryForKey(c)&&0===m.size()&&(c=m.getEqualityFunction(c),c=o(e,k,sa,!0,c),J(e,c[0]),delete A[k])};this.size=function(){for(var b=0,c=0,k=e.length;c<k;c++)b+=e[c][1].size();return b}}}(),types={};
(function(){function m(){var b=document.createElement("span");b.appendChild(document.createTextNode("("));b.className="lParen";return b}function q(){var b=document.createElement("span");b.appendChild(document.createTextNode(")"));b.className="rParen";return b}var c={}.hasOwnProperty,b=0;makeEqHashCode=function(){b++;return b};getEqHashCode=function(b){b&&!b._eqHashCode&&(b._eqHashCode=makeEqHashCode());return b&&b._eqHashCode?b._eqHashCode:"string"==typeof b?b:0};var e=function(){this.parentMap=y()};
e.prototype.find=function(b){var c=this.parentMap.containsKey(b)?this.parentMap.get(b):b;if(c===b)return c;c=this.find(c);this.parentMap.put(b,c);return c};e.prototype.merge=function(b,c){this.parentMap.put(this.find(b),this.find(c))};var o=function(){var b=!1,c=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/,j=function(){};j.extend=function(j){var l=this.prototype;b=!0;var u=new this;b=!1;for(var z in j)u[z]="function"==typeof j[z]&&"function"==typeof l[z]&&c.test(j[z])?function(b,g){return function(){var c=
this._super;this._super=l[b];var j=g.apply(this,arguments);this._super=c;return j}}(z,j[z]):j[z];z=function(){!b&&this.init&&this.init.apply(this,arguments)};z.prototype=u;z.constructor=z;z.extend=arguments.callee;return z};return j}();StructType=function(b,c,j,l,u,z,k,e,o){this.name=b;this.type=c;this.numberOfArgs=j;this.numberOfFields=l;this.firstField=u;this.constructor=z;this.predicate=k;this.accessor=e;this.mutator=o};StructType.prototype.toString=function(){return"#<struct-type:"+this.name+
">"};StructType.prototype.isEqual=function(b){return this===b};var J=function(b,c,j,l,u,z){c||(c={type:w,numberOfArgs:0,numberOfFields:0,firstField:0});var k=c.numberOfArgs,e=c.type.extend({init:function(b,g){z||(z=function(b){if(3==arguments.length)b(arguments[1]);else{var g=[],c;for(c=1;c<arguments.length-1;c++)g.push(arguments[c]);b(new fa(g))}});var c=this;g.unshift(function(g){var g=g instanceof fa?g.elts:[g],S=g.slice(0,k);c._super(b,S);for(S=0;S<j;S++)c._fields.push(g[S+k]);for(S=0;S<l;S++)c._fields.push(u)});
g.push(C.makeInstance(b));z.apply(null,g)}});e.prototype.type=e;return new StructType(b,e,j+k,j+l,c.firstField+c.numberOfFields,function(){for(var c=[],j=0;j<arguments.length;j++)c.push(arguments[j]);return new e(b,c)},function(b){return b instanceof e},function(b,g){return b._fields[g+this.firstField]},function(b,g,c){b._fields[g+this.firstField]=c})},w=o.extend({init:function(b){this._constructorName=b;this._fields=[]},toWrittenString:function(b){var c=[],j;c.push("(");c.push(this._constructorName);
for(j=0;j<this._fields.length;j++)c.push(" "),c.push(z(this._fields[j],b));c.push(")");return c.join("")},toDisplayedString:function(b){return this.toWrittenString(b)},toDomNode:function(b){var c=document.createElement("div"),j=document.createElement("span");j.appendChild(document.createTextNode(this._constructorName));c.appendChild(m());c.appendChild(j);for(j=0;j<this._fields.length;j++){var l=M(this._fields[j],b);c.appendChild(l)}c.appendChild(q());return c},isEqual:function(b,c){if(void 0==b.type||
this.type!==b.type||!(b instanceof this.type))return!1;for(var j=0;j<this._fields.length;j++)if(!D(this._fields[j],b._fields[j],c))return!1;return!0}});w.prototype.type=w;var k=function(b){this.pattern=b},A=function(b){this.pattern=b},aa=function(b){this.path=b},T=function(b,c){this.bytes=b;this.mutable=void 0===c?!1:c};T.prototype.get=function(b){return this.bytes[b]};T.prototype.set=function(b,c){this.mutable&&(this.bytes[b]=c)};T.prototype.length=function(){return this.bytes.length};T.prototype.copy=
function(b){return new T(this.bytes.slice(0),b)};T.prototype.subbytes=function(b,c){if(null==c||void 0==c)c=this.bytes.length;return new T(this.bytes.slice(b,c),!0)};T.prototype.toString=function(){for(var b="",c=0;c<this.bytes.length;c++)b+=String.fromCharCode(this.bytes[c]);return b};T.prototype.toDisplayedString=T.prototype.toString;T.prototype.toWrittenString=function(){for(var b=['#"'],c=0;c<this.bytes.length;c++)b.push(sa(this.bytes[c]));b.push('"');return b.join("")};var sa=function(b){var c=
[],j;switch(b){case 7:j="\\a";break;case 8:j="\\b";break;case 9:j="\\t";break;case 10:j="\\n";break;case 11:j="\\v";break;case 12:j="\\f";break;case 13:j="\\r";break;case 34:j='\\"';break;case 92:j="\\\\";break;default:32<=val&&126>=val?j=String.fromCharCode(val):c.push("\\"+val.toString(8))}return j},W=function(b,c){this.val=b;this.mutable=c};W.prototype.unbox=function(){return this.val};W.prototype.set=function(b){this.mutable&&(this.val=b)};W.prototype.toString=function(){return"#&"+this.val.toString()};
W.prototype.toWrittenString=function(b){return"#&"+z(this.val,b)};W.prototype.toDisplayedString=function(b){return"#&"+la(this.val,b)};W.prototype.toDomNode=function(b){var c=document.createElement("span"),j=document.createElement("span");j.appendChild(document.createTextNode("#&"));c.className="wescheme-box";c.appendChild(j);c.appendChild(M(this.val,b));return c};Logic={TRUE:!0,FALSE:!1};Boolean.prototype.toWrittenString=function(){return this.valueOf()?"true":"false"};Boolean.prototype.toDisplayedString=
Boolean.prototype.toWrittenString;Boolean.prototype.toString=function(){return this.valueOf()?"true":"false"};Boolean.prototype.isEqual=function(b){return this==b};Char=function(b){this.val=b};Char.makeInstance=function(b){return new Char(b)};Char.prototype.toString=function(){var b=this.val.charCodeAt(0);switch(b){case 0:b="#\\nul";break;case 8:b="#\\backspace";break;case 9:b="#\\tab";break;case 10:b="#\\newline";break;case 11:b="#\\vtab";break;case 12:b="#\\page";break;case 13:b="#\\return";break;
case 20:b="#\\space";break;case 127:b="#\\rubout";break;default:if(32<=b&&126>=b)b="#\\"+this.val;else{for(b=b.toString(16).toUpperCase();4>b.length;)b="0"+b;b="#\\u"+b}}return b};Char.prototype.toWrittenString=Char.prototype.toString;Char.prototype.toDisplayedString=function(){return this.val};Char.prototype.getValue=function(){return this.val};Char.prototype.isEqual=function(b){return b instanceof Char&&this.val==b.val};var C=function(b){this.val=b},ca={};C.makeInstance=function(b){c.call(ca,b)||
(ca[b]=new C(b));return ca[b]};C.prototype.isEqual=function(b){return b instanceof C&&this.val==b.val};C.prototype.toString=function(){return this.val};C.prototype.toWrittenString=function(){return this.val};C.prototype.toDisplayedString=function(){return this.val};C.prototype.toDomNode=function(){var b=document.createElement("span");b.className="wescheme-symbol";b.style.fontFamily="monospace";b.style.whiteSpace="pre";b.appendChild(document.createTextNode("'"+this.val));return b};var X=function(b){this.val=
b},R={};X.makeInstance=function(b){c.call(R,b)||(R[b]=new X(b));return R[b]};X.prototype.isEqual=function(b){return b instanceof X&&this.val==b.val};X.prototype.toString=function(){return this.val};X.prototype.toWrittenString=function(){return this.val};X.prototype.toDisplayedString=function(){return this.val};Empty=function(){};Empty.EMPTY=new Empty;Empty.prototype.isEqual=function(b){return b instanceof Empty};Empty.prototype.reverse=function(){return this};Empty.prototype.first=function(){throw Error("first can't be applied on empty.");
};Empty.prototype.rest=function(){throw Error("rest can't be applied on empty.");};Empty.prototype.isEmpty=function(){return!0};Empty.prototype.toWrittenString=function(){return"empty"};Empty.prototype.toDisplayedString=function(){return"empty"};Empty.prototype.toString=function(){return"()"};Empty.prototype.append=function(b){return b};Cons=function(b,c){this.f=b;this.r=c};Cons.prototype.reverse=function(){for(var b=this,c=Empty.EMPTY;!b.isEmpty();)c=Cons.makeInstance(b.first(),c),b=b.rest();return c};
Cons.makeInstance=function(b,c){return new Cons(b,c)};Cons.prototype.isEqual=function(b,c){return!(b instanceof Cons)?Logic.FALSE:D(this.first(),b.first(),c)&&D(this.rest(),b.rest(),c)};Cons.prototype.first=function(){return this.f};Cons.prototype.rest=function(){return this.r};Cons.prototype.isEmpty=function(){return!1};Cons.prototype.append=function(b){if(b===Empty.EMPTY)return this;for(var c=this.reverse();!c.isEmpty();)b=Cons.makeInstance(c.first(),b),c=c.rest();return b};Cons.prototype.toWrittenString=
function(b){for(var c=["list"],j=this;j instanceof Cons;)c.push(z(j.first(),b)),j=j.rest();return j!==Empty.EMPTY?ia(this,b,z):"("+c.join(" ")+")"};var ia=function(b,c,j){for(var l=[],u=[];b instanceof Cons;)l.push("(cons "),l.push(j(b.first(),c)),l.push(" "),u.push(")"),b=b.rest();l.push(j(b,c));return l.join("")+u.join("")};Cons.prototype.toString=Cons.prototype.toWrittenString;Cons.prototype.toDisplayedString=function(b){for(var c=["list"],j=this;j instanceof Cons;)c.push(la(j.first(),b)),j=j.rest();
return j!==Empty.EMPTY?ia(this,b,la):"("+c.join(" ")+")"};Cons.prototype.toDomNode=function(b){var c=document.createElement("span"),j=document.createElement("span");c.className="wescheme-cons";j.appendChild(document.createTextNode("list"));c.appendChild(m());c.appendChild(j);for(j=this;j instanceof Cons;){var l=M(j.first(),b);c.appendChild(l);j=j.rest()}if(j!==Empty.EMPTY){var l=this,j=c=document.createElement("span"),u=document.createElement("span");u.appendChild(document.createTextNode("cons"));
for(j.className="wescheme-cons";l instanceof Cons;){j.appendChild(m());j.appendChild(u);var z=M(l.first(),b);j.appendChild(z);z=document.createElement("span");j.appendChild(z);j.appendChild(q());j=z;l=l.rest()}b=M(l,b);j.appendChild(b);return c}c.appendChild(q());return c};Vector=function(b,c){this.elts=Array(b);if(c)for(var j=0;j<b;j++)this.elts[j]=c[j];else for(j=0;j<b;j++)this.elts[j]=void 0;this.mutable=!0};Vector.makeInstance=function(b,c){return new Vector(b,c)};Vector.prototype.length=function(){return this.elts.length};
Vector.prototype.ref=function(b){return this.elts[b]};Vector.prototype.set=function(b,c){this.elts[b]=c};Vector.prototype.isEqual=function(b,c){if(null!=b&&void 0!=b&&b instanceof Vector){if(b.length()!=this.length())return!1;for(var j=0;j<this.length();j++)if(!D(this.elts[j],b.elts[j],c))return!1;return!0}return!1};Vector.prototype.toList=function(){for(var b=Empty.EMPTY,c=this.length()-1;0<=c;c--)b=Cons.makeInstance(this.elts[c],b);return b};Vector.prototype.toWrittenString=function(b){for(var c=
[],j=0;j<this.length();j++)c.push(z(this.ref(j),b));return"#("+c.join(" ")+")"};Vector.prototype.toDisplayedString=function(b){for(var c=[],j=0;j<this.length();j++)c.push(la(this.ref(j),b));return"#("+c.join(" ")+")"};Vector.prototype.toDomNode=function(b){var c=document.createElement("span"),j=document.createElement("span"),l=document.createElement("span");j.appendChild(document.createTextNode("#("));j.className="lParen";l.appendChild(document.createTextNode(")"));l.className="rParen";c.className=
"wescheme-vector";c.appendChild(j);for(j=0;j<this.length();j++){var u=M(this.ref(j),b);c.appendChild(u)}c.appendChild(l);return c};var L=function(b){this.chars=b;this.length=b.length;this.mutable=!0};L.makeInstance=function(b){return new L(b)};L.fromString=function(b){return L.makeInstance(b.split(""))};L.prototype.toString=function(){return this.chars.join("")};L.prototype.toWrittenString=function(){return'"'+pa(this.toString())+'"'};L.prototype.toDisplayedString=L.prototype.toString;L.prototype.copy=
function(){return L.makeInstance(this.chars.slice(0))};L.prototype.substring=function(b,c){if(null==c||void 0==c)c=this.length;return L.makeInstance(this.chars.slice(b,c))};L.prototype.charAt=function(b){return this.chars[b]};L.prototype.charCodeAt=function(b){return this.chars[b].charCodeAt(0)};L.prototype.replace=function(b,c){return L.fromString(this.toString().replace(b,c))};L.prototype.isEqual=function(b){return!(b instanceof L||"string"==typeof b)?!1:this.toString()===b.toString()};L.prototype.set=
function(b,c){this.chars[b]=c};L.prototype.toUpperCase=function(){return L.fromString(this.chars.join("").toUpperCase())};L.prototype.toLowerCase=function(){return L.fromString(this.chars.join("").toLowerCase())};L.prototype.match=function(b){return this.toString().match(b)};var pa=function(b){for(var c=[],j=0;j<b.length;j++){var l=b.charCodeAt(j);switch(l){case 7:c.push("\\a");break;case 8:c.push("\\b");break;case 9:c.push("\\t");break;case 10:c.push("\\n");break;case 11:c.push("\\v");break;case 12:c.push("\\f");
break;case 13:c.push("\\r");break;case 34:c.push('\\"');break;case 92:c.push("\\\\");break;default:if(32<=l&&126>=l)c.push(b.charAt(j));else{for(l=l.toString(16).toUpperCase();4>l.length;)l="0"+l;c.push("\\u"+l)}}}return c.join("")},y=function(){return new _Hashtable(function(b){return getEqHashCode(b)},function(b,c){return b===c})},V=function(){this.hash=y();this.mutable=!0};V.prototype.toWrittenString=function(b){for(var c=this.hash.keys(),j=[],l=0;l<c.length;l++){var u=types.toWrittenString(c[l],
b),z=types.toWrittenString(this.hash.get(c[l]),b);j.push("("+u+" . "+z+")")}return"#hasheq("+j.join(" ")+")"};V.prototype.toDisplayedString=function(b){for(var c=this.hash.keys(),j=[],l=0;l<c.length;l++){var u=types.toDisplayedString(c[l],b),z=types.toDisplayedString(this.hash.get(c[l]),b);j.push("("+u+" . "+z+")")}return"#hasheq("+j.join(" ")+")"};V.prototype.isEqual=function(b,c){if(!(b instanceof V)||this.hash.keys().length!=b.hash.keys().length)return!1;for(var j=this.hash.keys(),l=0;l<j.length;l++)if(!b.hash.containsKey(j[l])||
!D(this.hash.get(j[l]),b.hash.get(j[l]),c))return!1;return!0};var Z=function(){this.hash=new _Hashtable(function(b){return z(b)},function(b,c){return D(b,c,new e)});this.mutable=!0};Z.prototype.toWrittenString=function(b){for(var c=this.hash.keys(),j=[],l=0;l<c.length;l++){var u=types.toWrittenString(c[l],b),z=types.toWrittenString(this.hash.get(c[l]),b);j.push("("+u+" . "+z+")")}return"#hash("+j.join(" ")+")"};Z.prototype.toDisplayedString=function(b){for(var c=this.hash.keys(),j=[],l=0;l<c.length;l++){var u=
types.toDisplayedString(c[l],b),z=types.toDisplayedString(this.hash.get(c[l]),b);j.push("("+u+" . "+z+")")}return"#hash("+j.join(" ")+")"};Z.prototype.isEqual=function(b,c){if(!(b instanceof Z)||this.hash.keys().length!=b.hash.keys().length)return!1;for(var j=this.hash.keys(),l=0;l<j.length;l++)if(!b.hash.containsKey(j[l])||!D(this.hash.get(j[l]),b.hash.get(j[l]),c))return!1;return!0};var ha=function(b,c){this.name=b;this.obj=c};ha.prototype.toString=function(){return"#<js-object:"+typeof this.obj+
":"+this.name+">"};ha.prototype.isEqual=function(b){return this.obj===b.obj};var ma=function(b,c,j){this.startup=b;this.shutdown=c;this.startupArgs=j;this.shutdownArg=void 0};ma.prototype.toString=function(){return"#<world-config>"};ma.prototype.isEqual=function(b,c){if(!D(this.startup,b.startup,c)||!D(this.shutdown,b.shutdown,c)||this.startupArgs.length!=b.startupArgs.length||!D(this.shutdownArg,b.shutdownArg,c))return!1;for(var j=0;j<args.length;j++)if(!D(this.startupArgs[j],b.startupArgs[j],c))return!1;
return!0};var p=J("effect",!1,0,0,!1,!1);p.type.prototype.invokeEffect=function(){helpers.raise(types.incompleteExn(types.exnFail,"effect type created without using make-effect-type",[]))};var j=J("render-effect",!1,0,0,!1,!1);j.type.prototype.callImplementation=function(){helpers.raise(types.incompleteExn(types.exnFail,"render effect created without using make-render-effect-type",[]))};var z=function(b,c){c||(c=y());if("object"==typeof b){if(c.containsKey(b))return"...";c.put(b,!0)}if(void 0==b||
null==b)return"#<undefined>";if("string"==typeof b)return'"'+pa(b.toString())+'"';if("object"!=typeof b&&"function"!=typeof b)return b.toString();var j;j="undefined"!==typeof b.toWrittenString?b.toWrittenString(c):"undefined"!==typeof b.toDisplayedString?b.toDisplayedString(c):b.toString();c.remove(b);return j},la=function(b,c){c||(c=y());if("object"==typeof b){if(c.containsKey(b))return"...";c.put(b,!0)}if(void 0==b||null==b)return"#<undefined>";if("string"==typeof b)return b;if("object"!=typeof b&&
"function"!=typeof b)return b.toString();var j;j="undefined"!==typeof b.toDisplayedString?b.toDisplayedString(c):"undefined"!==typeof b.toWrittenString?b.toWrittenString(c):b.toString();c.remove(b);return j},M=function(b,c){c||(c=y());if(Q(b))return Ka(b);if("object"==typeof b){if(c.containsKey(b)){var j=document.createElement("span");j.style["font-family"]="monospace";j.appendChild(document.createTextNode("..."));return j}c.put(b,!0)}if(void 0==b||null==b)return j=document.createElement("span"),
j.style["font-family"]="monospace",j.appendChild(document.createTextNode("#<undefined>")),j;if("string"==typeof b)return F(z(b));if("object"!=typeof b&&"function"!=typeof b)return F(b.toString());j=b.nodeType?b:"undefined"!==typeof b.toDomNode?b.toDomNode(c):"undefined"!==typeof b.toWrittenString?F(b.toWrittenString(c)):"undefined"!==typeof b.toDisplayedString?F(b.toDisplayedString(c)):F(b.toString());c.remove(b);return j},F=function(b){var b=b.split("\n"),c,j=document.createElement("span"),l;j.className=
"wescheme-string";j.style.fontFamily="monospace";j.style.whiteSpace="pre";0<b.length&&j.appendChild(document.createTextNode(b[0]));for(c=1;c<b.length;c++)l=document.createElement("br"),l.style.clear="left",j.appendChild(l),j.appendChild(document.createTextNode(b[c]));return j},Ka=function(b){var c;if(jsnums.isExact(b)){if(jsnums.isInteger(b))return c=document.createElement("span"),c.className="wescheme-number Integer",c.appendChild(document.createTextNode(b.toString())),c;if(jsnums.isRational(b))return ra(b);
E(b)?(c=document.createElement("span"),c.className="wescheme-number Complex"):(c=document.createElement("span"),c.className="wescheme-number");c.appendChild(document.createTextNode(b.toString()));return c}c=document.createElement("span");c.className="wescheme-number";c.appendChild(document.createTextNode(b.toString()));return c},ra=function(b){var c=document.createElement("span"),j=jsnums.toRepeatingDecimal(jsnums.numerator(b),jsnums.denominator(b),{limit:25}),l=document.createElement("span");l.appendChild(document.createTextNode(j[0]+
"."+j[1]));c.appendChild(l);"..."===j[2]?l.appendChild(document.createTextNode(j[2])):"0"!==j[2]&&(l=document.createElement("span"),l.style.textDecoration="overline",l.appendChild(document.createTextNode(j[2])),c.appendChild(l));var u=document.createElement("span"),j=document.createElement("sup");j.appendChild(document.createTextNode(""+jsnums.numerator(b)));l=document.createElement("sub");l.appendChild(document.createTextNode(""+jsnums.denominator(b)));b=document.createElement("span");b.appendChild(document.createTextNode("/"));
u.appendChild(j);u.appendChild(b);u.appendChild(l);b=document.createElement("span");b.appendChild(c);b.appendChild(u);u.style.display="none";var z=!0;b.onclick=function(){z=!z;c.style.display=z?"inline":"none";u.style.display=!z?"inline":"none"};b.style.cursor="pointer";b.className="wescheme-number Rational";return b},Q=jsnums.isSchemeNumber,E=Q,da=function(b){return"string"===typeof b||b instanceof L},D=function(b,c,j){if(b===c)return!0;if(Q(b)&&Q(c))return jsnums.equals(b,c);if(da(b)&&da(c))return b.toString()===
c.toString();if(void 0==b||null==b)return void 0==c||null==c;if("object"==typeof b&&"object"==typeof c&&b.isEqual&&c.isEqual){if(j.find(b)===j.find(c))return!0;j.merge(b,c);return b.isEqual(c,j)}return!1},fa=function(b){this.elts=b};fa.prototype.toDomNode=function(b){var c=document.createElement("span");c.style.whiteSpace="pre";if(0<this.elts.length){c.appendChild(M(this.elts[0],b));for(var j=1;j<this.elts.length;j++)c.appendChild(document.createTextNode("\n")),c.appendChild(M(this.elts[j],b))}return c};
var Y=function(){};Y.prototype.toString=function(){return"#<undefined>"};var Y=new Y,U=function(){};U.prototype.toString=function(){return"#<void>"};var I=new U,U=function(){};U.prototype.toString=function(){return"#<eof>"};var U=new U,B=function(b,c,j,l,u,z,k){this.name=b;this.locs=c;this.numParams=j;this.paramTypes=l;this.isRest=u;this.closureVals=z;this.body=k};B.prototype.toString=function(){return this.name!==Empty.EMPTY?helpers.format("#<function:~a>",[this.name]):"#<function>"};var xa=function(b,
c){this.name=b;this.closures=c};xa.prototype.toString=function(){return this.name!==Empty.EMPTY?helpers.format("#<case-lambda-procedure:~a>",[this.name]):"#<case-lambda-procedure>"};var Fa=function(b,c){this.name=!1;this.vstack=b.slice(0);this.cstack=c.slice(0)};Fa.prototype.toString=function(){return this.name!==Empty.EMPTY?helpers.format("#<function:~a>",[this.name]):"#<function>"};var qa=function(){this.slots=[];this.definedMask=[]};qa.prototype.addSlot=function(b){void 0===b?(this.slots.push(types.UNDEFINED),
this.definedMask.push(!1)):(this.slots.push(b),b instanceof za?b.value===types.UNDEFINED?this.definedMask.push(!1):this.definedMask.push(!0):this.definedMask.push(!0))};qa.prototype.ref=function(b,c){if(this.slots[b]instanceof za){if(this.definedMask[b])return this.slots[b].value;helpers.raise(types.incompleteExn(types.exnFailContractVariable,new N([new ja(this.slots[b].name,c),": this variable is not defined"]),[this.slots[b].name]))}else{if(this.definedMask[b])return this.slots[b];helpers.raise(types.incompleteExn(types.exnFailContractVariable,
"variable has not been defined",[!1]))}};qa.prototype.set=function(b,c){this.slots[b]instanceof za?this.slots[b].value=c:this.slots[b]=c;this.definedMask[b]=!0};qa.prototype.length=function(){return this.slots.length};var za=function(b,c){this.name=b;this.value=c},va=function(b,c){this.prefix=b;this.pos=c};va.prototype.ref=function(){return this.prefix.ref(this.pos)};va.prototype.set=function(b){this.prefix.set(this.pos,b)};var $=function(b){this.dict=b||y()};$.prototype.invoke=function(){};$.prototype.update=
function(b,c){for(var j=y(),l=this.dict.keys(),u=0;u<l.length;u++)j.put(l[u],this.dict.get(l[u]));j.put(b,c);return new $(j)};var ea=function(b){this.dict=b};ea.prototype.toDomNode=function(){var b=document.createElement("span");b.appendChild(document.createTextNode("#<continuation-mark-set>"));return b};ea.prototype.toWrittenString=function(){return"#<continuation-mark-set>"};ea.prototype.toDisplayedString=function(){return"#<continuation-mark-set>"};ea.prototype.ref=function(b){return this.dict.containsKey(b)?
this.dict.get(b):[]};var l=function(){},u=new l,ua=function(b,c,j,l,u){this.name=b;this.numParams=c;this.isRest=j;this.assignsToValueRegister=l;this.impl=u};ua.prototype.toString=function(){return"#<function:"+this.name+">"};ua.prototype.toWrittenString=function(){return"#<function:"+this.name+">"};ua.prototype.toDisplayedString=function(){return"#<function:"+this.name+">"};ua.prototype.toDomNode=function(){var b=document.createElement("span");b.className="wescheme-primproc";b.appendChild(document.createTextNode("#<function:"+
this.name+">"));return b};var ba=function(b,c){this.name=b;this.cases=c};ba.prototype.toDomNode=function(){var b=document.createElement("span");b.className="wescheme-caseprimitive";b.appendChild(document.createTextNode("#<function:"+this.name+">"));return b};ba.prototype.toWrittenString=function(){return"#<function:"+this.name+">"};ba.prototype.toDisplayedString=function(){return"#<function:"+this.name+">"};var N=function(b){this.args=b};N.prototype.toString=function(){var b=[],c;for(c=0;c<this.args.length;c++)b.push(""+
this.args[c]);return b.join("")};var ja=function(b,c){this.text=b;this.location=c};ja.prototype.toString=function(){return this.text+""};var H=function(b){this.coloredParts=b};H.prototype.toString=function(){var b,c=[];for(b=0;b<this.coloredParts.length;b++)c.push(this.coloredParts[b].text+"");return c.join("")};var $a=function(b,c,j){this.text=b;this.locations=c;this.solid=j};$a.prototype.toString=function(){return this.text};var ka=function(b){return Vector.makeInstance(b.length,b)},wa=ka(["<no-location>",
0,0,0,0]),ta=J("posn",!1,2,0,!1,!1),O=J("color",!1,4,0,!1,!1),oa=J("arity-at-least",!1,1,0,!1,function(b,c,j){helpers.check(void 0,c,function(b){return jsnums.isExact(b)&&jsnums.isInteger(b)&&jsnums.greaterThanOrEqual(b,0)},j,"exact non-negative integer",1);b(c)});types.symbol=C.makeInstance;types.rational=jsnums.makeRational;types["float"]=jsnums.makeFloat;types.complex=jsnums.makeComplex;types.bignum=jsnums.makeBignum;types.list=function(b){var c=Empty.EMPTY,j;for(j=b.length-1;0<=j;j--)c=Cons.makeInstance(b[j],
c);return c};types.vector=ka;types.regexp=function(b){return new k(b)};types.byteRegexp=function(b){return new A(b)};types["char"]=Char.makeInstance;types.string=function(b){if(b instanceof L)return b;if(b instanceof Array)return L.makeInstance(b);if("string"===typeof b)return L.fromString(b);throw types.internalError("makeString expects and array of 1-character strings or a string; given "+b.toString(),!1);};types.box=function(b){return new W(b,!0)};types.boxImmutable=function(b){return new W(b,
!1)};types.path=function(b){return new aa(b)};types.bytes=function(b,c){return new T(b,c)};types.keyword=function(b){return new X(b)};types.pair=function(b,c){return Cons.makeInstance(b,c)};types.hash=function(b){for(var c=new Z;!b.isEmpty();)c.hash.put(b.first().first(),b.first().rest()),b=b.rest();return c};types.hashEq=function(b){for(var c=new V;!b.isEmpty();)c.hash.put(b.first().first(),b.first().rest()),b=b.rest();return c};types.jsObject=function(b,c){return new ha(b,c)};types.toWrittenString=
z;types.toDisplayedString=la;types.toDomNode=M;types.posn=ta.constructor;types.posnX=function(b){return ta.accessor(b,0)};types.posnY=function(b){return ta.accessor(b,1)};types.color=function(b,c,j,l){void 0===l&&(l=255);return O.constructor(b,c,j,l)};types.colorRed=function(b){return O.accessor(b,0)};types.colorGreen=function(b){return O.accessor(b,1)};types.colorBlue=function(b){return O.accessor(b,2)};types.colorAlpha=function(b){return O.accessor(b,3)};types.arityAtLeast=oa.constructor;types.arityValue=
function(b){return oa.accessor(b,0)};types.FALSE=Logic.FALSE;types.TRUE=Logic.TRUE;types.EMPTY=Empty.EMPTY;types.isEqual=D;types.isNumber=Q;types.isSymbol=function(b){return b instanceof C};types.isChar=function(b){return b instanceof Char};types.isString=da;types.isPair=function(b){return b instanceof Cons};types.isVector=function(b){return b instanceof Vector};types.isBox=function(b){return b instanceof W};types.isHash=function(b){return b instanceof V||b instanceof Z};types.isByteString=function(b){return b instanceof
T};types.isStruct=function(b){return b instanceof w};types.isPosn=ta.predicate;types.isArityAtLeast=oa.predicate;types.isColor=O.predicate;types.isFunction=function(b){return b instanceof ua||b instanceof ba||b instanceof B||b instanceof xa||b instanceof Fa};types.isJsObject=function(b){return b instanceof ha};types.UnionFind=e;types.cons=Cons.makeInstance;types.UNDEFINED=Y;types.VOID=I;types.EOF=U;types.ValuesWrapper=fa;types.ClosureValue=B;types.ContinuationPrompt=l;types.defaultContinuationPrompt=
u;types.ContinuationClosureValue=Fa;types.CaseLambdaValue=xa;types.PrimProc=ua;types.CasePrimitive=ba;types.contMarkRecordControl=function(b){return new $(b)};types.isContMarkRecordControl=function(b){return b instanceof $};types.continuationMarkSet=function(b){return new ea(b)};types.isContinuationMarkSet=function(b){return b instanceof ea};types.PrefixValue=qa;types.GlobalBucket=za;types.ModuleVariableRecord=function(b,c){this.resolvedModuleName=b;this.variableName=c};types.VariableReference=va;
types.Box=W;types.ThreadCell=function(b,c){this.v=b;this.isPreserved=c||!1};types.Class=o;types.makeStructureType=J;types.isStructType=function(b){return b instanceof StructType};types.makeLowLevelEqHash=y;var Ia=function(b,c){this.val=b;this.contMarks=c?c:!1};types.internalError=function(b,c){return new Ia(b,c)};types.isInternalError=function(b){return b instanceof Ia};var Ea=function(b){this.val=b};types.schemeError=function(b){return new Ea(b)};types.isSchemeError=function(b){return b instanceof
Ea};var Na=function(b,c,j){this.constructor=b;this.msg=c;this.otherArgs=j};types.incompleteExn=function(b,c,j){return new Na(b,c,j)};types.isIncompleteExn=function(b){return b instanceof Na};var ya=J("exn",!1,2,0,!1,function(b,c,j,l){helpers.check(void 0,j,types.isContinuationMarkSet,l,"continuation mark set",2);b(new fa([c,j]))});types.exn=ya.constructor;types.isExn=ya.predicate;types.exnMessage=function(b){return ya.accessor(b,0)};types.exnContMarks=function(b){return ya.accessor(b,1)};types.exnSetContMarks=
function(b,c){ya.mutator(b,1,c)};var Ba=J("exn:break",ya,1,0,!1,function(b,c,j,l){b(new fa([c,j,l]))});types.exnBreak=Ba.constructor;types.isExnBreak=Ba.predicate;types.exnBreakContinuation=function(b){return Ba.accessor(b,0)};o=J("exn:fail",ya,0,0,!1,!1);types.exnFail=o.constructor;types.isExnFail=o.predicate;Y=J("exn:fail:contract",o,0,0,!1,!1);types.exnFailContract=Y.constructor;types.isExnFailContract=Y.predicate;o=J("exn:fail:contract:arity",Y,0,0,!1,!1);types.exnFailContractArity=Y.constructor;
types.isExnFailContractArity=Y.predicate;var Qa=J("exn:fail:contract:variable",Y,1,0,!1,!1);types.exnFailContractVariable=Y.constructor;types.isExnFailContractVariable=Y.predicate;types.exnFailContractVariableId=function(b){return Qa.accessor(b,0)};Y=J("exn:fail:contract:division-by-zero",Y,0,0,!1,!1);types.exnFailContractDivisionByZero=Y.constructor;types.isExnFailContractDivisionByZero=Y.predicate;var P=J("exn:fail:contract:arity:position",o,1,0,!1,!1);types.exnFailContractArityWithPosition=P.constructor;
types.isExnFailContractArityWithPosition=P.predicate;types.exnFailContractArityWithPositionLocations=function(b){return P.accessor(b,0)};types.worldConfig=function(b,c,j){return new ma(b,c,j)};types.isWorldConfig=function(b){return b instanceof ma};types.makeEffectType=function(b,c,j,l,u,z){c||(c=p);var b=J(b,c,j,0,!1,u),k=b.firstField+b.numberOfFields;b.type.prototype.invokeEffect=function(b,c){var j=new ua("update-world",1,!1,!0,function(c,j){helpers.check(c,j,helpers.procArityContains(1),"update-world",
"procedure (arity 1)",1);b(function(b,g){interpret.call(c,j,[b],g,function(b){throw b;})},function(){c.v=I})}),g=this._fields.slice(0,k);g.unshift(j);z(l,g,c)};return b};types.isEffectType=function(b){return b instanceof StructType&&b.type.prototype.invokeEffect?!0:!1};types.isEffect=p.predicate;types.makeRenderEffectType=function(b,c,l,u,z){c||(c=j);var b=J(b,c,l,0,!1,z),k=b.firstField+b.numberOfFields;b.type.prototype.callImplementation=function(b,c){var j=this._fields.slice(0,k);b(u,j,c)};return b};
types.isRenderEffectType=function(b){return b instanceof StructType&&b.type.prototype.callImplementation?!0:!1};types.isRenderEffect=j.predicate;types.NoLocation=wa;types.isNoLocation=function(b){return b===wa};types.ColoredPart=ja;types.Message=N;types.isColoredPart=function(b){return b instanceof ja};types.isMessage=function(b){return b instanceof N};types.GradientPart=H;types.isGradientPart=function(b){return b instanceof H};types.MultiPart=$a;types.isMultiPart=function(b){return b instanceof $a}})();
var state={};
(function(){var m=function(b){sys.print(types.toWrittenString(b)+"\n")},q=function(){throw Error("There is a software configuration error by the system's maintainer: the toplevel node has not been initialized yet.");},c=function(b,c,k){k(b+" not known")},b=function(){this.v=[];this.vstack=[];this.cstack=[];this.heap={};this.globals={};this.hooks={printHook:m,displayHook:m,toplevelNodeHook:q,imageProxyHook:!1,dynamicModuleLoader:c};this.invokedModules={};this.breakRequested=!1;this.breakRequestedListeners=[]};
b.prototype.clearForEval=function(b){this.v=[];this.vstack=[];this.cstack=[];if(!b||!b.preserveBreak)this.breakRequested=!1,this.breakRequestedListeners=[];b&&b.clearGlobals&&(this.globals={})};b.prototype.save=function(){return{v:this.v,vstack:this.vstack.slice(0),cstack:this.cstack.slice(0),heap:this.heap,globals:o(this.globals),hooks:this.hooks,breakRequested:this.breakRequested,breakRequestedListeners:o(this.breakRequestedListeners),invokedModules:this.invokedModules}};var e={}.hasOwnProperty,
o=function(b){var c={},k;for(k in b)e.call(b,k)&&(c[k]=b[k]);return c};b.prototype.restore=function(b){this.v=b.v;this.vstack=b.vstack;this.cstack=b.cstack;this.heap=b.heap;this.globals=b.globals;this.hooks=b.hooks;this.breakRequestListeners=b.breakRequestListeners;this.invokedModules=b.invokedModules};b.prototype.requestBreak=function(){this.breakRequested=!0;for(var b=0;b<this.breakRequestedListeners.length;b++)try{this.breakRequestedListeners[b]()}catch(c){helpers.reportError(c)}};b.prototype.addBreakRequestedListener=
function(b){this.breakRequestedListeners.push(b)};b.prototype.removeBreakRequestedListener=function(b){for(var c=this.breakRequestedListeners.length-1;0<=c;c--)this.breakRequestedListeners[c]===b&&this.breakRequestedListeners.splice(c,1)};b.prototype.pushControl=function(b){this.cstack.push(b)};b.prototype.pushManyControls=function(b){for(var c=0;c<b.length;c++)this.cstack.push(b[b.length-1-c])};b.prototype.isStuck=function(){return 0===this.cstack.length};b.prototype.popControl=function(){if(0===
this.cstack.length)throw types.internalError("cstack empty",J(this));return this.cstack.pop()};b.prototype.pushValue=function(b){this.vstack.push(b)};b.prototype.popValue=function(){if(0===this.vstack.length)throw types.internalError("vstack empty",J(this));return this.vstack.pop()};b.prototype.pushn=function(b){for(var c=0;c<b;c++)this.vstack.push(types.UNDEFINED)};b.prototype.popn=function(b){for(var c=0;c<b;c++){if(0===this.vstack.length)throw types.internalError("vstack empty",J(this));this.vstack.pop()}};
b.prototype.peekn=function(b){if(0>this.vstack.length-1-(b||0))throw types.internalError("vstack not long enough",J(this));return this.vstack[this.vstack.length-1-(b||0)]};b.prototype.setn=function(b,c){this.vstack[this.vstack.length-1-(b||0)]=c};b.prototype.refPrefix=function(b,c,k){b=this.vstack[this.vstack.length-1-b].ref(c,k);if(b instanceof types.ModuleVariableRecord&&this.invokedModules[b.resolvedModuleName]){c=this.invokedModules[b.resolvedModuleName];if("undefined"!==typeof c.providedValues[b.variableName])return c.providedValues[b.variableName];
throw types.schemeError(types.exnFailContractVariable("reference to an identifier before its definition: "+b.variableName,!1,b.variableName));}return b};b.prototype.setPrefix=function(b,c,k){this.vstack[this.vstack.length-1-b].set(c,k)};b.prototype.setPrintHook=function(b){this.hooks.printHook=b};b.prototype.getPrintHook=function(){return this.hooks.printHook};b.prototype.setDisplayHook=function(b){this.hooks.displayHook=b};b.prototype.setImageProxyHook=function(b){this.hooks.imageProxyHook=b};b.prototype.getImageProxyHook=
function(){return this.hooks.imageProxyHook};b.prototype.getDisplayHook=function(){return this.hooks.displayHook};b.prototype.getToplevelNodeHook=function(){return this.hooks.toplevelNodeHook};b.prototype.setToplevelNodeHook=function(b){this.hooks.toplevelNodeHook=b};var J=function(b){for(var c=types.makeLowLevelEqHash(),k=0;k<b.cstack.length;k++)if(types.isContMarkRecordControl(b.cstack[k]))for(var e=b.cstack[k].dict,o=e.keys(),m=0;m<o.length;m++)c.put(o[m],c.get(o[m])||[]),c.get(o[m]).push(e.get(o[m]));
return types.continuationMarkSet(c)},w=types.symbol("moby-stack-record-continuation-mark-key"),k=function(b,c){for(var k in b)if(e.call(b,k))if(e.call(c,k)){if(b[k]!==c[k])return!1}else return!1;for(k in c)if(e.call(c,k))if(e.call(b,k)){if(b[k]!==c[k])return!1}else return!1;return!0};state.State=b;state.isState=function(c){return c instanceof b};state.captureCurrentContinuationMarks=J;state.getStackTraceFromContinuationMarks=function(b){for(var c=[],b=b.ref(w),e=b.length-1;0<=e;e--){var o=b[e],m=
o.ref(0),q=o.ref(1),J=o.ref(2),X=o.ref(3),o=o.ref(4),m={id:m,offset:q,line:J,column:X,span:o};(0===c.length||!k(c[c.length-1],m))&&c.push(m)}return c}})();var world={};
(function(){world.config={};var m=function(){this.vals={changeWorld:!1,shutdownWorld:!1,initialEffect:!1,onRedraw:!1,onDraw:!1,onDrawCss:!1,tickDelay:!1,onTick:!1,onTickEffect:!1,onKey:!1,onKeyEffect:!1,onTilt:!1,onTiltEffect:!1,onTap:!1,onTapEffect:!1,onAcceleration:!1,onAccelerationEffect:!1,onShake:!1,onShakeEffect:!1,onSmsReceive:!1,onSmsReceiveEffect:!1,onLocationChange:!1,onLocationChangeEffect:!1,onAnnounce:!1,onAnnounceEffect:!1,stopWhen:!1,stopWhenEffect:!1,connectToGame:!1,onGameStart:!1,
onOpponentTurn:!1,onMyTurn:!1,afterMyTurn:!1,onGameFinish:!1}};m.prototype.lookup=function(m){if(m in this.vals)return this.vals[m];throw Error("Can't find "+m+" in the configuration");};m.prototype.updateAll=function(q){var c=new m,b=this.vals,e={},o;for(o in b)Object.hasOwnProperty.call(b,o)&&(e[o]=b[o]);for(o in q)Object.hasOwnProperty.call(q,o)&&(e[o]=q[o]);c.vals=e;return c};world.config.WorldConfig=m;world.config.CONFIG=new m;world.config.Kernel=world.config.Kernel||{};world.config.Kernel.getNoneEffect=
function(){throw Error("getNoneEffect: We should not be calling effects!");}})();
(function(){world.stimuli={};var m=[],q=function(){},c=function(b,c,e){this.config=b;this.caller=c;this.restarter=e;m.push(this)};c.prototype.doStimuli=function(b,c,e,k){var m=this;try{m.change(function(b,k){var o=[b].concat(e);c?m.caller(c,o,k):k(b)},k)}catch(q){this.onShutdown()}};c.prototype.onTilt=function(c,e){var m=this.lookup("onTilt");this.doStimuli(this.lookup("onTiltEffect"),m,helpers.map(b,c),e)};c.prototype.onAcceleration=function(c,e){var m=this.lookup("onAcceleration");this.doStimuli(this.lookup("onAccelerationEffect"),
m,helpers.map(b,c),e)};c.prototype.onShake=function(b,c){var e=this.lookup("onShake");this.doStimuli(this.lookup("onShakeEffect"),e,[],c)};c.prototype.onSmsReceive=function(b,c){var e=this.lookup("onSmsReceive");this.doStimuli(this.lookup("onSmsReceiveEffect"),e,[b[0]+"",b[1]+""],c)};c.prototype.onLocation=function(c,e){var m=this.lookup("onLocationChange");this.doStimuli(this.lookup("onLocationChangeEffect"),m,helpers.map(b,c),e)};c.prototype.onKey=function(b,c){var e;e=b[0];e=e.charCode||e.keyCode;
switch(e){case 16:e="shift";break;case 17:e="control";break;case 19:e="pause";break;case 27:e="escape";break;case 33:e="prior";break;case 34:e="next";break;case 35:e="end";break;case 36:e="home";break;case 37:e="left";break;case 38:e="up";break;case 39:e="right";break;case 40:e="down";break;case 42:e="print";break;case 45:e="insert";break;case 46:e=String.fromCharCode(127);break;case 106:e="*";break;case 107:e="+";break;case 109:e="-";break;case 110:e=".";break;case 111:e="/";break;case 144:e="numlock";
break;case 145:e="scroll";break;case 186:e=";";break;case 187:e="=";break;case 188:e=",";break;case 189:e="-";break;case 190:e=".";break;case 191:e="/";break;case 192:e="`";break;case 219:e="[";break;case 220:e="\\";break;case 221:e="]";break;case 222:e="'";break;default:e=96<=e&&105>=e?(e-96).toString():112<=e&&123>=e?"f"+(e-111):String.fromCharCode(e).toLowerCase()}var k=this.lookup("onKey");this.doStimuli(this.lookup("onKeyEffect"),k,[e],c)};c.prototype.onAnnounce=function(b,c){for(var e=b[1],
k=types.EMPTY,m=0;m<e.length;m++)k=types.cons(e[e.length-m-1],k);e=this.lookup("onAnnounce");m=this.lookup("onAnnounceEffect");this.doStimuli(e,m,[b[0],k],c)};c.prototype.onShutdown=function(){var b=m.indexOf(this);-1!=b&&m.splice(b,1);(b=this.lookup("shutdownWorld"))&&b()};var b=types["float"];c.prototype.lookup=function(b){return this.config.lookup(b)};c.prototype.change=function(b,c){this.lookup("changeWorld")?this.lookup("changeWorld")(b,c):c()};var e=function(b){return function(){for(var c=arguments,
e=0;e<m.length;e++)m[e][b](c,q)}};world.stimuli.StimuliHandler=c;world.stimuli.onTilt=e("onTilt");world.stimuli.onAcceleration=e("onAcceleration");world.stimuli.onShake=e("onShake");world.stimuli.onSmsReceive=e("onSmsReceive");world.stimuli.onLocation=e("onLocation");world.stimuli.onKey=e("onKey");world.stimuli.onAnnounce=e("onAnnounce");world.stimuli.massShutdown=function(){for(var b=0;b<m.length;b++){var c=m[b].lookup("shutdownWorld");c&&c()}m=[]}})();"undefined"===typeof world&&(world={});
(function(){world.Kernel={};var m=[],q=function(b){var c=function(){};c.prototype=b;return new c},c=function(b){var c=function(){},e;c.prototype=b;c=new c;for(e in b)Object.hasOwnProperty.call(b,e)&&(c[e]=b[e]);return c},b=[];world.Kernel.addAnnounceListener=function(c){b.push(c)};world.Kernel.removeAnnounceListener=function(c){c=b.indexOf(c);-1!==c&&b.splice(c,1)};world.Kernel.announce=function(c,e){var k;for(k=0;k<b.length;k++)try{b[k](c,e)}catch(m){}};world.Kernel.updateWorld=function(b){world=
b(world);for(b=0;b<m.length;b++)m[b](world)};world.Kernel.shutdownWorld=function(){};var e=function(b,c){if(b.length!==c.length)throw Error("failure in zipVertices");for(var e=[],k=0;k<b.length;k++)e.push({x:b[k],y:c[k]});return e},o=function(){};world.Kernel.BaseImage=o;o.prototype.updatePinhole=function(b,e){var k=c(this);k.pinholeX=b;k.pinholeY=e;return k};o.prototype.getHeight=function(){return this.height};o.prototype.getWidth=function(){return this.width};o.prototype.getBaseline=function(){return this.height};
o.prototype.getVertices=function(){return this.vertices?this.vertices:[{x:0,y:0},{x:this.width,y:0},{x:0,y:this.height},{x:this.width,y:this.height}]};o.prototype.render=function(b,c,e){if(!this.vertices)throw Error("BaseImage.render is not implemented for this type!");b.save();b.beginPath();b.moveTo(c+this.vertices[0].x,e+this.vertices[0].y);for(var k=1;k<this.vertices.length;k++)b.lineTo(c+this.vertices[k].x,e+this.vertices[k].y);b.closePath();"outline"===this.style.toString().toLowerCase()?(b.strokeStyle=
R(this.color),b.stroke()):(b.fillStyle=R(this.color,this.style),b.fill());b.restore()};world.Kernel.makeCanvas=function(b,c){var e=document.createElement("canvas");e.width=b;e.height=c;e.style.width=e.width+"px";e.style.height=e.height+"px";window&&"undefined"!==typeof window.G_vmlCanvasManager&&(e=window.G_vmlCanvasManager.initElement(e));return e};o.prototype.toDomNode=function(){var b=this,c=b.getWidth(),e=b.getHeight(),k=world.Kernel.makeCanvas(c,e);k.afterAttach=function(){var c=k.getContext("2d");
b.render(c,0,0)};return k};o.prototype.toWrittenString=function(){return"<image>"};o.prototype.toDisplayedString=function(){return"<image>"};o.prototype.isEqual=function(b,c){if(this.width!==b.width||this.height!==b.height)return!1;if(this.vertices&&b.vertices){var e;if(e=this.style===b.style){a:{e=this.vertices;var k=b.vertices;if(e.length!==k.length)e=!1;else{for(var m=0;m<e.length;m++)if(e[m].x!==k[m].x||e[m].y!==k[m].y){e=!1;break a}e=!0}}e=e&&types.isEqual(this.color,b.color,c)}return e}var m=
this.toDomNode(),o=b.toDomNode();m.afterAttach();o.afterAttach();if(m.width!==o.width||m.height!==o.height)return!1;try{var p=m.getContext("2d"),q=o.getContext("2d"),y=p.getImageData(0,0,m.width,m.height),w=q.getImageData(0,0,o.width,o.height);e=y.data;k=w.data;for(m=0;m<e.length;m++)if(e[m]!==k[m])return!1}catch(A){return!1}return!0};var J=function(b,c,e,k){this.width=b;this.height=c;this.children=e;this.withBorder=k};J.prototype=q(o.prototype);J.prototype.add=function(b,c,e){return new J(this.width,
this.height,this.children.concat([[b,c-b.getWidth()/2,e-b.getHeight()/2]]),this.withBorder)};J.prototype.render=function(b,c,e){var k,m,o,p;b.save();b.fillStyle="rgba(0,0,0,0)";b.fillRect(c,e,this.width,this.height);b.restore();b.save();b.beginPath();b.rect(c,e,this.width,this.height);b.clip();for(k=0;k<this.children.length;k++)m=this.children[k][0],o=this.children[k][1],p=this.children[k][2],m.render(b,o+c,p+e);b.restore();this.withBorder&&(b.strokeStyle="black",b.strokeRect(c,e,this.width,this.height))};
J.prototype.isEqual=function(b,c){if(!(b instanceof J))return o.prototype.isEqual.call(this,b,c);if(this.width!==b.width||this.height!==b.height||this.children.length!==b.children.length)return!1;for(var e=0;e<this.children.length;e++){var k=this.children[e],m=b.children[e];if(k[1]!==m[1]||k[2]!==m[2]||!types.isEqual(k[0],m[0],c))return!1}return!0};var w=function(b,c,e){var k=this;this.src=b;this.isLoaded=!1;this.animationHackImg=void 0;c&&c.complete?(this.img=c,this.isLoaded=!0,k.width=k.img.width,
k.height=k.img.height):(this.img=new Image,this.img.onload=function(){k.isLoaded=!0;k.width=k.img.width;k.height=k.img.height},this.img.onerror=function(){k.img.onerror="";k.img.src="http://www.wescheme.org/images/broken.png"},this.img.src=b);this.installHackToSupportAnimatedGifs(e)};w.prototype=q(o.prototype);var k={};w.makeInstance=function(b,c,e){b in k?e(k[b]):k[b]=new w(b,c,e);return k[b]};w.installInstance=function(b,c,e){k[b]=new w(b,c,e)};w.installBrokenImage=function(b){k[b]=new y("Unable to load "+
b,10,p.get("red"),"normal","Arial","","",!1)};w.prototype.render=function(b,c,e){b.drawImage(this.animationHackImg,c,e)};w.prototype.installHackToSupportAnimatedGifs=function(b){var c=this;this.animationHackImg=this.img.cloneNode(!0);document.body.appendChild(this.animationHackImg);this.animationHackImg.style.position="absolute";this.animationHackImg.style.top="-5000px";this.animationHackImg.complete?b(c):this.animationHackImg.onload=function(){b(c)}};w.prototype.getWidth=function(){return this.img.width};
w.prototype.getHeight=function(){return this.img.height};w.prototype.isEqual=function(b,c){return!(b instanceof w)?o.prototype.isEqual.call(this,b,c):this.src===b.src};var A=function(b,c){var e=this;this.src=b;c?(this.video=c,this.width=e.video.videoWidth,this.height=e.video.videoHeight,this.video.volume=1,this.video.poster="http://www.wescheme.org/images/broken.png",this.video.autoplay=!0,this.video.autobuffer=!0,this.video.loop=!0,this.video.play()):(this.video=document.createElement("video"),this.video.src=
b,this.video.addEventListener("canplay",function(){this.width=e.video.videoWidth;this.height=e.video.videoHeight;this.video.poster="http://www.wescheme.org/images/broken.png";this.video.autoplay=!0;this.video.autobuffer=!0;this.video.loop=!0;this.video.play()}),this.video.addEventListener("error",function(){e.video.onerror="";e.video.poster="http://www.wescheme.org/images/broken.png"}))};A.prototype=q(o.prototype);var aa={};A.makeInstance=function(b,c){b in A||(aa[b]=new A(b,c));return aa[b]};A.prototype.render=
function(b,c,e){b.drawImage(this.video,c,e)};A.prototype.isEqual=function(b,c){return!(b instanceof A)?o.prototype.isEqual.call(this,b,c):this.src===b.src};q(o.prototype);var T=function(b,c,k,m){var o,p;"left"===k?p=o=0:"right"===k?(o=Math.max(b.getWidth(),c.getWidth())-b.getWidth(),p=Math.max(b.getWidth(),c.getWidth())-c.getWidth()):"beside"===k?(o=0,p=b.getWidth()):"middle"===k||"center"===k?(o=Math.max(b.getWidth(),c.getWidth())/2-b.getWidth()/2,p=Math.max(b.getWidth(),c.getWidth())/2-c.getWidth()/
2):(o=Math.max(k,0)-k,p=Math.max(k,0));"top"===m?m=k=0:"bottom"===m?(k=Math.max(b.getHeight(),c.getHeight())-b.getHeight(),m=Math.max(b.getHeight(),c.getHeight())-c.getHeight()):"above"===m?(k=0,m=b.getHeight()):"baseline"===m?(k=Math.max(b.getBaseline(),c.getBaseline())-b.getBaseline(),m=Math.max(b.getBaseline(),c.getBaseline())-c.getBaseline()):"middle"===m||"center"===m?(k=Math.max(b.getHeight(),c.getHeight())/2-b.getHeight()/2,m=Math.max(b.getHeight(),c.getHeight())/2-c.getHeight()/2):(k=Math.max(m,
0)-m,m=Math.max(m,0));var q,y=b.getVertices(),E=c.getVertices(),w=[],A=[];for(q=0;q<y.length;q++)w.push(Math.round(y[q].x+o)),A.push(Math.round(y[q].y+k));for(q=0;q<E.length;q++)w.push(Math.round(E[q].x+p)),A.push(Math.round(E[q].y+m));this._vertices=e(w,A);this.width=Math.max.apply(Math,w)-Math.min.apply(Math,w);this.height=Math.max.apply(Math,A)-Math.min.apply(Math,A);this.x1=Math.floor(o);this.y1=Math.floor(k);this.x2=Math.floor(p);this.y2=Math.floor(m);this.img1=b;this.img2=c};T.prototype=q(o.prototype);
T.prototype.getVertices=function(){return this._vertices};T.prototype.render=function(b,c,e){b.save();this.img2.render(b,c+this.x2,e+this.y2);this.img1.render(b,c+this.x1,e+this.y1);b.restore()};T.prototype.isEqual=function(b,c){return!(b instanceof T)?o.prototype.isEqual.call(this,b,c):this.width===b.width&&this.height===b.height&&this.x1===b.x1&&this.y1===b.y1&&this.x2===b.x2&&this.y2===b.y2&&types.isEqual(this.img1,b.img1,c)&&types.isEqual(this.img2,b.img2,c)};var sa=function(b,c){var k=Math.sin(b*
Math.PI/180),m=Math.cos(b*Math.PI/180);c.getWidth();c.getHeight();for(var o=c.getVertices(),p=[],q=[],y=0;y<o.length;y++)p[y]=Math.round(o[y].x*m-o[y].y*k),q[y]=Math.round(o[y].x*k+o[y].y*m);k=Math.floor(-Math.min.apply(Math,p));m=Math.floor(-Math.min.apply(Math,q));for(y=0;y<o.length;y++)p[y]+=k,q[y]+=m;this._vertices=e(p,q);o=Math.max.apply(Math,p)-Math.min.apply(Math,p);q=Math.max.apply(Math,q)-Math.min.apply(Math,q);this.img=c;this.width=Math.floor(o);this.height=Math.floor(q);this.angle=b;this.translateX=
k;this.translateY=m};sa.prototype=q(o.prototype);sa.prototype.getVertices=function(){return this._vertices};sa.prototype.render=function(b,c,e){b.save();b.translate(c+this.translateX,e+this.translateY);b.rotate(this.angle*Math.PI/180);this.img.render(b,0,0);b.restore()};sa.prototype.isEqual=function(b,c){return!(b instanceof sa)?o.prototype.isEqual.call(this,b,c):this.width===b.width&&this.height===b.height&&this.angle===b.angle&&this.translateX===b.translateX&&this.translateY===b.translateY&&types.isEqual(this.img,
b.img,c)};var W=function(b,c,k){for(var m=k.getVertices(),o=[],p=[],q=0;q<m.length;q++)o[q]=Math.round(m[q].x*b),p[q]=Math.round(m[q].y*c);this._vertices=e(o,p);this.img=k;this.width=Math.floor(k.getWidth()*b);this.height=Math.floor(k.getHeight()*c);this.xFactor=b;this.yFactor=c};W.prototype=q(o.prototype);W.prototype.getVertices=function(){return this._vertices};W.prototype.render=function(b,c,e){b.save();b.scale(this.xFactor,this.yFactor);this.img.render(b,c/this.xFactor,e/this.yFactor);b.restore()};
W.prototype.isEqual=function(b,c){return!(b instanceof W)?o.prototype.isEqual.call(this,b,c):this.width===b.width&&this.height===b.height&&this.xFactor===b.xFactor&&this.yFactor===b.yFactor&&types.isEqual(this.img,b.img,c)};var C=function(b,c,e,k,m){this.x=b;this.y=c;this.width=e;this.height=k;this.img=m};C.prototype=q(o.prototype);C.prototype.render=function(b,c,e){b.save();b.beginPath();b.rect(c,e,this.width,this.height);b.clip();b.translate(-this.x,-this.y);this.img.render(b,c,e);b.restore()};
C.prototype.isEqual=function(b,c){return!(b instanceof C)?o.prototype.isEqual.call(this,b,c):this.width===b.width&&this.height===b.height&&this.x===b.x&&this.y===b.y&&types.isEqual(this.img,b.img,c)};var ca=function(b){this.img=b;this.width=b.getWidth();this.height=b.getHeight()};ca.prototype=q(o.prototype);ca.prototype.render=function(b,c,e){b.save();this.img.render(b,c,e);b.beginPath();b.strokeStyle="black";b.strokeRect(c,e,this.width,this.height);b.closePath();b.restore()};ca.prototype.isEqual=
function(b,c){return!(b instanceof ca)?o.prototype.isEqual.call(this,b,c):types.isEqual(this.img,b.img,c)};var X=function(b,c){this.img=b;this.width=b.getWidth();this.height=b.getHeight();this.direction=c};X.prototype=q(o.prototype);X.prototype.render=function(b,c,e){b.save();"horizontal"===this.direction&&(b.scale(-1,1),b.translate(-(this.width+2*c),0),this.img.render(b,c,e));"vertical"===this.direction&&(b.scale(1,-1),b.translate(0,-(this.height+2*e)),this.img.render(b,c,e));b.restore()};X.prototype.getWidth=
function(){return this.width};X.prototype.getHeight=function(){return this.height};X.prototype.isEqual=function(b,c){return!(b instanceof X)?o.prototype.isEqual.call(this,b,c):this.width===b.width&&this.height===b.height&&this.direction===b.direction&&types.isEqual(this.img,b.img,c)};var R=function(b,c){var e=isNaN(c)?1:c/255;return"rgba("+types.colorRed(b)+","+types.colorGreen(b)+", "+types.colorBlue(b)+", "+e+")"},ia=function(b,c,e,k){this.width=b;this.height=c;this.style=e;this.color=k;this.vertices=
[{x:0,y:c},{x:0,y:0},{x:b,y:0},{x:b,y:c}]};ia.prototype=q(o.prototype);ia.prototype.getWidth=function(){return this.width};ia.prototype.getHeight=function(){return this.height};var L=function(b,c,e,k){this.width=2*Math.sin(c/2*Math.PI/180)*b;this.height=2*Math.abs(Math.cos(c/2*Math.PI/180))*b;this.side=b;this.angle=c;this.style=e;this.color=k;this.vertices=[{x:this.width/2,y:0},{x:this.width,y:this.height/2},{x:this.width/2,y:this.height},{x:0,y:this.height/2}]};L.prototype=q(o.prototype);L.prototype.getWidth=
function(){return this.width};L.prototype.getHeight=function(){return this.height};var pa=function(b,c,k,m,o){this.outerRadius=Math.floor(b/(2*Math.sin(Math.PI/c)));this.innerRadius=Math.floor(b/(2*Math.tan(Math.PI/c)));for(var p=3*Math.PI/2+Math.PI/c,q=0,y=[],w=[],A=0;A<c;A++)q+=2*k*Math.PI/c,y.push(Math.round(this.outerRadius*Math.cos(q-p))),w.push(Math.round(this.outerRadius*Math.sin(q-p)));p=e(y,w);this.width=Math.max.apply(Math,y)-Math.min.apply(Math,y);this.height=Math.max.apply(Math,w)-Math.min.apply(Math,
w);this.length=b;this.count=c;this.step=k;this.style=m;this.color=o;b=Math.round(this.width/2);c=this.count%2?this.outerRadius:this.innerRadius;for(A=0;A<p.length;A++)p[A].x+=b,p[A].y+=c;this.vertices=p};pa.prototype=q(o.prototype);var y=function(b,c,e,k,m,o,p,q){var y;this.msg=b;this.size=c;this.color=e;this.face=k;this.family=m;this.style="slant"===o?"oblique":o;this.weight="light"===p?"lighter":p;this.underline=q;c=world.Kernel.makeCanvas(0,0).getContext("2d");this.font=this.style+" "+this.weight+
" "+this.size+'px "'+this.face+'", '+this.family;try{c.font=this.font}catch(w){this.fallbackOnFont(),c.font=this.font}try{y=c.measureText(b),this.width=y.width,this.height=Number(this.size)}catch(A){this.fallbackOnFont()}};y.prototype=q(o.prototype);y.prototype.fallbackOnFont=function(){this.font=this.size+"px "+(/ /.test(this.family)?'"'+this.family+'"':this.family);var b=world.Kernel.makeCanvas(0,0).getContext("2d");b.font=this.font;this.width=b.measureText(this.msg).width;this.height=Number(this.size)};
y.prototype.render=function(b,c,e){b.save();b.textAlign="left";b.textBaseline="top";b.fillStyle=R(this.color);b.font=this.font;try{b.fillText(this.msg,c,e)}catch(k){this.fallbackOnFont(),b.font=this.font,b.fillText(this.msg,c,e)}this.underline&&(b.beginPath(),b.moveTo(c,e+this.size),b.lineTo(c+this.width,e+this.size),b.closePath(),b.strokeStyle=R(this.color),b.stroke());b.restore()};y.prototype.getBaseline=function(){return this.size};y.prototype.isEqual=function(b,c){return!(b instanceof y)?o.prototype.isEqual.call(this,
b,c):this.msg===b.msg&&this.size===b.size&&this.face===b.face&&this.family===b.family&&this.style===b.style&&this.weight===b.weight&&this.underline===b.underline&&types.isEqual(this.color,b.color,c)&&this.font===b.font};var V=function(b,c,e,k,m){this.points=b;this.outer=c;this.inner=e;this.style=k;this.color=m;this.radius=Math.max(this.inner,this.outer);this.width=2*this.radius;this.height=2*this.radius;b=[];c=Math.PI/180;for(e=0;e<2*this.points+1;e++)k=360/(2*this.points)*e*c-0.5,m=1===e%2?this.outer:
this.inner,b.push({x:this.radius+Math.sin(k)*m,y:this.radius+Math.cos(k)*m});this.vertices=b};V.prototype=q(o.prototype);var Z=function(b,c,k,m,o){this.width=b;this.height=k*Math.sin(c*Math.PI/180);var p=[],q=[];180>c?(p=[0,b,k*Math.cos(c*Math.PI/180)],q=[0,0,this.height]):(p=[0,b,Math.abs(k*Math.cos(c*Math.PI/180))],q=[-this.height,-this.height,0]);this.vertices=e(p,q);b=Math.min.apply(Math,p);c=Math.min.apply(Math,q);p=Math.max.apply(Math,p);q=Math.max.apply(Math,q);this.width=p-b;this.height=q-
c;for(q=0;q<this.vertices.length;q++)this.vertices[q].x-=b,this.vertices[q].y-=c;this.style=m;this.color=o};Z.prototype=q(o.prototype);var ha=function(b,c,e,k){this.width=b;this.height=c;this.style=e;this.color=k};ha.prototype=q(o.prototype);ha.prototype.render=function(b,c,e){b.save();b.beginPath();var k=0.5522848*(this.width/2),m=0.5522848*(this.height/2),o=c+this.width,p=e+this.height,q=c+this.width/2,y=e+this.height/2;b.moveTo(c,y);b.bezierCurveTo(c,y-m,q-k,e,q,e);b.bezierCurveTo(q+k,e,o,y-m,
o,y);b.bezierCurveTo(o,y+m,q+k,p,q,p);b.bezierCurveTo(q-k,p,c,y+m,c,y);b.closePath();"outline"===this.style.toString().toLowerCase()?(b.strokeStyle=R(this.color),b.stroke()):(b.fillStyle=R(this.color,this.style),b.fill());b.restore()};ha.prototype.isEqual=function(b,c){return!(b instanceof ha)?o.prototype.isEqual.call(this,b,c):this.width===b.width&&this.height===b.height&&this.style===b.style&&types.isEqual(this.color,b.color,c)};var ma=function(b,c,e){var k;k=0<=b?0<=c?[{x:0,y:0},{x:b,y:c}]:[{x:0,
y:-c},{x:b,y:0}]:0<=c?[{x:-b,y:0},{x:0,y:c}]:[{x:-b,y:-c},{x:0,y:0}];this.style="outline";this.color=e;this.width=Math.abs(b);this.height=Math.abs(c);this.vertices=k};ma.prototype=q(o.prototype);world.Kernel.applyEffect=function(b){if(b!==types.EMPTY){if(types.isPair(b))return world.Kernel.applyEffect(b.first).concat(world.Kernel.applyEffect(b.rest));if(b=b.run())return b}return[]};q=function(){this.colors={}};q.prototype.put=function(b,c){this.colors[b]=c};q.prototype.get=function(b){return this.colors[b.toString().toUpperCase()]};
var p=new q;p.put("ORANGE",types.color(255,165,0));p.put("RED",types.color(255,0,0));p.put("ORANGERED",types.color(255,69,0));p.put("TOMATO",types.color(255,99,71));p.put("DARKRED",types.color(139,0,0));p.put("RED",types.color(255,0,0));p.put("FIREBRICK",types.color(178,34,34));p.put("CRIMSON",types.color(220,20,60));p.put("DEEPPINK",types.color(255,20,147));p.put("MAROON",types.color(176,48,96));p.put("INDIAN RED",types.color(205,92,92));p.put("INDIANRED",types.color(205,92,92));p.put("MEDIUM VIOLET RED",
types.color(199,21,133));p.put("MEDIUMVIOLETRED",types.color(199,21,133));p.put("VIOLET RED",types.color(208,32,144));p.put("VIOLETRED",types.color(208,32,144));p.put("LIGHTCORAL",types.color(240,128,128));p.put("HOTPINK",types.color(255,105,180));p.put("PALEVIOLETRED",types.color(219,112,147));p.put("LIGHTPINK",types.color(255,182,193));p.put("ROSYBROWN",types.color(188,143,143));p.put("PINK",types.color(255,192,203));p.put("ORCHID",types.color(218,112,214));p.put("LAVENDERBLUSH",types.color(255,
240,245));p.put("SNOW",types.color(255,250,250));p.put("CHOCOLATE",types.color(210,105,30));p.put("SADDLEBROWN",types.color(139,69,19));p.put("BROWN",types.color(132,60,36));p.put("DARKORANGE",types.color(255,140,0));p.put("CORAL",types.color(255,127,80));p.put("SIENNA",types.color(160,82,45));p.put("ORANGE",types.color(255,165,0));p.put("SALMON",types.color(250,128,114));p.put("PERU",types.color(205,133,63));p.put("DARKGOLDENROD",types.color(184,134,11));p.put("GOLDENROD",types.color(218,165,32));
p.put("SANDYBROWN",types.color(244,164,96));p.put("LIGHTSALMON",types.color(255,160,122));p.put("DARKSALMON",types.color(233,150,122));p.put("GOLD",types.color(255,215,0));p.put("YELLOW",types.color(255,255,0));p.put("OLIVE",types.color(128,128,0));p.put("BURLYWOOD",types.color(222,184,135));p.put("TAN",types.color(210,180,140));p.put("NAVAJOWHITE",types.color(255,222,173));p.put("PEACHPUFF",types.color(255,218,185));p.put("KHAKI",types.color(240,230,140));p.put("DARKKHAKI",types.color(189,183,107));
p.put("MOCCASIN",types.color(255,228,181));p.put("WHEAT",types.color(245,222,179));p.put("BISQUE",types.color(255,228,196));p.put("PALEGOLDENROD",types.color(238,232,170));p.put("BLANCHEDALMOND",types.color(255,235,205));p.put("MEDIUM GOLDENROD",types.color(234,234,173));p.put("MEDIUMGOLDENROD",types.color(234,234,173));p.put("PAPAYAWHIP",types.color(255,239,213));p.put("MISTYROSE",types.color(255,228,225));p.put("LEMONCHIFFON",types.color(255,250,205));p.put("ANTIQUEWHITE",types.color(250,235,215));
p.put("CORNSILK",types.color(255,248,220));p.put("LIGHTGOLDENRODYELLOW",types.color(250,250,210));p.put("OLDLACE",types.color(253,245,230));p.put("LINEN",types.color(250,240,230));p.put("LIGHTYELLOW",types.color(255,255,224));p.put("SEASHELL",types.color(255,245,238));p.put("BEIGE",types.color(245,245,220));p.put("FLORALWHITE",types.color(255,250,240));p.put("IVORY",types.color(255,255,240));p.put("GREEN",types.color(0,255,0));p.put("LAWNGREEN",types.color(124,252,0));p.put("CHARTREUSE",types.color(127,
255,0));p.put("GREEN YELLOW",types.color(173,255,47));p.put("GREENYELLOW",types.color(173,255,47));p.put("YELLOW GREEN",types.color(154,205,50));p.put("YELLOWGREEN",types.color(154,205,50));p.put("MEDIUM FOREST GREEN",types.color(107,142,35));p.put("OLIVEDRAB",types.color(107,142,35));p.put("MEDIUMFORESTGREEN",types.color(107,142,35));p.put("DARK OLIVE GREEN",types.color(85,107,47));p.put("DARKOLIVEGREEN",types.color(85,107,47));p.put("DARKSEAGREEN",types.color(143,188,139));p.put("LIME",types.color(0,
255,0));p.put("DARK GREEN",types.color(0,100,0));p.put("DARKGREEN",types.color(0,100,0));p.put("LIME GREEN",types.color(50,205,50));p.put("LIMEGREEN",types.color(50,205,50));p.put("FOREST GREEN",types.color(34,139,34));p.put("FORESTGREEN",types.color(34,139,34));p.put("SPRING GREEN",types.color(0,255,127));p.put("SPRINGGREEN",types.color(0,255,127));p.put("MEDIUM SPRING GREEN",types.color(0,250,154));p.put("MEDIUMSPRINGGREEN",types.color(0,250,154));p.put("SEA GREEN",types.color(46,139,87));p.put("SEAGREEN",
types.color(46,139,87));p.put("MEDIUM SEA GREEN",types.color(60,179,113));p.put("MEDIUMSEAGREEN",types.color(60,179,113));p.put("AQUAMARINE",types.color(112,216,144));p.put("LIGHTGREEN",types.color(144,238,144));p.put("PALE GREEN",types.color(152,251,152));p.put("PALEGREEN",types.color(152,251,152));p.put("MEDIUM AQUAMARINE",types.color(102,205,170));p.put("MEDIUMAQUAMARINE",types.color(102,205,170));p.put("TURQUOISE",types.color(64,224,208));p.put("LIGHTSEAGREEN",types.color(32,178,170));p.put("MEDIUM TURQUOISE",
types.color(72,209,204));p.put("MEDIUMTURQUOISE",types.color(72,209,204));p.put("HONEYDEW",types.color(240,255,240));p.put("MINTCREAM",types.color(245,255,250));p.put("ROYALBLUE",types.color(65,105,225));p.put("DODGERBLUE",types.color(30,144,255));p.put("DEEPSKYBLUE",types.color(0,191,255));p.put("CORNFLOWERBLUE",types.color(100,149,237));p.put("STEEL BLUE",types.color(70,130,180));p.put("STEELBLUE",types.color(70,130,180));p.put("LIGHTSKYBLUE",types.color(135,206,250));p.put("DARK TURQUOISE",types.color(0,
206,209));p.put("DARKTURQUOISE",types.color(0,206,209));p.put("CYAN",types.color(0,255,255));p.put("AQUA",types.color(0,255,255));p.put("DARKCYAN",types.color(0,139,139));p.put("TEAL",types.color(0,128,128));p.put("SKY BLUE",types.color(135,206,235));p.put("SKYBLUE",types.color(135,206,235));p.put("CADET BLUE",types.color(96,160,160));p.put("CADETBLUE",types.color(95,158,160));p.put("DARK SLATE GRAY",types.color(47,79,79));p.put("DARKSLATEGRAY",types.color(47,79,79));p.put("LIGHTSLATEGRAY",types.color(119,
136,153));p.put("SLATEGRAY",types.color(112,128,144));p.put("LIGHT STEEL BLUE",types.color(176,196,222));p.put("LIGHTSTEELBLUE",types.color(176,196,222));p.put("LIGHT BLUE",types.color(173,216,230));p.put("LIGHTBLUE",types.color(173,216,230));p.put("POWDERBLUE",types.color(176,224,230));p.put("PALETURQUOISE",types.color(175,238,238));p.put("LIGHTCYAN",types.color(224,255,255));p.put("ALICEBLUE",types.color(240,248,255));p.put("AZURE",types.color(240,255,255));p.put("MEDIUM BLUE",types.color(0,0,205));
p.put("MEDIUMBLUE",types.color(0,0,205));p.put("DARKBLUE",types.color(0,0,139));p.put("MIDNIGHT BLUE",types.color(25,25,112));p.put("MIDNIGHTBLUE",types.color(25,25,112));p.put("NAVY",types.color(36,36,140));p.put("BLUE",types.color(0,0,255));p.put("INDIGO",types.color(75,0,130));p.put("BLUE VIOLET",types.color(138,43,226));p.put("BLUEVIOLET",types.color(138,43,226));p.put("MEDIUM SLATE BLUE",types.color(123,104,238));p.put("MEDIUMSLATEBLUE",types.color(123,104,238));p.put("SLATE BLUE",types.color(106,
90,205));p.put("SLATEBLUE",types.color(106,90,205));p.put("PURPLE",types.color(160,32,240));p.put("DARK SLATE BLUE",types.color(72,61,139));p.put("DARKSLATEBLUE",types.color(72,61,139));p.put("DARKVIOLET",types.color(148,0,211));p.put("DARK ORCHID",types.color(153,50,204));p.put("DARKORCHID",types.color(153,50,204));p.put("MEDIUMPURPLE",types.color(147,112,219));p.put("CORNFLOWER BLUE",types.color(68,64,108));p.put("MEDIUM ORCHID",types.color(186,85,211));p.put("MEDIUMORCHID",types.color(186,85,211));
p.put("MAGENTA",types.color(255,0,255));p.put("FUCHSIA",types.color(255,0,255));p.put("DARKMAGENTA",types.color(139,0,139));p.put("VIOLET",types.color(238,130,238));p.put("PLUM",types.color(221,160,221));p.put("LAVENDER",types.color(230,230,250));p.put("THISTLE",types.color(216,191,216));p.put("GHOSTWHITE",types.color(248,248,255));p.put("WHITE",types.color(255,255,255));p.put("WHITESMOKE",types.color(245,245,245));p.put("GAINSBORO",types.color(220,220,220));p.put("LIGHT GRAY",types.color(211,211,
211));p.put("LIGHTGRAY",types.color(211,211,211));p.put("SILVER",types.color(192,192,192));p.put("GRAY",types.color(190,190,190));p.put("DARK GRAY",types.color(169,169,169));p.put("DARKGRAY",types.color(169,169,169));p.put("DIM GRAY",types.color(105,105,105));p.put("DIMGRAY",types.color(105,105,105));p.put("BLACK",types.color(0,0,0));world.Kernel.isImage=function(b){return null!==b&&void 0!==b&&b instanceof o};world.Kernel.isScene=function(b){return void 0!==b&&null!==b&&b instanceof J};world.Kernel.isColor=
function(b){return types.isColor(b)||(types.isString(b)||types.isSymbol(b))&&"undefined"!==typeof p.get(b)};world.Kernel.nameToColor=function(b){return p.get(""+b)};world.Kernel.colorDb=p;world.Kernel.sceneImage=function(b,c,e,k){return new J(b,c,e,k)};world.Kernel.circleImage=function(b,c,e){return new ha(2*b,2*b,c,e)};world.Kernel.starImage=function(b,c,e,k,m){return new V(b,c,e,k,m)};world.Kernel.rectangleImage=function(b,c,e,k){return new ia(b,c,e,k)};world.Kernel.rhombusImage=function(b,c,e,
k){return new L(b,c,e,k)};world.Kernel.polygonImage=function(b,c,e,k,m){return new pa(b,c,e,k,m)};world.Kernel.squareImage=function(b,c,e){return new ia(b,b,c,e)};world.Kernel.triangleImage=function(b,c,e,k,m){return new Z(b,c,e,k,m)};world.Kernel.ellipseImage=function(b,c,e,k){return new ha(b,c,e,k)};world.Kernel.lineImage=function(b,c,e){return new ma(b,c,e)};world.Kernel.overlayImage=function(b,c,e,k){return new T(b,c,e,k)};world.Kernel.rotateImage=function(b,c){return new sa(b,c)};world.Kernel.scaleImage=
function(b,c,e){return new W(b,c,e)};world.Kernel.cropImage=function(b,c,e,k,m){return new C(b,c,e,k,m)};world.Kernel.frameImage=function(b){return new ca(b)};world.Kernel.flipImage=function(b,c){return new X(b,c)};world.Kernel.textImage=function(b,c,e,k,m,o,p,q){return new y(b,c,e,k,m,o,p,q)};world.Kernel.fileImage=function(b,c,e){return w.makeInstance(b,c,e)};world.Kernel.fileVideo=function(b,c){return A.makeInstance(b,c)};world.Kernel.isSceneImage=function(b){return b instanceof J};world.Kernel.isStarImage=
function(b){return b instanceof V};world.Kernel.isRectangleImage=function(b){return b instanceof ia};world.Kernel.isPolygonImage=function(b){return b instanceof pa};world.Kernel.isRhombusImage=function(b){return b instanceof L};world.Kernel.isTriangleImage=function(b){return b instanceof Z};world.Kernel.isEllipseImage=function(b){return b instanceof ha};world.Kernel.isLineImage=function(b){return b instanceof ma};world.Kernel.isOverlayImage=function(b){return b instanceof T};world.Kernel.isRotateImage=
function(b){return b instanceof sa};world.Kernel.isScaleImage=function(b){return b instanceof W};world.Kernel.isCropImage=function(b){return b instanceof C};world.Kernel.isFrameImage=function(b){return b instanceof ca};world.Kernel.isFlipImage=function(b){return b instanceof X};world.Kernel.isTextImage=function(b){return b instanceof y};world.Kernel.isFileImage=function(b){return b instanceof w};world.Kernel.isFileVideo=function(b){return b instanceof A}})();
(function(){var m=jsworld.MobyJsworld={},q=jsworld.Jsworld;(function(){for(var b=0,c=["ms","moz","webkit","o"],e=0;e<c.length&&!window.requestAnimationFrame;++e)window.requestAnimationFrame=window[c[e]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[c[e]+"CancelAnimationFrame"]||window[c[e]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(c){var e=(new Date).getTime(),k=Math.max(0,16-(e-b)),m=window.setTimeout(function(){c(e+k)},k);b=
e+k;return m});window.cancelAnimationFrame||(window.cancelAnimationFrame=function(b){clearTimeout(b)})})();var c,b=function(b){c=function(c,e,k){b(c,e,k,L)}},e=function(){c=function(){throw Error("caller not defined!");}};e();var o,J=function(b){var c=!1;o=function(e){if(c)throw Error("Cannot restart twice!");c=!0;b(e)}};(function(){o=function(){throw Error("restarter not defined!");}})();var w,k=function(b){w=b},A=function(){w=function(){throw Error("terminator not defined!");}};A();var aa=[],T=
function(b){helpers.forEachK(aa,function(b,e){c(b.startup,b.startupArgs,function(c){b.shutdownArg=c;e()})},L,b)},sa=function(b){var e=aa;aa=[];helpers.forEachK(e,function(b,e){c(b.shutdown,[b.shutdownArg],e)},L,b)},W=function(b){return types.jsObject("function",function(){for(var e=[],k=0;k<arguments.length;k++)e.push(helpers.wrapJsObject(arguments[k]));m.updateWorld(function(k,m){var o=[k].concat(e);c(b,o,m)},function(){})})},C=function(b,e){types.isJsObject(b)?e(b.obj):types.isRenderEffect(b)?b.callImplementation(c,
function(b){C(b,e)}):types.isPair(b)?C(b.first(),function(c){C(b.rest(),function(b){e(types.cons(c,b))})}):e(b)},ca=types.isPair;m.printWorldHook=function(b,c){var e;null==c.lastChild?(e=types.toDomNode(b),c.appendChild(e)):(e=types.toDomNode(b),c.replaceChild(e,c.lastChild));helpers.maybeCallAfterAttach(e)};var X=function(b,c,e){var k=function(b,c){throw types.schemeError(types.incompleteExn(types.exnFailContract,helpers.format(b,c),[]));};if(!q.isPage(b))if(types.isPair(b)){var m=b.first(),e=b.rest();
"undefined"!=typeof m.nodeType||k("on-draw: expected a dom-element, but received ~s instead, the first element within ~s",[m,c]);m.nodeType==Node.TEXT_NODE&&!e.isEmpty()&&k("on-draw: the text node ~s must not have children.  It has ~s",[m,e]);for(c=2;!e.isEmpty();)X(e.first(),b,c),e=e.rest(),c++}else m="on-draw: expected a dom-s-expression, but received ~s instead",b=[b],void 0!=e&&(m+=", the ~a element within ~s",b.push(helpers.ordinalize(e)),b.push(c)),k(m+".",b)},R=function(b,c,e){b.addEventListener?
b.addEventListener(c,e,!1):b.attachEvent("on"+c,e,!1);return function(){ia(b,c,e)}},ia=function(b,c,e){b.addEventListener?b.removeEventListener(c,e,!1):b.detachEvent("on"+c,e,!1)};m.bigBang=function(pa,y,V,Z,ha){b(Z);J(ha);k(function(b){ia(y,"click",p);sa(function(){e();A();o(b)})});var ma=types.EMPTY;y.tabIndex=0;var p=function(b){b.preventDefault?b.preventDefault():b.returnValue=!1;b.stopPropagation?b.stopPropagation():b.cancelBubble=!0;return!1};R(y,"click",p);[].push(function(){ia(y,"click",p)});
for(var j=new world.config.WorldConfig,Z=0;Z<V.length;Z++)ca(V[Z])||V[Z]===types.EMPTY?ma=V[Z]:"function"==typeof V[Z]?j=V[Z](j):types.isWorldConfig(V[Z])&&(V[Z].startupArgs=helpers.map(W,V[Z].startupArgs),aa.push(V[Z]));j=j.updateAll({changeWorld:m.updateWorld,shutdownWorld:m.shutdownWorld});new world.stimuli.StimuliHandler(j,c,o);var z=[];if(j.lookup("onDraw"))V=function(b,e){try{c(j.lookup("onDraw"),[b],function(b){C(b,function(b){X(b,b,void 0);b=[y,helpers.deepListToArray(b)];e(b)})})}catch(k){L(k)}},
Z=j.lookup("onDrawCss")?function(b,e){try{c(j.lookup("onDrawCss"),[b],function(b){b=helpers.deepListToArray(b);e(b)})}catch(k){L(k)}}:function(b,c){c([])},z.push(q.on_draw(V,Z));else if(j.lookup("onRedraw")){var la=void 0,M=void 0;z.push(q.on_draw(function(b,e){window.requestAnimationFrame(function(){try{b=q.getCurrentWorld(),c(j.lookup("onRedraw"),[b],function(b){if(world.Kernel.isImage(b)){var c=b.getWidth(),j=b.getHeight();la||(la=world.Kernel.makeCanvas(c,j),la.jsworldOpaque=!0,M=q.node_to_tree(la));
setTimeout(function(){la.width=c;la.height=j;var e=la.getContext("2d");b.render(e,0,0)},0);e([y,M])}else e([y,q.node_to_tree(types.toDomNode(b))])})}catch(k){L(k)}})},function(b,c){c([[la,["width",la.width+"px"],["height",la.height+"px"]]])}))}else z.push(q.on_world_change(function(b,c){m.printWorldHook(b,y);c()}));j.lookup("tickDelay")&&(V=jsnums.toFixnum(j.lookup("tickDelay")),z.push(q.on_tick(V,function(b,e){c(j.lookup("onTick"),[b],e)})));j.lookup("stopWhen")&&z.push(q.stop_when(function(b,e){c(j.lookup("stopWhen"),
[b],function(b){e(b)})}));j.lookup("onKey")&&(z.push(q.on_key(function(b,e,k){c(j.lookup("onKey"),[b,helpers.getKeyCodeName(e)],k)})),y.focus());j.lookup("onTap")&&z.push(q.on_tap(function(b,e,k){var m=e.pageX,o=e.pageY,e=e.target;do m-=e.offsetLeft,o-=e.offsetTop,e=e.offsetParent;while(e);c(j.lookup("onTap"),[b,m,o],k)}));j.lookup("onTilt")&&(z.push(q.on_tilt(function(b,e,k,m){c(j.lookup("onTilt"),[b,jsnums.makeFloat(e),jsnums.makeFloat(k)],m)})),y.focus());T(function(){q.big_bang(y,pa,z,helpers.assocListToHash(ma),
w)});return{breaker:function(){L(types.schemeError(types.incompleteExn(types.exnBreak,"user break",[])))}}};var L=function(b){world.stimuli.massShutdown();sa(function(){types.isSchemeError(b)?w(b):types.isInternalError(b)?w(b):"string"==typeof b?w(types.schemeError(types.incompleteExn(types.exnFail,b,[]))):b instanceof Error?w(types.schemeError(types.incompleteExn(types.exnFail,b.message,[]))):w(types.schemeError(b))})};m.updateWorld=function(b,c){q.change_world(function(c,e){try{b(c,e)}catch(k){L(k)}},
c)};m.shutdownWorld=function(){q.shutdown()};m.p=q.p;m.div=q.div;m.buttonBang=function(b,e,k){return q.button(function(e,k,m){try{c(b,[e],function(b){m(b)})}catch(o){L(o)}},k)};m.input=function(b,e,k){return q.input(b,function(b,k,m){c(e,[b,k],m)},k)};m.get_dash_input_dash_value=function(b){return types.isString(b)?document.getElementById(b).value||"":b.value||""};m.img=q.img;m.text=q.text;m.select=function(b,e,k){return q.select(k,b,function(b,k,m){c(e,[b,k.target.value],m)})};m.emptyPage=q.emptyPage;
m.placeOnPage=function(b,c,e,k){b=types.toDomNode(C(b));return q.placeOnPage(b,c,e,k)}})();var primitive={};
(function(){var m,q,c={},b=types.PrimProc,e=types.CasePrimitive,o=function(b){return b},J=function(b,d){return d instanceof types.ValuesWrapper?m(b,d.elts,o):m(b,[d],o)},w=function(h,d){g(h,d,u,"procedure-arity","function name",1,[d]);var c=function(b){return b instanceof types.ContinuationClosureValue?types.arityAtLeast(0):b.isRest?types.arityAtLeast(b.numParams):b.numParams};if(d instanceof b||d instanceof types.ClosureValue||d instanceof types.ContinuationClosureValue)return c(d);var i;if(d instanceof
e)i=d.cases;else if(d instanceof types.CaseLambdaValue)i=d.closures;else throw types.internalError("procedure-arity given wrong type that passed isFunction!",!1);for(var l=[],j=0;j<i.length;j++)l.push(c(i[j]));l=k(l);return 1==l.length?l[0]:types.list(l)},k=function(b){b=b.splice(0);b.sort(function(b,d){return types.isArityAtLeast(b)&&types.isArityAtLeast(d)?types.arityValue(b)-types.arityValue(d):types.isArityAtLeast(b)?types.arityValue(b)-d-0.5:types.isArityAtLeast(d)?b-types.arityValue(d)+0.5:
b-d});for(var d=0;d<b.length-1;d++)if(types.isArityAtLeast(b[d]))return b.splice(0,d+1);return b},A=helpers.procArityContains,aa=function(b){for(var d=0;!b.isEmpty();b=b.rest())d+=1;return d},T=function(b,d){if(0==d.length)return types.EMPTY;var c=d.slice(0,d.length-1),i=d[d.length-1];P(c,function(c,t){ga(b,c,"append",t+1,d)});for(var g=c.length-1;0<=g;g--)i=c[g].append(i);return i},sa=function(b,d,c){if(c[0].isEmpty())return d;for(var i=[],g=[],e=0;e<c.length;e++)i.push(c[e].first()),g.push(c[e].rest());
i.push(d);return m(b,i,function(d){return sa(b,d,g)})},W=function(h){return function(d,t,i){ga(d,t,h,1,arguments);g(d,i,A(2),h,"procedure (arity 2)",2,arguments);var e=function(d,h){if(h.isEmpty())return types.EMPTY;var t=new b("compYes",1,!1,!1,function(b,d){return m(i,[d,h.first()],o)}),g=new b("compNo",1,!1,!1,function(b,d){return m(i,[d,h.first()],function(b){return!b})}),l=new b("quicksort",1,!1,!1,e);return m(c.filter,[t,h.rest()],function(b){return m(l,[b],function(b){return m(c.filter,[g,
h.rest()],function(c){return m(l,[c],function(c){return T(d,[b,types.list([h.first()]),c])})})})})};return e(d,t)}},C=function(b,d){for(var c=b[0],i=1;i<b.length;i++){if(!d(c,b[i]))return!1;c=b[i]}return!0},ca=function(b){var d;for(d=0;d<b.length;d++)if(!("a"<=b.charAt(d)&&"z">=b.charAt(d)||"A"<=b.charAt(d)&&"Z">=b.charAt(d)))return!1;return!0},X=function(){var b=/^\s*$/;return function(d){return d.match(b)?!0:!1}}(),R=types.Class.extend({init:function(b){this.name=b},configure:function(){throw types.internalError("unimplemented",
!1);},toDomNode:function(){var b=document.createElement("div");b.appendChild(document.createTextNode("("+this.name+" ...)"));return b},toWrittenString:function(){return"("+this.name+" ...)"},toDisplayedString:function(){return"("+this.name+" ...)"}}),ia=function(h,d,c){return function(i,g){return L(h,d)(i,g,new b("",c,!1,!1,function(){return types.EMPTY}))}},L=function(b,d){return function(c,i,e){g(c,i,u,b,"function name",1,arguments);g(c,e,u,b,"function name",2,arguments);return new (R.extend({init:function(){this._super(b)},
configure:function(b){var h={};h[d]=i;h[d+"Effect"]=e;return b.updateAll(h)}}))}},pa=helpers.assocListToHash,y=helpers.raise,V=function(b){var d=function(b){"undefined"!==typeof console&&console.log&&(console.log("There was an error in a procedure converted from scheme to javascript"),b.stack?console.log(b.stack):console.log(b));throw b;};return function(c,i,g){return interpret.call(b,c,i,g,d)}},Z=function(b,d){var c=function(d,c,t){return interpret.call(b,d,c,t,function(b){throw b;})};return function(b){for(var h=
[],g=1;g<arguments.length;g++)h.push(arguments[g]);c(d,h,b)}},ha=function(h,d,c,i,g,e){b.call(this,d,c,i,g,e);this.typeName=h};ha.prototype=b.prototype;var ma=function(){ha.apply(this,arguments)};ma.prototype=ha.prototype;var p=function(){ha.apply(this,arguments)};p.prototype=ha.prototype;var j=function(){ha.apply(this,arguments)};j.prototype=ha.prototype;var z=function(){ha.apply(this,arguments)};z.prototype=ha.prototype;var la=function(b){var d=b.name;return new types.ValuesWrapper([b,new ma(d,
"make-"+d,b.numberOfArgs,!1,!1,function(d){return b.constructor.apply(null,[].slice.call(arguments,1))}),new p(d,d+"?",1,!1,!1,function(d,c){return b.predicate(c)}),new j(d,d+"-ref",2,!1,!1,function(c,i,e){g(c,i,b.predicate,d+"-ref","struct:"+d,1,arguments);g(c,e,Q,d+"-ref","non-negative exact integer",2,arguments);var l=b.numberOfFields;jsnums.greaterThanOrEqual(e,l)&&y(types.incompleteExn(types.exnFailContract,d+"-ref: slot index for <struct:"+d+"> not in [0, "+(l-1)+"]: "+e,[]));return b.accessor(i,
jsnums.toFixnum(e))}),new z(d,d+"-set!",3,!1,!1,function(c,i,e,l){g(c,i,b.predicate,d+"-set!","struct:"+d,1,arguments);g(c,e,Q,d+"-set!","non-negative exact integer",2,arguments);var j=b.numberOfFields;jsnums.greaterThanOrEqual(e,j)&&y(types.incompleteExn(types.exnFailContract,d+"-set!: slot index for <struct"+d+"> not in [0, "+(j-1)+"]: "+e,[]));b.mutator(i,jsnums.toFixnum(e),l)})])},M=jsnums.isSchemeNumber,F=jsnums.isReal,Ka=jsnums.isRational,ra=jsnums.isInteger,Q=function(b){return jsnums.isExact(b)&&
ra(b)&&jsnums.greaterThanOrEqual(b,0)},E=function(b){return F(b)&&jsnums.greaterThanOrEqual(b,0)},da=function(b){return F(b)&&jsnums.greaterThanOrEqual(b,0)&&jsnums.lessThan(b,360)},D=function(b){return ra(b)&&jsnums.greaterThanOrEqual(b,3)},fa=function(b){return ra(b)&&jsnums.greaterThanOrEqual(b,1)},Y=types.isSymbol,U=types.isChar,I=types.isString,B=types.isPair,xa=helpers.isList,Fa=helpers.isListOf,qa=types.isVector,za=types.isBox,va=types.isHash,$=types.isByteString,ea=function(b){return Q(b)&&
jsnums.lessThanOrEqual(b,255)},l=function(b){return!0===b||!1===b},u=types.isFunction,ua=function(b,d){return types.isEqual(b,d,new types.UnionFind)},ba=function(b,d){return M(b)&&M(d)?jsnums.eqv(b,d):U(b)&&U(d)?b.val===d.val:b===d},N=world.Kernel.isImage,ja=world.Kernel.isScene,H=world.Kernel.isColor,$a=world.Kernel.nameToColor,ka=function(b){return(I(b)||Y(b))&&("default"==b.toString().toLowerCase()||"decorative"==b.toString().toLowerCase()||"roman"==b.toString().toLowerCase()||"script"==b.toString().toLowerCase()||
"swiss"==b.toString().toLowerCase()||"modern"==b.toString().toLowerCase()||"symbol"==b.toString().toLowerCase()||"system"==b.toString().toLowerCase())||!b},wa=function(b){return(I(b)||Y(b))&&("normal"==b.toString().toLowerCase()||"italic"==b.toString().toLowerCase()||"slant"==b.toString().toLowerCase())||!b},ta=function(b){return(I(b)||Y(b))&&("normal"==b.toString().toLowerCase()||"bold"==b.toString().toLowerCase()||"light"==b.toString().toLowerCase())||!b},O=world.Kernel.colorDb,oa=function(b){return(I(b)||
Y(b))&&("solid"==b.toString().toLowerCase()||"outline"==b.toString().toLowerCase())||F(b)&&jsnums.greaterThanOrEqual(b,0)&&jsnums.lessThanOrEqual(b,255)},Ia=function(b){return(I(b)||Y(b))&&("left"==b.toString().toLowerCase()||"right"==b.toString().toLowerCase()||"center"==b.toString().toLowerCase()||"middle"==b.toString().toLowerCase())},Ea=function(b){return(I(b)||Y(b))&&("top"==b.toString().toLowerCase()||"bottom"==b.toString().toLowerCase()||"baseline"==b.toString().toLowerCase()||"center"==b.toString().toLowerCase()||
"middle"==b.toString().toLowerCase())},Na=function(b){var d;if(d=B(b))if(d=B(b.rest()))d=b.rest().rest()===types.EMPTY;return d},ya=function(b){return types.isEffect(b)||Fa(b,ya)},Ba=types.isJsObject,Qa=function(b){return Ba(b)&&"function"==typeof b.obj},P=function(b,d){for(var c=0;c<b.length;c++)d.call(null,b[c],c)},g=helpers.check,S=helpers.checkVarArity,ga=function(b,d,c,i,g){xa(d)||helpers.throwCheckError(b,{functionName:c,typeName:"list",ordinalPosition:helpers.ordinalize(i),actualValue:d},i,
g)},Aa=helpers.checkListOf,Ta=function(b,d,c,i,g,e){(!xa(d)||aa(d)<c)&&helpers.throwCheckError(b,{functionName:i,typeName:"list with "+c+" or more elements",ordinalPosition:helpers.ordinalize(g),actualValue:d},g,e)},Ra=function(b,d,c,i){if(0!==d.length){var g=aa(d[0]);P(d,function(b){aa(b)!=g&&(b=helpers.map(function(){return" ~s"},i).join(""),b=helpers.format(c+": all lists must have the same size; arguments were:"+b,i),y(types.incompleteExn(types.exnFailContract,b,[])))})}};c["verify-boolean-branch-value"]=
new b("verify-boolean-branch-value",4,!1,!1,function(b,d,c,i,g){!0!==i&&!1!==i&&(state.captureCurrentContinuationMarks(b).ref(types.symbol("moby-application-position-key")),y(types.incompleteExn(types.exnFailContract,new types.Message([new types.ColoredPart(d,c),": expected a boolean value, but found: ",new types.ColoredPart(types.toWrittenString(i),g)]),[])));return i});c["throw-cond-exhausted-error"]=new b("throw-cond-exhausted-error",1,!1,!1,function(b,d){y(types.incompleteExn(types.exnFailContract,
new types.Message([new types.ColoredPart("cond",d),": all question results were false"]),[]))});c["print-values"]=new b("print-values",0,!0,!1,function(b,d){for(var c=!1,i=0;i<d.length;i++)d[i]!==types.VOID&&(b.getPrintHook()(d[i]),c=!0);c&&b.getDisplayHook()("\n");return types.VOID});c["check-expect"]=new b("check-expect",2,!1,!1,function(b,d,c){(u(d)||u(c))&&y(types.incompleteExn(types.exnFailContract,"check-expect cannot compare functions",[]));if(!ua(d,c)){d=helpers.format("check-expect: actual value ~s differs from ~s, the expected value.\n",
[d,c]);b.getDisplayHook()(d);d=state.getStackTraceFromContinuationMarks(state.captureCurrentContinuationMarks(b));for(c=0;c<d.length;c++)b.getPrintHook()(helpers.makeLocationDom(d[c]))}return types.VOID});c.EXAMPLE=c["check-expect"];c["check-within"]=new b("check-within",3,!1,!1,function(b,d,c,i){if(!E(i)){var g=helpers.format("check-within requires a non-negative real number for range, but given ~s.",[i]);y(types.incompleteExn(types.exnFailContract,g,[]))}(u(d)||u(c))&&y(types.incompleteExn(types.exnFailContract,
"check-within cannot compare functions",[]));if(!(ua(d,c)||F(d)&&F(c)&&jsnums.lessThanOrEqual(jsnums.abs(jsnums.subtract(d,c)),i))){g=helpers.format("check-within: actual value ~s is not within ~s of expected value ~s.",[d,i,c]);b.getDisplayHook()(g);d=state.getStackTraceFromContinuationMarks(state.captureCurrentContinuationMarks(b));for(c=0;c<d.length;c++)b.getPrintHook()(helpers.makeLocationDom(d[c]))}return types.VOID});var pb=new b("print",1,!1,!1,function(b,d){b.getPrintHook()(types.toWrittenString(d));
return types.VOID});c.write=new e("write",[new b("write",1,!1,!1,function(b,d){b.getPrintHook()(d);return types.VOID}),new b("write",2,!1,!0,function(){throw types.internalError("write to a port not implemented yet.",!1);})]);c.display=new e("display",[new b("display",1,!1,!1,function(b,d){b.getDisplayHook()(types.toDisplayedString(d));return types.VOID}),new b("display",2,!1,!0,function(){throw types.internalError("display to a port not implemented yet.",!1);})]);c.newline=new e("newline",[new b("newline",
0,!1,!0,function(b){b.getDisplayHook()("\n");b.v=types.VOID}),new b("newline",1,!1,!1,function(){throw types.internalError("newline to a port not implemented yet.",!1);})]);c["current-print"]=new b("current-print",0,!1,!1,function(){return pb});c["current-continuation-marks"]=new b("current-continuation-marks",0,!1,!1,function(b){return state.captureCurrentContinuationMarks(b)});c["continuation-mark-set->list"]=new b("continuation-mark-set->list",2,!1,!1,function(b,d,c){g(b,d,types.isContinuationMarkSet,
"continuation-mark-set->list","continuation-mark-set",1,[d,c]);return types.list(d.ref(c))});c["for-each"]=new b("for-each",2,!0,!1,function(b,d,c,i){var e=[d,c].concat(i);i.unshift(c);g(b,d,u,"for-each","function name",1,e);P(i,function(d,c){ga(b,d,"for-each",c+2,e)});Ra(b,i,"for-each",e);var l=function(b){if(b[0].isEmpty())return types.VOID;for(var c=[],h=[],t=0;t<b.length;t++)c.push(b[t].first()),h.push(b[t].rest());return m(d,c,function(){return l(h)})};return l(i)});c["make-thread-cell"]=new e("make-thread-cell",
[new b("make-thread-cell",1,!1,!1,function(b,d){return new types.ThreadCell(d,!1)}),new b("make-thread-cell",2,!1,!1,function(b,d,c){return new types.ThreadCell(d,c)})]);c["make-continuation-prompt-tag"]=new e("make-continuation-prompt-tag",[new b("make-continuation-prompt-tag",0,!1,!1,function(){return new types.ThreadCell}),new b("make-continuation-prompt-tag",1,!1,!1,function(b,d){return new types.ThreadCell(d)})]);var Ya=function(c,d,t,i,g){for(var l=function(e){return new b(c,d+e,!1,i,function(b){assert.equal(arguments.length,
d+e+1);for(var c=[arguments],h=0;h<arguments.length;h++)c.push(arguments[h]);return g.apply(g,c.concat(t.slice(h-d-1)))})},j=[],k=0;k<=t.length;k++)j.push(l(k));return new e(c,j)};c["make-struct-type"]=Ya("make-struct-type",4,[!1,types.EMPTY,types.symbol("prefab"),!1,types.EMPTY,!1],!1,function(b,d,c,i,e,l,j,k,m,o,p,q){g(d,c,Y,"make-struct-type","symbol",1,b);g(d,i,function(b){return!1===b||types.isStructType(b)},"make-struct-type","struct-type or #f",2,b);g(d,e,Q,"make-struct-type","exact non-negative integer",
3,b);g(d,l,Q,"make-struct-type","exact non-negative integer",4,b);Aa(d,p,Q,"make-struct-type","exact non-negative integer",9,b);g(d,q,function(b){return!1===b||u(b)},"make-struct-type","procedure or #f",10,b);b=e+1+(i?i.numberOfArgs:0);q&&!A(b)(q)&&y(types.incompleteExn(types.exnFailContract,helpers.format("make-struct-type: guard procedure does not accept ~a arguments (one more than the number constructor arguments): ~s",[b,q]),[]));d=q?Z(d,q):!1;c=types.makeStructureType(c.toString(),i,jsnums.toFixnum(e),
jsnums.toFixnum(l),j,d);return la(c)});c["make-struct-field-accessor"]=Ya("make-struct-field-accessor",2,[!1],!1,function(b,d,c,i,e){g(d,c,function(b){return b instanceof j&&1<b.numParams},"make-struct-field-accessor","accessor procedure that requires a field index",1,b);g(d,i,Q,"make-struct-field-accessor","exact non-negative integer",2,b);g(d,e,function(b){return!1===b||Y(b)},"make-struct-field-accessor","symbol or #f",3,b);var l=jsnums.toFixnum(i);return new j(c.typeName,c.typeName+"-"+(e?e.toString():
"field"+l),1,!1,!1,function(b,d){return c.impl(b,d,l)})});c["make-struct-field-mutator"]=Ya("make-struct-field-mutator",2,[!1],!1,function(b,d,c,i,e){g(d,c,function(b){return b instanceof z&&1<b.numParams},"make-struct-field-mutator","mutator procedure that requires a field index",1,b);g(d,i,Q,"make-struct-field-mutator","exact non-negative integer",2,b);g(d,e,function(b){return!1===b||Y(b)},"make-struct-field-mutator","symbol or #f",3,b);var l=jsnums.toFixnum(i);return new z(c.typeName,c.typeName+
"-"+(e?e.toString():"field"+l),2,!1,!1,function(b,h){return c.impl(d,b,l,h)})});c["struct-type?"]=new b("struct-type?",1,!1,!1,function(b,d){return types.isStructType(d)});c["struct-constructor-procedure?"]=new b("struct-constructor-procedure?",1,!1,!1,function(b,d){return d instanceof ma});c["struct-predicate-procedure?"]=new b("struct-predicate-procedure?",1,!1,!1,function(b,d){return d instanceof p});c["struct-accessor-procedure?"]=new b("struct-accessor-procedure?",1,!1,!1,function(b,d){return d instanceof
j});c["struct-mutator-procedure?"]=new b("struct-mutator-procedure?",1,!1,!1,function(b,d){return d instanceof z});c["procedure-arity"]=new b("procedure-arity",1,!1,!1,function(b,d){return w(b,d)});c.apply=new b("apply",2,!0,!1,function(b,d,c,i){var e=[d,c].concat(i);g(b,d,u,"apply","function name",1,e);i.unshift(c);c=i.pop();ga(b,c,"apply",i.length+2,e);i=i.concat(helpers.schemeListToArray(c));return m(d,i,o)});c.values=new b("values",0,!0,!1,function(b,d){return 1===d.length?d[0]:new types.ValuesWrapper(d)});
c["call-with-values"]=new b("call-with-values",2,!1,!1,function(b,d,c){g(b,d,A(0),"call-with-values","procedure (arity 0)",1,arguments);g(b,c,u,"call-with-values","function name",2,arguments);return m(d,[],function(b){return J(c,b)})});c.compose=new b("compose",0,!0,!1,function(h,d){P(d,function(b,c){g(h,b,u,"compose","function name",c+1,d)});if(0==d.length)return c.values;var t=types.list(d).reverse(),i=function(d,c){return c.isEmpty()?d:m(new b("",1,!1,!1,function(b,d){return J(c.first(),d)}),[d],
function(b){return i(b,c.rest())})};return new b("",0,!0,!1,function(b,d){return 1===d.length?i(d[0],t):i(new types.ValuesWrapper(d),t)})});c["current-inexact-milliseconds"]=new b("current-inexact-milliseconds",0,!1,!1,function(){return jsnums.makeFloat((new Date).valueOf())});c["current-seconds"]=new b("current-seconds",0,!1,!1,function(){return Math.floor((new Date).getTime()/1E3)});c.not=new b("not",1,!1,!1,function(b,d){return!1===d});c["void"]=new b("void",0,!0,!1,function(){return types.VOID});
c.random=new e("random",[new b("random",0,!1,!1,function(){return types["float"](Math.random())}),new b("random",1,!1,!1,function(b,d){g(b,d,Q,"random","non-negative exact integer",1,arguments);return Math.floor(Math.random()*jsnums.toFixnum(d))})]);c.sleep=new e("sleep",[new b("sleep",0,!1,!1,function(){return types.VOID}),new b("sleep",1,!1,!1,function(b,d){g(b,d,E,"sleep","non-negative real number",1);var c=jsnums.toFixnum(jsnums.multiply(d,1E3));return q(function(b){setTimeout(function(){b(types.VOID)},
c)})})]);c.identity=new b("identity",1,!1,!1,function(b,d){return d});c.raise=new b("raise",1,!1,!1,function(b,d){return y(d)});c.error=new b("error",1,!0,!0,function(b,d,c){var i=[d].concat(c);g(b,d,function(b){return Y(b)||I(b)},"error","symbol or string",1,i);if(Y(d)){0===c.length&&y(types.incompleteExn(types.exnFail,"error: "+d.val,[]));var e=c.shift();g(b,e,I,"error","string",2,i);c.unshift(d);y(types.incompleteExn(types.exnFail,helpers.format("~s: "+e.toString(),c),[]))}else{b=[d.toString()];
for(d=0;d<c.length;d++)b.push(types.toWrittenString(c[d]));y(types.incompleteExn(types.exnFail,b.join(""),[]))}});c["make-exn"]=new b("make-exn",2,!1,!1,function(b,d,c){return types.exn(d,c)});c["exn-message"]=new b("exn-message",1,!1,!1,function(b,d){g(b,d,types.isExn,"exn-message","exn",1,[d]);return""+types.exnMessage(d)});c["exn-continuation-marks"]=new b("exn-continuation-marks",1,!1,!1,function(b,d){g(b,d,types.isExn,"exn-continuation-marks","exn",1,[d]);return types.exnContMarks(d)});c["make-exn:fail"]=
new b("make-exn:fail",2,!1,!1,function(b,d,c){return types.exnFail(d,c)});c["make-exn:fail:contract"]=new b("make-exn:fail:contract",2,!1,!1,function(b,d,c){return types.exnFailContract(d,c)});c["make-exn:fail:contract:division-by-zero"]=new b("make-exn:fail:contract:division-by-zero",2,!1,!1,function(b,d,c){return types.exnFailContractDivisionByZero(d,c)});c["*"]=new b("*",0,!0,!1,function(b,d){P(d,function(c,t){g(b,c,M,"*","number",t+1,d)});var c=types.rational(1),i;for(i=0;i<d.length;i++)c=jsnums.multiply(d[i],
c);return c});c["-"]=new b("-",1,!0,!1,function(b,d,c){var i=[d].concat(c);g(b,d,M,"-","number",1,i);P(c,function(d,c){g(b,d,M,"-","number",c+2,i)});if(0==c.length)return jsnums.subtract(0,d);for(var e=0;e<c.length;e++)d=jsnums.subtract(d,c[e]);return d});c["+"]=new b("+",0,!0,!1,function(b,d){P(d,function(c,t){g(b,c,M,"+","number",t+1,d)});if(0==d.length)return 0;for(var c=d[0],i=1;i<d.length;i++)c=jsnums.add(c,d[i]);return c});c["="]=new b("=",2,!0,!1,function(b,d,c,i){i.unshift(c);i.unshift(d);
P(i,function(d,c){g(b,d,M,"=","number",c+1,i)});return C(i,jsnums.equals)});c["=~"]=new b("=~",3,!1,!1,function(b,d,c,i){g(b,d,F,"=~","real",1,arguments);g(b,c,F,"=~","real",2,arguments);g(b,i,E,"=~","non-negative-real",3,arguments);return jsnums.lessThanOrEqual(jsnums.abs(jsnums.subtract(d,c)),i)});c["/"]=new b("/",2,!0,!1,function(b,d,c,i){var e=[d,c].concat(i);P(e,function(d,c){g(b,d,M,"/","number",c+1,e)});var l=function(d){var c,t,i,g,e;try{t=state.captureCurrentContinuationMarks(b).ref(types.symbol("moby-application-position-key"));
i=t[t.length-1];g=i.first();i=i.rest();for(c=0;c<d;c++)i=i.rest();e=new types.Message([new types.ColoredPart("/",g),": cannot divide by ",new types.ColoredPart("zero",i.first())])}catch(l){e=new types.Message(["/: cannot divide by zero"])}y(types.incompleteExn(types.exnFailContractDivisionByZero,e,[]))};jsnums.equals(c,0)&&l(1);d=jsnums.divide(d,c);for(c=0;c<i.length;c++)jsnums.equals(i[c],0)&&l(2+c),d=jsnums.divide(d,i[c]);return d});c.sub1=new b("sub1",1,!1,!1,function(b,d){g(b,d,M,"sub1","number",
1,arguments);return jsnums.subtract(d,1)});c.add1=new b("add1",1,!1,!1,function(b,d){g(b,d,M,"add1","number",1,arguments);return jsnums.add(d,1)});c["<"]=new b("<",2,!0,!1,function(b,d,c,i){i.unshift(c);i.unshift(d);P(i,function(d,c){g(b,d,M,"<","number",c+1,i)});return C(i,jsnums.lessThan)});c[">"]=new b(">",2,!0,!1,function(b,d,c,i){i.unshift(c);i.unshift(d);P(i,function(d,c){g(b,d,M,">","number",c+1,i)});return C(i,jsnums.greaterThan)});c["<="]=new b("<=",2,!0,!1,function(b,d,c,i){i.unshift(c);
i.unshift(d);P(i,function(d,c){g(b,d,M,"<=","number",c+1,i)});return C(i,jsnums.lessThanOrEqual)});c[">="]=new b(">=",2,!0,!1,function(b,d,c,i){i.unshift(c);i.unshift(d);P(i,function(d,c){g(b,d,M,">=","number",c+1,i)});return C(i,jsnums.greaterThanOrEqual)});c.abs=new b("abs",1,!1,!1,function(b,d){g(b,d,F,"abs","real",1);return jsnums.abs(d)});c.quotient=new b("quotient",2,!1,!1,function(b,d,c){g(b,d,ra,"quotient","integer",1,arguments);g(b,c,ra,"quotient","integer",2,arguments);return jsnums.quotient(d,
c)});c.remainder=new b("remainder",2,!1,!1,function(b,d,c){g(b,d,ra,"remainder","integer",1,arguments);g(b,c,ra,"remainder","integer",2,arguments);return jsnums.remainder(d,c)});c.modulo=new b("modulo",2,!1,!1,function(b,d,c){g(b,d,ra,"modulo","integer",1,arguments);g(b,c,ra,"modulo","integer",2,arguments);return jsnums.modulo(d,c)});c.max=new b("max",1,!0,!1,function(b,d,c){c.unshift(d);P(c,function(d,i){g(b,d,F,"max","real",i+1,c)});for(var i=1;i<c.length;i++)jsnums.greaterThan(c[i],d)&&(d=c[i]);
return d});c.min=new b("min",1,!0,!1,function(b,d,c){c.unshift(d);P(c,function(d,i){g(b,d,F,"min","real",i+1,c)});for(var i=1;i<c.length;i++)jsnums.lessThan(c[i],d)&&(d=c[i]);return d});c.gcd=new b("gcd",1,!0,!1,function(b,d,c){var i=[d].concat(c);g(b,d,ra,"gcd","integer",1,i);P(c,function(d,c){g(b,d,ra,"gcd","integer",c+2,i)});return jsnums.gcd(d,c)});c.lcm=new b("lcm",1,!0,!1,function(b,d,c){var i=[d].concat(c);g(b,d,ra,"lcm","integer",1,i);P(c,function(d,c){g(b,d,ra,"lcm","integer",c+2,i)});return jsnums.lcm(d,
c)});c.floor=new b("floor",1,!1,!1,function(b,d){g(b,d,F,"floor","real",1);return jsnums.floor(d)});c.ceiling=new b("ceiling",1,!1,!1,function(b,d){g(b,d,F,"ceiling","real",1);return jsnums.ceiling(d)});c.round=new b("round",1,!1,!1,function(b,d){g(b,d,F,"round","real",1);return jsnums.round(d)});c.numerator=new b("numerator",1,!1,!1,function(b,d){g(b,d,Ka,"numerator","rational number",1);return jsnums.numerator(d)});c.denominator=new b("denominator",1,!1,!1,function(b,d){g(b,d,Ka,"denominator","rational number",
1);return jsnums.denominator(d)});c.expt=new b("expt",2,!1,!1,function(b,d,c){g(b,d,M,"expt","number",1,arguments);g(b,c,M,"expt","number",2,arguments);return jsnums.expt(d,c)});c.exp=new b("exp",1,!1,!1,function(b,d){g(b,d,M,"exp","number",1);return jsnums.exp(d)});c.log=new b("log",1,!1,!1,function(b,d){g(b,d,M,"log","number",1);return jsnums.log(d)});c.sin=new b("sin",1,!1,!1,function(b,d){g(b,d,M,"sin","number",1);return jsnums.sin(d)});c.cos=new b("cos",1,!1,!1,function(b,d){g(b,d,M,"cos","number",
1);return jsnums.cos(d)});c.tan=new b("tan",1,!1,!1,function(b,d){g(b,d,M,"tan","number",1);return jsnums.tan(d)});c.asin=new b("asin",1,!1,!1,function(b,d){g(b,d,M,"asin","number",1);return jsnums.asin(d)});c.acos=new b("acos",1,!1,!1,function(b,d){g(b,d,M,"acos","number",1);return jsnums.acos(d)});c.atan=new b("atan",1,!1,!1,function(b,d){g(b,d,M,"atan","number",1);return jsnums.atan(d)});c.sinh=new b("sinh",1,!1,!1,function(b,d){g(b,d,M,"sinh","number",1);return jsnums.sinh(d)});c.cosh=new b("cosh",
1,!1,!1,function(b,d){g(b,d,M,"cosh","number",1);return jsnums.cosh(d)});c.sqr=new b("sqr",1,!1,!1,function(b,d){g(b,d,M,"sqr","number",1);return jsnums.sqr(d)});c.sqrt=new b("sqrt",1,!1,!1,function(b,d){g(b,d,M,"sqrt","number",1);return jsnums.sqrt(d)});c["integer-sqrt"]=new b("integer-sqrt",1,!1,!1,function(b,d){g(b,d,ra,"integer-sqrt","integer",1);return jsnums.integerSqrt(d)});c["make-rectangular"]=new b("make-rectangular",2,!1,!1,function(b,d,c){g(b,d,F,"make-rectangular","real",1,arguments);
g(b,c,F,"make-rectangular","real",2,arguments);return types.complex(d,c)});c["make-polar"]=new b("make-polar",2,!1,!1,function(b,d,c){g(b,d,F,"make-polar","real",1,arguments);g(b,c,F,"make-polar","real",2,arguments);return jsnums.makeComplexPolar(d,c)});c["real-part"]=new b("real-part",1,!1,!1,function(b,d){g(b,d,M,"real-part","number",1);return jsnums.realPart(d)});c["imag-part"]=new b("imag-part",1,!1,!1,function(b,d){g(b,d,M,"imag-part","number",1);return jsnums.imaginaryPart(d)});c.angle=new b("angle",
1,!1,!1,function(b,d){g(b,d,M,"angle","number",1);return jsnums.angle(d)});c.magnitude=new b("magnitude",1,!1,!1,function(b,d){g(b,d,M,"magnitude","number",1);return jsnums.magnitude(d)});c.conjugate=new b("conjugate",1,!1,!1,function(b,d){g(b,d,M,"conjugate","number",1);return jsnums.conjugate(d)});c.sgn=new b("sgn",1,!1,!1,function(b,d){g(b,d,F,"sgn","real number",1);return jsnums.greaterThan(d,0)?1:jsnums.lessThan(d,0)?-1:0});c["inexact->exact"]=new b("inexact->exact",1,!1,!1,function(b,d){g(b,
d,M,"inexact->exact","number",1);try{return jsnums.toExact(d)}catch(c){y(types.exnFailContract("inexact->exact: no exact representation for "+types.toWrittenString(d),!1))}});c["exact->inexact"]=new b("exact->inexact",1,!1,!1,function(b,d){g(b,d,M,"exact->inexact","number",1);return jsnums.toInexact(d)});c["number->string"]=new b("number->string",1,!1,!1,function(b,d){g(b,d,M,"number->string","number",1);return types.string(d+"")});c["string->number"]=new b("string->number",1,!1,!1,function(b,d){g(b,
d,I,"string->number","string",1);return jsnums.fromString(d)});c["xml->s-exp"]=new b("xml->s-exp",1,!1,!1,function(b,d){g(b,d,I,"xml->s-exp","string",1);if(0==d.length)return types.string("");var c;try{c=new ActiveXObject("Microsoft.XMLDOM"),c.async="false",c.loadXML(s)}catch(i){c=(new DOMParser).parseFromString(s,"text/xml")}var e=function(b){for(var d=types.EMPTY,c=0;c<b.length;c++)var h=types.cons(types.symbol(b.item(c).nodeName),types.cons(b.item(c).nodeValue,types.EMPTY)),d=types.cons(h,d);return types.cons(types.symbol("@"),
d).reverse()},l=function(b){if(b.nodeType==Node.ELEMENT_NODE){for(var d=types.EMPTY,c=b.firstChild;null!=c;)var h=l(c),d=I(h)&&!d.isEmpty()&&I(d.first())?types.cons(d.first()+h,d.rest()):types.cons(h,d),c=c.nextSibling;d=d.reverse();d=types.cons(e(b.attributes),d);return d=types.cons(types.symbol(b.nodeName),d)}return b.nodeType==Node.TEXT_NODE?b.textContent:b.nodeType==Node.CDATA_SECTION_NODE?b.data:types.EMPTY};return l(c.firstChild)});c["procedure?"]=new b("procedure?",1,!1,!1,function(b,d){return u(d)});
c["pair?"]=new b("pair?",1,!1,!1,function(b,d){return B(d)});c["cons?"]=new b("cons?",1,!1,!1,function(b,d){return B(d)});c["empty?"]=new b("empty?",1,!1,!1,function(b,d){return d===types.EMPTY});c["null?"]=new b("null?",1,!1,!1,function(b,d){return d===types.EMPTY});c["undefined?"]=new b("undefined?",1,!1,!1,function(b,d){return d===types.UNDEFINED});c["void?"]=new b("void?",1,!1,!1,function(b,d){return d===types.VOID});c["symbol?"]=new b("symbol?",1,!1,!1,function(b,d){return Y(d)});c["string?"]=
new b("string?",1,!1,!1,function(b,d){return I(d)});c["char?"]=new b("char?",1,!1,!1,function(b,d){return U(d)});c["boolean?"]=new b("boolean?",1,!1,!1,function(b,d){return l(d)});c["vector?"]=new b("vector?",1,!1,!1,function(b,d){return qa(d)});c["struct?"]=new b("struct?",1,!1,!1,function(b,d){return types.isStruct(d)});c["eof-object?"]=new b("eof-object?",1,!1,!1,function(b,d){return d===types.EOF});c["posn?"]=new b("posn?",1,!1,!1,function(b,d){return types.isPosn(d)});c["bytes?"]=new b("bytes?",
1,!1,!1,function(b,d){return $(d)});c["byte?"]=new b("byte?",1,!1,!1,function(b,d){return ea(d)});c["number?"]=new b("number?",1,!1,!1,function(b,d){return M(d)});c["complex?"]=new b("complex?",1,!1,!1,function(b,d){return M(d)});c["real?"]=new b("real?",1,!1,!1,function(b,d){return F(d)});c["rational?"]=new b("rational?",1,!1,!1,function(b,d){return Ka(d)});c["integer?"]=new b("integer?",1,!1,!1,function(b,d){return ra(d)});c["exact?"]=new b("exact?",1,!1,!1,function(b,d){g(b,d,M,"exact?","number",
1);return jsnums.isExact(d)});c["inexact?"]=new b("inexact?",1,!1,!1,function(b,d){g(b,d,M,"inexact?","number",1);return jsnums.isInexact(d)});c["odd?"]=new b("odd?",1,!1,!1,function(b,d){g(b,d,ra,"odd?","integer",1);return jsnums.equals(jsnums.modulo(d,2),1)});c["even?"]=new b("even?",1,!1,!1,function(b,d){g(b,d,ra,"even?","integer",1);return jsnums.equals(jsnums.modulo(d,2),0)});c["zero?"]=new b("zero?",1,!1,!1,function(b,d){g(b,d,M,"zero?","number",1);return jsnums.equals(0,d)});c["positive?"]=
new b("positive?",1,!1,!1,function(b,d){g(b,d,F,"positive?","real",1);return jsnums.greaterThan(d,0)});c["negative?"]=new b("negative?",1,!1,!1,function(b,d){g(b,d,F,"negative?","real",1);return jsnums.lessThan(d,0)});c["box?"]=new b("box?",1,!1,!1,function(b,d){return za(d)});c["hash?"]=new b("hash?",1,!1,!1,function(b,d){return va(d)});c["eq?"]=new b("eq?",2,!1,!1,function(b,d,c){return d===c});c["eqv?"]=new b("eqv?",2,!1,!1,function(b,d,c){return ba(d,c)});c["equal?"]=new b("equal?",2,!1,!1,function(b,
d,c){return ua(d,c)});c["equal~?"]=new b("equal~?",3,!1,!1,function(b,d,c,i){g(b,i,E,"equal~?","non-negative number",3,arguments);return ua(d,c)||F(d)&&F(c)&&jsnums.lessThanOrEqual(jsnums.abs(jsnums.subtract(d,c)),i)});c["false?"]=new b("false?",1,!1,!1,function(b,d){return!1===d});c["boolean=?"]=new b("boolean=?",2,!1,!1,function(b,d,c){g(b,d,l,"boolean=?","boolean",1,arguments);g(b,c,l,"boolean=?","boolean",2,arguments);return d===c});c["symbol=?"]=new b("symbol=?",2,!1,!1,function(b,d,c){g(b,d,
Y,"symbol=?","symbol",1,arguments);g(b,c,Y,"symbol=?","symbol",2,arguments);return ua(d,c)});c["js-object?"]=new b("js-object?",1,!1,!1,function(b,d){return Ba(d)});c.cons=new b("cons",2,!1,!1,function(b,d,c){return types.cons(d,c)});c.car=new b("car",1,!1,!1,function(b,d){g(b,d,B,"car","pair",1);return d.first()});c.cdr=new b("cdr",1,!1,!1,function(b,d){g(b,d,B,"cdr","pair",1);return d.rest()});c.caar=new b("caar",1,!1,!1,function(b,d){g(b,d,function(b){return B(b)&&B(b.first())},"caar","caarable value",
1);return d.first().first()});c.cadr=new b("cadr",1,!1,!1,function(b,d){g(b,d,function(b){return B(b)&&B(b.rest())},"cadr","cadrable value",1);return d.rest().first()});c.cdar=new b("cdar",1,!1,!1,function(b,d){g(b,d,function(b){return B(b)&&B(b.first())},"cdar","cdarable value",1);return d.first().rest()});c.cddr=new b("cddr",1,!1,!1,function(b,d){g(b,d,function(b){return B(b)&&B(b.rest())},"cddr","cddrable value",1);return d.rest().rest()});c.caaar=new b("caaar",1,!1,!1,function(b,d){g(b,d,function(b){return B(b)&&
B(b.first())&&B(b.first().first())},"caaar","caaarable value",1);return d.first().first().first()});c.caadr=new b("caadr",1,!1,!1,function(b,d){g(b,d,function(b){return B(b)&&B(b.rest())&&B(b.rest().first())},"caadr","caadrable value",1);return d.rest().first().first()});c.cadar=new b("cadar",1,!1,!1,function(b,d){g(b,d,function(b){return B(b)&&B(b.first())&&B(b.first().rest())},"cadar","cadarable value",1);return d.first().rest().first()});c.cdaar=new b("cdaar",1,!1,!1,function(b,d){g(b,d,function(b){return B(b)&&
B(b.first())&&B(b.first().first())},"cdaar","cdaarable value",1);return d.first().first().rest()});c.cdadr=new b("cdadr",1,!1,!1,function(b,d){g(b,d,function(b){return B(b)&&B(b.rest())&&B(b.rest().first())},"cdadr","cdadrable value",1);return d.rest().first().rest()});c.cddar=new b("cddar",1,!1,!1,function(b,d){g(b,d,function(b){return B(b)&&B(b.first())&&B(b.first().rest())},"cddar","cddarable value",1);return d.first().rest().rest()});c.caddr=new b("caddr",1,!1,!1,function(b,d){g(b,d,function(b){return B(b)&&
B(b.rest())&&B(b.rest().rest())},"caddr","caddrable value",1);return d.rest().rest().first()});c.cdddr=new b("cdddr",1,!1,!1,function(b,d){g(b,d,function(b){return B(b)&&B(b.rest())&&B(b.rest().rest())},"cdddr","cdddrable value",1);return d.rest().rest().rest()});c.cadddr=new b("cadddr",1,!1,!1,function(b,d){g(b,d,function(b){return B(b)&&B(b.rest())&&B(b.rest().rest())&&B(b.rest().rest().rest())},"cadddr","cadddrable value",1);return d.rest().rest().rest().first()});c.rest=new b("rest",1,!1,!1,function(b,
d){g(b,d,function(b){return xa(b)&&b!==types.EMPTY},"rest","non-empty list",1);return d.rest()});c.first=new b("first",1,!1,!1,function(b,d){g(b,d,function(b){return xa(b)&&b!==types.EMPTY},"first","non-empty list",1);return d.first()});c.second=new b("second",1,!1,!1,function(b,d){Ta(b,d,2,"second",1);return d.rest().first()});c.third=new b("third",1,!1,!1,function(b,d){Ta(b,d,3,"third",1);return d.rest().rest().first()});c.fourth=new b("fourth",1,!1,!1,function(b,d){Ta(b,d,4,"fourth",1);return d.rest().rest().rest().first()});
c.fifth=new b("fifth",1,!1,!1,function(b,d){Ta(b,d,5,"fifth",1);return d.rest().rest().rest().rest().first()});c.sixth=new b("sixth",1,!1,!1,function(b,d){Ta(b,d,6,"sixth",1);return d.rest().rest().rest().rest().rest().first()});c.seventh=new b("seventh",1,!1,!1,function(b,d){Ta(b,d,7,"seventh",1);return d.rest().rest().rest().rest().rest().rest().first()});c.eighth=new b("eighth",1,!1,!1,function(b,d){Ta(b,d,8,"eighth",1);return d.rest().rest().rest().rest().rest().rest().rest().first()});c.length=
new b("length",1,!1,!1,function(b,d){ga(b,d,"length",1,arguments);return jsnums.makeRational(aa(d))});c["list?"]=new b("list?",1,!1,!1,function(b,d){return xa(d)});c.list=new b("list",0,!0,!1,function(b,d){return types.list(d)});c["list*"]=new b("list*",1,!0,!1,function(b,d,c){var i=[d].concat(c);if(0==c.length)return d;var g=c.pop();ga(b,g,"list*",c.length+2,i);c.unshift(d);return T(b,[types.list(c),g])});c["list-ref"]=new b("list-ref",2,!1,!1,function(b,d,c){ga(b,d,"list-ref",1,arguments);g(b,c,
Q,"list-ref","non-negative exact integer",2,arguments);for(var i=state.captureCurrentContinuationMarks(b).ref(types.symbol("moby-application-position-key")),i=i[i.length-1],e=d,l=jsnums.toFixnum(c),j=0;j<l;j++)(e.isEmpty()||e.rest().isEmpty())&&y(types.incompleteExn(types.exnFailContract,new types.Message([new types.ColoredPart("list-ref",i.first()),": index ",new types.ColoredPart(l,i.rest().rest().first())," is too large for list: ",new types.ColoredPart(types.toWrittenString(d),i.rest().first())]),
[])),e=e.rest();return e.first()});c["list-tail"]=new b("list-tail",2,!1,!1,function(b,d,c){ga(b,d,"list-tail",1,arguments);g(b,x,Q,"list-tail","non-negative exact integer",2,arguments);for(var d=origList,i=jsnums.toFixnum(c),e=0;e<i;e++){if(d.isEmpty()){var l="list-tail: index "+i+" is too large for list: "+types.toWrittenString(origList);y(types.incompleteExn(types.exnFailContract,l,[]))}d=d.rest()}return d});c.append=new b("append",0,!0,!1,function(b,d){return T(b,d)});c.reverse=new b("reverse",
1,!1,!1,function(b,d){ga(b,d,"reverse",1);return d.reverse()});c.map=new b("map",2,!0,!1,function(b,d,c,i){var e=[d,c].concat(i);i.unshift(c);g(b,d,u,"map","function name",1,e);P(i,function(d,c){ga(b,d,"map",c+2,e)});Ra(b,i,"map",e);var l=function(b,d,c){if(d[0].isEmpty())return c.reverse();for(var h=[],i=[],g=0;g<d.length;g++)h.push(d[g].first()),i.push(d[g].rest());return m(b,h,function(d){return l(b,i,types.cons(d,c))})};return l(d,i,types.EMPTY)});c.andmap=new b("andmap",2,!0,!1,function(b,d,
c,i){var e=[d,c].concat(i);i.unshift(c);g(b,d,u,"andmap","function name",1,e);P(i,function(d,c){ga(b,d,"andmap",c+2,e)});Ra(b,i,"andmap",e);var l=function(b,d){if(d[0].isEmpty())return!0;for(var c=[],h=[],i=0;i<d.length;i++)c.push(d[i].first()),h.push(d[i].rest());return m(b,c,function(d){return d&&l(b,h)})};return l(d,i)});c.ormap=new b("ormap",2,!0,!1,function(b,d,c,i){var e=[d,c].concat(i);i.unshift(c);g(b,d,u,"ormap","function name",1,e);P(i,function(d,c){ga(b,d,"ormap",c+2,e)});Ra(b,i,"ormap",
e);var l=function(b,d){if(d[0].isEmpty())return!1;for(var c=[],h=[],i=0;i<d.length;i++)c.push(d[i].first()),h.push(d[i].rest());return m(b,c,function(d){return d||l(b,h)})};return l(d,i)});c.memq=new b("memq",2,!1,!1,function(b,d,c){for(ga(b,c,"memq",2,arguments);!c.isEmpty();){var i=c.first();if(d===i)return c;c=c.rest()}return!1});c.memv=new b("memv",2,!1,!1,function(b,d,c){for(ga(b,c,"memv",2,arguments);!c.isEmpty();){if(ba(d,c.first()))return c;c=c.rest()}return!1});c.member=new b("member",2,
!1,!1,function(b,d,c){for(ga(b,c,"member",2,arguments);!c.isEmpty();){if(ua(d,c.first()))return c;c=c.rest()}return!1});c["member?"]=new b("member?",2,!1,!1,function(b,d,c){for(ga(b,c,"member?",2,arguments);!c.isEmpty();){if(ua(d,c.first()))return!0;c=c.rest()}return!1});c.memf=new b("memf",2,!1,!0,function(b,d,c){g(b,d,u,"memf","function name",1,arguments);ga(b,c,"memf",2,arguments);var i=function(b){return b.isEmpty()?!1:m(d,[b.first()],function(d){return d?b:i(b.rest())})};return i(c)});c.assq=
new b("assq",2,!1,!1,function(b,d,c){for(Aa(b,c,B,"assq","pair",2,arguments);!c.isEmpty();){var i=c.first().first();if(d===i)return c.first();c=c.rest()}return!1});c.assv=new b("assv",2,!1,!1,function(b,d,c){for(Aa(b,c,B,"assv","pair",2,arguments);!c.isEmpty();){if(ba(d,c.first().first()))return c.first();c=c.rest()}return!1});c.assoc=new b("assoc",2,!1,!1,function(b,d,c){for(Aa(b,c,B,"assoc","pair",2,arguments);!c.isEmpty();){if(ua(d,c.first().first()))return c.first();c=c.rest()}return!1});c.remove=
new b("remove",2,!1,!1,function(b,d,c){ga(b,c,"remove",2,arguments);for(var i=c,g=types.EMPTY;!c.isEmpty();){if(ua(d,c.first()))return T(b,[g.reverse(),c.rest()]);g=types.cons(c.first(),g);c=c.rest()}return i});c.filter=new b("filter",2,!1,!1,function(b,d,c){g(b,d,A(1),"filter","function name (arity 1)",1,arguments);ga(b,c,"filter",2);var i=function(b,d,c){return d.isEmpty()?c.reverse():m(b,[d.first()],function(h){return h?i(b,d.rest(),types.cons(d.first(),c)):i(b,d.rest(),c)})};return i(d,c,types.EMPTY)});
c.foldl=new b("foldl",3,!0,!1,function(b,d,c,i,e){e.unshift(i);var l=[d,c].concat(e);g(b,d,u,"foldl","function name",1,l);P(e,function(d,c){ga(b,d,"foldl",c+3,l)});Ra(b,e,"foldl",l);return sa(d,c,e)});c.foldr=new b("foldr",3,!0,!1,function(b,d,c,i,e){e.unshift(i);var l=[d,c].concat(e);g(b,d,u,"foldr","function name",1,l);P(e,function(d,c){ga(b,d,"foldr",c+3,l)});Ra(b,e,"foldr",l);for(i=0;i<e.length;i++)e[i]=e[i].reverse();return sa(d,c,e)});c.quicksort=new b("quicksort",2,!1,!1,W("quicksort"));c.sort=
new b("sort",2,!1,!1,W("sort"));c.argmax=new b("argmax",2,!1,!1,function(b,d,c){var i=arguments;g(b,d,u,"argmax","function name",1,i);g(b,c,B,"argmax","non-empty list",2,i);var e=function(c,t,l){return c.isEmpty()?l:m(d,[c.first()],function(d){g(b,d,F,"argmax","procedure that returns real numbers",1,i);return jsnums.greaterThan(d,t)?e(c.rest(),d,c.first()):e(c.rest(),t,l)})};return m(d,[c.first()],function(d){g(b,d,F,"argmax","procedure that returns real numbers",1,i);return e(c.rest(),d,c.first())})});
c.argmin=new b("argmin",2,!1,!1,function(b,d,c){var i=arguments;g(b,d,u,"argmin","function name",1,i);g(b,c,B,"argmin","non-empty list",2,i);var e=function(c,t,l){return c.isEmpty()?l:m(d,[c.first()],function(d){g(b,d,F,"argmin","procedure that returns real numbers",1,i);return jsnums.lessThan(d,t)?e(c.rest(),d,c.first()):e(c.rest(),t,l)})};return m(d,[c.first()],function(d){g(b,d,F,"argmin","procedure that returns real numbers",1,i);return e(c.rest(),d,c.first())})});c["build-list"]=new b("build-list",
2,!1,!1,function(b,d,c){g(b,d,Q,"build-list","non-negative exact integer",1,arguments);g(b,c,u,"build-list","function name",2,arguments);var i=function(b,h){return jsnums.greaterThanOrEqual(b,d)?h.reverse():m(c,[b],function(d){return i(b+1,types.cons(d,h))})};return i(0,types.EMPTY)});c.box=new b("box",1,!1,!1,function(b,d){return types.box(d)});c["box-immutable"]=new b("box-immutable",1,!1,!1,function(b,d){return types.boxImmutable(d)});c.unbox=new b("unbox",1,!1,!1,function(b,d){g(b,d,za,"unbox",
"box",1);return d.unbox()});c["set-box!"]=new b("set-box!",2,!1,!1,function(b,d,c){g(b,d,function(b){return za(b)&&b.mutable},"set-box!","mutable box",1,arguments);d.set(c);return types.VOID});c["make-hash"]=new e("make-hash",[new b("make-hash",0,!1,!1,function(){return types.hash(types.EMPTY)}),new b("make-hash",1,!1,!1,function(b,d){Aa(b,d,B,"make-hash","list of pairs",1);return types.hash(d)})]);c["make-hasheq"]=new e("make-hasheq",[new b("make-hasheq",0,!1,!1,function(){return types.hashEq(types.EMPTY)}),
new b("make-hasheq",1,!1,!1,function(b,d){Aa(b,d,B,"make-hasheq","list of pairs",1);return types.hashEq(d)})]);c["hash-set!"]=new b("hash-set!",3,!1,!1,function(b,d,c,i){g(b,d,va,"hash-set!","hash",1,arguments);d.hash.put(c,i);return types.VOID});c["hash-ref"]=new e("hash-ref",[new b("hash-ref",2,!1,!1,function(b,d,c){g(b,d,va,"hash-ref","hash",1,arguments);if(!d.hash.containsKey(c)){var i=state.captureCurrentContinuationMarks(b).ref(types.symbol("moby-application-position-key")),i=i[i.length-1];
y(types.incompleteExn(types.exnFailContract,new types.Message([new types.ColoredPart("hash-ref",i.first()),": no value found for key ",new types.ColoredPart(types.toWrittenString(c),i.rest().rest().first())]),[]))}return d.hash.get(c)}),new b("hash-ref",3,!1,!1,function(b,d,c,i){g(b,d,va,"hash-ref","hash",1,arguments);return d.hash.containsKey(c)?d.hash.get(c):u(i)?m(i,[],o):i})]);c["hash-remove!"]=new b("hash-remove",2,!1,!1,function(b,d,c){g(b,d,va,"hash-remove!","hash",1,arguments);d.hash.remove(c);
return types.VOID});c["hash-map"]=new b("hash-map",2,!1,!1,function(b,d,c){g(b,d,va,"hash-map","hash",1,arguments);g(b,c,u,"hash-map","function name",2,arguments);var i=d.hash.keys(),e=function(b,h){if(b>=i.length)return h;var g=d.hash.get(i[b]);return m(c,[i[b],g],function(d){return e(b+1,types.cons(d,h))})};return e(0,types.EMPTY)});c["hash-for-each"]=new b("hash-for-each",2,!1,!1,function(b,d,c){g(b,d,va,"hash-for-each","hash",1,arguments);g(b,c,u,"hash-for-each","function name",2,arguments);var i=
d.hash.keys(),e=function(b){if(b>=i.length)return types.VOID;var h=d.hash.get(i[b]);return m(c,[i[b],h],function(){return e(b+1)})};return e(0)});c["make-string"]=new b("make-string",2,!1,!1,function(b,d,c){g(b,d,Q,"make-string","non-negative exact integer",1,arguments);g(b,c,U,"make-string","character",2,arguments);for(var i=[],e=0;jsnums.lessThan(e,d);e++)i.push(c.val);return types.string(i)});c.replicate=new b("replicate",2,!1,!1,function(b,d,c){g(b,d,Q,"replicate","non-negative exact integer",
1,arguments);g(b,c,I,"replicate","string",2,arguments);for(var i="",e=c.toString(),l=0;jsnums.lessThan(l,d);l++)i+=e;return types.string(i)});c.string=new b("string",0,!0,!1,function(b,d){P(d,function(c,i){g(b,c,U,"string","character",i+1,d)});for(var c=[],i=0;i<d.length;i++)c.push(d[i].val);return types.string(c)});c["string-length"]=new b("string-length",1,!1,!1,function(b,d){g(b,d,I,"string-length","string",1);return d.length});c["string-ref"]=new b("string-ref",2,!1,!1,function(b,d,c){g(b,d,I,
"string-ref","string",1,arguments);g(b,c,Q,"string-ref","non-negative exact integer",2,arguments);var i=jsnums.toFixnum(c);if(i>=d.length){types.toWrittenString(d);var e=state.captureCurrentContinuationMarks(b).ref(types.symbol("moby-application-position-key")),e=e[e.length-1];y(types.incompleteExn(types.exnFailContract,new types.Message([new types.ColoredPart("string-ref",e.first()),": index ",i," out of range [0, ",d.length-1,"] for string: ",new types.ColoredPart(types.toWrittenString(d),e.rest().first())]),
[]))}return types["char"](d.charAt(i))});c["string=?"]=new b("string=?",2,!0,!1,function(b,d,c,i){i.unshift(c);i.unshift(d);P(i,function(d,c){g(b,d,I,"string=?","string",c+1,i)});return C(i,function(b,d){return b.toString()===d.toString()})});c["string-ci=?"]=new b("string-ci=?",2,!0,!1,function(b,d,c,i){i.unshift(c);i.unshift(d);for(d=0;d<i.length;d++)g(b,i[d],I,"string-ci=?","string",d+1,i),i[d]=i[d].toString().toLowerCase();return C(i,function(b,d){return b===d})});c["string<?"]=new b("string<?",
2,!0,!1,function(b,d,c,i){i.unshift(c);i.unshift(d);P(i,function(d,c){g(b,d,I,"string<?","string",c+1,i)});return C(i,function(b,d){return b.toString()<d.toString()})});c["string>?"]=new b("string>?",2,!0,!1,function(b,d,c,i){i.unshift(c);i.unshift(d);P(i,function(d,c){g(b,d,I,"string>?","string",c+1,i)});return C(i,function(b,d){return b.toString()>d.toString()})});c["string<=?"]=new b("string<=?",2,!0,!1,function(b,d,c,i){i.unshift(c);i.unshift(d);P(i,function(d,c){g(b,d,I,"string<=?","string",
c+1,i)});return C(i,function(b,d){return b.toString()<=d.toString()})});c["string>=?"]=new b("string>=?",2,!0,!1,function(b,d,c,i){i.unshift(c);i.unshift(d);P(i,function(d,c){g(b,d,I,"string>=?","string",c+1,i)});return C(i,function(b,d){return b.toString()>=d.toString()})});c["string-ci<?"]=new b("string-ci<?",2,!0,!1,function(b,d,c,i){i.unshift(c);i.unshift(d);for(d=0;d<i.length;d++)g(b,i[d],I,"string-ci<?","string",d+1,i),i[d]=i[d].toString().toLowerCase();return C(i,function(b,d){return b<d})});
c["string-ci>?"]=new b("string-ci>?",2,!0,!1,function(b,d,c,i){i.unshift(c);i.unshift(d);for(d=0;d<i.length;d++)g(b,i[d],I,"string-ci>?","string",d+1,i),i[d]=i[d].toString().toLowerCase();return C(i,function(b,d){return b>d})});c["string-ci<=?"]=new b("string-ci<=?",2,!0,!1,function(b,d,c,i){i.unshift(c);i.unshift(d);for(d=0;d<i.length;d++)g(b,i[d],I,"string-ci<=?","string",d+1,i),i[d]=i[d].toString().toLowerCase();return C(i,function(b,d){return b<=d})});c["string-ci>=?"]=new b("string-ci>=?",2,
!0,!1,function(b,d,c,i){i.unshift(c);i.unshift(d);for(d=0;d<i.length;d++)g(b,i[d],I,"string-ci>=?","string",d+1,i),i[d]=i[d].toString().toLowerCase();return C(i,function(b,d){return b>=d})});c.substring=new e("substring",[new b("substring",2,!1,!1,function(b,d,c){g(b,d,I,"substring","string",1,arguments);g(b,c,Q,"substring","non-negative exact integer",2,arguments);var i=state.captureCurrentContinuationMarks(b).ref(types.symbol("moby-application-position-key")),i=i[i.length-1],e=jsnums.toFixnum(c);
if(e>d.length)y(types.incompleteExn(types.exnFailContract,new types.Message([new types.ColoredPart("substring",i.first()),": starting index ",new types.ColoredPart(e,i.rest().rest().first())," out of range ","[0, ",d.length,"] for string: ",new types.ColoredPart(types.toWrittenString(d),i.rest().first())]),[]));else return types.string(d.substring(jsnums.toFixnum(e)))}),new b("substring",3,!1,!1,function(b,d,c,i){g(b,d,I,"substring","string",1,arguments);g(b,c,Q,"substring","non-negative exact integer",
2,arguments);g(b,i,Q,"substring","non-negative exact integer",3,arguments);var e=state.captureCurrentContinuationMarks(b).ref(types.symbol("moby-application-position-key")),e=e[e.length-1],l=jsnums.toFixnum(c),j=jsnums.toFixnum(i);l>d.length&&y(types.incompleteExn(types.exnFailContract,new types.Message([new types.ColoredPart("substring",e.first()),": starting index ",new types.ColoredPart(l,e.rest().rest().first())," out of range ","[0, ",d.length,"] for string: ",new types.ColoredPart(types.toWrittenString(d),
e.rest().first())]),[]));(j<l||j>d.length)&&y(types.incompleteExn(types.exnFailContract,new types.Message([new types.ColoredPart("substring",e.first()),": ending index ",new types.ColoredPart(j,e.rest().rest().rest().first())," out of range ","[0, ",d.length,"] for string: ",new types.ColoredPart(types.toWrittenString(d),e.rest().first())]),[]));return types.string(d.substring(l,j))})]);c["string-append"]=new b("string-append",0,!0,!1,function(b,d){P(d,function(c,e){g(b,c,I,"string-append","string",
e+1,d)});for(var c=0;c<d.length;c++)d[c]=d[c].toString();return types.string(d.join(""))});c["string->list"]=new b("string->list",1,!1,!1,function(b,d){g(b,d,I,"string->list","string",1);for(var c=types.EMPTY,i=d.length-1;0<=i;i--)c=types.cons(types["char"](d.charAt(i)),c);return c});c["list->string"]=new b("list->string",1,!1,!1,function(b,d){Aa(b,d,U,"list->string","character",1);for(var c=[];!d.isEmpty();)c.push(d.first().val),d=d.rest();return types.string(c)});c["string-copy"]=new b("string-copy",
1,!1,!1,function(b,d){g(b,d,I,"string-copy","string",1);return types.string(d.toString())});c["string->symbol"]=new b("string->symbol",1,!1,!1,function(b,d){g(b,d,I,"string->symbol","string",1);return types.symbol(d.toString())});c["symbol->string"]=new b("symbol->string",1,!1,!1,function(b,d){g(b,d,Y,"symbol->string","symbol",1);return types.string(d.toString())});c.format=new b("format",1,!0,!1,function(b,d,c){g(b,d,I,"format","string",1,[d].concat(c));return types.string(helpers.format(d,c,"format"))});
c.printf=new b("printf",1,!0,!1,function(b,d,c){g(b,d,I,"printf","string",1,[d].concat(c));d=helpers.format(d,c,"printf");b.getDisplayHook()(d);return types.VOID});c["string->int"]=new b("string->int",1,!1,!1,function(b,d){g(b,d,function(b){return I(b)&&1==b.length},"string->int","1-letter string",1);return d.charCodeAt(0)});c["int->string"]=new b("int->string",1,!1,!1,function(b,d){g(b,d,function(b){if(!ra(b))return!1;b=jsnums.toFixnum(b);return 0<=b&&55296>b||57343<b&&1114111>=b},"int->string",
"exact integer in [0,55295] or [57344,1114111]",1);return types.string(String.fromCharCode(jsnums.toFixnum(d)))});c.explode=new b("explode",1,!1,!1,function(b,d){g(b,d,I,"explode","string",1);for(var c=types.EMPTY,i=d.length-1;0<=i;i--)c=types.cons(types.string(d.charAt(i)),c);return c});c.implode=new b("implode",1,!1,!1,function(b,d){Aa(b,d,function(b){return I(b)&&1==b.length},"implode","1-letter strings",1);for(var c=[];!d.isEmpty();)c.push(d.first().toString()),d=d.rest();return types.string(c)});
c["string-alphabetic?"]=new b("string-alphabetic?",1,!1,!1,function(b,d){g(b,d,I,"string-alphabetic?","string",1);return ca(d)});c["string-ith"]=new b("string-ith",2,!1,!1,function(b,d,c){g(b,d,I,"string-ith","string",1,arguments);g(b,c,function(b){return Q(b)&&jsnums.lessThan(b,d.length)},"string-ith","exact integer in [0, length of the given string minus 1 ("+(d.length-1)+")]",2,arguments);return types.string(d.charAt(jsnums.toFixnum(c)))});c["string-lower-case?"]=new b("string-lower-case?",1,!1,
!1,function(b,d){g(b,d,I,"string-lower-case?","string",1);var c=d.toString();return ca(d)&&c.toLowerCase()===c});c["string-numeric?"]=new b("string-numeric?",1,!1,!1,function(b,d){g(b,d,I,"string-numeric?","string",1);var c;a:{for(c=0;c<d.length;c++)if(!("0"<=d.charAt(c)&&"9">=d.charAt(c))){c=!1;break a}c=!0}return c});c["string-upper-case?"]=new b("string-upper-case?",1,!1,!1,function(b,d){g(b,d,I,"string-upper-case?","string",1);var c=d.toString();return ca(d)&&c.toUpperCase()===c});c["string-whitespace?"]=
new b("string-whitespace?",1,!1,!1,function(b,d){g(b,d,I,"string-whitespace?","string",1);return X(d)});c["build-string"]=new b("build-string",2,!1,!1,function(b,d,c){g(b,d,Q,"build-string","non-negative exact integer",1,arguments);g(b,c,u,"build-string","function name",2,arguments);var i=function(e,l){return jsnums.greaterThanOrEqual(e,d)?types.string(l):m(c,[e],function(d){g(b,d,U,"build-string","procedure that returns a char",2);return i(e+1,l.push(d.val))})};return i(0,[])});c["string->immutable-string"]=
new b("string->immutable-string",1,!1,!1,function(b,d){g(b,d,I,"string->immutable-string","string",1);return d.toString()});c["string-set!"]=new b("string-set!",3,!1,!1,function(b,d,c,i){g(b,d,function(b){return I(b)&&"string"!=typeof b},"string-set!","mutable string",1,arguments);g(b,c,Q,"string-set!","non-negative exact integer",2,arguments);g(b,i,U,"string-set!","character",3,arguments);if(jsnums.greaterThanOrEqual(c,d.length)){var e="string-set!: index "+n+" out of range [0, "+(d.length-1)+"] for string: "+
types.toWrittenString(d);y(types.incompleteExn(types.exnFailContract,e,[]))}d.set(jsnums.toFixnum(c),i.val);return types.VOID});c["string-fill!"]=new b("string-fill!",2,!1,!1,function(b,d,c){g(b,d,function(b){return I(b)&&"string"!=typeof b},"string-fill!","mutable string",1,arguments);g(b,c,U,"string-fill!","character",2,arguments);for(var i=0;i<d.length;i++)d.set(i,c.val);return types.VOID});c["make-bytes"]=new e("make-bytes",[new b("make-bytes",1,!1,!1,function(b,d){g(b,d,Q,"make-bytes","non-negative exact integer",
1);for(var c=[],i=0;i<jsnums.toFixnum(d);i++)c.push(0);return types.bytes(c,!0)}),new b("make-bytes",2,!1,!1,function(b,d,c){g(b,d,Q,"make-bytes","non-negative exact integer",1,arguments);g(b,c,ea,"make-bytes","byte",2,arguments);for(var i=[],e=0;e<jsnums.toFixnum(d);e++)i.push(c);return types.bytes(i,!0)})]);c.bytes=new b("bytes",0,!0,!1,function(b,d){P(d,function(c,i){g(b,c,ea,"bytes","byte",i+1,d)});return types.bytes(d,!0)});c["bytes->immutable-bytes"]=new b("bytes->immutable-bytes",1,!1,!1,function(b,
d){g(b,d,$,"bytes->immutable-bytes","byte string",1);return d.mutable?d.copy(!1):d});c["bytes-length"]=new b("bytes-length",1,!1,!1,function(b,d){g(b,d,$,"bytes-length","byte string",1);return d.length()});c["bytes-ref"]=new b("bytes-ref",2,!1,!1,function(b,d,c){g(b,d,$,"bytes-ref","byte string",1,arguments);g(b,c,Q,"bytes-ref","non-negative exact integer",2,arguments);var i=jsnums.toFixnum(c);if(i>=d.length()){var e="bytes-ref: index "+i+" out of range [0, "+(d.length-1)+"] for byte-string: "+types.toWrittenString(d);
y(types.incompleteExn(types.exnFailContract,e,[]))}return d.get(i)});c["bytes-set!"]=new b("bytes-set!",3,!1,!1,function(b,d,c,i){g(b,d,function(b){return $(b)&&b.mutable},"bytes-set!","mutable byte string",1,arguments);g(b,c,Q,"bytes-set!","non-negative exact integer",2,arguments);g(b,i,ea,"bytes-set!","byte",3,arguments);var e=jsnums.toFixnum(c);if(e>=d.length()){var l="bytes-set!: index "+e+" out of range [0, "+(d.length-1)+"] for byte-string: "+types.toWrittenString(d);y(types.incompleteExn(types.exnFailContract,
l,[]))}d.set(e,i);return types.VOID});c.subbytes=new e("subbytes",[new b("subbytes",2,!1,!1,function(b,d,c){g(b,d,$,"subbytes","bytes string",1,arguments);g(b,c,Q,"subbytes","non-negative exact integer",2,arguments);var i=jsnums.toFixnum(c);if(i>d.length())i="subbytes: starting index "+i+" out of range [0, "+d.length+"] for byte-string: "+types.toWrittenString(d),y(types.incompleteExn(types.exnFailContract,i,[]));else return d.subbytes(jsnums.toFixnum(i))}),new b("subbytes",3,!1,!1,function(b,d,c,
i){g(b,d,$,"subbytes","byte string",1,arguments);g(b,c,Q,"subbytes","non-negative exact integer",2,arguments);g(b,i,Q,"subbytes","non-negative exact integer",3,arguments);var e=jsnums.toFixnum(c),l=jsnums.toFixnum(i);if(e>d.length()){var j="subbytes: starting index "+e+" out of range [0, "+d.length()+"] for byte-string: "+types.toWrittenString(d);y(types.incompleteExn(types.exnFailContract,j,[]))}if(l<e||l>d.length())j="subbytes: ending index "+l+" out of range ["+e+", "+d.length()+"] for byte-string: "+
types.toWrittenString(d),y(types.incompleteExn(types.exnFailContract,j,[]));else return d.subbytes(e,l)})]);c["bytes-copy"]=new b("bytes-copy",1,!1,!1,function(b,d){g(b,d,$,"bytes-copy","byte string",1);return d.copy(!0)});c["bytes-fill!"]=new b("bytes-fill!",2,!1,!1,function(b,d,c){g(b,d,function(b){return $(b)&&b.mutable},"bytes-fill!","mutable byte string",1,arguments);g(b,c,ea,"bytes-fill!","byte",2,arguments);for(var i=0;i<d.length();i++)d.set(i,c);return types.VOID});c["bytes-append"]=new b("bytes-append",
0,!0,!1,function(b,d){P(d,function(c,i){g(b,c,$,"bytes-append","byte string",i+1,d)});for(var c=[],i=0;i<d.length;i++)c=c.concat(d[i].bytes);return types.bytes(c,!0)});c["bytes->list"]=new b("bytes->list",1,!1,!1,function(b,d){g(b,d,$,"bytes->list","byte string",1);for(var c=types.EMPTY,i=d.length()-1;0<=i;i--)c=types.cons(d.get(i),c);return c});c["list->bytes"]=new b("list->bytes",1,!1,!1,function(b,d){Aa(b,d,ea,"list->bytes","byte",1);for(var c=[];!d.isEmpty();)c.push(d.first()),d=d.rest();return types.bytes(c,
!0)});c["bytes=?"]=new b("bytes=?",2,!0,!1,function(b,d,c,i){i.unshift(c);i.unshift(d);P(i,function(d,c){g(b,d,$,"bytes=?","byte string",c+1,i)});return C(i,function(b,d){return b.toString()===d.toString()})});c["bytes<?"]=new b("bytes<?",2,!0,!1,function(b,d,c,i){i.unshift(c);i.unshift(d);P(i,function(d,c){g(b,d,$,"bytes<?","byte string",c+1,i)});return C(i,function(b,d){return b.toString()<d.toString()})});c["bytes>?"]=new b("bytes>?",2,!0,!1,function(b,d,c,i){i.unshift(c);i.unshift(d);P(i,function(d,
c){g(b,d,$,"bytes>?","byte string",c+1,i)});return C(i,function(b,d){return b.toString()>d.toString()})});c["make-vector"]=new b("make-vector",2,!1,!1,function(b,d,c){g(b,d,Q,"make-vector","non-negative exact integer",1,arguments);for(var i=jsnums.toFixnum(d),e=[],l=0;l<i;l++)e.push(c);return types.vector(e)});c.vector=new b("vector",0,!0,!1,function(b,d){return types.vector(d)});c["vector-length"]=new b("vector-length",1,!1,!1,function(b,d){g(b,d,qa,"vector-length","vector",1);return d.length()});
c["vector-ref"]=new b("vector-ref",2,!1,!1,function(b,d,c){g(b,d,qa,"vector-ref","vector",1,arguments);g(b,c,Q,"vector-ref","non-negative exact integer",2,arguments);var i=jsnums.toFixnum(c);if(i>=d.length()){var e="vector-ref: index "+i+" out of range [0, "+(d.length()-1)+"] for vector: "+types.toWrittenString(d);y(types.incompleteExn(types.exnFailContract,e,[]))}return d.ref(i)});c["vector-set!"]=new b("vector-set!",3,!1,!1,function(b,d,c,i){g(b,d,qa,"vector-set!","vector",1,arguments);g(b,c,Q,
"vector-set!","non-negative exact integer",2,arguments);var e=jsnums.toFixnum(c);if(e>=d.length()){var l="vector-set!: index "+e+" out of range [0, "+(d.length()-1)+"] for vector: "+types.toWrittenString(d);y(types.incompleteExn(types.exnFailContract,l,[]))}d.set(e,i);return types.VOID});c["vector->list"]=new b("vector->list",1,!1,!1,function(b,d){g(b,d,qa,"vector->list","vector",1);return d.toList()});c["list->vector"]=new b("list->vector",1,!1,!1,function(b,d){ga(b,d,"list->vector",1);return types.vector(helpers.schemeListToArray(d))});
c["build-vector"]=new b("build-vector",2,!1,!1,function(b,d,c){g(b,d,Q,"build-vector","non-negative exact integer",1,arguments);g(b,c,u,"build-vector","function name",2,arguments);var i=function(b,h){return jsnums.greaterThanOrEqual(b,d)?types.vector(h):m(c,[b],function(d){return i(b+1,h.push(d))})};return i(0,[])});c["char=?"]=new b("char=?",2,!0,!1,function(b,d,c,i){i.unshift(c);i.unshift(d);P(i,function(d,c){g(b,d,U,"char=?","character",c+1,i)});return C(i,function(b,d){return b.val===d.val})});
c["char<?"]=new b("char<?",2,!0,!1,function(b,d,c,i){i.unshift(c);i.unshift(d);P(i,function(d,c){g(b,d,U,"char<?","character",c+1,i)});return C(i,function(b,d){return b.val<d.val})});c["char>?"]=new b("char>?",2,!0,!1,function(b,d,c,i){i.unshift(c);i.unshift(d);P(i,function(d,c){g(b,d,U,"char>?","character",c+1,i)});return C(i,function(b,d){return b.val>d.val})});c["char<=?"]=new b("char<=?",2,!0,!1,function(b,d,c,i){i.unshift(c);i.unshift(d);P(i,function(d,c){g(b,d,U,"char<=?","character",c+1,i)});
return C(i,function(b,d){return b.val<=d.val})});c["char>=?"]=new b("char>=?",2,!0,!1,function(b,d,c,i){i.unshift(c);i.unshift(d);P(i,function(d,c){g(b,d,U,"char>=?","character",c+1,i)});return C(i,function(b,d){return b.val>=d.val})});c["char-ci=?"]=new b("char-ci=?",2,!0,!1,function(b,d,c,i){i.unshift(c);i.unshift(d);P(i,function(d,c){g(b,d,U,"char-ci=?","character",c+1,i)});return C(i,function(b,d){return b.val.toLowerCase()===d.val.toLowerCase()})});c["char-ci<?"]=new b("char-ci<?",2,!0,!1,function(b,
d,c,i){i.unshift(c);i.unshift(d);P(i,function(d,c){g(b,d,U,"char-ci<?","character",c+1,i)});return C(i,function(b,d){return b.val.toLowerCase()<d.val.toLowerCase()})});c["char-ci>?"]=new b("char-ci>?",2,!0,!1,function(b,d,c,i){i.unshift(c);i.unshift(d);P(i,function(d,c){g(b,d,U,"char-ci>?","character",c+1,i)});return C(i,function(b,d){return b.val.toLowerCase()>d.val.toLowerCase()})});c["char-ci<=?"]=new b("char-ci<=?",2,!0,!1,function(b,d,c,i){i.unshift(c);i.unshift(d);P(i,function(d,c){g(b,d,U,
"char-ci<=?","character",c+1,i)});return C(i,function(b,d){return b.val.toLowerCase()<=d.val.toLowerCase()})});c["char-ci>=?"]=new b("char-ci>=?",2,!0,!1,function(b,d,c,i){i.unshift(c);i.unshift(d);P(i,function(d,c){g(b,d,U,"char-ci>=?","character",c+1,i)});return C(i,function(b,d){return b.val.toLowerCase()>=d.val.toLowerCase()})});c["char-alphabetic?"]=new b("char-alphabetic?",1,!1,!1,function(b,d){g(b,d,U,"char-alphabetic?","character",1);return ca(d.val)});c["char-numeric?"]=new b("char-numeric?",
1,!1,!1,function(b,d){g(b,d,U,"char-numeric?","character",1);return"0"<=d.val&&"9">=d.val});c["char-whitespace?"]=new b("char-whitespace?",1,!1,!1,function(b,d){g(b,d,U,"char-whitespace?","character",1);return X(d.val)});c["char-upper-case?"]=new b("char-upper-case?",1,!1,!1,function(b,d){g(b,d,U,"char-upper-case?","character",1);return ca(d.val)&&d.val.toUpperCase()===d.val});c["char-lower-case?"]=new b("char-lower-case?",1,!1,!1,function(b,d){g(b,d,U,"char-lower-case?","character",1);return ca(d.val)&&
d.val.toLowerCase()===d.val});c["char->integer"]=new b("char->integer",1,!1,!1,function(b,d){g(b,d,U,"char->integer","character",1);return d.val.charCodeAt(0)});c["integer->char"]=new b("integer->char",1,!1,!1,function(b,d){g(b,d,function(b){if(!ra(b))return!1;b=jsnums.toFixnum(b);return 0<=b&&55296>b||57343<b&&1114111>=b},"integer->char","exact integer in [0,#x10FFFF], not in [#xD800,#xDFFF]",1);return types["char"](String.fromCharCode(jsnums.toFixnum(d)))});c["char-upcase"]=new b("char-upcase",
1,!1,!1,function(b,d){g(b,d,U,"char-upcase","character",1);return types["char"](d.val.toUpperCase())});c["char-downcase"]=new b("char-downcase",1,!1,!1,function(b,d){g(b,d,U,"char-downcase","character",1);return types["char"](d.val.toLowerCase())});c["make-posn"]=new b("make-posn",2,!1,!1,function(b,d,c){return types.posn(d,c)});c["posn-x"]=new b("posn-x",1,!1,!1,function(b,d){g(b,d,types.isPosn,"posn-x","posn",1);return types.posnX(d)});c["posn-y"]=new b("posn-y",1,!1,!1,function(b,d){g(b,d,types.isPosn,
"posn-y","posn",1);return types.posnY(d)});c["key=?"]=new b("key=?",2,!1,!1,function(b,d,c){types.isChar(d)&&(d=d.getValue());types.isChar(c)&&(c=c.getValue());return d.toString().toLowerCase()===c.toString().toLowerCase()});c["image?"]=new b("image?",1,!1,!1,function(b,d){return N(d)});c["image=?"]=new b("image=?",2,!1,!1,function(b,d,c){g(b,d,N,"image=?","image",1);g(b,c,N,"image=?","image",2);return ua(d,c)});c["make-color"]=new e("make-color",[new b("make-color",3,!1,!1,function(b,d,c,i){g(b,
d,ea,"make-color","number between 0 and 255",1,arguments);g(b,c,ea,"make-color","number between 0 and 255",2,arguments);g(b,i,ea,"make-color","number between 0 and 255",3,arguments);return types.color(jsnums.toFixnum(d),jsnums.toFixnum(c),jsnums.toFixnum(i))}),new b("make-color",4,!1,!1,function(b,d,c,i,e){g(b,d,ea,"make-color","number between 0 and 255",1,arguments);g(b,c,ea,"make-color","number between 0 and 255",2,arguments);g(b,i,ea,"make-color","number between 0 and 255",3,arguments);g(b,e,ea,
"make-color","number between 0 and 255",4,arguments);return types.color(jsnums.toFixnum(d),jsnums.toFixnum(c),jsnums.toFixnum(i),jsnums.toFixnum(e))})]);c["color-red"]=new b("color-red",1,!1,!1,function(b,d){g(b,d,types.isColor,"color-red","color",1);return types.colorRed(d)});c["color-green"]=new b("color-green",1,!1,!1,function(b,d){g(b,d,types.isColor,"color-green","color",1);return types.colorGreen(d)});c["color-blue"]=new b("color-blue",1,!1,!1,function(b,d){g(b,d,types.isColor,"color-blue",
"color",1);return types.colorBlue(d)});c["color-alpha"]=new b("color-alpha",1,!1,!1,function(b,d){g(b,d,types.isColor,"color-alpha","color",1);return types.colorAlpha(d)});c["empty-scene"]=new b("empty-scene",2,!1,!1,function(b,d,c){g(b,d,E,"empty-scene","non-negative number",1,arguments);g(b,c,E,"empty-scene","non-negative number",2,arguments);return world.Kernel.sceneImage(jsnums.toFixnum(d),jsnums.toFixnum(c),[],!0)});c["put-image"]=new b("put-image",4,!1,!1,function(b,d,c,i,e){g(b,d,N,"put-image",
"image",1,arguments);g(b,c,F,"put-image","real",2,arguments);g(b,i,F,"put-image","real",3,arguments);g(b,e,function(b){return ja(b)||N(b)},"put-image","image",4,arguments);if(ja(e))return e.add(d,jsnums.toFixnum(c),e.getHeight()-jsnums.toFixnum(i));var l=world.Kernel.sceneImage(e.getWidth(),e.getHeight(),[],!1),l=l.add(e,e.getWidth()/2,e.getHeight()/2);return l=l.add(d,jsnums.toFixnum(c),e.getHeight()-jsnums.toFixnum(i))});c["place-image"]=new b("place-image",4,!1,!1,function(b,d,c,i,e){g(b,d,N,"place-image",
"image",1,arguments);g(b,c,F,"place-image","real",2,arguments);g(b,i,F,"place-image","real",3,arguments);g(b,e,function(b){return ja(b)||N(b)},"place-image","image",4,arguments);if(ja(e))return e.add(d,jsnums.toFixnum(c),jsnums.toFixnum(i));var l=world.Kernel.sceneImage(e.getWidth(),e.getHeight(),[],!1),l=l.add(e,e.getWidth()/2,e.getHeight()/2);return l=l.add(d,jsnums.toFixnum(c),jsnums.toFixnum(i))});c["place-image/align"]=new b("place-image/align",6,!1,!1,function(b,d,c,i,e,l,j){g(b,d,N,"place-image/align",
"image",1,arguments);g(b,c,F,"place-image/align","real number",2,arguments);g(b,i,F,"place-image/align","real number",3,arguments);g(b,e,Ia,"place-image/align","x-place",4,arguments);g(b,l,Ea,"place-image/align","y-place",5,arguments);g(b,j,function(b){return ja(b)||N(b)},"place-image/align","image",6,arguments);"left"==e?c+=d.getWidth()/2:"right"==e&&(c-=d.getWidth()/2);"top"==l?i+=d.getHeight()/2:"bottom"==l&&(i-=d.getHeight()/2);if(ja(j))return j.add(d,jsnums.toFixnum(c),jsnums.toFixnum(i));var k=
world.Kernel.sceneImage(j.getWidth(),j.getHeight(),[],!1),k=k.add(j,j.getWidth()/2,j.getHeight()/2);return k=k.add(d,jsnums.toFixnum(c),jsnums.toFixnum(i))});c["scene+line"]=new b("scene+line",6,!1,!1,function(b,d,c,i,e,l,j){g(b,d,N,"scene+line","image",1,arguments);g(b,c,F,"scene+line","finite real number",2,arguments);g(b,i,F,"scene+line","finite real number",3,arguments);g(b,e,F,"scene+line","finite real number",4,arguments);g(b,l,F,"scene+line","finite real number",5,arguments);g(b,j,H,"scene+line",
"color",6,arguments);O.get(j)&&(j=O.get(j));newScene=world.Kernel.sceneImage(jsnums.toFixnum(d.getWidth()),jsnums.toFixnum(d.getHeight()),[],!1);newScene=newScene.add(d,d.getWidth()/2,d.getHeight()/2);line=world.Kernel.lineImage(jsnums.toFixnum(e-c),jsnums.toFixnum(l-i),j);leftMost=Math.min(c,e);topMost=Math.min(i,l);return newScene.add(line,line.getWidth()/2+leftMost,line.getHeight()/2+topMost)});c["put-pinhole"]=new b("put-pinhole",3,!1,!1,function(b,d,c,i){g(b,d,N,"put-pinhole","image",1,arguments);
g(b,c,F,"put-pinhole","real",2,arguments);g(b,i,F,"put-pinhole","real",3,arguments);return d.updatePinhole(jsnums.toFixnum(c),jsnums.toFixnum(i))});c.circle=new b("circle",3,!1,!1,function(b,d,c,i){g(b,d,E,"circle","non-negative number",1,arguments);g(b,c,oa,"circle",'style ("solid" or "outline" or [0-255])',2,arguments);g(b,i,H,"circle","color",3,arguments);O.get(i)&&(i=O.get(i));return world.Kernel.circleImage(jsnums.toFixnum(d),c.toString(),i)});c.star=new e("star",[new b("star",5,!1,!1,function(b,
d,c,i,e,l){g(b,d,D,"star","positive integer greater than or equal to 3",1,arguments);g(b,c,E,"star","non-negative number",2,arguments);g(b,i,E,"star","non-negative number",3,arguments);g(b,e,oa,"star",'style ("solid" or "outline" or [0-255])',4,arguments);g(b,l,H,"star","color",5,arguments);O.get(l)&&(l=O.get(l));return world.Kernel.starImage(jsnums.toFixnum(d),jsnums.toFixnum(c),jsnums.toFixnum(i),e.toString(),l)}),new b("star",3,!1,!1,function(b,d,c,i){g(b,d,E,"star","non-negative number",1,arguments);
g(b,c,oa,"star",'style ("solid" or "outline" or [0-255])',2,arguments);g(b,i,H,"star","color",3,arguments);O.get(i)&&(i=O.get(i));return world.Kernel.polygonImage(jsnums.toFixnum(d),jsnums.toFixnum(5),jsnums.toFixnum(2),c.toString(),i)})]);c["radial-star"]=new b("radial-star",5,!1,!1,function(b,d,c,i,e,l){g(b,d,function(b){return Q(b)&&jsnums.greaterThanOrEqual(b,2)},"radial-star","positive integer greater than or equal to 2",1,arguments);g(b,c,function(b){return F(b)&&jsnums.greaterThan(b,0)},"radial-star",
"positive number",2,arguments);g(b,i,function(b){return F(b)&&jsnums.greaterThan(b,0)},"radial-star","positive number",3,arguments);g(b,e,oa,"radial-star",'style ("solid" or "outline" or [0-255])',4,arguments);g(b,l,H,"radial-star","color",5,arguments);O.get(l)&&(l=O.get(l));return world.Kernel.starImage(jsnums.toFixnum(d),jsnums.toFixnum(c),jsnums.toFixnum(i),e.toString(),l)});c.rectangle=new b("rectangle",4,!1,!1,function(b,d,c,i,e){g(b,d,E,"rectangle","non-negative number",1,arguments);g(b,c,E,
"rectangle","non-negative number",2,arguments);g(b,i,oa,"rectangle",'style ("solid" or "outline" or [0-255])',3,arguments);g(b,e,H,"rectangle","color",4,arguments);O.get(e)&&(e=O.get(e));return world.Kernel.rectangleImage(jsnums.toFixnum(d),jsnums.toFixnum(c),i.toString(),e)});c["regular-polygon"]=new b("regular-polygon",4,!1,!1,function(b,d,c,i,e){g(b,d,E,"regular-polygon","non-negative number",1,arguments);g(b,c,D,"regular-polygon","positive integer greater than or equal to 3",2,arguments);g(b,
i,oa,"regular-polygon",'style ("solid" or "outline" or [0-255])',3,arguments);g(b,e,H,"regular-polygon","color",4,arguments);O.get(e)&&(e=O.get(e));return world.Kernel.polygonImage(jsnums.toFixnum(d),jsnums.toFixnum(c),jsnums.toFixnum(1),i.toString(),e)});c["star-polygon"]=new b("star-polygon",5,!1,!1,function(b,d,c,i,e,l){g(b,d,E,"star-polygon","non-negative number",1,arguments);g(b,c,D,"star-polygon","positive integer greater than or equal to 3",2,arguments);g(b,i,fa,"star-polygon","positive integer greater than or equal to 1",
3,arguments);g(b,e,oa,"star-polygon",'style ("solid" or "outline" or [0-255])',4,arguments);g(b,l,H,"star-polygon","color",5,arguments);O.get(l)&&(l=O.get(l));return world.Kernel.polygonImage(jsnums.toFixnum(d),jsnums.toFixnum(c),jsnums.toFixnum(i),e.toString(),l)});c.rhombus=new b("rhombus",4,!1,!1,function(b,d,c,i,e){g(b,d,E,"rhombus","non-negative number",1,arguments);g(b,c,E,"rhombus","non-negative number",2,arguments);g(b,i,oa,"rhombus",'style ("solid" or "outline" or [0-255])',3,arguments);
g(b,e,H,"rhombus","color",4,arguments);O.get(e)&&(e=O.get(e));return world.Kernel.rhombusImage(jsnums.toFixnum(d),jsnums.toFixnum(c),i.toString(),e)});c.square=new b("square",3,!1,!1,function(b,d,c,i){g(b,d,E,"square","non-negative number",1,arguments);g(b,c,oa,"square",'style ("solid" or "outline" or [0-255])',2,arguments);g(b,i,H,"square","color",3,arguments);O.get(i)&&(i=O.get(i));return world.Kernel.squareImage(jsnums.toFixnum(d),c.toString(),i)});c.triangle=new b("triangle",3,!1,!1,function(b,
d,c,i){g(b,d,E,"triangle","non-negative number",1,arguments);g(b,c,oa,"triangle",'style ("solid" or "outline" or [0-255])',2,arguments);g(b,i,H,"triangle","color",3,arguments);O.get(i)&&(i=O.get(i));return world.Kernel.triangleImage(jsnums.toFixnum(d),jsnums.toFixnum(240),jsnums.toFixnum(d),c.toString(),i)});c["triangle/sas"]=new b("triangle/sas",5,!1,!1,function(b,d,c,i,e,l){g(b,d,E,"triangle/sas","non-negative number",1,arguments);g(b,c,da,"triangle/sas","finite real number between 0 and 360",2,
arguments);g(b,i,E,"triangle/sas","non-negative number",3,arguments);g(b,e,oa,"triangle/sas",'style ("solid" or "outline" or [0-255])',4,arguments);g(b,l,H,"triangle/sas","color",5,arguments);O.get(l)&&(l=O.get(l));var j=Math.sqrt(d*d+i*i-2*d*i*Math.cos(c*Math.PI/180)),k=180*Math.asin(d*Math.sin(c*Math.PI/180)/j)/Math.PI;return world.Kernel.triangleImage(jsnums.toFixnum(i),jsnums.toFixnum(k),jsnums.toFixnum(j),e.toString(),l)});c["triangle/sss"]=new b("triangle/sss",5,!1,!1,function(b,d,c,i,e,l){g(b,
d,E,"triangle/sss","non-negative number",1,arguments);g(b,c,E,"triangle/sss","non-negative number",2,arguments);g(b,i,E,"triangle/sss","non-negative number",3,arguments);g(b,e,oa,"triangle/sss",'style ("solid" or "outline" or [0-255])',4,arguments);g(b,l,H,"triangle/sss","color",5,arguments);O.get(l)&&(l=O.get(l));var j=180*Math.acos((c*c+i*i-d*d)/(2*c*i))/Math.PI;return world.Kernel.triangleImage(jsnums.toFixnum(i),jsnums.toFixnum(j),jsnums.toFixnum(c),e.toString(),l)});c["triangle/ass"]=new b("triangle/ass",
5,!1,!1,function(b,d,c,i,e,l){g(b,d,da,"triangle/ass","finite real number between 0 and 360",1,arguments);g(b,c,E,"triangle/ass","non-negative number",2,arguments);g(b,i,E,"triangle/ass","non-negative number",3,arguments);g(b,e,oa,"triangle/ass",'style ("solid" or "outline" or [0-255])',4,arguments);g(b,l,H,"triangle/ass","color",5,arguments);O.get(l)&&(l=O.get(l));return world.Kernel.triangleImage(jsnums.toFixnum(i),jsnums.toFixnum(d),jsnums.toFixnum(c),e.toString(),l)});c["triangle/ssa"]=new b("triangle/ssa",
5,!1,!1,function(b,d,c,i,e,l){g(b,d,E,"triangle/ssa","non-negative number",1,arguments);g(b,c,E,"triangle/ssa","non-negative number",2,arguments);g(b,i,da,"triangle/ssa","finite real number between 0 and 360",3,arguments);g(b,e,oa,"triangle/ssa",'style ("solid" or "outline" or [0-255])',4,arguments);g(b,l,H,"triangle/ssa","color",5,arguments);O.get(l)&&(l=O.get(l));var j=Math.sqrt(d*d+c*c)-2*d*c*Math.cos(i*Math.PI/180),k=180*Math.asin(d*Math.sin(i*Math.PI/180)/j)/Math.PI;return world.Kernel.triangleImage(jsnums.toFixnum(j),
jsnums.toFixnum(k),jsnums.toFixnum(c),e.toString(),l)});c["triangle/aas"]=new b("triangle/aas",5,!1,!1,function(b,d,c,i,e,l){g(b,d,da,"triangle/aas","finite real number between 0 and 360",1,arguments);g(b,c,da,"triangle/aas","finite real number between 0 and 360",2,arguments);g(b,i,E,"triangle/aas","non-negative number",3,arguments);g(b,e,oa,"triangle/aas",'style ("solid" or "outline" or [0-255])',4,arguments);g(b,l,H,"triangle/aas","color",5,arguments);O.get(l)&&(l=O.get(l));var j=180-d-c,j=Math.sin(d*
Math.PI/180)*i/Math.sin(j*Math.PI/180);return world.Kernel.triangleImage(jsnums.toFixnum(i),jsnums.toFixnum(d),jsnums.toFixnum(j),e.toString(),l)});c["triangle/asa"]=new b("triangle/asa",5,!1,!1,function(b,d,c,i,e,l){g(b,d,da,"triangle/asa","finite real number between 0 and 360",1,arguments);g(b,c,E,"triangle/asa","non-negative number",2,arguments);g(b,i,da,"triangle/asa","finite real number between 0 and 360",3,arguments);g(b,e,oa,"triangle/asa",'style ("solid" or "outline" or [0-255])',4,arguments);
g(b,l,H,"triangle/asa","color",5,arguments);O.get(l)&&(l=O.get(l));var j=180-d-i,j=c*Math.sin(i*Math.PI/180)/Math.sin(j*Math.PI/180);return world.Kernel.triangleImage(jsnums.toFixnum(j),jsnums.toFixnum(d),jsnums.toFixnum(c),e.toString(),l)});c["triangle/saa"]=new b("triangle/saa",5,!1,!1,function(b,d,c,i,e,l){g(b,d,E,"triangle/saa","non-negative number",1,arguments);g(b,c,da,"triangle/saa","finite real number between 0 and 360",2,arguments);g(b,i,da,"triangle/saa","finite real number between 0 and 360",
3,arguments);g(b,e,oa,"triangle/saa",'style ("solid" or "outline" or [0-255])',4,arguments);g(b,l,H,"triangle/saa","color",5,arguments);O.get(l)&&(l=O.get(l));var j=180-c-i,k=Math.sin(i*Math.PI/180)*d/Math.sin(j*Math.PI/180),u=Math.sin(c*Math.PI/180)*d/Math.sin(j*Math.PI/180);return world.Kernel.triangleImage(jsnums.toFixnum(k),jsnums.toFixnum(j),jsnums.toFixnum(u),e.toString(),l)});c["right-triangle"]=new b("right-triangle",4,!1,!1,function(b,d,c,i,e){g(b,d,E,"right-triangle","non-negative number",
1,arguments);g(b,c,E,"right-triangle","non-negative number",2,arguments);g(b,i,oa,"right-triangle",'style ("solid" or "outline" or [0-255])',3,arguments);g(b,e,H,"right-triangle","color",4,arguments);O.get(e)&&(e=O.get(e));return world.Kernel.triangleImage(jsnums.toFixnum(d),jsnums.toFixnum(270),jsnums.toFixnum(c),i.toString(),e)});c["isosceles-triangle"]=new b("isosceles-triangle",4,!1,!1,function(b,d,c,i,e){g(b,d,E,"isosceles-triangle","non-negative number",1,arguments);g(b,c,da,"isosceles-triangle",
"finite real number between 0 and 360",2,arguments);g(b,i,oa,"isosceles-triangle",'style ("solid" or "outline" or [0-255])',3,arguments);g(b,e,H,"isosceles-triangle","color",4,arguments);O.get(e)&&(e=O.get(e));var l=(180-c)/2,j=2*d*Math.sin(c*Math.PI/180/2);return world.Kernel.triangleImage(jsnums.toFixnum(j),jsnums.toFixnum(l+180),jsnums.toFixnum(d),i.toString(),e)});c.ellipse=new b("ellipse",4,!1,!1,function(b,d,c,i,e){g(b,d,E,"ellipse","non-negative number",1,arguments);g(b,c,E,"ellipse","non-negative number",
2,arguments);g(b,i,oa,"ellipse",'style ("solid" or "outline" or [0-255])',3,arguments);g(b,e,H,"ellipse","color",4,arguments);O.get(e)&&(e=O.get(e));return world.Kernel.ellipseImage(jsnums.toFixnum(d),jsnums.toFixnum(c),i.toString(),e)});c.line=new b("line",3,!1,!1,function(b,d,c,i){g(b,d,F,"line","finite real number",1,arguments);g(b,c,F,"line","finite real number",2,arguments);g(b,i,H,"line","color",3,arguments);O.get(i)&&(i=O.get(i));return world.Kernel.lineImage(jsnums.toFixnum(d),jsnums.toFixnum(c),
i)});c["add-line"]=new b("add-line",6,!1,!1,function(b,d,c,i,e,l,j){g(b,d,N,"add-line","image",1,arguments);g(b,c,F,"add-line","finite real number",2,arguments);g(b,i,F,"add-line","finite real number",3,arguments);g(b,e,F,"add-line","finite real number",4,arguments);g(b,l,F,"add-line","finite real number",5,arguments);g(b,j,H,"add-line","color",6,arguments);O.get(j)&&(j=O.get(j));var k=world.Kernel.lineImage(jsnums.toFixnum(e-c),jsnums.toFixnum(l-i),j),u=Math.min(c,e),m=Math.min(i,l);return world.Kernel.overlayImage(k,
d,-u,-m)});c.overlay=new b("overlay",2,!0,!1,function(b,d,c,i){var e=[d,c].concat(i);g(b,d,N,"overlay","image",1,e);g(b,c,N,"overlay","image",2,e);P(i,function(d,c){g(b,d,N,"overlay","image",c+3)},arguments);for(var e=world.Kernel.overlayImage(d,c,"middle","middle"),l=0;l<i.length;l++)e=world.Kernel.overlayImage(e,i[l],"middle","middle");return e});c["overlay/xy"]=new b("overlay/xy",4,!1,!1,function(b,d,c,i,e){g(b,d,N,"overlay/xy","image",1,arguments);g(b,c,F,"overlay/xy","finite real number",2,arguments);
g(b,i,F,"overlay/xy","finite real number",3,arguments);g(b,e,N,"overlay/xy","image",4,arguments);return world.Kernel.overlayImage(d,e,jsnums.toFixnum(c),jsnums.toFixnum(i))});c["overlay/align"]=new b("overlay/align",4,!0,!1,function(b,d,c,i,e,l){S(b,d,Ia,"overlay/align","x-place",1,arguments);S(b,c,Ea,"overlay/align","y-place",2,arguments);S(b,i,N,"overlay/align","image",3,arguments);S(b,e,N,"overlay/align","image",4,arguments);P(l,function(d,c){g(b,d,N,"overlay/align","image",c+4)},arguments);for(var j=
world.Kernel.overlayImage(i,e,d.toString(),c.toString()),k=0;k<l.length;k++)j=world.Kernel.overlayImage(j,l[k],d.toString(),c.toString());return j});c.underlay=new b("underlay",2,!0,!1,function(b,d,c,i){S(b,d,N,"underlay","image",1,arguments);S(b,c,N,"underlay","image",2,arguments);P(i,function(d,c){g(b,d,N,"underlay","image",c+3)},arguments);for(var e=world.Kernel.overlayImage(c,d,"middle","middle"),l=0;l<i.length;l++)e=world.Kernel.overlayImage(i[l],e,"middle","middle");return e});c["underlay/xy"]=
new b("underlay/xy",4,!1,!1,function(b,d,c,i,e){g(b,d,N,"underlay/xy","image",1,arguments);g(b,c,F,"underlay/xy","finite real number",2,arguments);g(b,i,F,"underlay/xy","finite real number",3,arguments);g(b,e,N,"underlay/xy","image",4,arguments);return world.Kernel.overlayImage(e,d,-jsnums.toFixnum(c),-jsnums.toFixnum(i))});c["underlay/align"]=new b("underlay/align",4,!0,!1,function(b,d,c,i,e,l){S(b,d,Ia,"underlay/align","x-place",1,arguments);S(b,c,Ea,"underlay/align","y-place",2,arguments);S(b,
i,N,"underlay/align","image",3,arguments);S(b,e,N,"underlay/align","image",4,arguments);P(l,function(d,c){g(b,d,N,"underlay/align","image",c+4)},arguments);for(var j=world.Kernel.overlayImage(e,i,d.toString(),c.toString()),k=0;k<l.length;k++)j=world.Kernel.overlayImage(l[k],j,d.toString(),c.toString());return j});c.beside=new b("beside",2,!0,!1,function(b,d,c,i){S(b,d,N,"beside","image",1,arguments);S(b,c,N,"beside","image",2,arguments);P(i,function(d,c){g(b,d,N,"beside","image",c+4)},arguments);
for(var e=world.Kernel.overlayImage(d,c,"beside","middle"),l=0;l<i.length;l++)e=world.Kernel.overlayImage(e,i[l],"beside","middle");return e});c["beside/align"]=new b("beside/align",3,!0,!1,function(b,d,c,i,e){S(b,d,Ea,"beside/align","y-place",1,arguments);S(b,c,N,"beside/align","image",2,arguments);S(b,i,N,"beside/align","image",3,arguments);P(e,function(d,c){g(b,d,N,"beside","image",c+3)},arguments);for(var l=world.Kernel.overlayImage(c,i,"beside",d.toString()),j=0;j<e.length;j++)l=world.Kernel.overlayImage(l,
e[j],"beside",d.toString());return l});c.above=new b("above",2,!0,!1,function(b,d,c,i){S(b,d,N,"above","image",1,arguments);S(b,c,N,"above","image",2,arguments);P(i,function(d,c){g(b,d,N,"above","image",c+4)},arguments);for(var e=world.Kernel.overlayImage(d,c,"middle","above"),l=0;l<i.length;l++)e=world.Kernel.overlayImage(e,i[l],"middle","above");return e});c["above/align"]=new b("above/align",3,!0,!1,function(b,d,c,i,e){S(b,d,Ia,"above/align","x-place",1,arguments);S(b,c,N,"above/align","image",
1,arguments);S(b,i,N,"above/align","image",2,arguments);P(e,function(d,c){g(b,d,N,"above/align","image",c+4)},arguments);var l,j=world.Kernel.overlayImage(c,i,d.toString(),"above");for(l=0;l<e.length;l++)j=world.Kernel.overlayImage(j,e[l],d.toString(),"above");return j});c.rotate=new b("rotate",2,!1,!1,function(b,d,c){g(b,d,da,"rotate","finite real number between 0 and 360",1,arguments);g(b,c,N,"rotate","image",2,arguments);return world.Kernel.rotateImage(jsnums.toFixnum(-d),c)});c["scale/xy"]=new b("scale/xy",
3,!1,!1,function(b,d,c,i){g(b,d,F,"scale/xy","finite real number",1,arguments);g(b,c,F,"scale/xy","finite real number",2,arguments);g(b,i,N,"scale/xy","image",3,arguments);return world.Kernel.scaleImage(jsnums.toFixnum(d),jsnums.toFixnum(c),i)});c.scale=new b("scale",2,!1,!1,function(b,d,c){g(b,d,F,"scale","finite real number",1,arguments);g(b,c,N,"scale","image",2,arguments);return world.Kernel.scaleImage(jsnums.toFixnum(d),jsnums.toFixnum(d),c)});c.crop=new b("crop",5,!1,!1,function(b,d,c,i,e,l){g(b,
d,F,"crop","finite real number",1,arguments);g(b,c,F,"crop","finite real number",2,arguments);g(b,i,E,"crop","non-negative number",3,arguments);g(b,e,E,"crop","non-negative number",4,arguments);g(b,l,N,"crop","image",5,arguments);return world.Kernel.cropImage(jsnums.toFixnum(d),jsnums.toFixnum(c),jsnums.toFixnum(i),jsnums.toFixnum(e),l)});c.frame=new b("frame",1,!1,!1,function(b,d){g(b,d,N,"frame","image",1,arguments);return world.Kernel.frameImage(d)});c["flip-vertical"]=new b("flip-vertical",1,
!1,!1,function(b,d){g(b,d,N,"flip-vertical","image",1,arguments);return world.Kernel.flipImage(d,"vertical")});c["flip-horizontal"]=new b("flip-horizontal",1,!1,!1,function(b,d){g(b,d,N,"flip-horizontal","image",1,arguments);return world.Kernel.flipImage(d,"horizontal")});c.text=new b("text",3,!1,!1,function(b,d,c,i){g(b,d,I,"text","string",1,arguments);g(b,c,function(b){return Q(b)&&jsnums.greaterThan(b,0)&&ea(b)},"text","exact integer between 1 and 255",2,arguments);g(b,i,H,"text","color",3,arguments);
O.get(i)&&(i=O.get(i));return world.Kernel.textImage(d.toString(),jsnums.toFixnum(c),i,"normal","Arial","","",!1)});c["text/font"]=new b("text/font",8,!1,!1,function(b,d,c,i,e,j,k,u,m){g(b,d,I,"text/font","string",1,arguments);g(b,c,function(b){return Q(b)&&jsnums.greaterThan(b,0)&&ea(b)},"text/font","exact integer between 1 and 255",2,arguments);g(b,i,H,"text/font","color",3,arguments);g(b,e,function(b){return I(b)||!b},"text/font","face",4,arguments);g(b,j,ka,"text/font","family",5,arguments);g(b,
k,wa,"text/font",'style ("solid" or "outline")',6,arguments);g(b,u,ta,"text/font","weight",7,arguments);g(b,m,l,"text/font","underline?",8,arguments);O.get(i)&&(i=O.get(i));try{return world.Kernel.textImage(d.toString(),jsnums.toFixnum(c),i,e.toString(),j.toString(),k.toString(),u.toString(),m)}catch(o){return world.Kernel.textImage(d.toString(),jsnums.toFixnum(c),i,"normal","Arial","","",!1)}});c["bitmap/url"]=c["image-url"]=new b("image-url",1,!1,!1,function(b,d){g(b,d,I,"image-url","string",1);
var c=d.toString(),d=b.getImageProxyHook()?b.getImageProxyHook()+"?url="+encodeURIComponent(d.toString()):d.toString();return q(function(b){var h=new Image;h.onload=function(){world.Kernel.fileImage(d,h,b)};h.onerror=function(){b(types.schemeError(types.incompleteExn(types.exnFail," (unable to load: "+c+")",[])))};h.src=d})});c["open-image-url"]=c["image-url"];c["video-url"]=new b("video-url",1,!1,!1,function(b,d){g(b,d,I,"video-url","string",1);return q(function(b){var c=document.createElement("video");
c.src=d.toString();c.addEventListener("canplay",function(){b(world.Kernel.fileVideo(d.toString(),c))});c.addEventListener("error",function(){b(types.schemeError(types.incompleteExn(types.exnFail," (unable to load: "+d+")",[])))});c.src=d.toString()})});c["video/url"]=c["video-url"];c["image-width"]=new b("image-width",1,!1,!1,function(b,d){g(b,d,N,"image-width","image",1);return d.getWidth()});c["image-height"]=new b("image-height",1,!1,!1,function(b,d){g(b,d,N,"image-height","image",1);return d.getHeight()});
c["image-baseline"]=new b("image-baseline",1,!1,!1,function(b,d){g(b,d,N,"image-baseline","image",1);return d.getBaseline()});c["image->color-list"]=new b("image->color-list",1,!1,!1,function(b,d){g(b,d,N,"image->color-list","image",1);var c=d.getWidth(),e=d.getHeight(),l=world.Kernel.makeCanvas(c,e).getContext("2d"),j,k,u;d.render(l,0,0);for(var c=l.getImageData(0,0,c,e).data,m=[],e=0;e<c.length;e+=4)l=c[e],j=c[e+1],k=c[e+2],u=c[e+3],m.push(types.color(l,j,k,u));return types.list(m)});var eb=function(b,
d,c,e,l,j){Aa(b,d,H,"color-list->image","image",1);g(b,c,Q,"color-list->image","natural",2);g(b,e,Q,"color-list->image","natural",3);g(b,l,Q,"color-list->image","natural",4);g(b,j,Q,"color-list->image","natural",5);for(var b=world.Kernel.makeCanvas(jsnums.toFixnum(c),jsnums.toFixnum(e)),l=b.getContext("2d"),c=l.createImageData(jsnums.toFixnum(c),jsnums.toFixnum(e)),e=c.data,k=0;d!==types.EMPTY;)j=d.first(),e[k]=jsnums.toFixnum(types.colorRed(j)),e[k+1]=jsnums.toFixnum(types.colorGreen(j)),e[k+2]=
jsnums.toFixnum(types.colorBlue(j)),e[k+3]=jsnums.toFixnum(types.colorAlpha(j)),k+=4,d=d.rest();l.putImageData(c,0,0);var u=b.toDataURL("image/png");return q(function(b){var d=new Image;d.onload=function(){world.Kernel.fileImage(u,d,b)};d.onerror=function(){b(types.schemeError(types.incompleteExn(types.exnFail," (unable to load: "+originalPath+")",[])))};d.src=u})};c["color-list->image"]=new b("color-list->image",5,!1,!1,function(b,d,c,e,g,l){return eb(b,d,c,e,g,l)});c["color-list->bitmap"]=new b("color-list->bitmap",
3,!1,!1,function(b,d,c,e){return eb(b,d,c,e,0,0)});c["mode?"]=new b("mode?",1,!1,!1,function(b,d){return oa(d)});c["image-color?"]=new b("image-color?",1,!1,!1,function(b,d){return H(d)});c["name->color"]=new b("name->color",1,!1,!1,function(b,d){return $a(d)||!1});c["x-place?"]=new b("x-place?",1,!1,!1,function(b,d){return Ia(d)});c["y-place?"]=new b("y-place?",1,!1,!1,function(b,d){return Ea(d)});c["angle?"]=new b("angle?",1,!1,!1,function(b,d){return da(d)});c["side-count?"]=new b("side-count?",
1,!1,!1,function(b,d){return D(d)});c["step-count?"]=new b("step-count?",1,!1,!1,function(b,d){return fa(d)});var Wa=R.extend({init:function(b,d,c){this._super("on-tick");this.handler=b;this.effectHandler=d;this.aDelay=c},configure:function(b){var d={onTick:this.handler,onTickEffect:this.effectHandler,tickDelay:jsnums.toFixnum(jsnums.multiply(1E3,this.aDelay))};return b.updateAll(d)}}),bb=types.rational(1,28);c["on-tick"]=new e("on-tick",[new b("on-tick",1,!1,!1,function(c,d){g(c,d,u,"on-tick","function name",
1);return new Wa(d,new b("",1,!1,!1,function(){return types.effectDoNothing()}),bb)}),new b("on-tick",2,!1,!1,function(c,d,e){g(c,d,u,"on-tick","function name",1,arguments);g(c,e,E,"on-tick","non-negative number",2,arguments);return new Wa(d,new b("",1,!1,!1,function(){return types.effectDoNothing()}),e)})]);c["on-tick!"]=new e("on-tick!",[new b("on-tick!",2,!1,!1,function(b,d,c){g(b,d,u,"on-tick!","function name",1,arguments);g(b,c,u,"on-tick!","function name",2,arguments);return new Wa(d,c,bb)}),
new b("on-tick!",3,!1,!1,function(b,d,c,e){g(b,d,u,"on-tick!","function name",1,arguments);g(b,c,u,"on-tick!","function name",2,arguments);g(b,e,E,"on-tick!","non-negative number",3,arguments);return new Wa(d,c,e)})]);c["on-tap"]=new b("on-tap",1,!1,!1,ia("on-tap","onTap",3));c["on-tilt"]=new b("on-tilt",1,!1,!1,ia("on-tilt","onTilt",3));c["on-key"]=new b("on-key",1,!1,!1,ia("on-key","onKey",2));c["on-key!"]=new b("on-key!",2,!1,!1,L("on-key!","onKey"));c["stop-when"]=new b("stop-when",1,!1,!1,ia("stop-when",
"stopWhen",1));c["stop-when!"]=new b("stop-when!",2,!1,!1,L("stop-when!","stopWhen"));c["on-redraw"]=new b("on-redraw",1,!1,!1,function(b,d){g(b,d,u,"on-redraw","function name",1);return new (R.extend({init:function(){this._super("on-redraw")},configure:function(b){return b.updateAll({onRedraw:d})}}))});c["to-draw"]=new b("to-draw",1,!1,!1,function(b,d){g(b,d,u,"to-draw","function name",1);return new (R.extend({init:function(){this._super("on-redraw")},configure:function(b){return b.updateAll({onRedraw:d})}}))});
c["on-draw"]=new e("on-draw",[new b("on-draw",1,!1,!1,function(b,d){g(b,d,u,"on-draw","function name",1);return new (R.extend({init:function(){this._super("on-draw")},configure:function(b){return b.updateAll({onDraw:d})}}))}),new b("on-draw",2,!1,!1,function(b,d,c){g(b,d,u,"on-draw","function name",1,arguments);g(b,c,u,"on-draw","function name",2,arguments);return new (R.extend({init:function(){this._super("on-draw")},configure:function(b){return b.updateAll({onDraw:d,onDrawCss:c})}}))})]);c["initial-effect"]=
new b("initial-effect",1,!1,!1,function(b,d){return new (R.extend({init:function(){this._super("initial-effect")},configure:function(b){return b.updateAll({initialEffect:d})}}))});var gb=function(b){Aa(void 0,b,function(b){return xa(b)&&2==aa(b)},"js-p","list of (list of X Y)",1);var b=pa(b),d=jsworld.MobyJsworld.p(b);d.toWrittenString=function(){return"(js-p)"};d.toDisplayedString=d.toWrittenString;d.toDomNode=function(){return d};return helpers.wrapJsObject(d)};c["js-p"]=new e("js-p",[new b("js-p",
0,!1,!1,function(){return gb(types.EMPTY)}),new b("js-p",1,!1,!1,function(b,d){return gb(d)})]);var hb=function(b){Aa(void 0,b,Na,"js-div","(listof X Y)",1);var b=pa(b),d=jsworld.MobyJsworld.div(b);d.toWrittenString=function(){return"(js-div)"};d.toDisplayedString=d.toWrittenString;d.toDomNode=function(){return d};return helpers.wrapJsObject(d)};c["js-div"]=new e("js-div",[new b("js-div",0,!1,!1,function(){return hb(types.EMPTY)}),new b("js-div",1,!1,!1,function(b,d){return hb(d)})]);var Va=function(b){return function(d,
c,e,l){g(d,c,u,b,"function name",1);g(d,e,u,b,"function name",2);Aa(void 0,l,Na,b,"(listof X Y)",3);var d=l?pa(l):{},j=jsworld.MobyJsworld.buttonBang(c,e,d);j.toWrittenString=function(){return"("+b+" ...)"};j.toDisplayedString=j.toWrittenString;j.toDomNode=function(){return j};return helpers.wrapJsObject(j)}},Oa=function(b,d,c){var e=new types.PrimProc("",1,!1,!1,function(){return types.EMPTY});return Va("js-button")(b,d,e,c)};c["js-button"]=new e("js-button",[new b("js-button",1,!1,!1,function(b,
d){return Oa(b,d)}),new b("js-button",2,!1,!1,function(b,d,c){return Oa(b,d,c)})]);c["js-button!"]=new e("js-button!",[new b("js-button!",2,!1,!1,Va("js-button!")),new b("js-button!",3,!1,!1,Va("js-button!"))]);var ib=function(b,d,c){g(aState,b,I,"js-input","string",1);g(aState,d,u,"js-input","function name",2);Aa(void 0,c,Na,"js-input","(listof X Y)",3);var c=c?pa(c):{},e=jsworld.MobyJsworld.input(b,d,c);e.toWrittenString=function(){return"(js-input ...)"};e.toDisplayedString=e.toWrittenString;e.toDomNode=
function(){return e};return helpers.wrapJsObject(e)};c["js-input"]=new e("js-input",[new b("js-input",2,!1,!1,function(b,d,c){return ib(d,c)}),new b("js-input",3,!1,!1,function(b,d,c,e){return ib(d,updateF,e)})]);var Xa=function(b,d){g(aState,b,I,"js-img","string",1);Aa(void 0,d,Na,"js-img","(listof X Y)",2);var c=pa(d),e=jsworld.MobyJsworld.img(b,c);e.toWrittenString=function(){return"(js-img ...)"};e.toDisplayedString=e.toWrittenString;e.toDomNode=function(){return e};return helpers.wrapJsObject(e)};
c["js-img"]=new e("js-img",[new b("js-img",1,!1,!1,function(b,d){return Xa(d,types.EMPTY)}),new b("js-img",2,!1,!1,function(b,d,c){return Xa(d,c)})]);c["js-text"]=new b("js-text",1,!1,!1,function(b,d){g(b,d,I,"js-text","string",1);var c=jsworld.MobyJsworld.text(d,[]);c.toWrittenString=function(){return"(js-text ...)"};c.toDisplayedString=c.toWrittenString;c.toDomNode=function(){return c};return helpers.wrapJsObject(c)});var jb=function(b,d,c){Aa(void 0,b,I,"js-select","listof string",1);g(aState,
d,u,"js-select","function name",2);Aa(void 0,c,Na,"js-select","(listof X Y)",3);var c=c?pa(c):{},b=helpers.deepListToArray(b),e=jsworld.MobyJsworld.select(b,d,c);e.toWrittenString=function(){return"(js-select ...)"};e.toDisplayedString=e.toWrittenString;e.toDomNode=function(){return e};return helpers.wrapJsObject(e)};c["js-select"]=new e("js-select",[new b("js-select",2,!1,!1,function(b,d,c){return jb(d,c)}),new b("js-select",3,!1,!1,function(b,d,c,e){return jb(d,c,e)})]);c["big-bang"]=c["js-big-bang"]=
new b("big-bang",1,!0,!1,function(b,d,c){P(c,function(e,i){g(b,e,function(b){return b instanceof R||xa(b)||types.isWorldConfig(b)},"big-bang","handler",i+2,[b,d].concat(c))});var e=helpers.map(function(b){return b instanceof R?function(d){return b.configure(d)}:b},c);return q(function(c,g){var l,j=function(){l.breaker()};b.addBreakRequestedListener(j);l=jsworld.MobyJsworld.bigBang(d,b.getToplevelNodeHook()(),e,g,function(d){b.removeBreakRequestedListener(j);c(d)})})});var cb=function(b){Aa(void 0,
b,Na,"empty-page","(listof X Y)",1);b=pa(b);return jsworld.MobyJsworld.emptyPage(b)};c["empty-page"]=new e("empty-page",[new b("empty-page",0,!1,!1,function(){return cb(types.EMPTY)}),new b("empty-page",1,!1,!1,function(b,d){return cb(d)})]);c["place-on-page"]=new b("empty-page",4,!1,!1,function(b,d,c,e,g){return jsworld.MobyJsworld.placeOnPage(d,c,e,g)});c["make-world-config"]=new b("make-world-config",2,!0,!1,function(b,d,c,e){var l=[d,c].concat(e);g(b,d,u,"make-world-config","function name",1,
l);g(b,c,A(1),"make-world-config","function name (arity 1)",2,l);P(e,function(d,c){g(b,d,u,"make-world-config","handler",c+3,l)});A(e.length)(d)||y(types.incompleteExn(types.exnFailContract,"make-world-config: 1st argument must have arity equal to the number of arguments after the second",[]));return types.worldConfig(d,c,e)});c["make-effect-type"]=Ya("make-effect-type",4,[!1],!1,function(b,d,c,e,l,j,k){g(d,c,Y,"make-effect-type","string",1,b);g(d,e,function(b){return!1===b||types.isEffectType(b)},
"make-effect-type","effect type or #f",2,b);g(d,l,Q,"make-effect-type","exact non-negative integer",3,b);g(d,j,u,"make-effect-type","function name",4,b);g(d,k,function(b){return!1===b||u(b)},"make-effect-type","procedure or #f",6,b);b=l+1+(e?e.numberOfArgs:0);k&&!A(b)(k)&&y(types.incompleteExn(types.exnFailContract,helpers.format("make-effect-type: guard procedure does not accept ~a arguments (one more than the number constructor arguments): ~s",[b,k]),[]));k=k?Z(d,k):!1;d=types.makeEffectType(c.toString(),
e,l,j,k,V(d));return la(d)});c["effect-type?"]=new b("effect-type?",1,!1,!1,function(b,d){return types.isEffectType(d)});c["effect?"]=new b("effect?",1,!1,!1,function(b,d){return types.isEffect(d)});c["make-render-effect-type"]=Ya("make-render-effect-type",4,[!1],!1,function(b,d,c,e,l,j,k){g(d,c,Y,"make-render-effect-type","string",1,b);g(d,e,function(b){return!1===b||types.isEffectType(b)},"make-render-effect-type","effect type or #f",2,b);g(d,l,Q,"make-render-effect-type","exact non-negative integer",
3,b);g(d,j,u,"make-render-effect-type","function name",4,b);g(d,k,function(b){return!1===b||u(b)},"make-render-effect-type","procedure or #f",6,b);b=l+1+(e?e.numberOfArgs:0);k&&!A(b)(k)&&y(types.incompleteExn(types.exnFailContract,helpers.format("make-effect-type: guard procedure does not accept ~a arguments (one more than the number constructor arguments): ~s",[b,k]),[]));d=k?Z(d,k):!1;c=types.makeRenderEffectType(c.toString(),e,l,j,d);return la(c)});c["render-effect-type?"]=new b("render-effect-type?",
1,!1,!1,function(b,d){return types.isRenderEffectType(d)});c["render-effect?"]=new b("render-effect?",1,!1,!1,function(b,d){return types.isRenderEffect(d)});c["world-with-effects"]=new b("world-with-effects",2,!1,!1,function(b,d,c){g(b,d,ya,"world-with-effects","compound effect",1,arguments);return jsworld.Jsworld.with_multiple_effects(c,helpers.flattenSchemeListToArray(d))});c["make-render-effect"]=new b("make-render-effect",2,!1,!1,function(b,d,c){return types.makeRenderEffect(d,c)});c["render-effect?"]=
new b("render-effect?",1,!1,!1,function(b,d){return types.isRenderEffect(d)});c["render-effect-dom-node"]=new b("render-effect-dom-node",1,!1,!1,function(b,d){g(b,d,types.isRenderEffect,"render-effect-dom-node","render-effect",1);return types.renderEffectDomNode(d)});c["render-effect-effects"]=new b("render-effect-effects",1,!1,!1,function(b,d){g(b,d,types.isRenderEffect,"render-effect-effects","render-effect",1);return types.renderEffectEffects(d)});c["scheme->prim-js"]=new b("scheme->prim-js",1,
!1,!1,function(b,d){g(b,d,function(b){return F(b)||I(b)||Y(b)||U(b)||l(b)||qa(b)},"scheme->prim-js","real number, string, symbol, char, boolean, or vector",1);var c;F(d)?(!jsnums.equals(d,jsnums.nan)&&!jsnums.equals(d,jsnums.inf)&&!jsnums.equals(d,jsnums.negative_inf)&&(jsnums.greaterThan(d,9E15)||jsnums.lessThan(d,-9E15))&&y(types.incompleteExn(types.exnFailContract,helpers.format("scheme->primitive-js: only numbers in [-9e15, 9e15] are accurately representable in javascript; given: ~s",[d]),[])),
c=jsnums.toFixnum(d)):I(d)?c=d.toString():Y(d)||U(d)?c=d.val:l(d)?c=d:qa(d)&&(c=d.elts.slice(0));return helpers.wrapJsObject(c)});c["prim-js->scheme"]=new b("prim-js->scheme",1,!1,!1,function(c,d){g(c,d,function(b){return Ba(b)&&("number"==typeof b.obj||"string"==typeof b.obj||"boolean"==typeof b.obj||"function"==typeof b.obj||b.obj instanceof Array)},"prim-js->scheme","javascript number, string, boolean, function, or array",1);if("number"===typeof d.obj)return types["float"](d.obj);if("string"===
typeof d.obj||"boolean"===typeof d.obj)return d.obj;if("function"===typeof d.obj)return new b("",0,!0,!1,function(b){return d.obj.apply(null,b)});if(d.obj instanceof Array)return types.vector(d.obj.slice(0))});c["procedure->cps-js-fun"]=new b("procedure->cps-js-fun",1,!1,!1,function(b,d){g(b,d,u,"procedure->cps-js-fun","function name",1);var c=V(b);return types.jsObject(d.name+" (cps)",function(){var b=helpers.map(helpers.wrapJsObject,arguments),e=0==b.length?function(){}:b.shift();c(d,b,e)})});c["procedure->void-js-fun"]=
new b("procedure->void-js-fun",1,!1,!1,function(b,d){g(b,d,u,"procedure->void-js-fun","function name",1);var c=V(b);return types.jsObject(d.name+" (void)",function(){var b=helpers.map(helpers.wrapJsObject,arguments);c(d,b,function(){})})});c["js-==="]=new b("js-===",2,!1,!1,function(b,d,c){g(b,d,Ba,"js-===","javascript value",1);g(b,c,Ba,"js-===","javascript value",2);return d.obj===c.obj});c["js-get-named-object"]=new b("js-get-named-object",1,!1,!1,function(b,d){g(b,d,I,"js-get-named-object","string",
1);var c=d.toString();return types.jsObject(c,"window"===c?window:window[c])});c["js-get-field"]=new b("js-get-field",2,!0,!1,function(b,d,c,e){e.unshift(c);var l=[d].concat(e);g(b,d,Ba,"js-get-field","js-object",1,l);P(e,function(d,c){g(b,d,I,"js-get-field","string",c+2,l)});for(var c=[d.name],d=d.obj,j=0;j<e.length;j++){if(void 0===d){var k=c.join("");y(types.incompleteExn(types.exnFailContract,helpers.format("js-get-field: tried to access field ~a of ~a, but ~a was undefined",[e[j],k,k]),[]))}c.push('["'+
e[j].toString()+'"]');d=d[e[j].toString()]}return types.jsObject(c.join(""),d)});c["js-set-field!"]=new b("js-set-field!",3,!1,!1,function(b,d,c,e){g(b,d,function(b){return Ba(b)&&"object"==typeof b.obj},"js-set-field!","javascript object",1,arguments);g(b,c,I,"js-set-field!","string",2,arguments);d.obj[c.toString()]=Ba(e)?e.obj:e;return types.VOID});c["js-typeof"]=new b("js-typeof",1,!1,!1,function(b,d){g(b,d,Ba,"js-typeof","js-object",1);return typeof d.obj});c["js-instanceof"]=new b("js-instanceof",
2,!1,!1,function(b,d,c){g(b,d,Ba,"js-instanceof","js-object",1,arguments);g(b,c,Qa,"js-instanceof","javascript function",2,arguments);return d.obj instanceof c.obj});c["js-call"]=new b("js-call",2,!0,!1,function(b,d,c,e){var l=[d,c].concat(e);g(b,d,Qa,"js-call","javascript function",1,l);g(b,c,function(b){return!1===b||Ba(b)&&"object"==typeof b.obj},"js-call","javascript object or false",2,l);b=helpers.map(function(b){return Ba(b)?b.obj:b},e);d=d.obj.apply(c?c.obj:null,b);return void 0===d?types.VOID:
helpers.wrapJsObject(d)});c["js-new"]=new b("js-new",1,!0,!1,function(b,d,c){S(b,d,Qa,"js-new","javascript function",1);var e=helpers.map(function(b){return Ba(b)?b.obj:b},c),b=function(){d.obj.apply(this,e)};b.prototype=d.obj.prototype;return helpers.wrapJsObject(new b)});c["js-make-hash"]=new e("js-make-hash",[new b("js-make-hash",0,!1,!1,function(){return types.jsObject("hash",{})}),new b("js-make-hash",1,!1,!1,function(b,d){Aa(b,d,function(b){return Na(b)&&I(b.first())},"js-make-hash","(listof string X)",
1);for(var c={};!d.isEmpty();){var e=d.first().first().toString(),g=d.first().rest().first();c[e]=Ba(g)?g.obj:g;d=d.rest()}return types.jsObject("hash",c)})]);c.eof=types.EOF;c.e=jsnums.e;c.empty=types.EMPTY;c["false"]=!1;c["true"]=!0;c.pi=jsnums.pi;c["null"]=types.EMPTY;c["js-undefined"]=types.jsObject("undefined",void 0);c["js-null"]=types.jsObject("null",null);primitive.getPrimitive=function(b){return c[b]};primitive.isPrimitive=function(c){return c instanceof b};primitive.addPrimitive=function(b,
d){c[b]=d};primitive.Primitive=b;primitive.CasePrimitive=e;primitive.setCALL=function(b){m=function(d,c,e){return new b(d,c,e)}};primitive.setPAUSE=function(b){q=function(d){return new b(d)}}})();var control={};
(function(){var m=function(b){this.depth=b};m.prototype.invoke=function(b){debug("SET "+this.depth);if(0>b.vstack.length-1-(this.depth||0))throw types.internalError("vstack not long enough",b.captureCurrentContinuationMarks(aState));b.setn(this.depth,b.v)};var q=function(b){this.n=b};q.prototype.invoke=function(b){b.pushn(this.n)};var c=function(b){this.depth=b};c.prototype.invoke=function(b){debug("SWAP "+this.depth);if(0>b.vstack.length-1-(this.depth||0))throw types.internalError("vstack not long enough",
b.captureCurrentContinuationMarks(aState));var c=b.vstack[b.vstack.length-1-(this.depth||0)];b.vstack[b.vstack.length-1-(this.depth||0)]=b.v;b.v=c};var b=function(b){this.n=b};b.prototype.invoke=function(b){b.popn(this.n)};var e=function(b,c){this.prefix=b;this.body=c};e.prototype.invoke=function(b){o(b,this.prefix);var c=[],e;for(e=0;e<this.body.length;e++)c.push(this.body[e]);b.pushManyControls(c)};var o=function(b,c){for(var e=c.numLifts,j=new types.PrefixValue,k=0;k<c.toplevels.length+e;k++){var m=
c.toplevels[k];if(!1===m)j.addSlot();else if("module-variable"===m.$){var o=b,p=j,q=m,m=q.modidx.path,q=q.sym+"",w=primitive.getPrimitive(q,m);o.globals[q]="undefined"!==typeof w?new types.GlobalBucket(q,w):new types.GlobalBucket(q,new types.ModuleVariableRecord(m,q));p.addSlot(o.globals[q])}else if("global-bucket"===m.$)o=b,p=j,m=m.value+"",o.globals[m]||(o.globals[m]=new types.GlobalBucket(m,types.UNDEFINED)),p.addSlot(o.globals[m]);else throw types.internalError("unable to install toplevel element "+
m,state.captureCurrentContinuationMarks(b));}b.vstack.push(j)},J=function(b){this.value=b};J.prototype.invoke=function(b){b.v=this.value};var w=function(b,c,e){this.test=b;this.thenPart=c;this.elsePart=e};w.prototype.invoke=function(b){var c=[];c.push(this.test);c.push(new k(this.thenPart,this.elsePart));b.pushManyControls(c)};var k=function(b,c){this.thenPart=b;this.elsePart=c};k.prototype.invoke=function(b){debug("BRANCH");!1!==b.v&&void 0!==b.v?b.pushControl(this.thenPart):b.pushControl(this.elsePart)};
var A=function(b){this.name=b};A.prototype.invoke=function(b){var c=this;throw new j(function(e){if(b.invokedModules[c.name])e(types.VOID);else{var j=function(b){return"undefined"!==typeof window.COLLECTIONS&&window.COLLECTIONS[b]},k=function(){e(types.schemeError(types.incompleteExn(types.exn,"unable to load "+c.name+": it isn't in the set of known collections",[])))};j(c.name)?aa(b,window.COLLECTIONS[c.name],e):b.hooks.dynamicModuleLoader(c.name,function(){j(c.name)?aa(b,window.COLLECTIONS[c.name],
e):k()},k)}});};var aa=function(b,c,e){b.clearForEval({preserveBreak:!0,clearGlobals:!0});interpret.load(c.bytecode,b);interpret.run(b,function(){for(var j={},k=0;k<c.provides.length;k++){var m=c.provides[k],o=b.globals[m];if(o)j[m]=o.value;else{e(types.schemeError(types.exn("module "+c.name+" is missing an expected definition for "+m)));return}}b.invokedModules[c.name]={record:c,providedValues:j};e(types.VOID)},function(b){e(b)})},T=function(b){this.forms=b};T.prototype.invoke=function(b){for(var c=
this.forms,e=[],j=0;j<c.length;j++)e.push(c[j]);b.pushManyControls(e)};var sa=function(b){this.seq=b};sa.prototype.invoke=function(b){if(1===this.seq.length)b.pushControl(this.seq[0]);else{for(var c=[],e=1;e<this.seq.length;e++)c.push(this.seq[e]);b.pushManyControls([this.seq[0],new W(c)])}};var W=function(b){this.rest=b};W.prototype.invoke=function(b){b.pushControl(new J(b.v));b.pushManyControls(this.rest)};var C=function(b,c,e){this.depth=b;this.pos=c;this.loc=e};C.prototype.invoke=function(b){b.v=
b.refPrefix(this.depth,this.pos,this.loc)};var ca=function(b,c){this.pos=b;this.isUnbox=c};ca.prototype.invoke=function(b){var c=b.peekn(this.pos);this.isUnbox&&(c=c.unbox());b.v=c};var X=function(b){this.name=b+""};X.prototype.invoke=function(b){var c=primitive.getPrimitive(this.name,void 0);if(!c)throw types.internalError("Primitive "+this.name+" not implemented!",state.captureCurrentContinuationMarks(b));b.v=c};var R=function(b){this.name=b.name;this.locs=b.locs;this.numParams=b.numParams;this.paramTypes=
b.paramTypes;this.isRest=b.isRest;this.closureMap=b.closureMap;this.closureTypes=b.closureTypes;this.body=b.body};R.prototype.invoke=function(b){b.v=new types.ClosureValue(this.name,this.locs,this.numParams,this.paramTypes,this.isRest,ia(b,this.closureMap,this.closureTypes),this.body)};var ia=function(b,c){for(var e=[],j=0;j<c.length;j++){var k;k=b.peekn(c[j]);e.push(k)}return e},L=function(b,c){this.procs=b;this.body=c};L.prototype.invoke=function(b){for(var c=[],e=this.procs.length,j=0;j<e;j++)c.push(this.procs[j]),
c.push(new m(e-1-j));c.push(new pa(this.procs));c.push(this.body);b.pushManyControls(c)};var pa=function(b){this.procs=b};pa.prototype.invoke=function(b){for(var c=this.procs.length,e=0;e<c;e++){var j=this.procs[e];b.peekn(c-1-e).closureVals=ia(b,j.closureMap,j.closureTypes)}};var y=function(b,c){this.ids=b;this.body=c};y.prototype.invoke=function(b){var c=[];c.push(this.body);c.push(new V(this.ids));b.pushManyControls(c)};var V=function(b){this.ids=b};V.prototype.invoke=function(b){debug("DEF_VALUES");
state.captureCurrentContinuationMarks(b).ref(types.symbol("moby-application-position-key"));var c=b.v;if(c instanceof types.ValuesWrapper){this.ids.length!==c.elts.length&&helpers.raise(types.exnFailContractArity("define-values: expected "+this.ids.length+" values, but received "+c.elts.length,state.captureCurrentContinuationMarks(b)));for(var e=0;e<this.ids.length;e++)b.setPrefix(this.ids[e].depth,this.ids[e].pos,c.elts[e])}else 1!==this.ids.length?helpers.raise(types.exnFailContractArity("define-values: expected "+
this.ids.length+" values, but only received one: "+c,state.captureCurrentContinuationMarks(b))):b.setPrefix(this.ids[0].depth,this.ids[0].pos,c)};var Z=function(b,c){this.rator=b;this.rands=c};Z.prototype.invoke=function(b){var e=this.rator,j=this.rands,k=[];0!==j.length&&k.push(new q(j.length));k.push(e);0!==j.length&&k.push(new m(j.length-1));for(e=0;e<j.length;e++)e!==j.length-1?(k.push(j[e]),k.push(new m(e))):(k.push(j[j.length-1]),k.push(new c(j.length-1)));k.push(new ha(j.length));b.pushManyControls(k)};
var ha=function(b){this.n=b};ha.prototype.invoke=function(b){debug("CALL "+this.n);for(var c=[],e=0;e<this.n;e++)c.push(b.popValue());ma(b,b.v,this.n,c)};var ma=function(c,e,j,k){e=F(c,j,e,k);if(primitive.isPrimitive(e)){0!==c.cstack.length&&c.cstack[c.cstack.length-1]instanceof b&&c.cstack.pop().invoke(c);var m=[];m.push(c);if(j<e.numParams)var o;if(e.isRest){for(o=0;o<e.numParams;o++)m.push(k.shift());var q=[];for(o=0;o<j-e.numParams;o++)q.push(k.shift());m.push(q)}else for(o=0;o<e.numParams;o++)m.push(k.shift());
j=e.impl.apply(e.impl,m);p(c,j,e)}else if(e instanceof types.ClosureValue)0!==c.cstack.length&&c.cstack[c.cstack.length-1]instanceof b?(c.cstack.pop().invoke(c),j=Ka(c,e,k,j),c.pushControl(new b(j))):2<=c.cstack.length&&types.isContMarkRecordControl(c.cstack[c.cstack.length-1])&&c.cstack[c.cstack.length-2]instanceof b?(c.cstack[c.cstack.length-2].invoke(c),j=Ka(c,e,k,j),c.cstack[c.cstack.length-2]=new b(j)):(j=Ka(c,e,k,j),c.pushControl(new b(j))),c.pushControl(e.body);else if(e instanceof types.ContinuationClosureValue)c.v=
1===j?k[0]:new types.ValuesWrapper(k),c.vstack=e.vstack,c.cstack=e.cstack;else throw types.internalError("Something went wrong with checking procedures!",state.captureCurrentContinuationMarks(c));},p=function(b,c,e){if(c instanceof z){b.cstack.push(new la(c.k,e));var e=c.operands.length,k,m=types.makeLowLevelEqHash(),o=[types.NoLocation];for(k=0;k<e;k++)o.push(types.NoLocation);m.put(types.symbol("moby-application-position-key"),types.list(o));b.pushControl(types.contMarkRecordControl(m));ma(b,c.operator,
c.operands.length,c.operands)}else{if(c instanceof M)throw new j(c.onPause);e.assignsToValueRegister||(b.v=c)}},j=function(b){this.onPause=b},z=function(b,c,e){this.operator=b;this.operands=c;this.k=e},la=function(b,c){this.k=b;this.procValue=c};la.prototype.invoke=function(b){p(b,this.k(b.v),this.procValue)};primitive.setCALL(z);var M=function(b){this.onPause=b};primitive.setPAUSE(M);var F=function(b,c,e,j){var k=function(){var b="";if(0<j.length){for(var b=[":"],c=0;c<j.length;c++)b.push(types.toWrittenString(j[c]));
b=b.join(" ")}return b},m=function(b){var c=[];if(0<j.length)for(var e=0;e<j.length;e++)c.push(new types.ColoredPart(j[e]+(e<j.length-1?" ":""),b.first())),b=b.rest();return c};if(!types.isFunction(e)){k("; arguments were:");for(var k=state.captureCurrentContinuationMarks(b).ref(types.symbol("moby-application-position-key")),o=k=k[k.length-1],p;!o.isEmpty();)p=o.first().elts,o=o.rest();o=m(k.rest());o=types.vector([p[0],p[1],p[2],p[3],1]);p=types.vector([p[0],p[1]+p[4]-1,p[2],p[3]+p[4]-1,1]);helpers.raise(types.incompleteExn(types.exnFailContract,
new types.Message([new types.MultiPart("function call",[o,p],!0),": expected function, given: ",new types.ColoredPart(e,k.first())]),[]))}if(e instanceof types.CaseLambdaValue){for(k=0;k<e.closures.length;k++)if(c===e.closures[k].numParams||c>e.closures[k].numParams&&e.closures[k].isRest)return e.closures[k];p=[];for(k=0;k<e.closures.length;k++)p.push(e.closures[k].numParams+"");k=state.captureCurrentContinuationMarks(b).ref(types.symbol("moby-application-position-key"));k=k[k.length-1];o=m(k.rest());
helpers.raise(types.incompleteExn(types.exnFailContractArity,new types.Message([new types.ColoredPart(e.name?e.name:"#<case-lambda-procedure>",k.first()),": expects [",p.join(", "),"] arguments, but given ",c,new types.GradientPart(o)]),[]))}else if(e instanceof primitive.CasePrimitive){for(k=0;k<e.cases.length;k++)if(c===e.cases[k].numParams||c>e.cases[k].numParams&&e.cases[k].isRest)return e.cases[k];p=[];for(k=0;k<e.cases.length;k++)p.push(e.cases[k].numParams+"");k=state.captureCurrentContinuationMarks(b).ref(types.symbol("moby-application-position-key"));
k=k[k.length-1];o=m(k.rest());helpers.raise(types.incompleteExn(types.exnFailContractArity,new types.Message([new types.ColoredPart(e.name,k.first()),": expects ",p.join(" or ")," arguments, but given ",c,0<o.length?": ":"",0<o.length?new types.GradientPart(o):""]),[]))}if(e instanceof types.ContinuationClosureValue||c===e.numParams||c>e.numParams&&e.isRest)return e;k=state.captureCurrentContinuationMarks(b).ref(types.symbol("moby-application-position-key"));k=k[k.length-1];o=m(k.rest());helpers.raise(types.incompleteExn(types.exnFailContractArityWithPosition,
new types.Message([new types.ColoredPart(""+(e.name!==types.EMPTY?e.name:"anonymous function"),k.first()),": expects ",""+(e.isRest?"at least ":""),void 0!=e.locs?new types.MultiPart(e.numParams+" argument"+(1==e.numParams?"":"s"),e.locs.slice(1),!1):e.numParams+" argument"+(1==e.numParams?"":"s"),", but given ",c,0<o.length?": ":"",0<o.length?new types.GradientPart(o):""]),[]))},Ka=function(b,c,e,j){var k=0;if(c.isRest){var m=types.EMPTY,o;for(o=0;o<j-c.numParams;o++)m=types.cons(e.pop(),m);b.pushValue(m);
k++}for(o=e.length-1;0<=o;o--)b.pushValue(e[o]),k++;for(o=c.closureVals.length-1;0<=o;o--)b.pushValue(c.closureVals[o]),k++;return k},ra=function(b,c,e){this.key=b;this.val=c;this.body=e};ra.prototype.invoke=function(b){var c=[];c.push(this.key);c.push(new Q(this.val,this.body));b.pushManyControls(c)};var Q=function(b,c){this.val=b;this.body=c};Q.prototype.invoke=function(b){var c=b.v,e=[];e.push(this.val);e.push(new E(c,this.body));b.pushManyControls(e)};var E=function(b,c){this.key=b;this.body=
c};E.prototype.invoke=function(b){var c=b.v;if(0!==b.cstack.length&&types.isContMarkRecordControl(b.cstack[b.cstack.length-1]))b.pushControl(b.cstack.pop().update(this.key,c));else{var e=types.makeLowLevelEqHash();e.put(this.key,c);b.pushControl(types.contMarkRecordControl(e))}b.pushControl(this.body)};var da=function(b,c){this.proc=b;this.argsExpr=c};da.prototype.invoke=function(b){var c=[];c.push(this.proc);c.push(new D(this.argsExpr));b.pushManyControls(c)};var D=function(b){this.expr=b};D.prototype.invoke=
function(b){var c=[];c.push(this.expr);c.push(new fa(b.v));b.pushManyControls(c)};var fa=function(b){this.procVal=b};fa.prototype.invoke=function(b){var c=b.v;b.v=this.procVal;if(c instanceof types.ValuesWrapper){for(var e=c.elts,c=e.length-1;0<=c;c--)b.pushValue(e[c]);b.pushControl(new ha(e.length))}else b.pushValue(c),b.pushControl(new ha(1))};var Y=function(b,c){this.rhs=b;this.body=c};Y.prototype.invoke=function(c){var e=[];c.pushn(1);e.push(this.rhs);e.push(new m(0));e.push(this.body);e.push(new b(1));
c.pushManyControls(e)};var U=function(b){this.count=b.count;this.isBoxes=b.isBoxes;this.body=b.body};U.prototype.invoke=function(c){var e=[],j=this.count;c.pushn(j);if(this.isBoxes)for(var k=0;k<j;k++)c.setn(k,types.box(types.UNDEFINED));e.push(this.body);e.push(new b(j));c.pushManyControls(e)};var I=function(b,c){this.pos=b;this.body=c};I.prototype.invoke=function(b){b.setn(this.pos,types.box(b.peekn(this.pos)));b.pushControl(this.body)};var B=function(b){this.count=b.count;this.pos=b.pos;this.isBoxes=
b.isBoxes;this.rhs=b.rhs;this.body=b.body};B.prototype.invoke=function(b){var c=[];c.push(this.rhs);c.push(new xa(this.count,this.pos,this.isBoxes,this.body));b.pushManyControls(c)};var xa=function(b,c,e,j){this.count=b;this.pos=c;this.isBoxes=e;this.body=j};xa.prototype.invoke=function(b){var c=b.v,e=[];c instanceof types.ValuesWrapper?(this.count!==c.elts.length&&helpers.raise(types.exnFailContractArity("expected "+this.count+" values, but received "+c.elts.length,b.captureCurrentContinuationMarks(aState))),
e=c.elts):(1!==this.count&&helpers.raise(types.exnFailContractArity("expected "+this.count+" values, but received one",b.captureCurrentContinuationMarks(aState))),e=[c]);if(this.isBoxes)for(c=0;c<this.count;c++)b.peekn(c+this.pos).set(e[c]);else for(c=0;c<this.count;c++)b.setn(c+this.pos,e[c]);b.pushControl(this.body)};var Fa=function(b){this.id=b.id;this.rhs=b.rhs;this.isUndefOk=b.isUndefOk};Fa.prototype.invoke=function(b){var c=[];c.push(this.rhs);c.push(new qa(this.id.depth,this.id.pos,this.isUndefOk));
b.pushManyControls(c)};var qa=function(b,c,e){this.depth=b;this.pos=c;this.isUndefOk=e};qa.prototype.invoke=function(b){debug("SET_TOPLEVEL "+this.depth+", "+this.pos);if(0>b.vstack.length-1-(this.depth||0))throw types.internalError("vstack not long enough",state.captureCurrentContinuationMarks(b));b.setPrefix(this.depth,this.pos,b.v)};var za=function(b){this.toplevel=b};za.prototype.invoke=function(b){b.v=new types.VariableReference(b.vstack[b.vstack.length-1-this.toplevel.depth],this.toplevel.pos)};
var va=function(b){this.genId=b+""};va.prototype.invoke=function(b){b.v=b.heap[this.genId]};var $=function(b,c){this.name=b;this.clauses=c};$.prototype.invoke=function(b){var c=this.clauses;0===c.length?b.v=new types.CaseLambdaValue(this.name,[]):(b.pushControl(new ea(this.name,types.list(c).rest(),types.list([]))),b.pushControl(c[0]))};var ea=function(b,c,e){this.name=b;this.lamsToEvaluate=c;this.evaluatedLams=e};ea.prototype.invoke=function(b){var c=b.v;if(this.lamsToEvaluate.isEmpty()){for(var c=
types.cons(c,this.evaluatedLams).reverse(),e=[];!c.isEmpty();)e.push(c.first()),c=c.rest();b.v=new types.CaseLambdaValue(this.name,e)}else b.pushControl(new ea(this.name,this.lamsToEvaluate.rest(),types.cons(c,this.evaluatedLams))),b.pushControl(this.lamsToEvaluate.first())};control.processPrefix=o;control.ConstantControl=J;control.BranchControl=w;control.SeqControl=T;control.Beg0Control=sa;control.ModControl=e;control.Prefix=function(b){this.numLifts=b.numLifts;this.toplevels=b.toplevels};control.ToplevelControl=
C;control.DefValuesControl=y;control.LamControl=R;control.PrimvalControl=X;control.ApplicationControl=Z;control.LocalrefControl=ca;control.ApplyValuesControl=da;control.LetOneControl=Y;control.LetVoidControl=U;control.BoxenvControl=I;control.InstallValueControl=B;control.WithContMarkControl=ra;control.AssignControl=Fa;control.VarrefControl=za;control.ClosureControl=va;control.CaseLamControl=$;control.LetRecControl=L;control.CallControl=ha;control.RequireControl=A;control.PauseException=j})();
var loader={};
(function(){var m=function(b,e){switch(e.$){case "mod":return new control.ModControl(c(e.prefix),q(b,e.body));case "def-values":return new control.DefValuesControl(e.ids,m(b,e.body));case "indirect":return new control.ConstantControl(b.heap[e.value]);case "apply-values":return new control.ApplyValuesControl(m(b,e.proc),m(b,e["args-expr"]));case "toplevel":return new control.ToplevelControl(e.depth,e.pos,e.loc);case "constant":return new control.ConstantControl(e.value);case "req":return new control.RequireControl(e.reqs+"");
case "seq":return new control.SeqControl(q(b,e.forms));case "application":return new control.ApplicationControl(m(b,e.rator),q(b,e.rands));case "localref":return new control.LocalrefControl(e.pos,e["unbox?"]);case "primval":return new control.PrimvalControl(e.value);case "branch":return new control.BranchControl(m(b,e.test),m(b,e.then),m(b,e["else"]));case "lam":return new control.LamControl({name:e.name,locs:e.locs,numParams:e["num-params"],paramTypes:e["param-types"],isRest:e["rest?"],closureMap:e["closure-map"],
closureTypes:e["closure-types"],body:m(b,e.body)});case "let-one":return new control.LetOneControl(m(b,e.rhs),m(b,e.body));case "let-void":return new control.LetVoidControl({count:e.count,isBoxes:e["boxes?"],body:m(b,e.body)});case "beg0":return new control.Beg0Control(q(b,e.seq));case "boxenv":return new control.BoxenvControl(e.pos,m(b,e.body));case "install-value":return new control.InstallValueControl({count:e.count,pos:e.pos,isBoxes:e["boxes?"],rhs:m(b,e.rhs),body:m(b,e.body)});case "with-cont-mark":return new control.WithContMarkControl(m(b,
e.key),m(b,e.val),m(b,e.body));case "assign":return new control.AssignControl({id:m(b,e.id),rhs:m(b,e.rhs),isUndefOk:e["undef-ok?"]});case "varref":return new control.VarrefControl(m(b,e.toplevel));case "closure":return new control.ClosureCommand(e["gen-id"]);case "case-lam":return new control.CaseLamControl(e.name,q(b,e.clauses));case "let-rec":return new control.LetRecControl(q(b,e.procs),m(b,e.body));default:throw types.internalError("I don't know how to handle "+sys.inspect(e),state.captureCurrentContinuationMarks(b));
}},q=function(b,c){for(var o=[],q=0;q<c.length;q++)o.push(m(b,c[q]));return o},c=function(b){return new control.Prefix({numLifts:b["num-lifts"],toplevels:b.toplevels})};loader.loadCode=m;loader.loadPrefix=c})();var interpret={};
(function(){var m=function(o,q,w){q||(q=function(){});w||(w=function(b){throw b;});try{for(var k=1E4;!o.isStuck()&&0<k;)e(o),k--;if(o.breakRequested)w(types.schemeError(types.exnBreak("user break",state.captureCurrentContinuationMarks(o),new types.ContinuationClosureValue(o.vstack,o.cstack))));else if(0>=k){var A=o.save();setTimeout(function(){o.restore(A);m(o,q,w)},0)}else q(o.v)}catch(aa){if(aa instanceof control.PauseException){var k=b(o,q,w),T=c(o);aa.onPause(k,T)}else types.isSchemeError(aa)&&
types.isIncompleteExn(aa.val)&&(k=state.captureCurrentContinuationMarks(o),aa=types.schemeError(aa.val.constructor.apply(null,[aa.val.msg,k].concat(aa.val.otherArgs)))),w(aa)}},q=function(b,c,e,k,q){var aa=b.save();b.clearForEval({preserveBreak:!0});b.pushControl(new control.ApplicationControl(new control.ConstantControl(c),helpers.map(function(b){return new control.ConstantControl(b)},e)));try{m(b,function(c){b.restore(aa);k(c)},function(c){b.restore(aa);q(c)})}catch(T){throw b.restore(aa),T;}},
c=function(b){return function(c,e,k,m){return q(b,c,e,k,m)}},b=function(b,c,e){var k=b.save();b.clearForEval({preserveBreak:!0});return function(q){b.restore(k);if(types.isSchemeError(q)){if(types.isIncompleteExn(q.val))var aa=state.captureCurrentContinuationMarks(b),q=types.schemeError(q.val.constructor.apply(null,[q.val.msg,aa].concat(q.val.otherArgs)));e(q)}else types.isInternalError(q)?e(q):(b.v=q,m(b,c,e))}},e=function(b){var c=b.popControl();debugF(function(){return sys.inspect(c)});if("object"===
typeof c&&c.invoke)c.invoke(b);else throw types.internalError("I don't know how to handle "+sys.inspect(c),state.captureCurrentContinuationMarks(b));};primitive.addPrimitive("call/cc",new primitive.Primitive("call/cc",1,!1,!0,function(b,c){var e=new types.ContinuationClosureValue(b.vstack,b.cstack);b.pushValue(e);b.v=c;b.pushControl(new control.CallControl(1))}));interpret.load=function(b,c){c||(c=new state.State);try{for(var e=c,k=b["compiled-indirects"],m=0;m<k.length;m++){for(var q=k[m],T=q.lam,
sa=T["num-params"],W=T["param-types"],C=T["rest?"],ca,X=e,R=T["closure-map"],ia=[],L=0;L<R.length;L++){var pa;pa=X.peekn(R[L]);ia.push(pa)}ca=ia;var y=new control.ConstantControl(!1);e.heap[q.id]=new types.ClosureValue(q.id,sa,W,C,ca,y)}for(m=0;m<k.length;m++)q=k[m],T=q.lam,e.heap[q.id].body=loader.loadCode(e,T.body);var V=loader.loadPrefix(b.prefix);control.processPrefix(c,V);c.pushControl(loader.loadCode(c,b.code))}catch(Z){throw types.isSchemeError(Z)&&types.isExn(Z.val)&&!types.isContinuationMarkSet(types.exnContMarks(Z.val))&&
types.exnSetContMarks(Z.val,state.captureCurrentContinuationMarks(c)),Z;}return c};interpret.step=e;interpret.run=m;interpret.call=q})();
